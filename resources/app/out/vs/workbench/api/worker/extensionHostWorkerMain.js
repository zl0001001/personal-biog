/*!--------------------------------------------------------
 * Copyright (C) Microsoft Corporation. All rights reserved.
 *--------------------------------------------------------*/var Zp=function(e,t){return Zp=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(i,r){i.__proto__=r}||function(i,r){for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(i[n]=r[n])},Zp(e,t)};export function __extends(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");Zp(e,t);function i(){this.constructor=e}e.prototype=t===null?Object.create(t):(i.prototype=t.prototype,new i)}export var __assign=function(){return __assign=Object.assign||function(t){for(var i,r=1,n=arguments.length;r<n;r++){i=arguments[r];for(var s in i)Object.prototype.hasOwnProperty.call(i,s)&&(t[s]=i[s])}return t},__assign.apply(this,arguments)};export function __rest(e,t){var i={};for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&t.indexOf(r)<0&&(i[r]=e[r]);if(e!=null&&typeof Object.getOwnPropertySymbols=="function")for(var n=0,r=Object.getOwnPropertySymbols(e);n<r.length;n++)t.indexOf(r[n])<0&&Object.prototype.propertyIsEnumerable.call(e,r[n])&&(i[r[n]]=e[r[n]]);return i}export function __decorate(e,t,i,r){var n=arguments.length,s=n<3?t:r===null?r=Object.getOwnPropertyDescriptor(t,i):r,o;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")s=Reflect.decorate(e,t,i,r);else for(var a=e.length-1;a>=0;a--)(o=e[a])&&(s=(n<3?o(s):n>3?o(t,i,s):o(t,i))||s);return n>3&&s&&Object.defineProperty(t,i,s),s}export function __param(e,t){return function(i,r){t(i,r,e)}}export function __esDecorate(e,t,i,r,n,s){function o(E){if(E!==void 0&&typeof E!="function")throw new TypeError("Function expected");return E}for(var a=r.kind,l=a==="getter"?"get":a==="setter"?"set":"value",c=!t&&e?r.static?e:e.prototype:null,u=t||(c?Object.getOwnPropertyDescriptor(c,r.name):{}),d,f=!1,p=i.length-1;p>=0;p--){var m={};for(var _ in r)m[_]=_==="access"?{}:r[_];for(var _ in r.access)m.access[_]=r.access[_];m.addInitializer=function(E){if(f)throw new TypeError("Cannot add initializers after decoration has completed");s.push(o(E||null))};var b=(0,i[p])(a==="accessor"?{get:u.get,set:u.set}:u[l],m);if(a==="accessor"){if(b===void 0)continue;if(b===null||typeof b!="object")throw new TypeError("Object expected");(d=o(b.get))&&(u.get=d),(d=o(b.set))&&(u.set=d),(d=o(b.init))&&n.unshift(d)}else(d=o(b))&&(a==="field"?n.unshift(d):u[l]=d)}c&&Object.defineProperty(c,r.name,u),f=!0}export function __runInitializers(e,t,i){for(var r=arguments.length>2,n=0;n<t.length;n++)i=r?t[n].call(e,i):t[n].call(e);return r?i:void 0}export function __propKey(e){return typeof e=="symbol"?e:"".concat(e)}export function __setFunctionName(e,t,i){return typeof t=="symbol"&&(t=t.description?"[".concat(t.description,"]"):""),Object.defineProperty(e,"name",{configurable:!0,value:i?"".concat(i," ",t):t})}export function __metadata(e,t){if(typeof Reflect=="object"&&typeof Reflect.metadata=="function")return Reflect.metadata(e,t)}export function __awaiter(e,t,i,r){function n(s){return s instanceof i?s:new i(function(o){o(s)})}return new(i||(i=Promise))(function(s,o){function a(u){try{c(r.next(u))}catch(d){o(d)}}function l(u){try{c(r.throw(u))}catch(d){o(d)}}function c(u){u.done?s(u.value):n(u.value).then(a,l)}c((r=r.apply(e,t||[])).next())})}export function __generator(e,t){var i={label:0,sent:function(){if(s[0]&1)throw s[1];return s[1]},trys:[],ops:[]},r,n,s,o;return o={next:a(0),throw:a(1),return:a(2)},typeof Symbol=="function"&&(o[Symbol.iterator]=function(){return this}),o;function a(c){return function(u){return l([c,u])}}function l(c){if(r)throw new TypeError("Generator is already executing.");for(;o&&(o=0,c[0]&&(i=0)),i;)try{if(r=1,n&&(s=c[0]&2?n.return:c[0]?n.throw||((s=n.return)&&s.call(n),0):n.next)&&!(s=s.call(n,c[1])).done)return s;switch(n=0,s&&(c=[c[0]&2,s.value]),c[0]){case 0:case 1:s=c;break;case 4:return i.label++,{value:c[1],done:!1};case 5:i.label++,n=c[1],c=[0];continue;case 7:c=i.ops.pop(),i.trys.pop();continue;default:if(s=i.trys,!(s=s.length>0&&s[s.length-1])&&(c[0]===6||c[0]===2)){i=0;continue}if(c[0]===3&&(!s||c[1]>s[0]&&c[1]<s[3])){i.label=c[1];break}if(c[0]===6&&i.label<s[1]){i.label=s[1],s=c;break}if(s&&i.label<s[2]){i.label=s[2],i.ops.push(c);break}s[2]&&i.ops.pop(),i.trys.pop();continue}c=t.call(e,i)}catch(u){c=[6,u],n=0}finally{r=s=0}if(c[0]&5)throw c[1];return{value:c[0]?c[1]:void 0,done:!0}}}export var __createBinding=Object.create?function(e,t,i,r){r===void 0&&(r=i);var n=Object.getOwnPropertyDescriptor(t,i);(!n||("get"in n?!t.__esModule:n.writable||n.configurable))&&(n={enumerable:!0,get:function(){return t[i]}}),Object.defineProperty(e,r,n)}:function(e,t,i,r){r===void 0&&(r=i),e[r]=t[i]};export function __exportStar(e,t){for(var i in e)i!=="default"&&!Object.prototype.hasOwnProperty.call(t,i)&&__createBinding(t,e,i)}export function __values(e){var t=typeof Symbol=="function"&&Symbol.iterator,i=t&&e[t],r=0;if(i)return i.call(e);if(e&&typeof e.length=="number")return{next:function(){return e&&r>=e.length&&(e=void 0),{value:e&&e[r++],done:!e}}};throw new TypeError(t?"Object is not iterable.":"Symbol.iterator is not defined.")}export function __read(e,t){var i=typeof Symbol=="function"&&e[Symbol.iterator];if(!i)return e;var r=i.call(e),n,s=[],o;try{for(;(t===void 0||t-- >0)&&!(n=r.next()).done;)s.push(n.value)}catch(a){o={error:a}}finally{try{n&&!n.done&&(i=r.return)&&i.call(r)}finally{if(o)throw o.error}}return s}export function __spread(){for(var e=[],t=0;t<arguments.length;t++)e=e.concat(__read(arguments[t]));return e}export function __spreadArrays(){for(var e=0,t=0,i=arguments.length;t<i;t++)e+=arguments[t].length;for(var r=Array(e),n=0,t=0;t<i;t++)for(var s=arguments[t],o=0,a=s.length;o<a;o++,n++)r[n]=s[o];return r}export function __spreadArray(e,t,i){if(i||arguments.length===2)for(var r=0,n=t.length,s;r<n;r++)(s||!(r in t))&&(s||(s=Array.prototype.slice.call(t,0,r)),s[r]=t[r]);return e.concat(s||Array.prototype.slice.call(t))}export function __await(e){return this instanceof __await?(this.v=e,this):new __await(e)}export function __asyncGenerator(e,t,i){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var r=i.apply(e,t||[]),n,s=[];return n={},a("next"),a("throw"),a("return",o),n[Symbol.asyncIterator]=function(){return this},n;function o(p){return function(m){return Promise.resolve(m).then(p,d)}}function a(p,m){r[p]&&(n[p]=function(_){return new Promise(function(b,E){s.push([p,_,b,E])>1||l(p,_)})},m&&(n[p]=m(n[p])))}function l(p,m){try{c(r[p](m))}catch(_){f(s[0][3],_)}}function c(p){p.value instanceof __await?Promise.resolve(p.value.v).then(u,d):f(s[0][2],p)}function u(p){l("next",p)}function d(p){l("throw",p)}function f(p,m){p(m),s.shift(),s.length&&l(s[0][0],s[0][1])}}export function __asyncDelegator(e){var t,i;return t={},r("next"),r("throw",function(n){throw n}),r("return"),t[Symbol.iterator]=function(){return this},t;function r(n,s){t[n]=e[n]?function(o){return(i=!i)?{value:__await(e[n](o)),done:!1}:s?s(o):o}:s}}export function __asyncValues(e){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var t=e[Symbol.asyncIterator],i;return t?t.call(e):(e=typeof __values=="function"?__values(e):e[Symbol.iterator](),i={},r("next"),r("throw"),r("return"),i[Symbol.asyncIterator]=function(){return this},i);function r(s){i[s]=e[s]&&function(o){return new Promise(function(a,l){o=e[s](o),n(a,l,o.done,o.value)})}}function n(s,o,a,l){Promise.resolve(l).then(function(c){s({value:c,done:a})},o)}}export function __makeTemplateObject(e,t){return Object.defineProperty?Object.defineProperty(e,"raw",{value:t}):e.raw=t,e}var K7=Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t};export function __importStar(e){if(e&&e.__esModule)return e;var t={};if(e!=null)for(var i in e)i!=="default"&&Object.prototype.hasOwnProperty.call(e,i)&&__createBinding(t,e,i);return K7(t,e),t}export function __importDefault(e){return e&&e.__esModule?e:{default:e}}export function __classPrivateFieldGet(e,t,i,r){if(i==="a"&&!r)throw new TypeError("Private accessor was defined without a getter");if(typeof t=="function"?e!==t||!r:!t.has(e))throw new TypeError("Cannot read private member from an object whose class did not declare it");return i==="m"?r:i==="a"?r.call(e):r?r.value:t.get(e)}export function __classPrivateFieldSet(e,t,i,r,n){if(r==="m")throw new TypeError("Private method is not writable");if(r==="a"&&!n)throw new TypeError("Private accessor was defined without a setter");if(typeof t=="function"?e!==t||!n:!t.has(e))throw new TypeError("Cannot write private member to an object whose class did not declare it");return r==="a"?n.call(e,i):n?n.value=i:t.set(e,i),i}export function __classPrivateFieldIn(e,t){if(t===null||typeof t!="object"&&typeof t!="function")throw new TypeError("Cannot use 'in' operator on non-object");return typeof e=="function"?t===e:e.has(t)}export function __addDisposableResource(e,t,i){if(t!=null){if(typeof t!="object"&&typeof t!="function")throw new TypeError("Object expected.");var r,n;if(i){if(!Symbol.asyncDispose)throw new TypeError("Symbol.asyncDispose is not defined.");r=t[Symbol.asyncDispose]}if(r===void 0){if(!Symbol.dispose)throw new TypeError("Symbol.dispose is not defined.");r=t[Symbol.dispose],i&&(n=r)}if(typeof r!="function")throw new TypeError("Object not disposable.");n&&(r=function(){try{n.call(this)}catch(s){return Promise.reject(s)}}),e.stack.push({value:t,dispose:r,async:i})}else i&&e.stack.push({async:!0});return t}var Y7=typeof SuppressedError=="function"?SuppressedError:function(e,t,i){var r=new Error(i);return r.name="SuppressedError",r.error=e,r.suppressed=t,r};export function __disposeResources(e){function t(r){e.error=e.hasError?new Y7(r,e.error,"An error was suppressed during disposal."):r,e.hasError=!0}function i(){for(;e.stack.length;){var r=e.stack.pop();try{var n=r.dispose&&r.dispose.call(r.value);if(r.async)return Promise.resolve(n).then(i,function(s){return t(s),i()})}catch(s){t(s)}}if(e.hasError)throw e.error}return i()}export default{__extends,__assign,__rest,__decorate,__param,__metadata,__awaiter,__generator,__createBinding,__exportStar,__values,__read,__spread,__spreadArrays,__spreadArray,__await,__asyncGenerator,__asyncDelegator,__asyncValues,__makeTemplateObject,__importStar,__importDefault,__classPrivateFieldGet,__classPrivateFieldSet,__classPrivateFieldIn,__addDisposableResource,__disposeResources};var Ci=class{constructor(e){this.executor=e,this._didRun=!1}get hasValue(){return this._didRun}get value(){if(!this._didRun)try{this._value=this.executor()}catch(e){this._error=e}finally{this._didRun=!0}if(this._error)throw this._error;return this._value}get rawValue(){return this._value}},e9=class{constructor(){this.listeners=[],this.unexpectedErrorHandler=function(e){setTimeout(()=>{throw e.stack?as.isErrorNoTelemetry(e)?new as(e.message+`

`+e.stack):new Error(e.message+`

`+e.stack):e},0)}}addListener(e){return this.listeners.push(e),()=>{this._removeListener(e)}}emit(e){this.listeners.forEach(t=>{t(e)})}_removeListener(e){this.listeners.splice(this.listeners.indexOf(e),1)}setUnexpectedErrorHandler(e){this.unexpectedErrorHandler=e}getUnexpectedErrorHandler(){return this.unexpectedErrorHandler}onUnexpectedError(e){this.unexpectedErrorHandler(e),this.emit(e)}onUnexpectedExternalError(e){this.unexpectedErrorHandler(e)}},tl=new e9;function Kp(e){tl.setUnexpectedErrorHandler(e)}function Iu(e){tl.onUnexpectedError(e)}function Qt(e){br(e)||tl.onUnexpectedError(e)}function Qw(e){br(e)||tl.onUnexpectedExternalError(e)}function wo(e){if(e instanceof Error){const{name:t,message:i,cause:r}=e,n=e.stacktrace||e.stack;return{$isError:!0,name:t,message:i,stack:n,noTelemetry:as.isErrorNoTelemetry(e),cause:r?wo(r):void 0,code:e.code}}return e}function Jw(e){let t;return e.noTelemetry?t=new as:(t=new Error,t.name=e.name),t.message=e.message,t.stack=e.stack,e.code&&(t.code=e.code),e.cause&&(t.cause=Jw(e.cause)),t}var ku="Canceled";function br(e){return e instanceof xr?!0:e instanceof Error&&e.name===ku&&e.message===ku}var xr=class extends Error{constructor(){super(ku),this.name=this.message}};function Xw(){const e=new Error(ku);return e.name=e.message,e}function Se(e){return e?new Error(`Illegal argument: ${e}`):new Error("Illegal argument")}function Yp(e){return e?new Error(`Illegal state: ${e}`):new Error("Illegal state")}var os=class extends TypeError{constructor(e){super(e?`${e} is read-only and cannot be changed`:"Cannot change read-only property")}},t9=class extends Error{constructor(e){super("NotImplemented"),e&&(this.message=e)}},eg=class extends Error{constructor(e){super("NotSupported"),e&&(this.message=e)}},as=class ww extends Error{constructor(t){super(t),this.name="CodeExpectedError"}static fromError(t){if(t instanceof ww)return t;const i=new ww;return i.message=t.message,i.stack=t.stack,i}static isErrorNoTelemetry(t){return t.name==="CodeExpectedError"}},Oi=class f6 extends Error{constructor(t){super(t||"An unexpected bug occurred."),Object.setPrototypeOf(this,f6.prototype)}};function i9(e,t,i=e.length-1){const r=r9(e,t,i);if(r!==-1)return e[r]}function r9(e,t,i=e.length-1){for(let r=i;r>=0;r--){const n=e[r];if(t(n))return r}return-1}function n9(e,t,i=0,r=e.length){let n=i,s=r;for(;n<s;){const o=Math.floor((n+s)/2);t(e[o])?n=o+1:s=o}return n-1}var aU=class p6{static{this.assertInvariants=!1}constructor(t){this._array=t,this._findLastMonotonousLastIdx=0}findLastMonotonous(t){if(p6.assertInvariants){if(this._prevFindLastPredicate){for(const r of this._array)if(this._prevFindLastPredicate(r)&&!t(r))throw new Error("MonotonousArray: current predicate must be weaker than (or equal to) the previous predicate.")}this._prevFindLastPredicate=t}const i=n9(this._array,t,this._findLastMonotonousLastIdx);return this._findLastMonotonousLastIdx=i+1,i===-1?void 0:this._array[i]}};function Sr(e,t,i=(r,n)=>r===n){if(e===t)return!0;if(!e||!t||e.length!==t.length)return!1;for(let r=0,n=e.length;r<n;r++)if(!i(e[r],t[r]))return!1;return!0}function s9(e,t){const i=[];let r;for(const n of e.slice(0).sort(t))!r||t(r[0],n)!==0?(r=[n],i.push(r)):r.push(n);return i}function Zw(e,t,i){const r=[];function n(a,l,c){if(l===0&&c.length===0)return;const u=r[r.length-1];u&&u.start+u.deleteCount===a?(u.deleteCount+=l,u.toInsert.push(...c)):r.push({start:a,deleteCount:l,toInsert:c})}let s=0,o=0;for(;;){if(s===e.length){n(s,0,t.slice(o));break}if(o===t.length){n(s,e.length-s,[]);break}const a=e[s],l=t[o],c=i(a,l);c===0?(s+=1,o+=1):c<0?(n(s,1,[]),s+=1):c>0&&(n(s,0,[l]),o+=1)}return r}function o9(e,t,i){const r=Zw(e,t,i),n=[],s=[];for(const o of r)n.push(...e.slice(o.start,o.start+o.deleteCount)),s.push(...o.toInsert);return{removed:n,added:s}}function xt(e){return e.filter(t=>!!t)}function a9(e){let t=0;for(let i=0;i<e.length;i++)e[i]&&(e[t]=e[i],t+=1);e.length=t}function tg(e){return!Array.isArray(e)||e.length===0}function yo(e){return Array.isArray(e)&&e.length>0}function bo(e,t=i=>i){const i=new Set;return e.filter(r=>{const n=t(r);return i.has(n)?!1:(i.add(n),!0)})}function Kw(e,t){let i;if(typeof t=="number"){let r=t;i=()=>{const n=Math.sin(r++)*179426549;return n-Math.floor(n)}}else i=Math.random;for(let r=e.length-1;r>0;r-=1){const n=Math.floor(i()*(r+1)),s=e[r];e[r]=e[n],e[n]=s}}function ig(e,t){return Array.isArray(e)?e.map(t):t(e)}function Fi(e){return Array.isArray(e)?e:[e]}var rg;(function(e){function t(s){return s<0}e.isLessThan=t;function i(s){return s<=0}e.isLessThanOrEqual=i;function r(s){return s>0}e.isGreaterThan=r;function n(s){return s===0}e.isNeitherLessOrGreaterThan=n,e.greaterThan=1,e.lessThan=-1,e.neitherLessOrGreaterThan=0})(rg||(rg={}));function l9(e,t){return(i,r)=>t(e(i),e(r))}var c9=(e,t)=>e-t,lU=class Rp{static{this.empty=new Rp(t=>{})}constructor(t){this.iterate=t}forEach(t){this.iterate(i=>(t(i),!0))}toArray(){const t=[];return this.iterate(i=>(t.push(i),!0)),t}filter(t){return new Rp(i=>this.iterate(r=>t(r)?i(r):!0))}map(t){return new Rp(i=>this.iterate(r=>i(t(r))))}some(t){let i=!1;return this.iterate(r=>(i=t(r),!i)),i}findFirst(t){let i;return this.iterate(r=>t(r)?(i=r,!1):!0),i}findLast(t){let i;return this.iterate(r=>(t(r)&&(i=r),!0)),i}findLastMaxBy(t){let i,r=!0;return this.iterate(n=>((r||rg.isGreaterThan(t(n,i)))&&(r=!1,i=n),!0)),i}},Yw;function ey(e,t){const i=Object.create(null);for(const r of e){const n=t(r);let s=i[n];s||(s=i[n]=[]),s.push(r)}return i}function u9(e,t){const i=[],r=[];for(const n of e)t.has(n)||i.push(n);for(const n of t)e.has(n)||r.push(n);return{removed:i,added:r}}var cU=class{static{Yw=Symbol.toStringTag}constructor(e,t){this.toKey=t,this._map=new Map,this[Yw]="SetWithKey";for(const i of e)this.add(i)}get size(){return this._map.size}add(e){const t=this.toKey(e);return this._map.set(t,e),this}delete(e){return this._map.delete(this.toKey(e))}has(e){return this._map.has(this.toKey(e))}*entries(){for(const e of this._map.values())yield[e,e]}keys(){return this.values()}*values(){for(const e of this._map.values())yield e}clear(){this._map.clear()}forEach(e,t){this._map.forEach(i=>e.call(t,i,i,this))}[Symbol.iterator](){return this.values()}},ty,iy,ry;function d9(e,t,i){let r=e.get(t);return r===void 0&&(r=i,e.set(t,r)),r}var h9=class{constructor(e,t){this.uri=e,this.value=t}};function f9(e){return Array.isArray(e)}var Ft=class fu{static{this.defaultToKey=t=>t.toString()}constructor(t,i){if(this[ty]="ResourceMap",t instanceof fu)this.map=new Map(t.map),this.toKey=i??fu.defaultToKey;else if(f9(t)){this.map=new Map,this.toKey=i??fu.defaultToKey;for(const[r,n]of t)this.set(r,n)}else this.map=new Map,this.toKey=t??fu.defaultToKey}set(t,i){return this.map.set(this.toKey(t),new h9(t,i)),this}get(t){return this.map.get(this.toKey(t))?.value}has(t){return this.map.has(this.toKey(t))}get size(){return this.map.size}clear(){this.map.clear()}delete(t){return this.map.delete(this.toKey(t))}forEach(t,i){typeof i<"u"&&(t=t.bind(i));for(const[r,n]of this.map)t(n.value,n.uri,this)}*values(){for(const t of this.map.values())yield t.value}*keys(){for(const t of this.map.values())yield t.uri}*entries(){for(const t of this.map.values())yield[t.uri,t.value]}*[(ty=Symbol.toStringTag,Symbol.iterator)](){for(const[,t]of this.map)yield[t.uri,t.value]}},ny=class{constructor(e,t){this[iy]="ResourceSet",!e||typeof e=="function"?this._map=new Ft(e):(this._map=new Ft(t),e.forEach(this.add,this))}get size(){return this._map.size}add(e){return this._map.set(e,e),this}clear(){this._map.clear()}delete(e){return this._map.delete(e)}forEach(e,t){this._map.forEach((i,r)=>e.call(t,r,r,this))}has(e){return this._map.has(e)}entries(){return this._map.entries()}keys(){return this._map.keys()}values(){return this._map.keys()}[(iy=Symbol.toStringTag,Symbol.iterator)](){return this.keys()}},sy;(function(e){e[e.None=0]="None",e[e.AsOld=1]="AsOld",e[e.AsNew=2]="AsNew"})(sy||(sy={}));var p9=class{constructor(){this[ry]="LinkedMap",this._map=new Map,this._head=void 0,this._tail=void 0,this._size=0,this._state=0}clear(){this._map.clear(),this._head=void 0,this._tail=void 0,this._size=0,this._state++}isEmpty(){return!this._head&&!this._tail}get size(){return this._size}get first(){return this._head?.value}get last(){return this._tail?.value}has(e){return this._map.has(e)}get(e,t=0){const i=this._map.get(e);if(i)return t!==0&&this.touch(i,t),i.value}set(e,t,i=0){let r=this._map.get(e);if(r)r.value=t,i!==0&&this.touch(r,i);else{switch(r={key:e,value:t,next:void 0,previous:void 0},i){case 0:this.addItemLast(r);break;case 1:this.addItemFirst(r);break;case 2:this.addItemLast(r);break;default:this.addItemLast(r);break}this._map.set(e,r),this._size++}return this}delete(e){return!!this.remove(e)}remove(e){const t=this._map.get(e);if(t)return this._map.delete(e),this.removeItem(t),this._size--,t.value}shift(){if(!this._head&&!this._tail)return;if(!this._head||!this._tail)throw new Error("Invalid list");const e=this._head;return this._map.delete(e.key),this.removeItem(e),this._size--,e.value}forEach(e,t){const i=this._state;let r=this._head;for(;r;){if(t?e.bind(t)(r.value,r.key,this):e(r.value,r.key,this),this._state!==i)throw new Error("LinkedMap got modified during iteration.");r=r.next}}keys(){const e=this,t=this._state;let i=this._head;const r={[Symbol.iterator](){return r},next(){if(e._state!==t)throw new Error("LinkedMap got modified during iteration.");if(i){const n={value:i.key,done:!1};return i=i.next,n}else return{value:void 0,done:!0}}};return r}values(){const e=this,t=this._state;let i=this._head;const r={[Symbol.iterator](){return r},next(){if(e._state!==t)throw new Error("LinkedMap got modified during iteration.");if(i){const n={value:i.value,done:!1};return i=i.next,n}else return{value:void 0,done:!0}}};return r}entries(){const e=this,t=this._state;let i=this._head;const r={[Symbol.iterator](){return r},next(){if(e._state!==t)throw new Error("LinkedMap got modified during iteration.");if(i){const n={value:[i.key,i.value],done:!1};return i=i.next,n}else return{value:void 0,done:!0}}};return r}[(ry=Symbol.toStringTag,Symbol.iterator)](){return this.entries()}trimOld(e){if(e>=this.size)return;if(e===0){this.clear();return}let t=this._head,i=this.size;for(;t&&i>e;)this._map.delete(t.key),t=t.next,i--;this._head=t,this._size=i,t&&(t.previous=void 0),this._state++}trimNew(e){if(e>=this.size)return;if(e===0){this.clear();return}let t=this._tail,i=this.size;for(;t&&i>e;)this._map.delete(t.key),t=t.previous,i--;this._tail=t,this._size=i,t&&(t.next=void 0),this._state++}addItemFirst(e){if(!this._head&&!this._tail)this._tail=e;else if(this._head)e.next=this._head,this._head.previous=e;else throw new Error("Invalid list");this._head=e,this._state++}addItemLast(e){if(!this._head&&!this._tail)this._head=e;else if(this._tail)e.previous=this._tail,this._tail.next=e;else throw new Error("Invalid list");this._tail=e,this._state++}removeItem(e){if(e===this._head&&e===this._tail)this._head=void 0,this._tail=void 0;else if(e===this._head){if(!e.next)throw new Error("Invalid list");e.next.previous=void 0,this._head=e.next}else if(e===this._tail){if(!e.previous)throw new Error("Invalid list");e.previous.next=void 0,this._tail=e.previous}else{const t=e.next,i=e.previous;if(!t||!i)throw new Error("Invalid list");t.previous=i,i.next=t}e.next=void 0,e.previous=void 0,this._state++}touch(e,t){if(!this._head||!this._tail)throw new Error("Invalid list");if(!(t!==1&&t!==2)){if(t===1){if(e===this._head)return;const i=e.next,r=e.previous;e===this._tail?(r.next=void 0,this._tail=r):(i.previous=r,r.next=i),e.previous=void 0,e.next=this._head,this._head.previous=e,this._head=e,this._state++}else if(t===2){if(e===this._tail)return;const i=e.next,r=e.previous;e===this._head?(i.previous=void 0,this._head=i):(i.previous=r,r.next=i),e.next=void 0,e.previous=this._tail,this._tail.next=e,this._tail=e,this._state++}}}toJSON(){const e=[];return this.forEach((t,i)=>{e.push([i,t])}),e}fromJSON(e){this.clear();for(const[t,i]of e)this.set(t,i)}},g9=class extends p9{constructor(e,t=1){super(),this._limit=e,this._ratio=Math.min(Math.max(0,t),1)}get limit(){return this._limit}set limit(e){this._limit=e,this.checkTrim()}get ratio(){return this._ratio}set ratio(e){this._ratio=Math.min(Math.max(0,e),1),this.checkTrim()}get(e,t=2){return super.get(e,t)}peek(e){return super.get(e,0)}set(e,t){return super.set(e,t,2),this}checkTrim(){this.size>this._limit&&this.trim(Math.round(this._limit*this._ratio))}},ng=class extends g9{constructor(e,t=1){super(e,t)}trim(e){this.trimOld(e)}set(e,t){return super.set(e,t),this.checkTrim(),this}},oy=class{constructor(){this.map=new Map}add(e,t){let i=this.map.get(e);i||(i=new Set,this.map.set(e,i)),i.add(t)}delete(e,t){const i=this.map.get(e);i&&(i.delete(t),i.size===0&&this.map.delete(e))}forEach(e,t){const i=this.map.get(e);i&&i.forEach(t)}get(e){const t=this.map.get(e);return t||new Set}};function sg(e,t){const i=this;let r=!1,n;return function(){if(r)return n;if(r=!0,t)try{n=e.apply(i,arguments)}finally{t()}else n=e.apply(i,arguments);return n}}function si(e,t){if(!e)throw new Error(t?`Assertion failed (${t})`:"Assertion Failed")}function og(e,t="Unreachable"){throw new Error(t)}function ag(e,t="unexpected state"){if(!e)throw typeof t=="string"?new Oi(`Assertion Failed: ${t}`):t}function ay(e){if(!e()){debugger;e(),Qt(new Oi("Assertion Failed"))}}function Me(e){return typeof e=="string"}function m9(e){return Array.isArray(e)&&e.every(t=>Me(t))}function St(e){return typeof e=="object"&&e!==null&&!Array.isArray(e)&&!(e instanceof RegExp)&&!(e instanceof Date)}function v9(e){const t=Object.getPrototypeOf(Uint8Array);return typeof e=="object"&&e instanceof t}function ls(e){return typeof e=="number"&&!isNaN(e)}function _9(e){return!!e&&typeof e[Symbol.iterator]=="function"}function il(e){return typeof e>"u"}function ji(e){return!Et(e)}function Et(e){return il(e)||e===null}function ly(e,t){if(!e)throw new Error(t?`Unexpected type, expected '${t}'`:"Unexpected type")}function xo(e){return ag(e!=null,"Argument is `undefined` or `null`."),e}var w9=Object.prototype.hasOwnProperty;function cy(e){if(!St(e))return!1;for(const t in e)if(w9.call(e,t))return!1;return!0}function uy(e){return typeof e=="function"}function y9(e,t){const i=Math.min(e.length,t.length);for(let r=0;r<i;r++)dy(e[r],t[r])}function dy(e,t){if(Me(t)){if(typeof e!==t)throw new Error(`argument does not match constraint: typeof ${t}`)}else if(uy(t)){try{if(e instanceof t)return}catch{}if(!Et(e)&&e.constructor===t||t.length===1&&t.call(void 0,e)===!0)return;throw new Error("argument does not match one of these constraints: arg instanceof constraint, arg.constructor === constraint, nor constraint(arg) === true")}}var Jt;(function(e){function t(M){return M&&typeof M=="object"&&typeof M[Symbol.iterator]=="function"}e.is=t;const i=Object.freeze([]);function r(){return i}e.empty=r;function*n(M){yield M}e.single=n;function s(M){return t(M)?M:n(M)}e.wrap=s;function o(M){return M||i}e.from=o;function*a(M){for(let B=M.length-1;B>=0;B--)yield M[B]}e.reverse=a;function l(M){return!M||M[Symbol.iterator]().next().done===!0}e.isEmpty=l;function c(M){return M[Symbol.iterator]().next().value}e.first=c;function u(M,B){let K=0;for(const Y of M)if(B(Y,K++))return!0;return!1}e.some=u;function d(M,B){for(const K of M)if(B(K))return K}e.find=d;function*f(M,B){for(const K of M)B(K)&&(yield K)}e.filter=f;function*p(M,B){let K=0;for(const Y of M)yield B(Y,K++)}e.map=p;function*m(M,B){let K=0;for(const Y of M)yield*B(Y,K++)}e.flatMap=m;function*_(...M){for(const B of M)_9(B)?yield*B:yield B}e.concat=_;function b(M,B,K){let Y=K;for(const X of M)Y=B(Y,X);return Y}e.reduce=b;function E(M){let B=0;for(const K of M)B++;return B}e.length=E;function*C(M,B,K=M.length){for(B<-M.length&&(B=0),B<0&&(B+=M.length),K<0?K+=M.length:K>M.length&&(K=M.length);B<K;B++)yield M[B]}e.slice=C;function T(M,B=Number.POSITIVE_INFINITY){const K=[];if(B===0)return[K,M];const Y=M[Symbol.iterator]();for(let X=0;X<B;X++){const ce=Y.next();if(ce.done)return[K,e.empty()];K.push(ce.value)}return[K,{[Symbol.iterator](){return Y}}]}e.consume=T;async function j(M){const B=[];for await(const K of M)B.push(K);return Promise.resolve(B)}e.asyncToArray=j})(Jt||(Jt={}));var b9=!1,cs=null,uU=class g6{constructor(){this.livingDisposables=new Map}static{this.idx=0}getDisposableData(t){let i=this.livingDisposables.get(t);return i||(i={parent:null,source:null,isSingleton:!1,value:t,idx:g6.idx++},this.livingDisposables.set(t,i)),i}trackDisposable(t){const i=this.getDisposableData(t);i.source||(i.source=new Error().stack)}setParent(t,i){const r=this.getDisposableData(t);r.parent=i}markAsDisposed(t){this.livingDisposables.delete(t)}markAsSingleton(t){this.getDisposableData(t).isSingleton=!0}getRootParent(t,i){const r=i.get(t);if(r)return r;const n=t.parent?this.getRootParent(this.getDisposableData(t.parent),i):t;return i.set(t,n),n}getTrackedDisposables(){const t=new Map;return[...this.livingDisposables.entries()].filter(([,r])=>r.source!==null&&!this.getRootParent(r,t).isSingleton).flatMap(([r])=>r)}computeLeakingDisposables(t=10,i){let r;if(i)r=i;else{const l=new Map,c=[...this.livingDisposables.values()].filter(d=>d.source!==null&&!this.getRootParent(d,l).isSingleton);if(c.length===0)return;const u=new Set(c.map(d=>d.value));if(r=c.filter(d=>!(d.parent&&u.has(d.parent))),r.length===0)throw new Error("There are cyclic diposable chains!")}if(!r)return;function n(l){function c(d,f){for(;d.length>0&&f.some(p=>typeof p=="string"?p===d[0]:d[0].match(p));)d.shift()}const u=l.source.split(`
`).map(d=>d.trim().replace("at ","")).filter(d=>d!=="");return c(u,["Error",/^trackDisposable \(.*\)$/,/^DisposableTracker.trackDisposable \(.*\)$/]),u.reverse()}const s=new oy;for(const l of r){const c=n(l);for(let u=0;u<=c.length;u++)s.add(c.slice(0,u).join(`
`),l)}r.sort(l9(l=>l.idx,c9));let o="",a=0;for(const l of r.slice(0,t)){a++;const c=n(l),u=[];for(let d=0;d<c.length;d++){let f=c[d];f=`(shared with ${s.get(c.slice(0,d+1).join(`
`)).size}/${r.length} leaks) at ${f}`;const m=s.get(c.slice(0,d).join(`
`)),_=ey([...m].map(b=>n(b)[d]),b=>b);delete _[c[d]];for(const[b,E]of Object.entries(_))u.unshift(`    - stacktraces of ${E.length} other leaks continue with ${b}`);u.unshift(f)}o+=`


==================== Leaking disposable ${a}/${r.length}: ${l.value.constructor.name} ====================
${u.join(`
`)}
============================================================

`}return r.length>t&&(o+=`


... and ${r.length-t} more leaking disposables

`),{leaks:r,details:o}}};function x9(e){cs=e}if(b9){const e="__is_disposable_tracked__";x9(new class{trackDisposable(t){const i=new Error("Potentially leaked disposable").stack;setTimeout(()=>{t[e]||console.log(i)},3e3)}setParent(t,i){if(t&&t!==se.None)try{t[e]=!0}catch{}}markAsDisposed(t){if(t&&t!==se.None)try{t[e]=!0}catch{}}markAsSingleton(t){}})}function So(e){return cs?.trackDisposable(e),e}function Eo(e){cs?.markAsDisposed(e)}function rl(e,t){cs?.setParent(e,t)}function S9(e,t){if(cs)for(const i of e)cs.setParent(i,t)}function lg(e){return cs?.markAsSingleton(e),e}function hy(e){return typeof e=="object"&&e!==null&&typeof e.dispose=="function"&&e.dispose.length===0}function zr(e){if(Jt.is(e)){const t=[];for(const i of e)if(i)try{i.dispose()}catch(r){t.push(r)}if(t.length===1)throw t[0];if(t.length>1)throw new AggregateError(t,"Encountered errors while disposing of store");return Array.isArray(e)?[]:e}else if(e)return e.dispose(),e}function cg(...e){const t=ne(()=>zr(e));return S9(e,t),t}function ne(e){const t=So({dispose:sg(()=>{Eo(t),e()})});return t}var he=class m6{static{this.DISABLE_DISPOSED_WARNING=!1}constructor(){this._toDispose=new Set,this._isDisposed=!1,So(this)}dispose(){this._isDisposed||(Eo(this),this._isDisposed=!0,this.clear())}get isDisposed(){return this._isDisposed}clear(){if(this._toDispose.size!==0)try{zr(this._toDispose)}finally{this._toDispose.clear()}}add(t){if(!t)return t;if(t===this)throw new Error("Cannot register a disposable on itself!");return rl(t,this),this._isDisposed?m6.DISABLE_DISPOSED_WARNING||console.warn(new Error("Trying to add a disposable to a DisposableStore that has already been disposed of. The added object will be leaked!").stack):this._toDispose.add(t),t}delete(t){if(t){if(t===this)throw new Error("Cannot dispose a disposable on itself!");this._toDispose.delete(t),t.dispose()}}deleteAndLeak(t){t&&this._toDispose.has(t)&&(this._toDispose.delete(t),rl(t,null))}},se=class{static{this.None=Object.freeze({dispose(){}})}constructor(){this._store=new he,So(this),rl(this._store,this)}dispose(){Eo(this),this._store.dispose()}_register(e){if(e===this)throw new Error("Cannot register a disposable on itself!");return this._store.add(e)}},Cn=class{constructor(){this._isDisposed=!1,So(this)}get value(){return this._isDisposed?void 0:this._value}set value(e){this._isDisposed||e===this._value||(this._value?.dispose(),e&&rl(e,this),this._value=e)}clear(){this.value=void 0}dispose(){this._isDisposed=!0,Eo(this),this._value?.dispose(),this._value=void 0}clearAndLeak(){const e=this._value;return this._value=void 0,e&&rl(e,null),e}},Pu=class{constructor(){this._store=new Map,this._isDisposed=!1,So(this)}dispose(){Eo(this),this._isDisposed=!0,this.clearAndDisposeAll()}clearAndDisposeAll(){if(this._store.size)try{zr(this._store.values())}finally{this._store.clear()}}has(e){return this._store.has(e)}get size(){return this._store.size}get(e){return this._store.get(e)}set(e,t,i=!1){this._isDisposed&&console.warn(new Error("Trying to add a disposable to a DisposableMap that has already been disposed of. The added object will be leaked!").stack),i||this._store.get(e)?.dispose(),this._store.set(e,t)}deleteAndDispose(e){this._store.get(e)?.dispose(),this._store.delete(e)}deleteAndLeak(e){const t=this._store.get(e);return this._store.delete(e),t}keys(){return this._store.keys()}values(){return this._store.values()}[Symbol.iterator](){return this._store[Symbol.iterator]()}};function fy(e,t){return new E9(e,t)}var E9=class{constructor(e,t){this.reducer=e,this.options=t,this.state={flowing:!1,ended:!1,destroyed:!1},this.buffer={data:[],error:[]},this.listeners={data:[],error:[],end:[]},this.pendingWritePromises=[]}pause(){this.state.destroyed||(this.state.flowing=!1)}resume(){this.state.destroyed||this.state.flowing||(this.state.flowing=!0,this.flowData(),this.flowErrors(),this.flowEnd())}write(e){if(!this.state.destroyed){if(this.state.flowing)this.emitData(e);else if(this.buffer.data.push(e),typeof this.options?.highWaterMark=="number"&&this.buffer.data.length>this.options.highWaterMark)return new Promise(t=>this.pendingWritePromises.push(t))}}error(e){this.state.destroyed||(this.state.flowing?this.emitError(e):this.buffer.error.push(e))}end(e){this.state.destroyed||(typeof e<"u"&&this.write(e),this.state.flowing?(this.emitEnd(),this.destroy()):this.state.ended=!0)}emitData(e){this.listeners.data.slice(0).forEach(t=>t(e))}emitError(e){this.listeners.error.length===0?Qt(e):this.listeners.error.slice(0).forEach(t=>t(e))}emitEnd(){this.listeners.end.slice(0).forEach(e=>e())}on(e,t){if(!this.state.destroyed)switch(e){case"data":this.listeners.data.push(t),this.resume();break;case"end":this.listeners.end.push(t),this.state.flowing&&this.flowEnd()&&this.destroy();break;case"error":this.listeners.error.push(t),this.state.flowing&&this.flowErrors();break}}removeListener(e,t){if(this.state.destroyed)return;let i;switch(e){case"data":i=this.listeners.data;break;case"end":i=this.listeners.end;break;case"error":i=this.listeners.error;break}if(i){const r=i.indexOf(t);r>=0&&i.splice(r,1)}}flowData(){if(this.buffer.data.length===0)return;if(typeof this.reducer=="function"){const t=this.reducer(this.buffer.data);this.emitData(t)}else for(const t of this.buffer.data)this.emitData(t);this.buffer.data.length=0;const e=[...this.pendingWritePromises];this.pendingWritePromises.length=0,e.forEach(t=>t())}flowErrors(){if(this.listeners.error.length>0){for(const e of this.buffer.error)this.emitError(e);this.buffer.error.length=0}}flowEnd(){return this.state.ended?(this.emitEnd(),this.listeners.end.length>0):!1}destroy(){this.state.destroyed||(this.state.destroyed=!0,this.state.ended=!0,this.buffer.data.length=0,this.buffer.error.length=0,this.listeners.data.length=0,this.listeners.error.length=0,this.listeners.end.length=0,this.pendingWritePromises.length=0)}};function C9(e,t){const i=[];let r;for(;(r=e.read())!==null;)i.push(r);return t(i)}function py(e,t){return new Promise((i,r)=>{const n=[];gy(e,{onData:s=>{t&&n.push(s)},onError:s=>{t?r(s):i(void 0)},onEnd:()=>{i(t?t(n):void 0)}})})}function gy(e,t,i){e.on("error",r=>{i?.isCancellationRequested||t.onError(r)}),e.on("end",()=>{i?.isCancellationRequested||t.onEnd()}),e.on("data",r=>{i?.isCancellationRequested||t.onData(r)})}function D9(e,t){const i=fy(t);return i.end(e),i}var Tu=typeof Buffer<"u",I9=new Ci(()=>new Uint8Array(256)),ug,dg,ae=class Zi{static alloc(t){return Tu?new Zi(Buffer.allocUnsafe(t)):new Zi(new Uint8Array(t))}static wrap(t){return Tu&&!Buffer.isBuffer(t)&&(t=Buffer.from(t.buffer,t.byteOffset,t.byteLength)),new Zi(t)}static fromString(t,i){return!(i?.dontUseNodeBuffer||!1)&&Tu?new Zi(Buffer.from(t)):(ug||(ug=new TextEncoder),new Zi(ug.encode(t)))}static fromByteArray(t){const i=Zi.alloc(t.length);for(let r=0,n=t.length;r<n;r++)i.buffer[r]=t[r];return i}static concat(t,i){if(typeof i>"u"){i=0;for(let s=0,o=t.length;s<o;s++)i+=t[s].byteLength}const r=Zi.alloc(i);let n=0;for(let s=0,o=t.length;s<o;s++){const a=t[s];r.set(a,n),n+=a.byteLength}return r}constructor(t){this.buffer=t,this.byteLength=this.buffer.byteLength}clone(){const t=Zi.alloc(this.byteLength);return t.set(this),t}toString(){return Tu?this.buffer.toString():(dg||(dg=new TextDecoder),dg.decode(this.buffer))}slice(t,i){return new Zi(this.buffer.subarray(t,i))}set(t,i){if(t instanceof Zi)this.buffer.set(t.buffer,i);else if(t instanceof Uint8Array)this.buffer.set(t,i);else if(t instanceof ArrayBuffer)this.buffer.set(new Uint8Array(t),i);else if(ArrayBuffer.isView(t))this.buffer.set(new Uint8Array(t.buffer,t.byteOffset,t.byteLength),i);else throw new Error("Unknown argument 'array'")}readUInt32BE(t){return Au(this.buffer,t)}writeUInt32BE(t,i){Ru(this.buffer,t,i)}readUInt32LE(t){return A9(this.buffer,t)}writeUInt32LE(t,i){R9(this.buffer,t,i)}readUInt8(t){return L9(this.buffer,t)}writeUInt8(t,i){N9(this.buffer,t,i)}indexOf(t,i=0){return k9(this.buffer,t instanceof Zi?t.buffer:t,i)}equals(t){return this===t?!0:this.byteLength!==t.byteLength?!1:this.buffer.every((i,r)=>i===t.buffer[r])}};function k9(e,t,i=0){const r=t.byteLength,n=e.byteLength;if(r===0)return 0;if(r===1)return e.indexOf(t[0]);if(r>n-i)return-1;const s=I9.value;s.fill(t.length);for(let c=0;c<t.length;c++)s[t[c]]=t.length-c-1;let o=i+t.length-1,a=o,l=-1;for(;o<n;)if(e[o]===t[a]){if(a===0){l=o;break}o--,a--}else o+=Math.max(t.length-a,s[e[o]]),a=t.length-1;return l}function P9(e,t){return e[t+0]<<0>>>0|e[t+1]<<8>>>0}function T9(e,t,i){e[i+0]=t&255,t=t>>>8,e[i+1]=t&255}function Au(e,t){return e[t]*2**24+e[t+1]*2**16+e[t+2]*2**8+e[t+3]}function Ru(e,t,i){e[i+3]=t,t=t>>>8,e[i+2]=t,t=t>>>8,e[i+1]=t,t=t>>>8,e[i]=t}function A9(e,t){return e[t+0]<<0>>>0|e[t+1]<<8>>>0|e[t+2]<<16>>>0|e[t+3]<<24>>>0}function R9(e,t,i){e[i+0]=t&255,t=t>>>8,e[i+1]=t&255,t=t>>>8,e[i+2]=t&255,t=t>>>8,e[i+3]=t&255}function L9(e,t){return e[t]}function N9(e,t,i){e[i]=t}function M9(e){return C9(e,t=>ae.concat(t))}function O9(e){return py(e,t=>ae.concat(t))}function F9(e){return D9(e,t=>ae.concat(t))}function Lu(e){let t=0,i=0,r=0;const n=new Uint8Array(Math.floor(e.length/4*3)),s=a=>{switch(i){case 3:n[r++]=t|a,i=0;break;case 2:n[r++]=t|a>>>2,t=a<<6,i=3;break;case 1:n[r++]=t|a>>>4,t=a<<4,i=2;break;default:t=a<<2,i=1}};for(let a=0;a<e.length;a++){const l=e.charCodeAt(a);if(l>=65&&l<=90)s(l-65);else if(l>=97&&l<=122)s(l-97+26);else if(l>=48&&l<=57)s(l-48+52);else if(l===43||l===45)s(62);else if(l===47||l===95)s(63);else{if(l===61)break;throw new SyntaxError(`Unexpected base64 character ${e[a]}`)}}const o=r;for(;i>0;)s(0);return ae.wrap(n).slice(0,o)}var $9="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",H9="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-_";function hg({buffer:e},t=!0,i=!1){const r=i?H9:$9;let n="";const s=e.byteLength%3;let o=0;for(;o<e.byteLength-s;o+=3){const a=e[o+0],l=e[o+1],c=e[o+2];n+=r[a>>>2],n+=r[(a<<4|l>>>4)&63],n+=r[(l<<2|c>>>6)&63],n+=r[c&63]}if(s===1){const a=e[o+0];n+=r[a>>>2],n+=r[a<<4&63],t&&(n+="==")}else if(s===2){const a=e[o+0],l=e[o+1];n+=r[a>>>2],n+=r[(a<<4|l>>>4)&63],n+=r[l<<2&63],t&&(n+="=")}return n}var wt=class Lp{static{this.Undefined=new Lp(void 0)}constructor(t){this.element=t,this.next=Lp.Undefined,this.prev=Lp.Undefined}},Dn=class{constructor(){this._first=wt.Undefined,this._last=wt.Undefined,this._size=0}get size(){return this._size}isEmpty(){return this._first===wt.Undefined}clear(){let e=this._first;for(;e!==wt.Undefined;){const t=e.next;e.prev=wt.Undefined,e.next=wt.Undefined,e=t}this._first=wt.Undefined,this._last=wt.Undefined,this._size=0}unshift(e){return this._insert(e,!1)}push(e){return this._insert(e,!0)}_insert(e,t){const i=new wt(e);if(this._first===wt.Undefined)this._first=i,this._last=i;else if(t){const n=this._last;this._last=i,i.prev=n,n.next=i}else{const n=this._first;this._first=i,i.next=n,n.prev=i}this._size+=1;let r=!1;return()=>{r||(r=!0,this._remove(i))}}shift(){if(this._first!==wt.Undefined){const e=this._first.element;return this._remove(this._first),e}}pop(){if(this._last!==wt.Undefined){const e=this._last.element;return this._remove(this._last),e}}_remove(e){if(e.prev!==wt.Undefined&&e.next!==wt.Undefined){const t=e.prev;t.next=e.next,e.next.prev=t}else e.prev===wt.Undefined&&e.next===wt.Undefined?(this._first=wt.Undefined,this._last=wt.Undefined):e.next===wt.Undefined?(this._last=this._last.prev,this._last.next=wt.Undefined):e.prev===wt.Undefined&&(this._first=this._first.next,this._first.prev=wt.Undefined);this._size-=1}*[Symbol.iterator](){let e=this._first;for(;e!==wt.Undefined;)yield e.element,e=e.next}},U9=globalThis.performance.now.bind(globalThis.performance),us=class v6{static create(t){return new v6(t)}constructor(t){this._now=t===!1?Date.now:U9,this._startTime=this._now(),this._stopTime=-1}stop(){this._stopTime=this._now()}reset(){this._startTime=this._now(),this._stopTime=-1}elapsed(){return this._stopTime!==-1?this._stopTime-this._startTime:this._now()-this._startTime}},my=!1,B9=!1,ct;(function(e){e.None=()=>se.None;function t(z){if(B9){const{onDidAddListener:H}=z,J=fg.create();let q=0;z.onDidAddListener=()=>{++q===2&&(console.warn("snapshotted emitter LIKELY used public and SHOULD HAVE BEEN created with DisposableStore. snapshotted here"),J.print()),H?.()}}}function i(z,H){return p(z,()=>{},0,void 0,!0,void 0,H)}e.defer=i;function r(z){return(H,J=null,q)=>{let Q=!1,ge;return ge=z(Pe=>{if(!Q)return ge?ge.dispose():Q=!0,H.call(J,Pe)},null,q),Q&&ge.dispose(),ge}}e.once=r;function n(z,H){return e.once(e.filter(z,H))}e.onceIf=n;function s(z,H,J){return d((q,Q=null,ge)=>z(Pe=>q.call(Q,H(Pe)),null,ge),J)}e.map=s;function o(z,H,J){return d((q,Q=null,ge)=>z(Pe=>{H(Pe),q.call(Q,Pe)},null,ge),J)}e.forEach=o;function a(z,H,J){return d((q,Q=null,ge)=>z(Pe=>H(Pe)&&q.call(Q,Pe),null,ge),J)}e.filter=a;function l(z){return z}e.signal=l;function c(...z){return(H,J=null,q)=>{const Q=cg(...z.map(ge=>ge(Pe=>H.call(J,Pe))));return f(Q,q)}}e.any=c;function u(z,H,J,q){let Q=J;return s(z,ge=>(Q=H(Q,ge),Q),q)}e.reduce=u;function d(z,H){let J;const q={onWillAddFirstListener(){J=z(Q.fire,Q)},onDidRemoveLastListener(){J?.dispose()}};H||t(q);const Q=new P(q);return H?.add(Q),Q.event}function f(z,H){return H instanceof Array?H.push(z):H&&H.add(z),z}function p(z,H,J=100,q=!1,Q=!1,ge,Pe){let we,Ge,Bt,pt=0,jt;const ri={leakWarningThreshold:ge,onWillAddFirstListener(){we=z(Wr=>{pt++,Ge=H(Ge,Wr),q&&!Bt&&(Qe.fire(Ge),Ge=void 0),jt=()=>{const go=Ge;Ge=void 0,Bt=void 0,(!q||pt>1)&&Qe.fire(go),pt=0},typeof J=="number"?(clearTimeout(Bt),Bt=setTimeout(jt,J)):Bt===void 0&&(Bt=0,queueMicrotask(jt))})},onWillRemoveListener(){Q&&pt>0&&jt?.()},onDidRemoveLastListener(){jt=void 0,we.dispose()}};Pe||t(ri);const Qe=new P(ri);return Pe?.add(Qe),Qe.event}e.debounce=p;function m(z,H=0,J){return e.debounce(z,(q,Q)=>q?(q.push(Q),q):[Q],H,void 0,!0,void 0,J)}e.accumulate=m;function _(z,H=(q,Q)=>q===Q,J){let q=!0,Q;return a(z,ge=>{const Pe=q||!H(ge,Q);return q=!1,Q=ge,Pe},J)}e.latch=_;function b(z,H,J){return[e.filter(z,H,J),e.filter(z,q=>!H(q),J)]}e.split=b;function E(z,H=!1,J=[],q){let Q=J.slice(),ge=z(Ge=>{Q?Q.push(Ge):we.fire(Ge)});q&&q.add(ge);const Pe=()=>{Q?.forEach(Ge=>we.fire(Ge)),Q=null},we=new P({onWillAddFirstListener(){ge||(ge=z(Ge=>we.fire(Ge)),q&&q.add(ge))},onDidAddFirstListener(){Q&&(H?setTimeout(Pe):Pe())},onDidRemoveLastListener(){ge&&ge.dispose(),ge=null}});return q&&q.add(we),we.event}e.buffer=E;function C(z,H){return(q,Q,ge)=>{const Pe=H(new j);return z(function(we){const Ge=Pe.evaluate(we);Ge!==T&&q.call(Q,Ge)},void 0,ge)}}e.chain=C;const T=Symbol("HaltChainable");class j{constructor(){this.steps=[]}map(H){return this.steps.push(H),this}forEach(H){return this.steps.push(J=>(H(J),J)),this}filter(H){return this.steps.push(J=>H(J)?J:T),this}reduce(H,J){let q=J;return this.steps.push(Q=>(q=H(q,Q),q)),this}latch(H=(J,q)=>J===q){let J=!0,q;return this.steps.push(Q=>{const ge=J||!H(Q,q);return J=!1,q=Q,ge?Q:T}),this}evaluate(H){for(const J of this.steps)if(H=J(H),H===T)break;return H}}function M(z,H,J=q=>q){const q=(...we)=>Pe.fire(J(...we)),Q=()=>z.on(H,q),ge=()=>z.removeListener(H,q),Pe=new P({onWillAddFirstListener:Q,onDidRemoveLastListener:ge});return Pe.event}e.fromNodeEventEmitter=M;function B(z,H,J=q=>q){const q=(...we)=>Pe.fire(J(...we)),Q=()=>z.addEventListener(H,q),ge=()=>z.removeEventListener(H,q),Pe=new P({onWillAddFirstListener:Q,onDidRemoveLastListener:ge});return Pe.event}e.fromDOMEventEmitter=B;function K(z,H){return new Promise(J=>r(z)(J,null,H))}e.toPromise=K;function Y(z){const H=new P;return z.then(J=>{H.fire(J)},()=>{H.fire(void 0)}).finally(()=>{H.dispose()}),H.event}e.fromPromise=Y;function X(z,H){return z(J=>H.fire(J))}e.forward=X;function ce(z,H,J){return H(J),z(q=>H(q))}e.runAndSubscribe=ce;class We{constructor(H,J){this._observable=H,this._counter=0,this._hasChanged=!1;const q={onWillAddFirstListener:()=>{H.addObserver(this),this._observable.reportChanges()},onDidRemoveLastListener:()=>{H.removeObserver(this)}};J||t(q),this.emitter=new P(q),J&&J.add(this.emitter)}beginUpdate(H){this._counter++}handlePossibleChange(H){}handleChange(H,J){this._hasChanged=!0}endUpdate(H){this._counter--,this._counter===0&&(this._observable.reportChanges(),this._hasChanged&&(this._hasChanged=!1,this.emitter.fire(this._observable.get())))}}function De(z,H){return new We(z,H).emitter.event}e.fromObservable=De;function gt(z){return(H,J,q)=>{let Q=0,ge=!1;const Pe={beginUpdate(){Q++},endUpdate(){Q--,Q===0&&(z.reportChanges(),ge&&(ge=!1,H.call(J)))},handlePossibleChange(){},handleChange(){ge=!0}};z.addObserver(Pe),z.reportChanges();const we={dispose(){z.removeObserver(Pe)}};return q instanceof he?q.add(we):Array.isArray(q)&&q.push(we),we}}e.fromObservableLight=gt})(ct||(ct={}));var W9=class yw{static{this.all=new Set}static{this._idPool=0}constructor(t){this.listenerCount=0,this.invocationCount=0,this.elapsedOverall=0,this.durations=[],this.name=`${t}_${yw._idPool++}`,yw.all.add(this)}start(t){this._stopWatch=new us,this.listenerCount=t}stop(){if(this._stopWatch){const t=this._stopWatch.elapsed();this.durations.push(t),this.elapsedOverall+=t,this.invocationCount+=1,this._stopWatch=void 0}}},vy=-1,V9=class _6{static{this._idPool=1}constructor(t,i,r=(_6._idPool++).toString(16).padStart(3,"0")){this._errorHandler=t,this.threshold=i,this.name=r,this._warnCountdown=0}dispose(){this._stacks?.clear()}check(t,i){const r=this.threshold;if(r<=0||i<r)return;this._stacks||(this._stacks=new Map);const n=this._stacks.get(t.value)||0;if(this._stacks.set(t.value,n+1),this._warnCountdown-=1,this._warnCountdown<=0){this._warnCountdown=r*.5;const[s,o]=this.getMostFrequentStack(),a=`[${this.name}] potential listener LEAK detected, having ${i} listeners already. MOST frequent listener (${o}):`;console.warn(a),console.warn(s);const l=new z9(a,s);this._errorHandler(l)}return()=>{const s=this._stacks.get(t.value)||0;this._stacks.set(t.value,s-1)}}getMostFrequentStack(){if(!this._stacks)return;let t,i=0;for(const[r,n]of this._stacks)(!t||i<n)&&(t=[r,n],i=n);return t}},fg=class w6{static create(){const t=new Error;return new w6(t.stack??"")}constructor(t){this.value=t}print(){console.warn(this.value.split(`
`).slice(2).join(`
`))}},z9=class extends Error{constructor(e,t){super(e),this.name="ListenerLeakError",this.stack=t}},q9=class extends Error{constructor(e,t){super(e),this.name="ListenerRefusalError",this.stack=t}},j9=0,Nu=class{constructor(e){this.value=e,this.id=j9++}},G9=2,_y=(e,t)=>{if(e instanceof Nu)t(e);else for(let i=0;i<e.length;i++){const r=e[i];r&&t(r)}},P=class{constructor(e){this._size=0,this._options=e,this._leakageMon=vy>0||this._options?.leakWarningThreshold?new V9(e?.onListenerError??Qt,this._options?.leakWarningThreshold??vy):void 0,this._perfMon=this._options?._profName?new W9(this._options._profName):void 0,this._deliveryQueue=this._options?.deliveryQueue}dispose(){if(!this._disposed){if(this._disposed=!0,this._deliveryQueue?.current===this&&this._deliveryQueue.reset(),this._listeners){if(my){const e=this._listeners;queueMicrotask(()=>{_y(e,t=>t.stack?.print())})}this._listeners=void 0,this._size=0}this._options?.onDidRemoveLastListener?.(),this._leakageMon?.dispose()}}get event(){return this._event??=(e,t,i)=>{if(this._leakageMon&&this._size>this._leakageMon.threshold**2){const a=`[${this._leakageMon.name}] REFUSES to accept new listeners because it exceeded its threshold by far (${this._size} vs ${this._leakageMon.threshold})`;console.warn(a);const l=this._leakageMon.getMostFrequentStack()??["UNKNOWN stack",-1],c=new q9(`${a}. HINT: Stack shows most frequent listener (${l[1]}-times)`,l[0]);return(this._options?.onListenerError||Qt)(c),se.None}if(this._disposed)return se.None;t&&(e=e.bind(t));const r=new Nu(e);let n,s;this._leakageMon&&this._size>=Math.ceil(this._leakageMon.threshold*.2)&&(r.stack=fg.create(),n=this._leakageMon.check(r.stack,this._size+1)),my&&(r.stack=s??fg.create()),this._listeners?this._listeners instanceof Nu?(this._deliveryQueue??=new Q9,this._listeners=[this._listeners,r]):this._listeners.push(r):(this._options?.onWillAddFirstListener?.(this),this._listeners=r,this._options?.onDidAddFirstListener?.(this)),this._options?.onDidAddListener?.(this),this._size++;const o=ne(()=>{n?.(),this._removeListener(r)});return i instanceof he?i.add(o):Array.isArray(i)&&i.push(o),o},this._event}_removeListener(e){if(this._options?.onWillRemoveListener?.(this),!this._listeners)return;if(this._size===1){this._listeners=void 0,this._options?.onDidRemoveLastListener?.(this),this._size=0;return}const t=this._listeners,i=t.indexOf(e);if(i===-1)throw console.log("disposed?",this._disposed),console.log("size?",this._size),console.log("arr?",JSON.stringify(this._listeners)),new Error("Attempted to dispose unknown listener");this._size--,t[i]=void 0;const r=this._deliveryQueue.current===this;if(this._size*G9<=t.length){let n=0;for(let s=0;s<t.length;s++)t[s]?t[n++]=t[s]:r&&n<this._deliveryQueue.end&&(this._deliveryQueue.end--,n<this._deliveryQueue.i&&this._deliveryQueue.i--);t.length=n}}_deliver(e,t){if(!e)return;const i=this._options?.onListenerError||Qt;if(!i){e.value(t);return}try{e.value(t)}catch(r){i(r)}}_deliverQueue(e){const t=e.current._listeners;for(;e.i<e.end;)this._deliver(t[e.i++],e.value);e.reset()}fire(e){if(this._deliveryQueue?.current&&(this._deliverQueue(this._deliveryQueue),this._perfMon?.stop()),this._perfMon?.start(this._size),this._listeners)if(this._listeners instanceof Nu)this._deliver(this._listeners,e);else{const t=this._deliveryQueue;t.enqueue(this,e,this._listeners.length),this._deliverQueue(t)}this._perfMon?.stop()}hasListeners(){return this._size>0}},Q9=class{constructor(){this.i=-1,this.end=0}enqueue(e,t,i){this.i=0,this.end=i,this.current=e,this.value=t}reset(){this.i=this.end,this.current=void 0,this.value=void 0}},nl=class extends P{async fireAsync(e,t,i){if(this._listeners)for(this._asyncDeliveryQueue||(this._asyncDeliveryQueue=new Dn),_y(this._listeners,r=>this._asyncDeliveryQueue.push([r.value,e]));this._asyncDeliveryQueue.size>0&&!t.isCancellationRequested;){const[r,n]=this._asyncDeliveryQueue.shift(),s=[],o={...n,token:t,waitUntil:a=>{if(Object.isFrozen(s))throw new Error("waitUntil can NOT be called asynchronous");i&&(a=i(a,r)),s.push(a)}};try{r(o)}catch(a){Qt(a);continue}Object.freeze(s),await Promise.allSettled(s).then(a=>{for(const l of a)l.status==="rejected"&&Qt(l.reason)})}}},Mu=class extends P{get isPaused(){return this._isPaused!==0}constructor(e){super(e),this._isPaused=0,this._eventQueue=new Dn,this._mergeFn=e?.merge}pause(){this._isPaused++}resume(){if(this._isPaused!==0&&--this._isPaused===0)if(this._mergeFn){if(this._eventQueue.size>0){const e=Array.from(this._eventQueue);this._eventQueue.clear(),super.fire(this._mergeFn(e))}}else for(;!this._isPaused&&this._eventQueue.size!==0;)super.fire(this._eventQueue.shift())}fire(e){this._size&&(this._isPaused!==0?this._eventQueue.push(e):super.fire(e))}},J9=class extends Mu{constructor(e){super(e),this._delay=e.delay??100}fire(e){this._handle||(this.pause(),this._handle=setTimeout(()=>{this._handle=void 0,this.resume()},this._delay)),super.fire(e)}},X9=class extends P{constructor(e){super(e),this._queuedEvents=[],this._mergeFn=e?.merge}fire(e){this.hasListeners()&&(this._queuedEvents.push(e),this._queuedEvents.length===1&&queueMicrotask(()=>{this._mergeFn?super.fire(this._mergeFn(this._queuedEvents)):this._queuedEvents.forEach(t=>super.fire(t)),this._queuedEvents=[]}))}},sl;(function(e){e[e.Desktop=1]="Desktop",e[e.Web=2]="Web"})(sl||(sl={}));var wy;(function(e){e[e.VersionMismatch=55]="VersionMismatch",e[e.UnexpectedError=81]="UnexpectedError"})(wy||(wy={}));var yy;(function(e){e[e.Initialized=0]="Initialized",e[e.Ready=1]="Ready",e[e.Terminate=2]="Terminate"})(yy||(yy={}));function by(e){const t=ae.alloc(1);switch(e){case 0:t.writeUInt8(1,0);break;case 1:t.writeUInt8(2,0);break;case 2:t.writeUInt8(3,0);break}return t}function Z9(e,t){if(e.byteLength!==1)return!1;switch(e.readUInt8(0)){case 1:return t===0;case 2:return t===1;case 3:return t===2;default:return!1}}var xy;(function(e){e.Start="START_NATIVE_LOG",e.End="END_NATIVE_LOG"})(xy||(xy={}));function pg(e){const t=[];typeof e=="number"&&t.push("code/timeOrigin",e);function i(n,s){t.push(n,s?.startTime??Date.now())}function r(){const n=[];for(let s=0;s<t.length;s+=2)n.push({name:t[s],startTime:t[s+1]});return n}return{mark:i,getMarks:r}}function K9(){if(typeof performance=="object"&&typeof performance.mark=="function"&&!performance.nodeTiming)return typeof performance.timeOrigin!="number"&&!performance.timing?pg():{mark(e,t){performance.mark(e,t)},getMarks(){let e=performance.timeOrigin;typeof e!="number"&&(e=performance.timing.navigationStart||performance.timing.redirectStart||performance.timing.fetchStart);const t=[{name:"code/timeOrigin",startTime:Math.round(e)}];for(const i of performance.getEntriesByType("mark"))t.push({name:i.name,startTime:Math.round(e+i.startTime)});return t}};if(typeof process=="object"){const e=performance?.timeOrigin;return pg(e)}else return console.trace("perf-util loaded in UNKNOWN environment"),pg()}function Y9(e){return e.MonacoPerformanceMarks||(e.MonacoPerformanceMarks=K9()),e.MonacoPerformanceMarks}var Sy=Y9(globalThis),di=Sy.mark,eP=Sy.getMarks;function tP(){return globalThis._VSCODE_NLS_MESSAGES}function Ey(){return globalThis._VSCODE_NLS_LANGUAGE}var iP=Ey()==="pseudo"||typeof document<"u"&&document.location&&typeof document.location.hash=="string"&&document.location.hash.indexOf("pseudo=true")>=0;function Ou(e,t){let i;return t.length===0?i=e:i=e.replace(/\{(\d+)\}/g,(r,n)=>{const s=n[0],o=t[s];let a=r;return typeof o=="string"?a=o:(typeof o=="number"||typeof o=="boolean"||o===void 0||o===null)&&(a=String(o)),a}),iP&&(i="\uFF3B"+i.replace(/[aouei]/g,"$&$&")+"\uFF3D"),i}function h(e,t,...i){return Ou(typeof e=="number"?Cy(e,t):t,i)}function Cy(e,t){const i=tP()?.[e];if(typeof i!="string"){if(typeof t=="string")return t;throw new Error(`!!! NLS MISSING: ${e} !!!`)}return i}function Fu(e,t,...i){let r;typeof e=="number"?r=Cy(e,t):r=t;const n=Ou(r,i);return{value:n,original:t===r?n:Ou(t,i)}}var In="en",ol=!1,al=!1,ll=!1,rP=!1,Dy=!1,gg=!1,nP=!1,mg=!1,Iy=!1,ky=!1,$u=void 0,Hu=In,Py=In,sP=void 0,qr=void 0,jr=globalThis,$i=void 0;typeof jr.vscode<"u"&&typeof jr.vscode.process<"u"?$i=jr.vscode.process:typeof process<"u"&&typeof process?.versions?.node=="string"&&($i=process);var Ty=typeof $i?.versions?.electron=="string",oP=Ty&&$i?.type==="renderer";if(typeof $i=="object"){ol=$i.platform==="win32",al=$i.platform==="darwin",ll=$i.platform==="linux",rP=ll&&!!$i.env.SNAP&&!!$i.env.SNAP_REVISION,nP=Ty,Iy=!!$i.env.CI||!!$i.env.BUILD_ARTIFACTSTAGINGDIRECTORY,$u=In,Hu=In;const e=$i.env.VSCODE_NLS_CONFIG;if(e)try{const t=JSON.parse(e);$u=t.userLocale,Py=t.osLocale,Hu=t.resolvedLanguage||In,sP=t.languagePack?.translationsConfigFile}catch{}Dy=!0}else typeof navigator=="object"&&!oP?(qr=navigator.userAgent,ol=qr.indexOf("Windows")>=0,al=qr.indexOf("Macintosh")>=0,mg=(qr.indexOf("Macintosh")>=0||qr.indexOf("iPad")>=0||qr.indexOf("iPhone")>=0)&&!!navigator.maxTouchPoints&&navigator.maxTouchPoints>0,ll=qr.indexOf("Linux")>=0,ky=qr?.indexOf("Mobi")>=0,gg=!0,Hu=Ey()||In,$u=navigator.language.toLowerCase(),Py=$u):console.error("Unable to resolve platform.");var Ay;(function(e){e[e.Web=0]="Web",e[e.Mac=1]="Mac",e[e.Linux=2]="Linux",e[e.Windows=3]="Windows"})(Ay||(Ay={}));function aP(e){switch(e){case 0:return"Web";case 1:return"Mac";case 2:return"Linux";case 3:return"Windows"}}var vg=0;al?vg=1:ol?vg=3:ll&&(vg=2);var oi=ol,Hi=al,Gr=ll,Ry=Dy,Co=gg,lP=gg&&typeof jr.importScripts=="function",cP=lP?jr.origin:void 0,uP=mg,dP=ky,ds=Iy,Er=qr,kn=Hu,Ly;(function(e){function t(){return kn}e.value=t;function i(){return kn.length===2?kn==="en":kn.length>=3?kn[0]==="e"&&kn[1]==="n"&&kn[2]==="-":!1}e.isDefaultVariant=i;function r(){return kn==="en"}e.isDefault=r})(Ly||(Ly={}));var hP=typeof jr.postMessage=="function"&&!jr.importScripts,Ny=(()=>{if(hP){const e=[];jr.addEventListener("message",i=>{if(i.data&&i.data.vscodeScheduleAsyncWork)for(let r=0,n=e.length;r<n;r++){const s=e[r];if(s.id===i.data.vscodeScheduleAsyncWork){e.splice(r,1),s.callback();return}}});let t=0;return i=>{const r=++t;e.push({id:r,callback:i}),jr.postMessage({vscodeScheduleAsyncWork:r},"*")}}return e=>setTimeout(e)})(),My;(function(e){e[e.Windows=1]="Windows",e[e.Macintosh=2]="Macintosh",e[e.Linux=3]="Linux"})(My||(My={}));var cl=al||mg?2:ol?1:3,Oy=!0,Fy=!1;function $y(){if(!Fy){Fy=!0;const e=new Uint8Array(2);e[0]=1,e[1]=2,Oy=new Uint16Array(e.buffer)[0]===513}return Oy}var _g=!!(Er&&Er.indexOf("Chrome")>=0),fP=!!(Er&&Er.indexOf("Firefox")>=0),pP=!!(!_g&&Er&&Er.indexOf("Safari")>=0),Hy=!!(Er&&Er.indexOf("Edg/")>=0),dU=!!(Er&&Er.indexOf("Android")>=0),hs,wg=globalThis.vscode;if(typeof wg<"u"&&typeof wg.process<"u"){const e=wg.process;hs={get platform(){return e.platform},get arch(){return e.arch},get env(){return e.env},cwd(){return e.cwd()}}}else typeof process<"u"&&typeof process?.versions?.node=="string"?hs={get platform(){return process.platform},get arch(){return process.arch},get env(){return process.env},cwd(){return process.env.VSCODE_CWD||process.cwd()}}:hs={get platform(){return oi?"win32":Hi?"darwin":"linux"},get arch(){},get env(){return{}},cwd(){return"/"}};var Do=hs.cwd,Io=hs.env,gP=hs.platform,hU=hs.arch,mP=65,vP=97,_P=90,wP=122,fs=46,Xt=47,Di=92,Qr=58,yP=63,Uy=class extends Error{constructor(e,t,i){let r;typeof t=="string"&&t.indexOf("not ")===0?(r="must not be",t=t.replace(/^not /,"")):r="must be";const n=e.indexOf(".")!==-1?"property":"argument";let s=`The "${e}" ${n} ${r} of type ${t}`;s+=`. Received type ${typeof i}`,super(s),this.code="ERR_INVALID_ARG_TYPE"}};function bP(e,t){if(e===null||typeof e!="object")throw new Uy(t,"Object",e)}function Ct(e,t){if(typeof e!="string")throw new Uy(t,"string",e)}var Ii=gP==="win32";function ke(e){return e===Xt||e===Di}function yg(e){return e===Xt}function Jr(e){return e>=mP&&e<=_P||e>=vP&&e<=wP}function Uu(e,t,i,r){let n="",s=0,o=-1,a=0,l=0;for(let c=0;c<=e.length;++c){if(c<e.length)l=e.charCodeAt(c);else{if(r(l))break;l=Xt}if(r(l)){if(!(o===c-1||a===1))if(a===2){if(n.length<2||s!==2||n.charCodeAt(n.length-1)!==fs||n.charCodeAt(n.length-2)!==fs){if(n.length>2){const u=n.lastIndexOf(i);u===-1?(n="",s=0):(n=n.slice(0,u),s=n.length-1-n.lastIndexOf(i)),o=c,a=0;continue}else if(n.length!==0){n="",s=0,o=c,a=0;continue}}t&&(n+=n.length>0?`${i}..`:"..",s=2)}else n.length>0?n+=`${i}${e.slice(o+1,c)}`:n=e.slice(o+1,c),s=c-o-1;o=c,a=0}else l===fs&&a!==-1?++a:a=-1}return n}function xP(e){return e?`${e[0]==="."?"":"."}${e}`:""}function By(e,t){bP(t,"pathObject");const i=t.dir||t.root,r=t.base||`${t.name||""}${xP(t.ext)}`;return i?i===t.root?`${i}${r}`:`${i}${e}${r}`:r}var Dt={resolve(...e){let t="",i="",r=!1;for(let n=e.length-1;n>=-1;n--){let s;if(n>=0){if(s=e[n],Ct(s,`paths[${n}]`),s.length===0)continue}else t.length===0?s=Do():(s=Io[`=${t}`]||Do(),(s===void 0||s.slice(0,2).toLowerCase()!==t.toLowerCase()&&s.charCodeAt(2)===Di)&&(s=`${t}\\`));const o=s.length;let a=0,l="",c=!1;const u=s.charCodeAt(0);if(o===1)ke(u)&&(a=1,c=!0);else if(ke(u))if(c=!0,ke(s.charCodeAt(1))){let d=2,f=d;for(;d<o&&!ke(s.charCodeAt(d));)d++;if(d<o&&d!==f){const p=s.slice(f,d);for(f=d;d<o&&ke(s.charCodeAt(d));)d++;if(d<o&&d!==f){for(f=d;d<o&&!ke(s.charCodeAt(d));)d++;(d===o||d!==f)&&(l=`\\\\${p}\\${s.slice(f,d)}`,a=d)}}}else a=1;else Jr(u)&&s.charCodeAt(1)===Qr&&(l=s.slice(0,2),a=2,o>2&&ke(s.charCodeAt(2))&&(c=!0,a=3));if(l.length>0)if(t.length>0){if(l.toLowerCase()!==t.toLowerCase())continue}else t=l;if(r){if(t.length>0)break}else if(i=`${s.slice(a)}\\${i}`,r=c,c&&t.length>0)break}return i=Uu(i,!r,"\\",ke),r?`${t}\\${i}`:`${t}${i}`||"."},normalize(e){Ct(e,"path");const t=e.length;if(t===0)return".";let i=0,r,n=!1;const s=e.charCodeAt(0);if(t===1)return yg(s)?"\\":e;if(ke(s))if(n=!0,ke(e.charCodeAt(1))){let a=2,l=a;for(;a<t&&!ke(e.charCodeAt(a));)a++;if(a<t&&a!==l){const c=e.slice(l,a);for(l=a;a<t&&ke(e.charCodeAt(a));)a++;if(a<t&&a!==l){for(l=a;a<t&&!ke(e.charCodeAt(a));)a++;if(a===t)return`\\\\${c}\\${e.slice(l)}\\`;a!==l&&(r=`\\\\${c}\\${e.slice(l,a)}`,i=a)}}}else i=1;else Jr(s)&&e.charCodeAt(1)===Qr&&(r=e.slice(0,2),i=2,t>2&&ke(e.charCodeAt(2))&&(n=!0,i=3));let o=i<t?Uu(e.slice(i),!n,"\\",ke):"";if(o.length===0&&!n&&(o="."),o.length>0&&ke(e.charCodeAt(t-1))&&(o+="\\"),!n&&r===void 0&&e.includes(":")){if(o.length>=2&&Jr(o.charCodeAt(0))&&o.charCodeAt(1)===Qr)return`.\\${o}`;let a=e.indexOf(":");do if(a===t-1||ke(e.charCodeAt(a+1)))return`.\\${o}`;while((a=e.indexOf(":",a+1))!==-1)}return r===void 0?n?`\\${o}`:o:n?`${r}\\${o}`:`${r}${o}`},isAbsolute(e){Ct(e,"path");const t=e.length;if(t===0)return!1;const i=e.charCodeAt(0);return ke(i)||t>2&&Jr(i)&&e.charCodeAt(1)===Qr&&ke(e.charCodeAt(2))},join(...e){if(e.length===0)return".";let t,i;for(let s=0;s<e.length;++s){const o=e[s];Ct(o,"path"),o.length>0&&(t===void 0?t=i=o:t+=`\\${o}`)}if(t===void 0)return".";let r=!0,n=0;if(typeof i=="string"&&ke(i.charCodeAt(0))){++n;const s=i.length;s>1&&ke(i.charCodeAt(1))&&(++n,s>2&&(ke(i.charCodeAt(2))?++n:r=!1))}if(r){for(;n<t.length&&ke(t.charCodeAt(n));)n++;n>=2&&(t=`\\${t.slice(n)}`)}return Dt.normalize(t)},relative(e,t){if(Ct(e,"from"),Ct(t,"to"),e===t)return"";const i=Dt.resolve(e),r=Dt.resolve(t);if(i===r||(e=i.toLowerCase(),t=r.toLowerCase(),e===t))return"";if(i.length!==e.length||r.length!==t.length){const m=i.split("\\"),_=r.split("\\");m[m.length-1]===""&&m.pop(),_[_.length-1]===""&&_.pop();const b=m.length,E=_.length,C=b<E?b:E;let T;for(T=0;T<C&&m[T].toLowerCase()===_[T].toLowerCase();T++);return T===0?r:T===C?E>C?_.slice(T).join("\\"):b>C?"..\\".repeat(b-1-T)+"..":"":"..\\".repeat(b-T)+_.slice(T).join("\\")}let n=0;for(;n<e.length&&e.charCodeAt(n)===Di;)n++;let s=e.length;for(;s-1>n&&e.charCodeAt(s-1)===Di;)s--;const o=s-n;let a=0;for(;a<t.length&&t.charCodeAt(a)===Di;)a++;let l=t.length;for(;l-1>a&&t.charCodeAt(l-1)===Di;)l--;const c=l-a,u=o<c?o:c;let d=-1,f=0;for(;f<u;f++){const m=e.charCodeAt(n+f);if(m!==t.charCodeAt(a+f))break;m===Di&&(d=f)}if(f!==u){if(d===-1)return r}else{if(c>u){if(t.charCodeAt(a+f)===Di)return r.slice(a+f+1);if(f===2)return r.slice(a+f)}o>u&&(e.charCodeAt(n+f)===Di?d=f:f===2&&(d=3)),d===-1&&(d=0)}let p="";for(f=n+d+1;f<=s;++f)(f===s||e.charCodeAt(f)===Di)&&(p+=p.length===0?"..":"\\..");return a+=d,p.length>0?`${p}${r.slice(a,l)}`:(r.charCodeAt(a)===Di&&++a,r.slice(a,l))},toNamespacedPath(e){if(typeof e!="string"||e.length===0)return e;const t=Dt.resolve(e);if(t.length<=2)return e;if(t.charCodeAt(0)===Di){if(t.charCodeAt(1)===Di){const i=t.charCodeAt(2);if(i!==yP&&i!==fs)return`\\\\?\\UNC\\${t.slice(2)}`}}else if(Jr(t.charCodeAt(0))&&t.charCodeAt(1)===Qr&&t.charCodeAt(2)===Di)return`\\\\?\\${t}`;return t},dirname(e){Ct(e,"path");const t=e.length;if(t===0)return".";let i=-1,r=0;const n=e.charCodeAt(0);if(t===1)return ke(n)?e:".";if(ke(n)){if(i=r=1,ke(e.charCodeAt(1))){let a=2,l=a;for(;a<t&&!ke(e.charCodeAt(a));)a++;if(a<t&&a!==l){for(l=a;a<t&&ke(e.charCodeAt(a));)a++;if(a<t&&a!==l){for(l=a;a<t&&!ke(e.charCodeAt(a));)a++;if(a===t)return e;a!==l&&(i=r=a+1)}}}}else Jr(n)&&e.charCodeAt(1)===Qr&&(i=t>2&&ke(e.charCodeAt(2))?3:2,r=i);let s=-1,o=!0;for(let a=t-1;a>=r;--a)if(ke(e.charCodeAt(a))){if(!o){s=a;break}}else o=!1;if(s===-1){if(i===-1)return".";s=i}return e.slice(0,s)},basename(e,t){t!==void 0&&Ct(t,"suffix"),Ct(e,"path");let i=0,r=-1,n=!0,s;if(e.length>=2&&Jr(e.charCodeAt(0))&&e.charCodeAt(1)===Qr&&(i=2),t!==void 0&&t.length>0&&t.length<=e.length){if(t===e)return"";let o=t.length-1,a=-1;for(s=e.length-1;s>=i;--s){const l=e.charCodeAt(s);if(ke(l)){if(!n){i=s+1;break}}else a===-1&&(n=!1,a=s+1),o>=0&&(l===t.charCodeAt(o)?--o===-1&&(r=s):(o=-1,r=a))}return i===r?r=a:r===-1&&(r=e.length),e.slice(i,r)}for(s=e.length-1;s>=i;--s)if(ke(e.charCodeAt(s))){if(!n){i=s+1;break}}else r===-1&&(n=!1,r=s+1);return r===-1?"":e.slice(i,r)},extname(e){Ct(e,"path");let t=0,i=-1,r=0,n=-1,s=!0,o=0;e.length>=2&&e.charCodeAt(1)===Qr&&Jr(e.charCodeAt(0))&&(t=r=2);for(let a=e.length-1;a>=t;--a){const l=e.charCodeAt(a);if(ke(l)){if(!s){r=a+1;break}continue}n===-1&&(s=!1,n=a+1),l===fs?i===-1?i=a:o!==1&&(o=1):i!==-1&&(o=-1)}return i===-1||n===-1||o===0||o===1&&i===n-1&&i===r+1?"":e.slice(i,n)},format:By.bind(null,"\\"),parse(e){Ct(e,"path");const t={root:"",dir:"",base:"",ext:"",name:""};if(e.length===0)return t;const i=e.length;let r=0,n=e.charCodeAt(0);if(i===1)return ke(n)?(t.root=t.dir=e,t):(t.base=t.name=e,t);if(ke(n)){if(r=1,ke(e.charCodeAt(1))){let d=2,f=d;for(;d<i&&!ke(e.charCodeAt(d));)d++;if(d<i&&d!==f){for(f=d;d<i&&ke(e.charCodeAt(d));)d++;if(d<i&&d!==f){for(f=d;d<i&&!ke(e.charCodeAt(d));)d++;d===i?r=d:d!==f&&(r=d+1)}}}}else if(Jr(n)&&e.charCodeAt(1)===Qr){if(i<=2)return t.root=t.dir=e,t;if(r=2,ke(e.charCodeAt(2))){if(i===3)return t.root=t.dir=e,t;r=3}}r>0&&(t.root=e.slice(0,r));let s=-1,o=r,a=-1,l=!0,c=e.length-1,u=0;for(;c>=r;--c){if(n=e.charCodeAt(c),ke(n)){if(!l){o=c+1;break}continue}a===-1&&(l=!1,a=c+1),n===fs?s===-1?s=c:u!==1&&(u=1):s!==-1&&(u=-1)}return a!==-1&&(s===-1||u===0||u===1&&s===a-1&&s===o+1?t.base=t.name=e.slice(o,a):(t.name=e.slice(o,s),t.base=e.slice(o,a),t.ext=e.slice(s,a))),o>0&&o!==r?t.dir=e.slice(0,o-1):t.dir=t.root,t},sep:"\\",delimiter:";",win32:null,posix:null},SP=(()=>{if(Ii){const e=/\\/g;return()=>{const t=Do().replace(e,"/");return t.slice(t.indexOf("/"))}}return()=>Do()})(),Ne={resolve(...e){let t="",i=!1;for(let r=e.length-1;r>=0&&!i;r--){const n=e[r];Ct(n,`paths[${r}]`),n.length!==0&&(t=`${n}/${t}`,i=n.charCodeAt(0)===Xt)}if(!i){const r=SP();t=`${r}/${t}`,i=r.charCodeAt(0)===Xt}return t=Uu(t,!i,"/",yg),i?`/${t}`:t.length>0?t:"."},normalize(e){if(Ct(e,"path"),e.length===0)return".";const t=e.charCodeAt(0)===Xt,i=e.charCodeAt(e.length-1)===Xt;return e=Uu(e,!t,"/",yg),e.length===0?t?"/":i?"./":".":(i&&(e+="/"),t?`/${e}`:e)},isAbsolute(e){return Ct(e,"path"),e.length>0&&e.charCodeAt(0)===Xt},join(...e){if(e.length===0)return".";const t=[];for(let i=0;i<e.length;++i){const r=e[i];Ct(r,"path"),r.length>0&&t.push(r)}return t.length===0?".":Ne.normalize(t.join("/"))},relative(e,t){if(Ct(e,"from"),Ct(t,"to"),e===t||(e=Ne.resolve(e),t=Ne.resolve(t),e===t))return"";const i=1,r=e.length,n=r-i,s=1,o=t.length-s,a=n<o?n:o;let l=-1,c=0;for(;c<a;c++){const d=e.charCodeAt(i+c);if(d!==t.charCodeAt(s+c))break;d===Xt&&(l=c)}if(c===a)if(o>a){if(t.charCodeAt(s+c)===Xt)return t.slice(s+c+1);if(c===0)return t.slice(s+c)}else n>a&&(e.charCodeAt(i+c)===Xt?l=c:c===0&&(l=0));let u="";for(c=i+l+1;c<=r;++c)(c===r||e.charCodeAt(c)===Xt)&&(u+=u.length===0?"..":"/..");return`${u}${t.slice(s+l)}`},toNamespacedPath(e){return e},dirname(e){if(Ct(e,"path"),e.length===0)return".";const t=e.charCodeAt(0)===Xt;let i=-1,r=!0;for(let n=e.length-1;n>=1;--n)if(e.charCodeAt(n)===Xt){if(!r){i=n;break}}else r=!1;return i===-1?t?"/":".":t&&i===1?"//":e.slice(0,i)},basename(e,t){t!==void 0&&Ct(t,"suffix"),Ct(e,"path");let i=0,r=-1,n=!0,s;if(t!==void 0&&t.length>0&&t.length<=e.length){if(t===e)return"";let o=t.length-1,a=-1;for(s=e.length-1;s>=0;--s){const l=e.charCodeAt(s);if(l===Xt){if(!n){i=s+1;break}}else a===-1&&(n=!1,a=s+1),o>=0&&(l===t.charCodeAt(o)?--o===-1&&(r=s):(o=-1,r=a))}return i===r?r=a:r===-1&&(r=e.length),e.slice(i,r)}for(s=e.length-1;s>=0;--s)if(e.charCodeAt(s)===Xt){if(!n){i=s+1;break}}else r===-1&&(n=!1,r=s+1);return r===-1?"":e.slice(i,r)},extname(e){Ct(e,"path");let t=-1,i=0,r=-1,n=!0,s=0;for(let o=e.length-1;o>=0;--o){const a=e[o];if(a==="/"){if(!n){i=o+1;break}continue}r===-1&&(n=!1,r=o+1),a==="."?t===-1?t=o:s!==1&&(s=1):t!==-1&&(s=-1)}return t===-1||r===-1||s===0||s===1&&t===r-1&&t===i+1?"":e.slice(t,r)},format:By.bind(null,"/"),parse(e){Ct(e,"path");const t={root:"",dir:"",base:"",ext:"",name:""};if(e.length===0)return t;const i=e.charCodeAt(0)===Xt;let r;i?(t.root="/",r=1):r=0;let n=-1,s=0,o=-1,a=!0,l=e.length-1,c=0;for(;l>=r;--l){const u=e.charCodeAt(l);if(u===Xt){if(!a){s=l+1;break}continue}o===-1&&(a=!1,o=l+1),u===fs?n===-1?n=l:c!==1&&(c=1):n!==-1&&(c=-1)}if(o!==-1){const u=s===0&&i?1:s;n===-1||c===0||c===1&&n===o-1&&n===s+1?t.base=t.name=e.slice(u,o):(t.name=e.slice(u,n),t.base=e.slice(u,o),t.ext=e.slice(n,o))}return s>0?t.dir=e.slice(0,s-1):i&&(t.dir="/"),t},sep:"/",delimiter:":",win32:null,posix:null};Ne.win32=Dt.win32=Dt,Ne.posix=Dt.posix=Ne;var ko=Ii?Dt.normalize:Ne.normalize,Bu=Ii?Dt.isAbsolute:Ne.isAbsolute,bg=Ii?Dt.join:Ne.join,EP=Ii?Dt.resolve:Ne.resolve,ul=Ii?Dt.relative:Ne.relative,Po=Ii?Dt.dirname:Ne.dirname,ki=Ii?Dt.basename:Ne.basename,xg=Ii?Dt.extname:Ne.extname,fU=Ii?Dt.format:Ne.format,pU=Ii?Dt.parse:Ne.parse,gU=Ii?Dt.toNamespacedPath:Ne.toNamespacedPath,tr=Ii?Dt.sep:Ne.sep,mU=Ii?Dt.delimiter:Ne.delimiter,CP=/^\w[\w\d+.-]*$/,DP=/^\//,IP=/^\/\//;function kP(e,t){if(!e.scheme&&t)throw new Error(`[UriError]: Scheme is missing: {scheme: "", authority: "${e.authority}", path: "${e.path}", query: "${e.query}", fragment: "${e.fragment}"}`);if(e.scheme&&!CP.test(e.scheme))throw new Error("[UriError]: Scheme contains illegal characters.");if(e.path){if(e.authority){if(!DP.test(e.path))throw new Error('[UriError]: If a URI contains an authority component, then the path component must either be empty or begin with a slash ("/") character')}else if(IP.test(e.path))throw new Error('[UriError]: If a URI does not contain an authority component, then the path cannot begin with two slash characters ("//")')}}function PP(e,t){return!e&&!t?"file":e}function TP(e,t){switch(e){case"https":case"http":case"file":t?t[0]!==ir&&(t=ir+t):t=ir;break}return t}var ut="",ir="/",AP=/^(([^:/?#]+?):)?(\/\/([^/?#]*))?([^?#]*)(\?([^#]*))?(#(.*))?/,y=class Np{static isUri(t){return t instanceof Np?!0:t?typeof t.authority=="string"&&typeof t.fragment=="string"&&typeof t.path=="string"&&typeof t.query=="string"&&typeof t.scheme=="string"&&typeof t.fsPath=="string"&&typeof t.with=="function"&&typeof t.toString=="function":!1}constructor(t,i,r,n,s,o=!1){typeof t=="object"?(this.scheme=t.scheme||ut,this.authority=t.authority||ut,this.path=t.path||ut,this.query=t.query||ut,this.fragment=t.fragment||ut):(this.scheme=PP(t,o),this.authority=i||ut,this.path=TP(this.scheme,r||ut),this.query=n||ut,this.fragment=s||ut,kP(this,o))}get fsPath(){return Vu(this,!1)}with(t){if(!t)return this;let{scheme:i,authority:r,path:n,query:s,fragment:o}=t;return i===void 0?i=this.scheme:i===null&&(i=ut),r===void 0?r=this.authority:r===null&&(r=ut),n===void 0?n=this.path:n===null&&(n=ut),s===void 0?s=this.query:s===null&&(s=ut),o===void 0?o=this.fragment:o===null&&(o=ut),i===this.scheme&&r===this.authority&&n===this.path&&s===this.query&&o===this.fragment?this:new To(i,r,n,s,o)}static parse(t,i=!1){const r=AP.exec(t);return r?new To(r[2]||ut,zu(r[4]||ut),zu(r[5]||ut),zu(r[7]||ut),zu(r[9]||ut),i):new To(ut,ut,ut,ut,ut)}static file(t){let i=ut;if(oi&&(t=t.replace(/\\/g,ir)),t[0]===ir&&t[1]===ir){const r=t.indexOf(ir,2);r===-1?(i=t.substring(2),t=ir):(i=t.substring(2,r),t=t.substring(r)||ir)}return new To("file",i,t,ut,ut)}static from(t,i){return new To(t.scheme,t.authority,t.path,t.query,t.fragment,i)}static joinPath(t,...i){if(!t.path)throw new Error("[UriError]: cannot call joinPath on URI without path");let r;return oi&&t.scheme==="file"?r=Np.file(Dt.join(Vu(t,!0),...i)).path:r=Ne.join(t.path,...i),t.with({path:r})}toString(t=!1){return Sg(this,t)}toJSON(){return this}static revive(t){if(t){if(t instanceof Np)return t;{const i=new To(t);return i._formatted=t.external??null,i._fsPath=t._sep===Wy?t.fsPath??null:null,i}}else return t}[Symbol.for("debug.description")](){return`URI(${this.toString()})`}};function Wu(e){return!e||typeof e!="object"?!1:typeof e.scheme=="string"&&(typeof e.authority=="string"||typeof e.authority>"u")&&(typeof e.path=="string"||typeof e.path>"u")&&(typeof e.query=="string"||typeof e.query>"u")&&(typeof e.fragment=="string"||typeof e.fragment>"u")}var Wy=oi?1:void 0,To=class extends y{constructor(){super(...arguments),this._formatted=null,this._fsPath=null}get fsPath(){return this._fsPath||(this._fsPath=Vu(this,!1)),this._fsPath}toString(e=!1){return e?Sg(this,!0):(this._formatted||(this._formatted=Sg(this,!1)),this._formatted)}toJSON(){const e={$mid:1};return this._fsPath&&(e.fsPath=this._fsPath,e._sep=Wy),this._formatted&&(e.external=this._formatted),this.path&&(e.path=this.path),this.scheme&&(e.scheme=this.scheme),this.authority&&(e.authority=this.authority),this.query&&(e.query=this.query),this.fragment&&(e.fragment=this.fragment),e}},Vy={58:"%3A",47:"%2F",63:"%3F",35:"%23",91:"%5B",93:"%5D",64:"%40",33:"%21",36:"%24",38:"%26",39:"%27",40:"%28",41:"%29",42:"%2A",43:"%2B",44:"%2C",59:"%3B",61:"%3D",32:"%20"};function zy(e,t,i){let r,n=-1;for(let s=0;s<e.length;s++){const o=e.charCodeAt(s);if(o>=97&&o<=122||o>=65&&o<=90||o>=48&&o<=57||o===45||o===46||o===95||o===126||t&&o===47||i&&o===91||i&&o===93||i&&o===58)n!==-1&&(r+=encodeURIComponent(e.substring(n,s)),n=-1),r!==void 0&&(r+=e.charAt(s));else{r===void 0&&(r=e.substr(0,s));const a=Vy[o];a!==void 0?(n!==-1&&(r+=encodeURIComponent(e.substring(n,s)),n=-1),r+=a):n===-1&&(n=s)}}return n!==-1&&(r+=encodeURIComponent(e.substring(n))),r!==void 0?r:e}function RP(e){let t;for(let i=0;i<e.length;i++){const r=e.charCodeAt(i);r===35||r===63?(t===void 0&&(t=e.substr(0,i)),t+=Vy[r]):t!==void 0&&(t+=e[i])}return t!==void 0?t:e}function Vu(e,t){let i;return e.authority&&e.path.length>1&&e.scheme==="file"?i=`//${e.authority}${e.path}`:e.path.charCodeAt(0)===47&&(e.path.charCodeAt(1)>=65&&e.path.charCodeAt(1)<=90||e.path.charCodeAt(1)>=97&&e.path.charCodeAt(1)<=122)&&e.path.charCodeAt(2)===58?t?i=e.path.substr(1):i=e.path[1].toLowerCase()+e.path.substr(2):i=e.path,oi&&(i=i.replace(/\//g,"\\")),i}function Sg(e,t){const i=t?RP:zy;let r="",{scheme:n,authority:s,path:o,query:a,fragment:l}=e;if(n&&(r+=n,r+=":"),(s||n==="file")&&(r+=ir,r+=ir),s){let c=s.indexOf("@");if(c!==-1){const u=s.substr(0,c);s=s.substr(c+1),c=u.lastIndexOf(":"),c===-1?r+=i(u,!1,!1):(r+=i(u.substr(0,c),!1,!1),r+=":",r+=i(u.substr(c+1),!1,!0)),r+="@"}s=s.toLowerCase(),c=s.lastIndexOf(":"),c===-1?r+=i(s,!1,!0):(r+=i(s.substr(0,c),!1,!0),r+=s.substr(c))}if(o){if(o.length>=3&&o.charCodeAt(0)===47&&o.charCodeAt(2)===58){const c=o.charCodeAt(1);c>=65&&c<=90&&(o=`/${String.fromCharCode(c+32)}:${o.substr(3)}`)}else if(o.length>=2&&o.charCodeAt(1)===58){const c=o.charCodeAt(0);c>=65&&c<=90&&(o=`${String.fromCharCode(c+32)}:${o.substr(2)}`)}r+=i(o,!0,!1)}return a&&(r+="?",r+=i(a,!1,!1)),l&&(r+="#",r+=t?l:zy(l,!1,!1)),r}function qy(e){try{return decodeURIComponent(e)}catch{return e.length>3?e.substr(0,3)+qy(e.substr(3)):e}}var jy=/(%[0-9A-Za-z][0-9A-Za-z])+/g;function zu(e){return e.match(jy)?e.replace(jy,t=>qy(t)):e}var Gy=class y6{static{this.count=0}constructor(t){this._proxyIdentifierBrand=void 0,this.sid=t,this.nid=++y6.count}},Qy=[];function R(e){const t=new Gy(e);return Qy[t.nid]=t,t}function qu(e){return Qy[e].sid}var ai=class{constructor(e){this.value=e}},Jy;(function(e){e[e.Default=0]="Default",e[e.InCenter=1]="InCenter",e[e.InCenterIfOutsideViewport=2]="InCenterIfOutsideViewport",e[e.AtTop=3]="AtTop"})(Jy||(Jy={}));var Xy;(function(e){e[e.UnknownInput=0]="UnknownInput",e[e.TextInput=1]="TextInput",e[e.TextDiffInput=2]="TextDiffInput",e[e.TextMergeInput=3]="TextMergeInput",e[e.NotebookInput=4]="NotebookInput",e[e.NotebookDiffInput=5]="NotebookDiffInput",e[e.CustomEditorInput=6]="CustomEditorInput",e[e.WebviewEditorInput=7]="WebviewEditorInput",e[e.TerminalEditorInput=8]="TerminalEditorInput",e[e.InteractiveEditorInput=9]="InteractiveEditorInput",e[e.ChatEditorInput=10]="ChatEditorInput",e[e.MultiDiffEditorInput=11]="MultiDiffEditorInput"})(Xy||(Xy={}));var Zy;(function(e){e[e.TAB_OPEN=0]="TAB_OPEN",e[e.TAB_CLOSE=1]="TAB_CLOSE",e[e.TAB_UPDATE=2]="TAB_UPDATE",e[e.TAB_MOVE=3]="TAB_MOVE"})(Zy||(Zy={}));var Ky;(function(e){e[e.Editable=0]="Editable",e[e.SupportsHotExit=1]="SupportsHotExit"})(Ky||(Ky={}));var Yy;(function(e){e[e.Int8Array=1]="Int8Array",e[e.Uint8Array=2]="Uint8Array",e[e.Uint8ClampedArray=3]="Uint8ClampedArray",e[e.Int16Array=4]="Int16Array",e[e.Uint16Array=5]="Uint16Array",e[e.Int32Array=6]="Int32Array",e[e.Uint32Array=7]="Uint32Array",e[e.Float32Array=8]="Float32Array",e[e.Float64Array=9]="Float64Array",e[e.BigInt64Array=10]="BigInt64Array",e[e.BigUint64Array=11]="BigUint64Array"})(Yy||(Yy={}));var eb;(function(e){e[e.Text=1]="Text",e[e.Error=2]="Error",e[e.Rich=3]="Rich"})(eb||(eb={}));var tb;(function(e){e[e.Default=0]="Default",e[e.InCenter=1]="InCenter",e[e.InCenterIfOutsideViewport=2]="InCenterIfOutsideViewport",e[e.AtTop=3]="AtTop"})(tb||(tb={}));var Eg;(function(e){e[e.None=0]="None",e[e.Process=1]="Process",e[e.Output=2]="Output",e[e.Hybrid=3]="Hybrid"})(Eg||(Eg={}));var vU=class b6{static{this._n=0}static mixin(t){return t._id=b6._n++,t}},ib;(function(e){e.label="a",e.kind="b",e.detail="c",e.documentation="d",e.sortText="e",e.filterText="f",e.preselect="g",e.insertText="h",e.insertTextRules="i",e.range="j",e.commitCharacters="k",e.additionalTextEdits="l",e.kindModifier="m",e.commandIdent="n",e.commandId="o",e.commandArguments="p"})(ib||(ib={}));var rb;(function(e){e.defaultRanges="a",e.completions="b",e.isIncomplete="c",e.duration="d"})(rb||(rb={}));var nb;(function(e){e[e.Workspace=0]="Workspace",e[e.TextDocument=1]="TextDocument"})(nb||(nb={}));var W={MainThreadAuthentication:R("MainThreadAuthentication"),MainThreadBulkEdits:R("MainThreadBulkEdits"),MainThreadLanguageModels:R("MainThreadLanguageModels"),MainThreadEmbeddings:R("MainThreadEmbeddings"),MainThreadChatAgents2:R("MainThreadChatAgents2"),MainThreadCodeMapper:R("MainThreadCodeMapper"),MainThreadLanguageModelTools:R("MainThreadChatSkills"),MainThreadClipboard:R("MainThreadClipboard"),MainThreadCommands:R("MainThreadCommands"),MainThreadComments:R("MainThreadComments"),MainThreadConfiguration:R("MainThreadConfiguration"),MainThreadConsole:R("MainThreadConsole"),MainThreadDebugService:R("MainThreadDebugService"),MainThreadDecorations:R("MainThreadDecorations"),MainThreadDiagnostics:R("MainThreadDiagnostics"),MainThreadDialogs:R("MainThreadDiaglogs"),MainThreadDocuments:R("MainThreadDocuments"),MainThreadDocumentContentProviders:R("MainThreadDocumentContentProviders"),MainThreadTextEditors:R("MainThreadTextEditors"),MainThreadEditorInsets:R("MainThreadEditorInsets"),MainThreadEditorTabs:R("MainThreadEditorTabs"),MainThreadErrors:R("MainThreadErrors"),MainThreadTreeViews:R("MainThreadTreeViews"),MainThreadDownloadService:R("MainThreadDownloadService"),MainThreadLanguageFeatures:R("MainThreadLanguageFeatures"),MainThreadLanguages:R("MainThreadLanguages"),MainThreadLogger:R("MainThreadLogger"),MainThreadMessageService:R("MainThreadMessageService"),MainThreadOutputService:R("MainThreadOutputService"),MainThreadProgress:R("MainThreadProgress"),MainThreadQuickDiff:R("MainThreadQuickDiff"),MainThreadQuickOpen:R("MainThreadQuickOpen"),MainThreadStatusBar:R("MainThreadStatusBar"),MainThreadSecretState:R("MainThreadSecretState"),MainThreadStorage:R("MainThreadStorage"),MainThreadSpeech:R("MainThreadSpeechProvider"),MainThreadTelemetry:R("MainThreadTelemetry"),MainThreadTerminalService:R("MainThreadTerminalService"),MainThreadTerminalShellIntegration:R("MainThreadTerminalShellIntegration"),MainThreadWebviews:R("MainThreadWebviews"),MainThreadWebviewPanels:R("MainThreadWebviewPanels"),MainThreadWebviewViews:R("MainThreadWebviewViews"),MainThreadCustomEditors:R("MainThreadCustomEditors"),MainThreadUrls:R("MainThreadUrls"),MainThreadUriOpeners:R("MainThreadUriOpeners"),MainThreadProfileContentHandlers:R("MainThreadProfileContentHandlers"),MainThreadWorkspace:R("MainThreadWorkspace"),MainThreadFileSystem:R("MainThreadFileSystem"),MainThreadFileSystemEventService:R("MainThreadFileSystemEventService"),MainThreadExtensionService:R("MainThreadExtensionService"),MainThreadSCM:R("MainThreadSCM"),MainThreadSearch:R("MainThreadSearch"),MainThreadShare:R("MainThreadShare"),MainThreadTask:R("MainThreadTask"),MainThreadWindow:R("MainThreadWindow"),MainThreadLabelService:R("MainThreadLabelService"),MainThreadNotebook:R("MainThreadNotebook"),MainThreadNotebookDocuments:R("MainThreadNotebookDocumentsShape"),MainThreadNotebookEditors:R("MainThreadNotebookEditorsShape"),MainThreadNotebookKernels:R("MainThreadNotebookKernels"),MainThreadNotebookRenderers:R("MainThreadNotebookRenderers"),MainThreadInteractive:R("MainThreadInteractive"),MainThreadTheming:R("MainThreadTheming"),MainThreadTunnelService:R("MainThreadTunnelService"),MainThreadManagedSockets:R("MainThreadManagedSockets"),MainThreadTimeline:R("MainThreadTimeline"),MainThreadTesting:R("MainThreadTesting"),MainThreadLocalization:R("MainThreadLocalizationShape"),MainThreadMcp:R("MainThreadMcpShape"),MainThreadAiRelatedInformation:R("MainThreadAiRelatedInformation"),MainThreadAiEmbeddingVector:R("MainThreadAiEmbeddingVector"),MainThreadChatStatus:R("MainThreadChatStatus"),MainThreadAiSettingsSearch:R("MainThreadAiSettingsSearch"),MainThreadInlineDiff:R("MainThreadInlineDiff"),MainThreadEditorBottomWidget:R("MainThreadEditorBottomWidget"),MainThreadInlineChat:R("MainThreadInlineChat"),MainThreadTerminalCommandChat:R("MainThreadTerminalCommandChat"),MainThreadSelectionAction:R("MainThreadSelectionAction"),MainThreadTerminalSelectionAction:R("MainThreadTerminalSelectionAction"),MainThreadEditCode:R("MainThreadEditCode")},Z={ExtHostCodeMapper:R("ExtHostCodeMapper"),ExtHostCommands:R("ExtHostCommands"),ExtHostConfiguration:R("ExtHostConfiguration"),ExtHostDiagnostics:R("ExtHostDiagnostics"),ExtHostDebugService:R("ExtHostDebugService"),ExtHostDecorations:R("ExtHostDecorations"),ExtHostDocumentsAndEditors:R("ExtHostDocumentsAndEditors"),ExtHostDocuments:R("ExtHostDocuments"),ExtHostDocumentContentProviders:R("ExtHostDocumentContentProviders"),ExtHostDocumentSaveParticipant:R("ExtHostDocumentSaveParticipant"),ExtHostEditors:R("ExtHostEditors"),ExtHostTreeViews:R("ExtHostTreeViews"),ExtHostFileSystem:R("ExtHostFileSystem"),ExtHostFileSystemInfo:R("ExtHostFileSystemInfo"),ExtHostFileSystemEventService:R("ExtHostFileSystemEventService"),ExtHostLanguages:R("ExtHostLanguages"),ExtHostLanguageFeatures:R("ExtHostLanguageFeatures"),ExtHostQuickOpen:R("ExtHostQuickOpen"),ExtHostQuickDiff:R("ExtHostQuickDiff"),ExtHostStatusBar:R("ExtHostStatusBar"),ExtHostShare:R("ExtHostShare"),ExtHostExtensionService:R("ExtHostExtensionService"),ExtHostLogLevelServiceShape:R("ExtHostLogLevelServiceShape"),ExtHostTerminalService:R("ExtHostTerminalService"),ExtHostTerminalShellIntegration:R("ExtHostTerminalShellIntegration"),ExtHostSCM:R("ExtHostSCM"),ExtHostSearch:R("ExtHostSearch"),ExtHostTask:R("ExtHostTask"),ExtHostWorkspace:R("ExtHostWorkspace"),ExtHostWindow:R("ExtHostWindow"),ExtHostWebviews:R("ExtHostWebviews"),ExtHostWebviewPanels:R("ExtHostWebviewPanels"),ExtHostCustomEditors:R("ExtHostCustomEditors"),ExtHostWebviewViews:R("ExtHostWebviewViews"),ExtHostEditorInsets:R("ExtHostEditorInsets"),ExtHostEditorTabs:R("ExtHostEditorTabs"),ExtHostProgress:R("ExtHostProgress"),ExtHostComments:R("ExtHostComments"),ExtHostSecretState:R("ExtHostSecretState"),ExtHostStorage:R("ExtHostStorage"),ExtHostUrls:R("ExtHostUrls"),ExtHostUriOpeners:R("ExtHostUriOpeners"),ExtHostProfileContentHandlers:R("ExtHostProfileContentHandlers"),ExtHostOutputService:R("ExtHostOutputService"),ExtHostLabelService:R("ExtHostLabelService"),ExtHostNotebook:R("ExtHostNotebook"),ExtHostNotebookDocuments:R("ExtHostNotebookDocuments"),ExtHostNotebookEditors:R("ExtHostNotebookEditors"),ExtHostNotebookKernels:R("ExtHostNotebookKernels"),ExtHostNotebookRenderers:R("ExtHostNotebookRenderers"),ExtHostNotebookDocumentSaveParticipant:R("ExtHostNotebookDocumentSaveParticipant"),ExtHostInteractive:R("ExtHostInteractive"),ExtHostChatAgents2:R("ExtHostChatAgents"),ExtHostLanguageModelTools:R("ExtHostChatSkills"),ExtHostChatProvider:R("ExtHostChatProvider"),ExtHostSpeech:R("ExtHostSpeech"),ExtHostEmbeddings:R("ExtHostEmbeddings"),ExtHostAiRelatedInformation:R("ExtHostAiRelatedInformation"),ExtHostAiEmbeddingVector:R("ExtHostAiEmbeddingVector"),ExtHostAiSettingsSearch:R("ExtHostAiSettingsSearch"),ExtHostTheming:R("ExtHostTheming"),ExtHostTunnelService:R("ExtHostTunnelService"),ExtHostManagedSockets:R("ExtHostManagedSockets"),ExtHostAuthentication:R("ExtHostAuthentication"),ExtHostTimeline:R("ExtHostTimeline"),ExtHostTesting:R("ExtHostTesting"),ExtHostTelemetry:R("ExtHostTelemetry"),ExtHostLocalization:R("ExtHostLocalization"),ExtHostMcp:R("ExtHostMcp"),ExtHostInlineDiff:R("ExtHostInlineDiff"),ExtHostEditorBottomWidget:R("ExtHostEditorBottomWidget"),ExtHostInlineChat:R("ExtHostInlineChat"),ExtHostTerminalCommandChat:R("ExtHostTerminalCommandChat"),ExtHostSelectionAction:R("ExtHostSelectionAction"),ExtHostTerminalSelectionAction:R("ExtHostTerminalSelectionAction"),ExtHostEditCode:R("ExtHostEditCode")},sb=Object.freeze(function(e,t){const i=setTimeout(e.bind(t),0);return{dispose(){clearTimeout(i)}}}),Xe;(function(e){function t(i){return i===e.None||i===e.Cancelled||i instanceof ju?!0:!i||typeof i!="object"?!1:typeof i.isCancellationRequested=="boolean"&&typeof i.onCancellationRequested=="function"}e.isCancellationToken=t,e.None=Object.freeze({isCancellationRequested:!1,onCancellationRequested:ct.None}),e.Cancelled=Object.freeze({isCancellationRequested:!0,onCancellationRequested:sb})})(Xe||(Xe={}));var ju=class{constructor(){this._isCancelled=!1,this._emitter=null}cancel(){this._isCancelled||(this._isCancelled=!0,this._emitter&&(this._emitter.fire(void 0),this.dispose()))}get isCancellationRequested(){return this._isCancelled}get onCancellationRequested(){return this._isCancelled?sb:(this._emitter||(this._emitter=new P),this._emitter.event)}dispose(){this._emitter&&(this._emitter.dispose(),this._emitter=null)}},ft=class{constructor(e){this._token=void 0,this._parentListener=void 0,this._parentListener=e&&e.onCancellationRequested(this.cancel,this)}get token(){return this._token||(this._token=new ju),this._token}cancel(){this._token?this._token instanceof ju&&this._token.cancel():this._token=Xe.Cancelled}dispose(e=!1){e&&this.cancel(),this._parentListener?.dispose(),this._token?this._token instanceof ju&&this._token.dispose():this._token=Xe.None}};function LP(e){return e}var NP=class{constructor(e,t){this.lastCache=void 0,this.lastArgKey=void 0,typeof e=="function"?(this._fn=e,this._computeKey=LP):(this._fn=t,this._computeKey=e.getCacheKey)}get(e){const t=this._computeKey(e);return this.lastArgKey!==t&&(this.lastArgKey=t,this.lastCache=this._fn(e)),this.lastCache}};function Gu(e){return!e||typeof e!="string"?!0:e.trim().length===0}var MP=/{([^}]+)}/g;function ob(e,t){return Object.keys(t).length===0?e:e.replace(MP,(i,r)=>t[r]??i)}function ps(e){return e.replace(/[\\\{\}\*\+\?\|\^\$\.\[\]\(\)]/g,"\\$&")}function OP(e,t){let i=0,r=e.indexOf(t);for(;r!==-1;)i++,r=e.indexOf(t,r+t.length);return i}function FP(e,t){if(!e||!t)return e;const i=t.length;if(i===0||e.length===0)return e;let r=0;for(;e.indexOf(t,r)===r;)r=r+i;return e.substring(r)}function Cg(e,t){if(!e||!t)return e;const i=t.length,r=e.length;if(i===0||r===0)return e;let n=r,s=-1;for(;s=e.lastIndexOf(t,n-1),!(s===-1||s+i!==n);){if(s===0)return"";n=s}return e.substring(0,n)}function $P(e,t,i={}){if(!e)throw new Error("Cannot create regex from empty string");t||(e=ps(e)),i.wholeWord&&(/\B/.test(e.charAt(0))||(e="\\b"+e),/\B/.test(e.charAt(e.length-1))||(e=e+"\\b"));let r="";return i.global&&(r+="g"),i.matchCase||(r+="i"),i.multiline&&(r+="m"),i.unicode&&(r+="u"),new RegExp(e,r)}function ab(e){return e.source==="^"||e.source==="^$"||e.source==="$"||e.source==="^\\s*$"?!1:!!(e.exec("")&&e.lastIndex===0)}function lb(e){return e.split(/\r\n|\r|\n/)}function Dg(e){for(let t=0,i=e.length;t<i;t++){const r=e.charCodeAt(t);if(r!==32&&r!==9)return t}return-1}function HP(e,t=e.length-1){for(let i=t;i>=0;i--){const r=e.charCodeAt(i);if(r!==32&&r!==9)return i}return-1}function gs(e,t){return e<t?-1:e>t?1:0}function Ig(e,t,i=0,r=e.length,n=0,s=t.length){for(;i<r&&n<s;i++,n++){const l=e.charCodeAt(i),c=t.charCodeAt(n);if(l<c)return-1;if(l>c)return 1}const o=r-i,a=s-n;return o<a?-1:o>a?1:0}function kg(e,t){return dl(e,t,0,e.length,0,t.length)}function dl(e,t,i=0,r=e.length,n=0,s=t.length){for(;i<r&&n<s;i++,n++){let l=e.charCodeAt(i),c=t.charCodeAt(n);if(l===c)continue;if(l>=128||c>=128)return Ig(e.toLowerCase(),t.toLowerCase(),i,r,n,s);cb(l)&&(l-=32),cb(c)&&(c-=32);const u=l-c;if(u!==0)return u}const o=r-i,a=s-n;return o<a?-1:o>a?1:0}function cb(e){return e>=97&&e<=122}function Pn(e,t){return e.length===t.length&&dl(e,t)===0}function Pg(e,t){const i=t.length;return t.length>e.length?!1:dl(e,t,0,i)===0}function UP(e,t){const i=Math.min(e.length,t.length);let r;for(r=0;r<i;r++)if(e.charCodeAt(r)!==t.charCodeAt(r))return r;return i}function Qu(e){return 55296<=e&&e<=56319}function Ju(e){return 56320<=e&&e<=57343}function Tg(e,t){return(e-55296<<10)+(t-56320)+65536}function ub(e,t,i){const r=e.charCodeAt(i);if(Qu(r)&&i+1<t){const n=e.charCodeAt(i+1);if(Ju(n))return Tg(r,n)}return r}function BP(e,t){const i=e.charCodeAt(t-1);if(Ju(i)&&t>1){const r=e.charCodeAt(t-2);if(Qu(r))return Tg(r,i)}return i}var WP=class{get offset(){return this._offset}constructor(e,t=0){this._str=e,this._len=e.length,this._offset=t}setOffset(e){this._offset=e}prevCodePoint(){const e=BP(this._str,this._offset);return this._offset-=e>=65536?2:1,e}nextCodePoint(){const e=ub(this._str,this._len,this._offset);return this._offset+=e>=65536?2:1,e}eol(){return this._offset>=this._len}},VP=class{get offset(){return this._iterator.offset}constructor(e,t=0){this._iterator=new WP(e,t)}nextGraphemeLength(){const e=vb.getInstance(),t=this._iterator,i=t.offset;let r=e.getGraphemeBreakType(t.nextCodePoint());for(;!t.eol();){const n=t.offset,s=e.getGraphemeBreakType(t.nextCodePoint());if(gb(r,s)){t.setOffset(n);break}r=s}return t.offset-i}prevGraphemeLength(){const e=vb.getInstance(),t=this._iterator,i=t.offset;let r=e.getGraphemeBreakType(t.prevCodePoint());for(;t.offset>0;){const n=t.offset,s=e.getGraphemeBreakType(t.prevCodePoint());if(gb(s,r)){t.setOffset(n);break}r=s}return i-t.offset}eol(){return this._iterator.eol()}};function db(e,t){return new VP(e,t).nextGraphemeLength()}var Ag=void 0;function zP(){return/(?:[\u05BE\u05C0\u05C3\u05C6\u05D0-\u05F4\u0608\u060B\u060D\u061B-\u064A\u066D-\u066F\u0671-\u06D5\u06E5\u06E6\u06EE\u06EF\u06FA-\u0710\u0712-\u072F\u074D-\u07A5\u07B1-\u07EA\u07F4\u07F5\u07FA\u07FE-\u0815\u081A\u0824\u0828\u0830-\u0858\u085E-\u088E\u08A0-\u08C9\u200F\uFB1D\uFB1F-\uFB28\uFB2A-\uFD3D\uFD50-\uFDC7\uFDF0-\uFDFC\uFE70-\uFEFC]|\uD802[\uDC00-\uDD1B\uDD20-\uDE00\uDE10-\uDE35\uDE40-\uDEE4\uDEEB-\uDF35\uDF40-\uDFFF]|\uD803[\uDC00-\uDD23\uDE80-\uDEA9\uDEAD-\uDF45\uDF51-\uDF81\uDF86-\uDFF6]|\uD83A[\uDC00-\uDCCF\uDD00-\uDD43\uDD4B-\uDFFF]|\uD83B[\uDC00-\uDEBB])/}function hb(e){return Ag||(Ag=zP()),Ag.test(e)}var qP=/^[\t\n\r\x20-\x7E]*$/;function jP(e){return qP.test(e)}var GP=/[\u2028\u2029]/;function fb(e){return GP.test(e)}var QP=/(?:\x1b\[|\x9b)[=?>!]?[\d;:]*["$#'* ]?[a-zA-Z@^`{}|~]/,JP=/(?:\x1b\]|\x9d).*?(?:\x1b\\|\x07|\x9c)/,XP=/\x1b(?:[ #%\(\)\*\+\-\.\/]?[a-zA-Z0-9\|}~@])/,_U=new RegExp("(?:"+[QP.source,JP.source,XP.source].join("|")+")","g"),ZP="\uFEFF";function KP(e){return!!(e&&e.length>0&&e.charCodeAt(0)===65279)}function pb(e,t=!1){return e?(t&&(e=e.replace(/\\./g,"")),e.toLowerCase()!==e):!1}function YP(e,t=1){if(t===0)return"";let i=-1;do i=e.indexOf(`
`,i+1),t--;while(t>0&&i>=0);return i===-1?e:(e[i-1]==="\r"&&i--,e.substr(0,i))}function gb(e,t){return e===0?t!==5&&t!==7:e===2&&t===3?!1:e===4||e===2||e===3||t===4||t===2||t===3?!0:!(e===8&&(t===8||t===9||t===11||t===12)||(e===11||e===9)&&(t===9||t===10)||(e===12||e===10)&&t===10||t===5||t===13||t===7||e===1||e===13&&t===14||e===6&&t===6)}var mb;(function(e){e[e.Other=0]="Other",e[e.Prepend=1]="Prepend",e[e.CR=2]="CR",e[e.LF=3]="LF",e[e.Control=4]="Control",e[e.Extend=5]="Extend",e[e.Regional_Indicator=6]="Regional_Indicator",e[e.SpacingMark=7]="SpacingMark",e[e.L=8]="L",e[e.V=9]="V",e[e.T=10]="T",e[e.LV=11]="LV",e[e.LVT=12]="LVT",e[e.ZWJ=13]="ZWJ",e[e.Extended_Pictographic=14]="Extended_Pictographic"})(mb||(mb={}));var vb=class pu{static{this._INSTANCE=null}static getInstance(){return pu._INSTANCE||(pu._INSTANCE=new pu),pu._INSTANCE}constructor(){this._data=eT()}getGraphemeBreakType(t){if(t<32)return t===10?3:t===13?2:4;if(t<127)return 0;const i=this._data,r=i.length/3;let n=1;for(;n<=r;)if(t<i[3*n])n=2*n;else if(t>i[3*n+1])n=2*n+1;else return i[3*n+2];return 0}};function eT(){return JSON.parse("[0,0,0,51229,51255,12,44061,44087,12,127462,127487,6,7083,7085,5,47645,47671,12,54813,54839,12,128678,128678,14,3270,3270,5,9919,9923,14,45853,45879,12,49437,49463,12,53021,53047,12,71216,71218,7,128398,128399,14,129360,129374,14,2519,2519,5,4448,4519,9,9742,9742,14,12336,12336,14,44957,44983,12,46749,46775,12,48541,48567,12,50333,50359,12,52125,52151,12,53917,53943,12,69888,69890,5,73018,73018,5,127990,127990,14,128558,128559,14,128759,128760,14,129653,129655,14,2027,2035,5,2891,2892,7,3761,3761,5,6683,6683,5,8293,8293,4,9825,9826,14,9999,9999,14,43452,43453,5,44509,44535,12,45405,45431,12,46301,46327,12,47197,47223,12,48093,48119,12,48989,49015,12,49885,49911,12,50781,50807,12,51677,51703,12,52573,52599,12,53469,53495,12,54365,54391,12,65279,65279,4,70471,70472,7,72145,72147,7,119173,119179,5,127799,127818,14,128240,128244,14,128512,128512,14,128652,128652,14,128721,128722,14,129292,129292,14,129445,129450,14,129734,129743,14,1476,1477,5,2366,2368,7,2750,2752,7,3076,3076,5,3415,3415,5,4141,4144,5,6109,6109,5,6964,6964,5,7394,7400,5,9197,9198,14,9770,9770,14,9877,9877,14,9968,9969,14,10084,10084,14,43052,43052,5,43713,43713,5,44285,44311,12,44733,44759,12,45181,45207,12,45629,45655,12,46077,46103,12,46525,46551,12,46973,46999,12,47421,47447,12,47869,47895,12,48317,48343,12,48765,48791,12,49213,49239,12,49661,49687,12,50109,50135,12,50557,50583,12,51005,51031,12,51453,51479,12,51901,51927,12,52349,52375,12,52797,52823,12,53245,53271,12,53693,53719,12,54141,54167,12,54589,54615,12,55037,55063,12,69506,69509,5,70191,70193,5,70841,70841,7,71463,71467,5,72330,72342,5,94031,94031,5,123628,123631,5,127763,127765,14,127941,127941,14,128043,128062,14,128302,128317,14,128465,128467,14,128539,128539,14,128640,128640,14,128662,128662,14,128703,128703,14,128745,128745,14,129004,129007,14,129329,129330,14,129402,129402,14,129483,129483,14,129686,129704,14,130048,131069,14,173,173,4,1757,1757,1,2200,2207,5,2434,2435,7,2631,2632,5,2817,2817,5,3008,3008,5,3201,3201,5,3387,3388,5,3542,3542,5,3902,3903,7,4190,4192,5,6002,6003,5,6439,6440,5,6765,6770,7,7019,7027,5,7154,7155,7,8205,8205,13,8505,8505,14,9654,9654,14,9757,9757,14,9792,9792,14,9852,9853,14,9890,9894,14,9937,9937,14,9981,9981,14,10035,10036,14,11035,11036,14,42654,42655,5,43346,43347,7,43587,43587,5,44006,44007,7,44173,44199,12,44397,44423,12,44621,44647,12,44845,44871,12,45069,45095,12,45293,45319,12,45517,45543,12,45741,45767,12,45965,45991,12,46189,46215,12,46413,46439,12,46637,46663,12,46861,46887,12,47085,47111,12,47309,47335,12,47533,47559,12,47757,47783,12,47981,48007,12,48205,48231,12,48429,48455,12,48653,48679,12,48877,48903,12,49101,49127,12,49325,49351,12,49549,49575,12,49773,49799,12,49997,50023,12,50221,50247,12,50445,50471,12,50669,50695,12,50893,50919,12,51117,51143,12,51341,51367,12,51565,51591,12,51789,51815,12,52013,52039,12,52237,52263,12,52461,52487,12,52685,52711,12,52909,52935,12,53133,53159,12,53357,53383,12,53581,53607,12,53805,53831,12,54029,54055,12,54253,54279,12,54477,54503,12,54701,54727,12,54925,54951,12,55149,55175,12,68101,68102,5,69762,69762,7,70067,70069,7,70371,70378,5,70720,70721,7,71087,71087,5,71341,71341,5,71995,71996,5,72249,72249,7,72850,72871,5,73109,73109,5,118576,118598,5,121505,121519,5,127245,127247,14,127568,127569,14,127777,127777,14,127872,127891,14,127956,127967,14,128015,128016,14,128110,128172,14,128259,128259,14,128367,128368,14,128424,128424,14,128488,128488,14,128530,128532,14,128550,128551,14,128566,128566,14,128647,128647,14,128656,128656,14,128667,128673,14,128691,128693,14,128715,128715,14,128728,128732,14,128752,128752,14,128765,128767,14,129096,129103,14,129311,129311,14,129344,129349,14,129394,129394,14,129413,129425,14,129466,129471,14,129511,129535,14,129664,129666,14,129719,129722,14,129760,129767,14,917536,917631,5,13,13,2,1160,1161,5,1564,1564,4,1807,1807,1,2085,2087,5,2307,2307,7,2382,2383,7,2497,2500,5,2563,2563,7,2677,2677,5,2763,2764,7,2879,2879,5,2914,2915,5,3021,3021,5,3142,3144,5,3263,3263,5,3285,3286,5,3398,3400,7,3530,3530,5,3633,3633,5,3864,3865,5,3974,3975,5,4155,4156,7,4229,4230,5,5909,5909,7,6078,6085,7,6277,6278,5,6451,6456,7,6744,6750,5,6846,6846,5,6972,6972,5,7074,7077,5,7146,7148,7,7222,7223,5,7416,7417,5,8234,8238,4,8417,8417,5,9000,9000,14,9203,9203,14,9730,9731,14,9748,9749,14,9762,9763,14,9776,9783,14,9800,9811,14,9831,9831,14,9872,9873,14,9882,9882,14,9900,9903,14,9929,9933,14,9941,9960,14,9974,9974,14,9989,9989,14,10006,10006,14,10062,10062,14,10160,10160,14,11647,11647,5,12953,12953,14,43019,43019,5,43232,43249,5,43443,43443,5,43567,43568,7,43696,43696,5,43765,43765,7,44013,44013,5,44117,44143,12,44229,44255,12,44341,44367,12,44453,44479,12,44565,44591,12,44677,44703,12,44789,44815,12,44901,44927,12,45013,45039,12,45125,45151,12,45237,45263,12,45349,45375,12,45461,45487,12,45573,45599,12,45685,45711,12,45797,45823,12,45909,45935,12,46021,46047,12,46133,46159,12,46245,46271,12,46357,46383,12,46469,46495,12,46581,46607,12,46693,46719,12,46805,46831,12,46917,46943,12,47029,47055,12,47141,47167,12,47253,47279,12,47365,47391,12,47477,47503,12,47589,47615,12,47701,47727,12,47813,47839,12,47925,47951,12,48037,48063,12,48149,48175,12,48261,48287,12,48373,48399,12,48485,48511,12,48597,48623,12,48709,48735,12,48821,48847,12,48933,48959,12,49045,49071,12,49157,49183,12,49269,49295,12,49381,49407,12,49493,49519,12,49605,49631,12,49717,49743,12,49829,49855,12,49941,49967,12,50053,50079,12,50165,50191,12,50277,50303,12,50389,50415,12,50501,50527,12,50613,50639,12,50725,50751,12,50837,50863,12,50949,50975,12,51061,51087,12,51173,51199,12,51285,51311,12,51397,51423,12,51509,51535,12,51621,51647,12,51733,51759,12,51845,51871,12,51957,51983,12,52069,52095,12,52181,52207,12,52293,52319,12,52405,52431,12,52517,52543,12,52629,52655,12,52741,52767,12,52853,52879,12,52965,52991,12,53077,53103,12,53189,53215,12,53301,53327,12,53413,53439,12,53525,53551,12,53637,53663,12,53749,53775,12,53861,53887,12,53973,53999,12,54085,54111,12,54197,54223,12,54309,54335,12,54421,54447,12,54533,54559,12,54645,54671,12,54757,54783,12,54869,54895,12,54981,55007,12,55093,55119,12,55243,55291,10,66045,66045,5,68325,68326,5,69688,69702,5,69817,69818,5,69957,69958,7,70089,70092,5,70198,70199,5,70462,70462,5,70502,70508,5,70750,70750,5,70846,70846,7,71100,71101,5,71230,71230,7,71351,71351,5,71737,71738,5,72000,72000,7,72160,72160,5,72273,72278,5,72752,72758,5,72882,72883,5,73031,73031,5,73461,73462,7,94192,94193,7,119149,119149,7,121403,121452,5,122915,122916,5,126980,126980,14,127358,127359,14,127535,127535,14,127759,127759,14,127771,127771,14,127792,127793,14,127825,127867,14,127897,127899,14,127945,127945,14,127985,127986,14,128000,128007,14,128021,128021,14,128066,128100,14,128184,128235,14,128249,128252,14,128266,128276,14,128335,128335,14,128379,128390,14,128407,128419,14,128444,128444,14,128481,128481,14,128499,128499,14,128526,128526,14,128536,128536,14,128543,128543,14,128556,128556,14,128564,128564,14,128577,128580,14,128643,128645,14,128649,128649,14,128654,128654,14,128660,128660,14,128664,128664,14,128675,128675,14,128686,128689,14,128695,128696,14,128705,128709,14,128717,128719,14,128725,128725,14,128736,128741,14,128747,128748,14,128755,128755,14,128762,128762,14,128981,128991,14,129009,129023,14,129160,129167,14,129296,129304,14,129320,129327,14,129340,129342,14,129356,129356,14,129388,129392,14,129399,129400,14,129404,129407,14,129432,129442,14,129454,129455,14,129473,129474,14,129485,129487,14,129648,129651,14,129659,129660,14,129671,129679,14,129709,129711,14,129728,129730,14,129751,129753,14,129776,129782,14,917505,917505,4,917760,917999,5,10,10,3,127,159,4,768,879,5,1471,1471,5,1536,1541,1,1648,1648,5,1767,1768,5,1840,1866,5,2070,2073,5,2137,2139,5,2274,2274,1,2363,2363,7,2377,2380,7,2402,2403,5,2494,2494,5,2507,2508,7,2558,2558,5,2622,2624,7,2641,2641,5,2691,2691,7,2759,2760,5,2786,2787,5,2876,2876,5,2881,2884,5,2901,2902,5,3006,3006,5,3014,3016,7,3072,3072,5,3134,3136,5,3157,3158,5,3260,3260,5,3266,3266,5,3274,3275,7,3328,3329,5,3391,3392,7,3405,3405,5,3457,3457,5,3536,3537,7,3551,3551,5,3636,3642,5,3764,3772,5,3895,3895,5,3967,3967,7,3993,4028,5,4146,4151,5,4182,4183,7,4226,4226,5,4253,4253,5,4957,4959,5,5940,5940,7,6070,6070,7,6087,6088,7,6158,6158,4,6432,6434,5,6448,6449,7,6679,6680,5,6742,6742,5,6754,6754,5,6783,6783,5,6912,6915,5,6966,6970,5,6978,6978,5,7042,7042,7,7080,7081,5,7143,7143,7,7150,7150,7,7212,7219,5,7380,7392,5,7412,7412,5,8203,8203,4,8232,8232,4,8265,8265,14,8400,8412,5,8421,8432,5,8617,8618,14,9167,9167,14,9200,9200,14,9410,9410,14,9723,9726,14,9733,9733,14,9745,9745,14,9752,9752,14,9760,9760,14,9766,9766,14,9774,9774,14,9786,9786,14,9794,9794,14,9823,9823,14,9828,9828,14,9833,9850,14,9855,9855,14,9875,9875,14,9880,9880,14,9885,9887,14,9896,9897,14,9906,9916,14,9926,9927,14,9935,9935,14,9939,9939,14,9962,9962,14,9972,9972,14,9978,9978,14,9986,9986,14,9997,9997,14,10002,10002,14,10017,10017,14,10055,10055,14,10071,10071,14,10133,10135,14,10548,10549,14,11093,11093,14,12330,12333,5,12441,12442,5,42608,42610,5,43010,43010,5,43045,43046,5,43188,43203,7,43302,43309,5,43392,43394,5,43446,43449,5,43493,43493,5,43571,43572,7,43597,43597,7,43703,43704,5,43756,43757,5,44003,44004,7,44009,44010,7,44033,44059,12,44089,44115,12,44145,44171,12,44201,44227,12,44257,44283,12,44313,44339,12,44369,44395,12,44425,44451,12,44481,44507,12,44537,44563,12,44593,44619,12,44649,44675,12,44705,44731,12,44761,44787,12,44817,44843,12,44873,44899,12,44929,44955,12,44985,45011,12,45041,45067,12,45097,45123,12,45153,45179,12,45209,45235,12,45265,45291,12,45321,45347,12,45377,45403,12,45433,45459,12,45489,45515,12,45545,45571,12,45601,45627,12,45657,45683,12,45713,45739,12,45769,45795,12,45825,45851,12,45881,45907,12,45937,45963,12,45993,46019,12,46049,46075,12,46105,46131,12,46161,46187,12,46217,46243,12,46273,46299,12,46329,46355,12,46385,46411,12,46441,46467,12,46497,46523,12,46553,46579,12,46609,46635,12,46665,46691,12,46721,46747,12,46777,46803,12,46833,46859,12,46889,46915,12,46945,46971,12,47001,47027,12,47057,47083,12,47113,47139,12,47169,47195,12,47225,47251,12,47281,47307,12,47337,47363,12,47393,47419,12,47449,47475,12,47505,47531,12,47561,47587,12,47617,47643,12,47673,47699,12,47729,47755,12,47785,47811,12,47841,47867,12,47897,47923,12,47953,47979,12,48009,48035,12,48065,48091,12,48121,48147,12,48177,48203,12,48233,48259,12,48289,48315,12,48345,48371,12,48401,48427,12,48457,48483,12,48513,48539,12,48569,48595,12,48625,48651,12,48681,48707,12,48737,48763,12,48793,48819,12,48849,48875,12,48905,48931,12,48961,48987,12,49017,49043,12,49073,49099,12,49129,49155,12,49185,49211,12,49241,49267,12,49297,49323,12,49353,49379,12,49409,49435,12,49465,49491,12,49521,49547,12,49577,49603,12,49633,49659,12,49689,49715,12,49745,49771,12,49801,49827,12,49857,49883,12,49913,49939,12,49969,49995,12,50025,50051,12,50081,50107,12,50137,50163,12,50193,50219,12,50249,50275,12,50305,50331,12,50361,50387,12,50417,50443,12,50473,50499,12,50529,50555,12,50585,50611,12,50641,50667,12,50697,50723,12,50753,50779,12,50809,50835,12,50865,50891,12,50921,50947,12,50977,51003,12,51033,51059,12,51089,51115,12,51145,51171,12,51201,51227,12,51257,51283,12,51313,51339,12,51369,51395,12,51425,51451,12,51481,51507,12,51537,51563,12,51593,51619,12,51649,51675,12,51705,51731,12,51761,51787,12,51817,51843,12,51873,51899,12,51929,51955,12,51985,52011,12,52041,52067,12,52097,52123,12,52153,52179,12,52209,52235,12,52265,52291,12,52321,52347,12,52377,52403,12,52433,52459,12,52489,52515,12,52545,52571,12,52601,52627,12,52657,52683,12,52713,52739,12,52769,52795,12,52825,52851,12,52881,52907,12,52937,52963,12,52993,53019,12,53049,53075,12,53105,53131,12,53161,53187,12,53217,53243,12,53273,53299,12,53329,53355,12,53385,53411,12,53441,53467,12,53497,53523,12,53553,53579,12,53609,53635,12,53665,53691,12,53721,53747,12,53777,53803,12,53833,53859,12,53889,53915,12,53945,53971,12,54001,54027,12,54057,54083,12,54113,54139,12,54169,54195,12,54225,54251,12,54281,54307,12,54337,54363,12,54393,54419,12,54449,54475,12,54505,54531,12,54561,54587,12,54617,54643,12,54673,54699,12,54729,54755,12,54785,54811,12,54841,54867,12,54897,54923,12,54953,54979,12,55009,55035,12,55065,55091,12,55121,55147,12,55177,55203,12,65024,65039,5,65520,65528,4,66422,66426,5,68152,68154,5,69291,69292,5,69633,69633,5,69747,69748,5,69811,69814,5,69826,69826,5,69932,69932,7,70016,70017,5,70079,70080,7,70095,70095,5,70196,70196,5,70367,70367,5,70402,70403,7,70464,70464,5,70487,70487,5,70709,70711,7,70725,70725,7,70833,70834,7,70843,70844,7,70849,70849,7,71090,71093,5,71103,71104,5,71227,71228,7,71339,71339,5,71344,71349,5,71458,71461,5,71727,71735,5,71985,71989,7,71998,71998,5,72002,72002,7,72154,72155,5,72193,72202,5,72251,72254,5,72281,72283,5,72344,72345,5,72766,72766,7,72874,72880,5,72885,72886,5,73023,73029,5,73104,73105,5,73111,73111,5,92912,92916,5,94095,94098,5,113824,113827,4,119142,119142,7,119155,119162,4,119362,119364,5,121476,121476,5,122888,122904,5,123184,123190,5,125252,125258,5,127183,127183,14,127340,127343,14,127377,127386,14,127491,127503,14,127548,127551,14,127744,127756,14,127761,127761,14,127769,127769,14,127773,127774,14,127780,127788,14,127796,127797,14,127820,127823,14,127869,127869,14,127894,127895,14,127902,127903,14,127943,127943,14,127947,127950,14,127972,127972,14,127988,127988,14,127992,127994,14,128009,128011,14,128019,128019,14,128023,128041,14,128064,128064,14,128102,128107,14,128174,128181,14,128238,128238,14,128246,128247,14,128254,128254,14,128264,128264,14,128278,128299,14,128329,128330,14,128348,128359,14,128371,128377,14,128392,128393,14,128401,128404,14,128421,128421,14,128433,128434,14,128450,128452,14,128476,128478,14,128483,128483,14,128495,128495,14,128506,128506,14,128519,128520,14,128528,128528,14,128534,128534,14,128538,128538,14,128540,128542,14,128544,128549,14,128552,128555,14,128557,128557,14,128560,128563,14,128565,128565,14,128567,128576,14,128581,128591,14,128641,128642,14,128646,128646,14,128648,128648,14,128650,128651,14,128653,128653,14,128655,128655,14,128657,128659,14,128661,128661,14,128663,128663,14,128665,128666,14,128674,128674,14,128676,128677,14,128679,128685,14,128690,128690,14,128694,128694,14,128697,128702,14,128704,128704,14,128710,128714,14,128716,128716,14,128720,128720,14,128723,128724,14,128726,128727,14,128733,128735,14,128742,128744,14,128746,128746,14,128749,128751,14,128753,128754,14,128756,128758,14,128761,128761,14,128763,128764,14,128884,128895,14,128992,129003,14,129008,129008,14,129036,129039,14,129114,129119,14,129198,129279,14,129293,129295,14,129305,129310,14,129312,129319,14,129328,129328,14,129331,129338,14,129343,129343,14,129351,129355,14,129357,129359,14,129375,129387,14,129393,129393,14,129395,129398,14,129401,129401,14,129403,129403,14,129408,129412,14,129426,129431,14,129443,129444,14,129451,129453,14,129456,129465,14,129472,129472,14,129475,129482,14,129484,129484,14,129488,129510,14,129536,129647,14,129652,129652,14,129656,129658,14,129661,129663,14,129667,129670,14,129680,129685,14,129705,129708,14,129712,129718,14,129723,129727,14,129731,129733,14,129744,129750,14,129754,129759,14,129768,129775,14,129783,129791,14,917504,917504,4,917506,917535,4,917632,917759,4,918000,921599,4,0,9,4,11,12,4,14,31,4,169,169,14,174,174,14,1155,1159,5,1425,1469,5,1473,1474,5,1479,1479,5,1552,1562,5,1611,1631,5,1750,1756,5,1759,1764,5,1770,1773,5,1809,1809,5,1958,1968,5,2045,2045,5,2075,2083,5,2089,2093,5,2192,2193,1,2250,2273,5,2275,2306,5,2362,2362,5,2364,2364,5,2369,2376,5,2381,2381,5,2385,2391,5,2433,2433,5,2492,2492,5,2495,2496,7,2503,2504,7,2509,2509,5,2530,2531,5,2561,2562,5,2620,2620,5,2625,2626,5,2635,2637,5,2672,2673,5,2689,2690,5,2748,2748,5,2753,2757,5,2761,2761,7,2765,2765,5,2810,2815,5,2818,2819,7,2878,2878,5,2880,2880,7,2887,2888,7,2893,2893,5,2903,2903,5,2946,2946,5,3007,3007,7,3009,3010,7,3018,3020,7,3031,3031,5,3073,3075,7,3132,3132,5,3137,3140,7,3146,3149,5,3170,3171,5,3202,3203,7,3262,3262,7,3264,3265,7,3267,3268,7,3271,3272,7,3276,3277,5,3298,3299,5,3330,3331,7,3390,3390,5,3393,3396,5,3402,3404,7,3406,3406,1,3426,3427,5,3458,3459,7,3535,3535,5,3538,3540,5,3544,3550,7,3570,3571,7,3635,3635,7,3655,3662,5,3763,3763,7,3784,3789,5,3893,3893,5,3897,3897,5,3953,3966,5,3968,3972,5,3981,3991,5,4038,4038,5,4145,4145,7,4153,4154,5,4157,4158,5,4184,4185,5,4209,4212,5,4228,4228,7,4237,4237,5,4352,4447,8,4520,4607,10,5906,5908,5,5938,5939,5,5970,5971,5,6068,6069,5,6071,6077,5,6086,6086,5,6089,6099,5,6155,6157,5,6159,6159,5,6313,6313,5,6435,6438,7,6441,6443,7,6450,6450,5,6457,6459,5,6681,6682,7,6741,6741,7,6743,6743,7,6752,6752,5,6757,6764,5,6771,6780,5,6832,6845,5,6847,6862,5,6916,6916,7,6965,6965,5,6971,6971,7,6973,6977,7,6979,6980,7,7040,7041,5,7073,7073,7,7078,7079,7,7082,7082,7,7142,7142,5,7144,7145,5,7149,7149,5,7151,7153,5,7204,7211,7,7220,7221,7,7376,7378,5,7393,7393,7,7405,7405,5,7415,7415,7,7616,7679,5,8204,8204,5,8206,8207,4,8233,8233,4,8252,8252,14,8288,8292,4,8294,8303,4,8413,8416,5,8418,8420,5,8482,8482,14,8596,8601,14,8986,8987,14,9096,9096,14,9193,9196,14,9199,9199,14,9201,9202,14,9208,9210,14,9642,9643,14,9664,9664,14,9728,9729,14,9732,9732,14,9735,9741,14,9743,9744,14,9746,9746,14,9750,9751,14,9753,9756,14,9758,9759,14,9761,9761,14,9764,9765,14,9767,9769,14,9771,9773,14,9775,9775,14,9784,9785,14,9787,9791,14,9793,9793,14,9795,9799,14,9812,9822,14,9824,9824,14,9827,9827,14,9829,9830,14,9832,9832,14,9851,9851,14,9854,9854,14,9856,9861,14,9874,9874,14,9876,9876,14,9878,9879,14,9881,9881,14,9883,9884,14,9888,9889,14,9895,9895,14,9898,9899,14,9904,9905,14,9917,9918,14,9924,9925,14,9928,9928,14,9934,9934,14,9936,9936,14,9938,9938,14,9940,9940,14,9961,9961,14,9963,9967,14,9970,9971,14,9973,9973,14,9975,9977,14,9979,9980,14,9982,9985,14,9987,9988,14,9992,9996,14,9998,9998,14,10000,10001,14,10004,10004,14,10013,10013,14,10024,10024,14,10052,10052,14,10060,10060,14,10067,10069,14,10083,10083,14,10085,10087,14,10145,10145,14,10175,10175,14,11013,11015,14,11088,11088,14,11503,11505,5,11744,11775,5,12334,12335,5,12349,12349,14,12951,12951,14,42607,42607,5,42612,42621,5,42736,42737,5,43014,43014,5,43043,43044,7,43047,43047,7,43136,43137,7,43204,43205,5,43263,43263,5,43335,43345,5,43360,43388,8,43395,43395,7,43444,43445,7,43450,43451,7,43454,43456,7,43561,43566,5,43569,43570,5,43573,43574,5,43596,43596,5,43644,43644,5,43698,43700,5,43710,43711,5,43755,43755,7,43758,43759,7,43766,43766,5,44005,44005,5,44008,44008,5,44012,44012,7,44032,44032,11,44060,44060,11,44088,44088,11,44116,44116,11,44144,44144,11,44172,44172,11,44200,44200,11,44228,44228,11,44256,44256,11,44284,44284,11,44312,44312,11,44340,44340,11,44368,44368,11,44396,44396,11,44424,44424,11,44452,44452,11,44480,44480,11,44508,44508,11,44536,44536,11,44564,44564,11,44592,44592,11,44620,44620,11,44648,44648,11,44676,44676,11,44704,44704,11,44732,44732,11,44760,44760,11,44788,44788,11,44816,44816,11,44844,44844,11,44872,44872,11,44900,44900,11,44928,44928,11,44956,44956,11,44984,44984,11,45012,45012,11,45040,45040,11,45068,45068,11,45096,45096,11,45124,45124,11,45152,45152,11,45180,45180,11,45208,45208,11,45236,45236,11,45264,45264,11,45292,45292,11,45320,45320,11,45348,45348,11,45376,45376,11,45404,45404,11,45432,45432,11,45460,45460,11,45488,45488,11,45516,45516,11,45544,45544,11,45572,45572,11,45600,45600,11,45628,45628,11,45656,45656,11,45684,45684,11,45712,45712,11,45740,45740,11,45768,45768,11,45796,45796,11,45824,45824,11,45852,45852,11,45880,45880,11,45908,45908,11,45936,45936,11,45964,45964,11,45992,45992,11,46020,46020,11,46048,46048,11,46076,46076,11,46104,46104,11,46132,46132,11,46160,46160,11,46188,46188,11,46216,46216,11,46244,46244,11,46272,46272,11,46300,46300,11,46328,46328,11,46356,46356,11,46384,46384,11,46412,46412,11,46440,46440,11,46468,46468,11,46496,46496,11,46524,46524,11,46552,46552,11,46580,46580,11,46608,46608,11,46636,46636,11,46664,46664,11,46692,46692,11,46720,46720,11,46748,46748,11,46776,46776,11,46804,46804,11,46832,46832,11,46860,46860,11,46888,46888,11,46916,46916,11,46944,46944,11,46972,46972,11,47000,47000,11,47028,47028,11,47056,47056,11,47084,47084,11,47112,47112,11,47140,47140,11,47168,47168,11,47196,47196,11,47224,47224,11,47252,47252,11,47280,47280,11,47308,47308,11,47336,47336,11,47364,47364,11,47392,47392,11,47420,47420,11,47448,47448,11,47476,47476,11,47504,47504,11,47532,47532,11,47560,47560,11,47588,47588,11,47616,47616,11,47644,47644,11,47672,47672,11,47700,47700,11,47728,47728,11,47756,47756,11,47784,47784,11,47812,47812,11,47840,47840,11,47868,47868,11,47896,47896,11,47924,47924,11,47952,47952,11,47980,47980,11,48008,48008,11,48036,48036,11,48064,48064,11,48092,48092,11,48120,48120,11,48148,48148,11,48176,48176,11,48204,48204,11,48232,48232,11,48260,48260,11,48288,48288,11,48316,48316,11,48344,48344,11,48372,48372,11,48400,48400,11,48428,48428,11,48456,48456,11,48484,48484,11,48512,48512,11,48540,48540,11,48568,48568,11,48596,48596,11,48624,48624,11,48652,48652,11,48680,48680,11,48708,48708,11,48736,48736,11,48764,48764,11,48792,48792,11,48820,48820,11,48848,48848,11,48876,48876,11,48904,48904,11,48932,48932,11,48960,48960,11,48988,48988,11,49016,49016,11,49044,49044,11,49072,49072,11,49100,49100,11,49128,49128,11,49156,49156,11,49184,49184,11,49212,49212,11,49240,49240,11,49268,49268,11,49296,49296,11,49324,49324,11,49352,49352,11,49380,49380,11,49408,49408,11,49436,49436,11,49464,49464,11,49492,49492,11,49520,49520,11,49548,49548,11,49576,49576,11,49604,49604,11,49632,49632,11,49660,49660,11,49688,49688,11,49716,49716,11,49744,49744,11,49772,49772,11,49800,49800,11,49828,49828,11,49856,49856,11,49884,49884,11,49912,49912,11,49940,49940,11,49968,49968,11,49996,49996,11,50024,50024,11,50052,50052,11,50080,50080,11,50108,50108,11,50136,50136,11,50164,50164,11,50192,50192,11,50220,50220,11,50248,50248,11,50276,50276,11,50304,50304,11,50332,50332,11,50360,50360,11,50388,50388,11,50416,50416,11,50444,50444,11,50472,50472,11,50500,50500,11,50528,50528,11,50556,50556,11,50584,50584,11,50612,50612,11,50640,50640,11,50668,50668,11,50696,50696,11,50724,50724,11,50752,50752,11,50780,50780,11,50808,50808,11,50836,50836,11,50864,50864,11,50892,50892,11,50920,50920,11,50948,50948,11,50976,50976,11,51004,51004,11,51032,51032,11,51060,51060,11,51088,51088,11,51116,51116,11,51144,51144,11,51172,51172,11,51200,51200,11,51228,51228,11,51256,51256,11,51284,51284,11,51312,51312,11,51340,51340,11,51368,51368,11,51396,51396,11,51424,51424,11,51452,51452,11,51480,51480,11,51508,51508,11,51536,51536,11,51564,51564,11,51592,51592,11,51620,51620,11,51648,51648,11,51676,51676,11,51704,51704,11,51732,51732,11,51760,51760,11,51788,51788,11,51816,51816,11,51844,51844,11,51872,51872,11,51900,51900,11,51928,51928,11,51956,51956,11,51984,51984,11,52012,52012,11,52040,52040,11,52068,52068,11,52096,52096,11,52124,52124,11,52152,52152,11,52180,52180,11,52208,52208,11,52236,52236,11,52264,52264,11,52292,52292,11,52320,52320,11,52348,52348,11,52376,52376,11,52404,52404,11,52432,52432,11,52460,52460,11,52488,52488,11,52516,52516,11,52544,52544,11,52572,52572,11,52600,52600,11,52628,52628,11,52656,52656,11,52684,52684,11,52712,52712,11,52740,52740,11,52768,52768,11,52796,52796,11,52824,52824,11,52852,52852,11,52880,52880,11,52908,52908,11,52936,52936,11,52964,52964,11,52992,52992,11,53020,53020,11,53048,53048,11,53076,53076,11,53104,53104,11,53132,53132,11,53160,53160,11,53188,53188,11,53216,53216,11,53244,53244,11,53272,53272,11,53300,53300,11,53328,53328,11,53356,53356,11,53384,53384,11,53412,53412,11,53440,53440,11,53468,53468,11,53496,53496,11,53524,53524,11,53552,53552,11,53580,53580,11,53608,53608,11,53636,53636,11,53664,53664,11,53692,53692,11,53720,53720,11,53748,53748,11,53776,53776,11,53804,53804,11,53832,53832,11,53860,53860,11,53888,53888,11,53916,53916,11,53944,53944,11,53972,53972,11,54000,54000,11,54028,54028,11,54056,54056,11,54084,54084,11,54112,54112,11,54140,54140,11,54168,54168,11,54196,54196,11,54224,54224,11,54252,54252,11,54280,54280,11,54308,54308,11,54336,54336,11,54364,54364,11,54392,54392,11,54420,54420,11,54448,54448,11,54476,54476,11,54504,54504,11,54532,54532,11,54560,54560,11,54588,54588,11,54616,54616,11,54644,54644,11,54672,54672,11,54700,54700,11,54728,54728,11,54756,54756,11,54784,54784,11,54812,54812,11,54840,54840,11,54868,54868,11,54896,54896,11,54924,54924,11,54952,54952,11,54980,54980,11,55008,55008,11,55036,55036,11,55064,55064,11,55092,55092,11,55120,55120,11,55148,55148,11,55176,55176,11,55216,55238,9,64286,64286,5,65056,65071,5,65438,65439,5,65529,65531,4,66272,66272,5,68097,68099,5,68108,68111,5,68159,68159,5,68900,68903,5,69446,69456,5,69632,69632,7,69634,69634,7,69744,69744,5,69759,69761,5,69808,69810,7,69815,69816,7,69821,69821,1,69837,69837,1,69927,69931,5,69933,69940,5,70003,70003,5,70018,70018,7,70070,70078,5,70082,70083,1,70094,70094,7,70188,70190,7,70194,70195,7,70197,70197,7,70206,70206,5,70368,70370,7,70400,70401,5,70459,70460,5,70463,70463,7,70465,70468,7,70475,70477,7,70498,70499,7,70512,70516,5,70712,70719,5,70722,70724,5,70726,70726,5,70832,70832,5,70835,70840,5,70842,70842,5,70845,70845,5,70847,70848,5,70850,70851,5,71088,71089,7,71096,71099,7,71102,71102,7,71132,71133,5,71219,71226,5,71229,71229,5,71231,71232,5,71340,71340,7,71342,71343,7,71350,71350,7,71453,71455,5,71462,71462,7,71724,71726,7,71736,71736,7,71984,71984,5,71991,71992,7,71997,71997,7,71999,71999,1,72001,72001,1,72003,72003,5,72148,72151,5,72156,72159,7,72164,72164,7,72243,72248,5,72250,72250,1,72263,72263,5,72279,72280,7,72324,72329,1,72343,72343,7,72751,72751,7,72760,72765,5,72767,72767,5,72873,72873,7,72881,72881,7,72884,72884,7,73009,73014,5,73020,73021,5,73030,73030,1,73098,73102,7,73107,73108,7,73110,73110,7,73459,73460,5,78896,78904,4,92976,92982,5,94033,94087,7,94180,94180,5,113821,113822,5,118528,118573,5,119141,119141,5,119143,119145,5,119150,119154,5,119163,119170,5,119210,119213,5,121344,121398,5,121461,121461,5,121499,121503,5,122880,122886,5,122907,122913,5,122918,122922,5,123566,123566,5,125136,125142,5,126976,126979,14,126981,127182,14,127184,127231,14,127279,127279,14,127344,127345,14,127374,127374,14,127405,127461,14,127489,127490,14,127514,127514,14,127538,127546,14,127561,127567,14,127570,127743,14,127757,127758,14,127760,127760,14,127762,127762,14,127766,127768,14,127770,127770,14,127772,127772,14,127775,127776,14,127778,127779,14,127789,127791,14,127794,127795,14,127798,127798,14,127819,127819,14,127824,127824,14,127868,127868,14,127870,127871,14,127892,127893,14,127896,127896,14,127900,127901,14,127904,127940,14,127942,127942,14,127944,127944,14,127946,127946,14,127951,127955,14,127968,127971,14,127973,127984,14,127987,127987,14,127989,127989,14,127991,127991,14,127995,127999,5,128008,128008,14,128012,128014,14,128017,128018,14,128020,128020,14,128022,128022,14,128042,128042,14,128063,128063,14,128065,128065,14,128101,128101,14,128108,128109,14,128173,128173,14,128182,128183,14,128236,128237,14,128239,128239,14,128245,128245,14,128248,128248,14,128253,128253,14,128255,128258,14,128260,128263,14,128265,128265,14,128277,128277,14,128300,128301,14,128326,128328,14,128331,128334,14,128336,128347,14,128360,128366,14,128369,128370,14,128378,128378,14,128391,128391,14,128394,128397,14,128400,128400,14,128405,128406,14,128420,128420,14,128422,128423,14,128425,128432,14,128435,128443,14,128445,128449,14,128453,128464,14,128468,128475,14,128479,128480,14,128482,128482,14,128484,128487,14,128489,128494,14,128496,128498,14,128500,128505,14,128507,128511,14,128513,128518,14,128521,128525,14,128527,128527,14,128529,128529,14,128533,128533,14,128535,128535,14,128537,128537,14]")}var _b;(function(e){e[e.zwj=8205]="zwj",e[e.emojiVariantSelector=65039]="emojiVariantSelector",e[e.enclosingKeyCap=8419]="enclosingKeyCap",e[e.space=32]="space"})(_b||(_b={}));var wU=class gu{static{this.ambiguousCharacterData=new Ci(()=>JSON.parse('{"_common":[8232,32,8233,32,5760,32,8192,32,8193,32,8194,32,8195,32,8196,32,8197,32,8198,32,8200,32,8201,32,8202,32,8287,32,8199,32,8239,32,2042,95,65101,95,65102,95,65103,95,8208,45,8209,45,8210,45,65112,45,1748,45,8259,45,727,45,8722,45,10134,45,11450,45,1549,44,1643,44,184,44,42233,44,894,59,2307,58,2691,58,1417,58,1795,58,1796,58,5868,58,65072,58,6147,58,6153,58,8282,58,1475,58,760,58,42889,58,8758,58,720,58,42237,58,451,33,11601,33,660,63,577,63,2429,63,5038,63,42731,63,119149,46,8228,46,1793,46,1794,46,42510,46,68176,46,1632,46,1776,46,42232,46,1373,96,65287,96,8219,96,1523,96,8242,96,1370,96,8175,96,65344,96,900,96,8189,96,8125,96,8127,96,8190,96,697,96,884,96,712,96,714,96,715,96,756,96,699,96,701,96,700,96,702,96,42892,96,1497,96,2036,96,2037,96,5194,96,5836,96,94033,96,94034,96,65339,91,10088,40,10098,40,12308,40,64830,40,65341,93,10089,41,10099,41,12309,41,64831,41,10100,123,119060,123,10101,125,65342,94,8270,42,1645,42,8727,42,66335,42,5941,47,8257,47,8725,47,8260,47,9585,47,10187,47,10744,47,119354,47,12755,47,12339,47,11462,47,20031,47,12035,47,65340,92,65128,92,8726,92,10189,92,10741,92,10745,92,119311,92,119355,92,12756,92,20022,92,12034,92,42872,38,708,94,710,94,5869,43,10133,43,66203,43,8249,60,10094,60,706,60,119350,60,5176,60,5810,60,5120,61,11840,61,12448,61,42239,61,8250,62,10095,62,707,62,119351,62,5171,62,94015,62,8275,126,732,126,8128,126,8764,126,65372,124,65293,45,118002,50,120784,50,120794,50,120804,50,120814,50,120824,50,130034,50,42842,50,423,50,1000,50,42564,50,5311,50,42735,50,119302,51,118003,51,120785,51,120795,51,120805,51,120815,51,120825,51,130035,51,42923,51,540,51,439,51,42858,51,11468,51,1248,51,94011,51,71882,51,118004,52,120786,52,120796,52,120806,52,120816,52,120826,52,130036,52,5070,52,71855,52,118005,53,120787,53,120797,53,120807,53,120817,53,120827,53,130037,53,444,53,71867,53,118006,54,120788,54,120798,54,120808,54,120818,54,120828,54,130038,54,11474,54,5102,54,71893,54,119314,55,118007,55,120789,55,120799,55,120809,55,120819,55,120829,55,130039,55,66770,55,71878,55,2819,56,2538,56,2666,56,125131,56,118008,56,120790,56,120800,56,120810,56,120820,56,120830,56,130040,56,547,56,546,56,66330,56,2663,57,2920,57,2541,57,3437,57,118009,57,120791,57,120801,57,120811,57,120821,57,120831,57,130041,57,42862,57,11466,57,71884,57,71852,57,71894,57,9082,97,65345,97,119834,97,119886,97,119938,97,119990,97,120042,97,120094,97,120146,97,120198,97,120250,97,120302,97,120354,97,120406,97,120458,97,593,97,945,97,120514,97,120572,97,120630,97,120688,97,120746,97,65313,65,117974,65,119808,65,119860,65,119912,65,119964,65,120016,65,120068,65,120120,65,120172,65,120224,65,120276,65,120328,65,120380,65,120432,65,913,65,120488,65,120546,65,120604,65,120662,65,120720,65,5034,65,5573,65,42222,65,94016,65,66208,65,119835,98,119887,98,119939,98,119991,98,120043,98,120095,98,120147,98,120199,98,120251,98,120303,98,120355,98,120407,98,120459,98,388,98,5071,98,5234,98,5551,98,65314,66,8492,66,117975,66,119809,66,119861,66,119913,66,120017,66,120069,66,120121,66,120173,66,120225,66,120277,66,120329,66,120381,66,120433,66,42932,66,914,66,120489,66,120547,66,120605,66,120663,66,120721,66,5108,66,5623,66,42192,66,66178,66,66209,66,66305,66,65347,99,8573,99,119836,99,119888,99,119940,99,119992,99,120044,99,120096,99,120148,99,120200,99,120252,99,120304,99,120356,99,120408,99,120460,99,7428,99,1010,99,11429,99,43951,99,66621,99,128844,67,71913,67,71922,67,65315,67,8557,67,8450,67,8493,67,117976,67,119810,67,119862,67,119914,67,119966,67,120018,67,120174,67,120226,67,120278,67,120330,67,120382,67,120434,67,1017,67,11428,67,5087,67,42202,67,66210,67,66306,67,66581,67,66844,67,8574,100,8518,100,119837,100,119889,100,119941,100,119993,100,120045,100,120097,100,120149,100,120201,100,120253,100,120305,100,120357,100,120409,100,120461,100,1281,100,5095,100,5231,100,42194,100,8558,68,8517,68,117977,68,119811,68,119863,68,119915,68,119967,68,120019,68,120071,68,120123,68,120175,68,120227,68,120279,68,120331,68,120383,68,120435,68,5024,68,5598,68,5610,68,42195,68,8494,101,65349,101,8495,101,8519,101,119838,101,119890,101,119942,101,120046,101,120098,101,120150,101,120202,101,120254,101,120306,101,120358,101,120410,101,120462,101,43826,101,1213,101,8959,69,65317,69,8496,69,117978,69,119812,69,119864,69,119916,69,120020,69,120072,69,120124,69,120176,69,120228,69,120280,69,120332,69,120384,69,120436,69,917,69,120492,69,120550,69,120608,69,120666,69,120724,69,11577,69,5036,69,42224,69,71846,69,71854,69,66182,69,119839,102,119891,102,119943,102,119995,102,120047,102,120099,102,120151,102,120203,102,120255,102,120307,102,120359,102,120411,102,120463,102,43829,102,42905,102,383,102,7837,102,1412,102,119315,70,8497,70,117979,70,119813,70,119865,70,119917,70,120021,70,120073,70,120125,70,120177,70,120229,70,120281,70,120333,70,120385,70,120437,70,42904,70,988,70,120778,70,5556,70,42205,70,71874,70,71842,70,66183,70,66213,70,66853,70,65351,103,8458,103,119840,103,119892,103,119944,103,120048,103,120100,103,120152,103,120204,103,120256,103,120308,103,120360,103,120412,103,120464,103,609,103,7555,103,397,103,1409,103,117980,71,119814,71,119866,71,119918,71,119970,71,120022,71,120074,71,120126,71,120178,71,120230,71,120282,71,120334,71,120386,71,120438,71,1292,71,5056,71,5107,71,42198,71,65352,104,8462,104,119841,104,119945,104,119997,104,120049,104,120101,104,120153,104,120205,104,120257,104,120309,104,120361,104,120413,104,120465,104,1211,104,1392,104,5058,104,65320,72,8459,72,8460,72,8461,72,117981,72,119815,72,119867,72,119919,72,120023,72,120179,72,120231,72,120283,72,120335,72,120387,72,120439,72,919,72,120494,72,120552,72,120610,72,120668,72,120726,72,11406,72,5051,72,5500,72,42215,72,66255,72,731,105,9075,105,65353,105,8560,105,8505,105,8520,105,119842,105,119894,105,119946,105,119998,105,120050,105,120102,105,120154,105,120206,105,120258,105,120310,105,120362,105,120414,105,120466,105,120484,105,618,105,617,105,953,105,8126,105,890,105,120522,105,120580,105,120638,105,120696,105,120754,105,1110,105,42567,105,1231,105,43893,105,5029,105,71875,105,65354,106,8521,106,119843,106,119895,106,119947,106,119999,106,120051,106,120103,106,120155,106,120207,106,120259,106,120311,106,120363,106,120415,106,120467,106,1011,106,1112,106,65322,74,117983,74,119817,74,119869,74,119921,74,119973,74,120025,74,120077,74,120129,74,120181,74,120233,74,120285,74,120337,74,120389,74,120441,74,42930,74,895,74,1032,74,5035,74,5261,74,42201,74,119844,107,119896,107,119948,107,120000,107,120052,107,120104,107,120156,107,120208,107,120260,107,120312,107,120364,107,120416,107,120468,107,8490,75,65323,75,117984,75,119818,75,119870,75,119922,75,119974,75,120026,75,120078,75,120130,75,120182,75,120234,75,120286,75,120338,75,120390,75,120442,75,922,75,120497,75,120555,75,120613,75,120671,75,120729,75,11412,75,5094,75,5845,75,42199,75,66840,75,1472,108,8739,73,9213,73,65512,73,1633,108,1777,73,66336,108,125127,108,118001,108,120783,73,120793,73,120803,73,120813,73,120823,73,130033,73,65321,73,8544,73,8464,73,8465,73,117982,108,119816,73,119868,73,119920,73,120024,73,120128,73,120180,73,120232,73,120284,73,120336,73,120388,73,120440,73,65356,108,8572,73,8467,108,119845,108,119897,108,119949,108,120001,108,120053,108,120105,73,120157,73,120209,73,120261,73,120313,73,120365,73,120417,73,120469,73,448,73,120496,73,120554,73,120612,73,120670,73,120728,73,11410,73,1030,73,1216,73,1493,108,1503,108,1575,108,126464,108,126592,108,65166,108,65165,108,1994,108,11599,73,5825,73,42226,73,93992,73,66186,124,66313,124,119338,76,8556,76,8466,76,117985,76,119819,76,119871,76,119923,76,120027,76,120079,76,120131,76,120183,76,120235,76,120287,76,120339,76,120391,76,120443,76,11472,76,5086,76,5290,76,42209,76,93974,76,71843,76,71858,76,66587,76,66854,76,65325,77,8559,77,8499,77,117986,77,119820,77,119872,77,119924,77,120028,77,120080,77,120132,77,120184,77,120236,77,120288,77,120340,77,120392,77,120444,77,924,77,120499,77,120557,77,120615,77,120673,77,120731,77,1018,77,11416,77,5047,77,5616,77,5846,77,42207,77,66224,77,66321,77,119847,110,119899,110,119951,110,120003,110,120055,110,120107,110,120159,110,120211,110,120263,110,120315,110,120367,110,120419,110,120471,110,1400,110,1404,110,65326,78,8469,78,117987,78,119821,78,119873,78,119925,78,119977,78,120029,78,120081,78,120185,78,120237,78,120289,78,120341,78,120393,78,120445,78,925,78,120500,78,120558,78,120616,78,120674,78,120732,78,11418,78,42208,78,66835,78,3074,111,3202,111,3330,111,3458,111,2406,111,2662,111,2790,111,3046,111,3174,111,3302,111,3430,111,3664,111,3792,111,4160,111,1637,111,1781,111,65359,111,8500,111,119848,111,119900,111,119952,111,120056,111,120108,111,120160,111,120212,111,120264,111,120316,111,120368,111,120420,111,120472,111,7439,111,7441,111,43837,111,959,111,120528,111,120586,111,120644,111,120702,111,120760,111,963,111,120532,111,120590,111,120648,111,120706,111,120764,111,11423,111,4351,111,1413,111,1505,111,1607,111,126500,111,126564,111,126596,111,65259,111,65260,111,65258,111,65257,111,1726,111,64428,111,64429,111,64427,111,64426,111,1729,111,64424,111,64425,111,64423,111,64422,111,1749,111,3360,111,4125,111,66794,111,71880,111,71895,111,66604,111,1984,79,2534,79,2918,79,12295,79,70864,79,71904,79,118000,79,120782,79,120792,79,120802,79,120812,79,120822,79,130032,79,65327,79,117988,79,119822,79,119874,79,119926,79,119978,79,120030,79,120082,79,120134,79,120186,79,120238,79,120290,79,120342,79,120394,79,120446,79,927,79,120502,79,120560,79,120618,79,120676,79,120734,79,11422,79,1365,79,11604,79,4816,79,2848,79,66754,79,42227,79,71861,79,66194,79,66219,79,66564,79,66838,79,9076,112,65360,112,119849,112,119901,112,119953,112,120005,112,120057,112,120109,112,120161,112,120213,112,120265,112,120317,112,120369,112,120421,112,120473,112,961,112,120530,112,120544,112,120588,112,120602,112,120646,112,120660,112,120704,112,120718,112,120762,112,120776,112,11427,112,65328,80,8473,80,117989,80,119823,80,119875,80,119927,80,119979,80,120031,80,120083,80,120187,80,120239,80,120291,80,120343,80,120395,80,120447,80,929,80,120504,80,120562,80,120620,80,120678,80,120736,80,11426,80,5090,80,5229,80,42193,80,66197,80,119850,113,119902,113,119954,113,120006,113,120058,113,120110,113,120162,113,120214,113,120266,113,120318,113,120370,113,120422,113,120474,113,1307,113,1379,113,1382,113,8474,81,117990,81,119824,81,119876,81,119928,81,119980,81,120032,81,120084,81,120188,81,120240,81,120292,81,120344,81,120396,81,120448,81,11605,81,119851,114,119903,114,119955,114,120007,114,120059,114,120111,114,120163,114,120215,114,120267,114,120319,114,120371,114,120423,114,120475,114,43847,114,43848,114,7462,114,11397,114,43905,114,119318,82,8475,82,8476,82,8477,82,117991,82,119825,82,119877,82,119929,82,120033,82,120189,82,120241,82,120293,82,120345,82,120397,82,120449,82,422,82,5025,82,5074,82,66740,82,5511,82,42211,82,94005,82,65363,115,119852,115,119904,115,119956,115,120008,115,120060,115,120112,115,120164,115,120216,115,120268,115,120320,115,120372,115,120424,115,120476,115,42801,115,445,115,1109,115,43946,115,71873,115,66632,115,65331,83,117992,83,119826,83,119878,83,119930,83,119982,83,120034,83,120086,83,120138,83,120190,83,120242,83,120294,83,120346,83,120398,83,120450,83,1029,83,1359,83,5077,83,5082,83,42210,83,94010,83,66198,83,66592,83,119853,116,119905,116,119957,116,120009,116,120061,116,120113,116,120165,116,120217,116,120269,116,120321,116,120373,116,120425,116,120477,116,8868,84,10201,84,128872,84,65332,84,117993,84,119827,84,119879,84,119931,84,119983,84,120035,84,120087,84,120139,84,120191,84,120243,84,120295,84,120347,84,120399,84,120451,84,932,84,120507,84,120565,84,120623,84,120681,84,120739,84,11430,84,5026,84,42196,84,93962,84,71868,84,66199,84,66225,84,66325,84,119854,117,119906,117,119958,117,120010,117,120062,117,120114,117,120166,117,120218,117,120270,117,120322,117,120374,117,120426,117,120478,117,42911,117,7452,117,43854,117,43858,117,651,117,965,117,120534,117,120592,117,120650,117,120708,117,120766,117,1405,117,66806,117,71896,117,8746,85,8899,85,117994,85,119828,85,119880,85,119932,85,119984,85,120036,85,120088,85,120140,85,120192,85,120244,85,120296,85,120348,85,120400,85,120452,85,1357,85,4608,85,66766,85,5196,85,42228,85,94018,85,71864,85,8744,118,8897,118,65366,118,8564,118,119855,118,119907,118,119959,118,120011,118,120063,118,120115,118,120167,118,120219,118,120271,118,120323,118,120375,118,120427,118,120479,118,7456,118,957,118,120526,118,120584,118,120642,118,120700,118,120758,118,1141,118,1496,118,71430,118,43945,118,71872,118,119309,86,1639,86,1783,86,8548,86,117995,86,119829,86,119881,86,119933,86,119985,86,120037,86,120089,86,120141,86,120193,86,120245,86,120297,86,120349,86,120401,86,120453,86,1140,86,11576,86,5081,86,5167,86,42719,86,42214,86,93960,86,71840,86,66845,86,623,119,119856,119,119908,119,119960,119,120012,119,120064,119,120116,119,120168,119,120220,119,120272,119,120324,119,120376,119,120428,119,120480,119,7457,119,1121,119,1309,119,1377,119,71434,119,71438,119,71439,119,43907,119,71910,87,71919,87,117996,87,119830,87,119882,87,119934,87,119986,87,120038,87,120090,87,120142,87,120194,87,120246,87,120298,87,120350,87,120402,87,120454,87,1308,87,5043,87,5076,87,42218,87,5742,120,10539,120,10540,120,10799,120,65368,120,8569,120,119857,120,119909,120,119961,120,120013,120,120065,120,120117,120,120169,120,120221,120,120273,120,120325,120,120377,120,120429,120,120481,120,5441,120,5501,120,5741,88,9587,88,66338,88,71916,88,65336,88,8553,88,117997,88,119831,88,119883,88,119935,88,119987,88,120039,88,120091,88,120143,88,120195,88,120247,88,120299,88,120351,88,120403,88,120455,88,42931,88,935,88,120510,88,120568,88,120626,88,120684,88,120742,88,11436,88,11613,88,5815,88,42219,88,66192,88,66228,88,66327,88,66855,88,611,121,7564,121,65369,121,119858,121,119910,121,119962,121,120014,121,120066,121,120118,121,120170,121,120222,121,120274,121,120326,121,120378,121,120430,121,120482,121,655,121,7935,121,43866,121,947,121,8509,121,120516,121,120574,121,120632,121,120690,121,120748,121,1199,121,4327,121,71900,121,65337,89,117998,89,119832,89,119884,89,119936,89,119988,89,120040,89,120092,89,120144,89,120196,89,120248,89,120300,89,120352,89,120404,89,120456,89,933,89,978,89,120508,89,120566,89,120624,89,120682,89,120740,89,11432,89,1198,89,5033,89,5053,89,42220,89,94019,89,71844,89,66226,89,119859,122,119911,122,119963,122,120015,122,120067,122,120119,122,120171,122,120223,122,120275,122,120327,122,120379,122,120431,122,120483,122,7458,122,43923,122,71876,122,71909,90,66293,90,65338,90,8484,90,8488,90,117999,90,119833,90,119885,90,119937,90,119989,90,120041,90,120197,90,120249,90,120301,90,120353,90,120405,90,120457,90,918,90,120493,90,120551,90,120609,90,120667,90,120725,90,5059,90,42204,90,71849,90,65282,34,65283,35,65284,36,65285,37,65286,38,65290,42,65291,43,65294,46,65295,47,65296,48,65298,50,65299,51,65300,52,65301,53,65302,54,65303,55,65304,56,65305,57,65308,60,65309,61,65310,62,65312,64,65316,68,65318,70,65319,71,65324,76,65329,81,65330,82,65333,85,65334,86,65335,87,65343,95,65346,98,65348,100,65350,102,65355,107,65357,109,65358,110,65361,113,65362,114,65364,116,65365,117,65367,119,65370,122,65371,123,65373,125,119846,109],"_default":[160,32,8211,45,65374,126,8218,44,65306,58,65281,33,8216,96,8217,96,8245,96,180,96,12494,47,1047,51,1073,54,1072,97,1040,65,1068,98,1042,66,1089,99,1057,67,1077,101,1045,69,1053,72,305,105,1050,75,921,73,1052,77,1086,111,1054,79,1009,112,1088,112,1056,80,1075,114,1058,84,215,120,1093,120,1061,88,1091,121,1059,89,65288,40,65289,41,65292,44,65297,49,65307,59,65311,63],"cs":[65374,126,8218,44,65306,58,65281,33,8216,96,8245,96,180,96,12494,47,1047,51,1073,54,1072,97,1040,65,1068,98,1042,66,1089,99,1057,67,1077,101,1045,69,1053,72,305,105,1050,75,921,73,1052,77,1086,111,1054,79,1009,112,1088,112,1056,80,1075,114,1058,84,1093,120,1061,88,1091,121,1059,89,65288,40,65289,41,65292,44,65297,49,65307,59,65311,63],"de":[65374,126,65306,58,65281,33,8245,96,180,96,12494,47,1047,51,1073,54,1072,97,1040,65,1068,98,1042,66,1089,99,1057,67,1077,101,1045,69,1053,72,305,105,1050,75,921,73,1052,77,1086,111,1054,79,1009,112,1088,112,1056,80,1075,114,1058,84,1093,120,1061,88,1091,121,1059,89,65288,40,65289,41,65292,44,65297,49,65307,59,65311,63],"es":[8211,45,65374,126,8218,44,65306,58,65281,33,8245,96,180,96,12494,47,1047,51,1073,54,1072,97,1040,65,1068,98,1042,66,1089,99,1057,67,1077,101,1045,69,1053,72,305,105,1050,75,1052,77,1086,111,1054,79,1009,112,1088,112,1056,80,1075,114,1058,84,215,120,1093,120,1061,88,1091,121,1059,89,65288,40,65289,41,65292,44,65297,49,65307,59,65311,63],"fr":[65374,126,8218,44,65306,58,65281,33,8216,96,8245,96,12494,47,1047,51,1073,54,1072,97,1040,65,1068,98,1042,66,1089,99,1057,67,1077,101,1045,69,1053,72,305,105,1050,75,921,73,1052,77,1086,111,1054,79,1009,112,1088,112,1056,80,1075,114,1058,84,215,120,1093,120,1061,88,1091,121,1059,89,65288,40,65289,41,65292,44,65297,49,65307,59,65311,63],"it":[160,32,8211,45,65374,126,8218,44,65306,58,65281,33,8245,96,180,96,12494,47,1047,51,1073,54,1072,97,1040,65,1068,98,1042,66,1089,99,1057,67,1077,101,1045,69,1053,72,305,105,1050,75,921,73,1052,77,1086,111,1054,79,1009,112,1088,112,1056,80,1075,114,1058,84,215,120,1093,120,1061,88,1091,121,1059,89,65288,40,65289,41,65292,44,65297,49,65307,59,65311,63],"ja":[8211,45,8218,44,65281,33,8216,96,8245,96,180,96,1047,51,1073,54,1072,97,1040,65,1068,98,1042,66,1089,99,1057,67,1077,101,1045,69,1053,72,305,105,1050,75,921,73,1052,77,1086,111,1054,79,1009,112,1088,112,1056,80,1075,114,1058,84,215,120,1093,120,1061,88,1091,121,1059,89,65292,44,65297,49,65307,59],"ko":[8211,45,65374,126,8218,44,65306,58,65281,33,8245,96,180,96,12494,47,1047,51,1073,54,1072,97,1040,65,1068,98,1042,66,1089,99,1057,67,1077,101,1045,69,1053,72,305,105,1050,75,921,73,1052,77,1086,111,1054,79,1009,112,1088,112,1056,80,1075,114,1058,84,215,120,1093,120,1061,88,1091,121,1059,89,65288,40,65289,41,65292,44,65297,49,65307,59,65311,63],"pl":[65374,126,65306,58,65281,33,8216,96,8245,96,180,96,12494,47,1047,51,1073,54,1072,97,1040,65,1068,98,1042,66,1089,99,1057,67,1077,101,1045,69,1053,72,305,105,1050,75,921,73,1052,77,1086,111,1054,79,1009,112,1088,112,1056,80,1075,114,1058,84,215,120,1093,120,1061,88,1091,121,1059,89,65288,40,65289,41,65292,44,65297,49,65307,59,65311,63],"pt-BR":[65374,126,8218,44,65306,58,65281,33,8216,96,8245,96,180,96,12494,47,1047,51,1073,54,1072,97,1040,65,1068,98,1042,66,1089,99,1057,67,1077,101,1045,69,1053,72,305,105,1050,75,921,73,1052,77,1086,111,1054,79,1009,112,1088,112,1056,80,1075,114,1058,84,215,120,1093,120,1061,88,1091,121,1059,89,65288,40,65289,41,65292,44,65297,49,65307,59,65311,63],"qps-ploc":[160,32,8211,45,65374,126,8218,44,65306,58,65281,33,8216,96,8245,96,180,96,12494,47,1047,51,1073,54,1072,97,1040,65,1068,98,1042,66,1089,99,1057,67,1077,101,1045,69,1053,72,305,105,1050,75,921,73,1052,77,1086,111,1054,79,1088,112,1056,80,1075,114,1058,84,215,120,1093,120,1061,88,1091,121,1059,89,65288,40,65289,41,65292,44,65297,49,65307,59,65311,63],"ru":[65374,126,8218,44,65306,58,65281,33,8216,96,8245,96,180,96,12494,47,305,105,921,73,1009,112,215,120,65288,40,65289,41,65292,44,65297,49,65307,59,65311,63],"tr":[160,32,8211,45,65374,126,8218,44,65306,58,65281,33,8245,96,180,96,12494,47,1047,51,1073,54,1072,97,1040,65,1068,98,1042,66,1089,99,1057,67,1077,101,1045,69,1053,72,1050,75,921,73,1052,77,1086,111,1054,79,1009,112,1088,112,1056,80,1075,114,1058,84,215,120,1093,120,1061,88,1091,121,1059,89,65288,40,65289,41,65292,44,65297,49,65307,59,65311,63],"zh-hans":[160,32,65374,126,8218,44,8245,96,180,96,12494,47,1047,51,1073,54,1072,97,1040,65,1068,98,1042,66,1089,99,1057,67,1077,101,1045,69,1053,72,305,105,1050,75,921,73,1052,77,1086,111,1054,79,1009,112,1088,112,1056,80,1075,114,1058,84,215,120,1093,120,1061,88,1091,121,1059,89,65297,49],"zh-hant":[8211,45,65374,126,8218,44,180,96,12494,47,1047,51,1073,54,1072,97,1040,65,1068,98,1042,66,1089,99,1057,67,1077,101,1045,69,1053,72,305,105,1050,75,921,73,1052,77,1086,111,1054,79,1009,112,1088,112,1056,80,1075,114,1058,84,215,120,1093,120,1061,88,1091,121,1059,89]}'))}static{this.cache=new NP({getCacheKey:JSON.stringify},t=>{function i(u){const d=new Map;for(let f=0;f<u.length;f+=2)d.set(u[f],u[f+1]);return d}function r(u,d){const f=new Map(u);for(const[p,m]of d)f.set(p,m);return f}function n(u,d){if(!u)return d;const f=new Map;for(const[p,m]of u)d.has(p)&&f.set(p,m);return f}const s=this.ambiguousCharacterData.value;let o=t.filter(u=>!u.startsWith("_")&&u in s);o.length===0&&(o=["_default"]);let a;for(const u of o){const d=i(s[u]);a=n(a,d)}const l=i(s._common),c=r(l,a);return new gu(c)})}static getInstance(t){return gu.cache.get(Array.from(t))}static{this._locales=new Ci(()=>Object.keys(gu.ambiguousCharacterData.value).filter(t=>!t.startsWith("_")))}static getLocales(){return gu._locales.value}constructor(t){this.confusableDictionary=t}isAmbiguous(t){return this.confusableDictionary.has(t)}containsAmbiguousCharacter(t){for(let i=0;i<t.length;i++){const r=t.codePointAt(i);if(typeof r=="number"&&this.isAmbiguous(r))return!0}return!1}getPrimaryConfusable(t){return this.confusableDictionary.get(t)}getConfusableCodePoints(){return new Set(this.confusableDictionary.keys())}},yU=class mu{static getRawData(){return JSON.parse('{"_common":[11,12,13,127,847,1564,4447,4448,6068,6069,6155,6156,6157,6158,7355,7356,8192,8193,8194,8195,8196,8197,8198,8199,8200,8201,8202,8204,8205,8206,8207,8234,8235,8236,8237,8238,8239,8287,8288,8289,8290,8291,8292,8293,8294,8295,8296,8297,8298,8299,8300,8301,8302,8303,10240,12644,65024,65025,65026,65027,65028,65029,65030,65031,65032,65033,65034,65035,65036,65037,65038,65039,65279,65440,65520,65521,65522,65523,65524,65525,65526,65527,65528,65532,78844,119155,119156,119157,119158,119159,119160,119161,119162,917504,917505,917506,917507,917508,917509,917510,917511,917512,917513,917514,917515,917516,917517,917518,917519,917520,917521,917522,917523,917524,917525,917526,917527,917528,917529,917530,917531,917532,917533,917534,917535,917536,917537,917538,917539,917540,917541,917542,917543,917544,917545,917546,917547,917548,917549,917550,917551,917552,917553,917554,917555,917556,917557,917558,917559,917560,917561,917562,917563,917564,917565,917566,917567,917568,917569,917570,917571,917572,917573,917574,917575,917576,917577,917578,917579,917580,917581,917582,917583,917584,917585,917586,917587,917588,917589,917590,917591,917592,917593,917594,917595,917596,917597,917598,917599,917600,917601,917602,917603,917604,917605,917606,917607,917608,917609,917610,917611,917612,917613,917614,917615,917616,917617,917618,917619,917620,917621,917622,917623,917624,917625,917626,917627,917628,917629,917630,917631,917760,917761,917762,917763,917764,917765,917766,917767,917768,917769,917770,917771,917772,917773,917774,917775,917776,917777,917778,917779,917780,917781,917782,917783,917784,917785,917786,917787,917788,917789,917790,917791,917792,917793,917794,917795,917796,917797,917798,917799,917800,917801,917802,917803,917804,917805,917806,917807,917808,917809,917810,917811,917812,917813,917814,917815,917816,917817,917818,917819,917820,917821,917822,917823,917824,917825,917826,917827,917828,917829,917830,917831,917832,917833,917834,917835,917836,917837,917838,917839,917840,917841,917842,917843,917844,917845,917846,917847,917848,917849,917850,917851,917852,917853,917854,917855,917856,917857,917858,917859,917860,917861,917862,917863,917864,917865,917866,917867,917868,917869,917870,917871,917872,917873,917874,917875,917876,917877,917878,917879,917880,917881,917882,917883,917884,917885,917886,917887,917888,917889,917890,917891,917892,917893,917894,917895,917896,917897,917898,917899,917900,917901,917902,917903,917904,917905,917906,917907,917908,917909,917910,917911,917912,917913,917914,917915,917916,917917,917918,917919,917920,917921,917922,917923,917924,917925,917926,917927,917928,917929,917930,917931,917932,917933,917934,917935,917936,917937,917938,917939,917940,917941,917942,917943,917944,917945,917946,917947,917948,917949,917950,917951,917952,917953,917954,917955,917956,917957,917958,917959,917960,917961,917962,917963,917964,917965,917966,917967,917968,917969,917970,917971,917972,917973,917974,917975,917976,917977,917978,917979,917980,917981,917982,917983,917984,917985,917986,917987,917988,917989,917990,917991,917992,917993,917994,917995,917996,917997,917998,917999],"cs":[173,8203,12288],"de":[173,8203,12288],"es":[8203,12288],"fr":[173,8203,12288],"it":[160,173,12288],"ja":[173],"ko":[173,12288],"pl":[173,8203,12288],"pt-BR":[173,8203,12288],"qps-ploc":[160,173,8203,12288],"ru":[173,12288],"tr":[160,173,8203,12288],"zh-hans":[160,173,8203,12288],"zh-hant":[173,12288]}')}static{this._data=void 0}static getData(){return this._data||(this._data=new Set([...Object.values(mu.getRawData())].flat())),this._data}static isInvisibleCharacter(t){return mu.getData().has(t)}static containsInvisibleCharacter(t){for(let i=0;i<t.length;i++){const r=t.codePointAt(i);if(typeof r=="number"&&(mu.isInvisibleCharacter(r)||r===32))return!0}return!1}static get codePoints(){return mu.getData()}};function Tn(e){return e===47||e===92}function wb(e){return e.replace(/[\\/]/g,Ne.sep)}function tT(e){return e.indexOf("/")===-1&&(e=wb(e)),/^[a-zA-Z]:(\/|$)/.test(e)&&(e="/"+e),e}function yb(e,t=Ne.sep){if(!e)return"";const i=e.length,r=e.charCodeAt(0);if(Tn(r)){if(Tn(e.charCodeAt(1))&&!Tn(e.charCodeAt(2))){let s=3;const o=s;for(;s<i&&!Tn(e.charCodeAt(s));s++);if(o!==s&&!Tn(e.charCodeAt(s+1))){for(s+=1;s<i;s++)if(Tn(e.charCodeAt(s)))return e.slice(0,s+1).replace(/[\\/]/g,t)}}return t}else if(bb(r)&&e.charCodeAt(1)===58)return Tn(e.charCodeAt(2))?e.slice(0,2)+t:e.slice(0,2);let n=e.indexOf("://");if(n!==-1){for(n+=3;n<i;n++)if(Tn(e.charCodeAt(n)))return e.slice(0,n+1)}return""}var iT=/[\\/:\*\?"<>\|]/g,rT=/[/]/g,nT=/^(con|prn|aux|clock\$|nul|lpt[0-9]|com[0-9])(\.(.*?))?$/i;function sT(e,t=oi){const i=t?iT:rT;return!(!e||e.length===0||/^\s+$/.test(e)||(i.lastIndex=0,i.test(e))||t&&nT.test(e)||e==="."||e===".."||t&&e[e.length-1]==="."||t&&e.length!==e.trim().length||e.length>255)}function Xu(e,t,i,r=tr){if(e===t)return!0;if(!e||!t||t.length>e.length)return!1;if(i){if(!Pg(e,t))return!1;if(t.length===e.length)return!0;let s=t.length;return t.charAt(t.length-1)===r&&s--,e.charAt(s)===r}return t.charAt(t.length-1)!==r&&(t+=r),e.indexOf(t)===0}function bb(e){return e>=65&&e<=90||e>=97&&e<=122}function oT(e,t=oi){return t?bb(e.charCodeAt(0))&&e.charCodeAt(1)===58:!1}var V;(function(e){e.inMemory="inmemory",e.vscode="vscode",e.internal="private",e.walkThrough="walkThrough",e.walkThroughSnippet="walkThroughSnippet",e.http="http",e.https="https",e.file="file",e.mailto="mailto",e.untitled="untitled",e.data="data",e.command="command",e.vscodeRemote="vscode-remote",e.vscodeRemoteResource="vscode-remote-resource",e.vscodeManagedRemoteResource="vscode-managed-remote-resource",e.vscodeUserData="vscode-userdata",e.vscodeCustomEditor="vscode-custom-editor",e.vscodeNotebookCell="vscode-notebook-cell",e.vscodeNotebookCellMetadata="vscode-notebook-cell-metadata",e.vscodeNotebookCellMetadataDiff="vscode-notebook-cell-metadata-diff",e.vscodeNotebookCellOutput="vscode-notebook-cell-output",e.vscodeNotebookCellOutputDiff="vscode-notebook-cell-output-diff",e.vscodeNotebookMetadata="vscode-notebook-metadata",e.vscodeInteractiveInput="vscode-interactive-input",e.vscodeSettings="vscode-settings",e.vscodeWorkspaceTrust="vscode-workspace-trust",e.vscodeTerminal="vscode-terminal",e.vscodeChatCodeBlock="vscode-chat-code-block",e.vscodeChatCodeCompareBlock="vscode-chat-code-compare-block",e.vscodeChatSesssion="vscode-chat-editor",e.webviewPanel="webview-panel",e.vscodeWebview="vscode-webview",e.extension="extension",e.vscodeFileResource="vscode-file",e.tmp="tmp",e.vsls="vsls",e.vscodeSourceControl="vscode-scm",e.commentsInput="comment",e.codeSetting="code-setting",e.outputChannel="output",e.accessibleView="accessible-view"})(V||(V={}));function Rg(e,t){return y.isUri(e)?Pn(e.scheme,t):Pg(e,t+":")}function aT(e,...t){return t.some(i=>Rg(e,i))}var lT="tkn",cT=class{constructor(){this._hosts=Object.create(null),this._ports=Object.create(null),this._connectionTokens=Object.create(null),this._preferredWebSchema="http",this._delegate=null,this._serverRootPath="/"}setPreferredWebSchema(e){this._preferredWebSchema=e}setDelegate(e){this._delegate=e}setServerRootPath(e,t){this._serverRootPath=Ne.join(t??"/",dT(e))}getServerRootPath(){return this._serverRootPath}get _remoteResourcesPath(){return Ne.join(this._serverRootPath,V.vscodeRemoteResource)}set(e,t,i){this._hosts[e]=t,this._ports[e]=i}setConnectionToken(e,t){this._connectionTokens[e]=t}getPreferredWebSchema(){return this._preferredWebSchema}rewrite(e){if(this._delegate)try{return this._delegate(e)}catch(o){return Qt(o),e}const t=e.authority;let i=this._hosts[t];i&&i.indexOf(":")!==-1&&i.indexOf("[")===-1&&(i=`[${i}]`);const r=this._ports[t],n=this._connectionTokens[t];let s=`path=${encodeURIComponent(e.path)}`;return typeof n=="string"&&(s+=`&${lT}=${encodeURIComponent(n)}`),y.from({scheme:Co?this._preferredWebSchema:V.vscodeRemoteResource,authority:`${i}:${r}`,path:this._remoteResourcesPath,query:s})}},uT=new cT;function dT(e){return`${e.quality??"oss"}-${e.commit??"dev"}`}var hT="vs/../../node_modules",fT="vs/../../node_modules.asar",xb="vscode-app",pT=class Mp{static{this.FALLBACK_AUTHORITY=xb}asBrowserUri(t){const i=this.toUri(t);return this.uriToBrowserUri(i)}uriToBrowserUri(t){return t.scheme===V.vscodeRemote?uT.rewrite(t):t.scheme===V.file&&(Ry||cP===`${V.vscodeFileResource}://${Mp.FALLBACK_AUTHORITY}`)?t.with({scheme:V.vscodeFileResource,authority:t.authority||Mp.FALLBACK_AUTHORITY,query:null,fragment:null}):t}asFileUri(t){const i=this.toUri(t);return this.uriToFileUri(i)}uriToFileUri(t){return t.scheme===V.vscodeFileResource?t.with({scheme:V.file,authority:t.authority!==Mp.FALLBACK_AUTHORITY?t.authority:null,query:null,fragment:null}):t}toUri(t){if(y.isUri(t))return t;if(globalThis._VSCODE_FILE_ROOT){const i=globalThis._VSCODE_FILE_ROOT;if(/^\w[\w\d+.-]*:\/\//.test(i))return y.joinPath(y.parse(i,!0),t);const r=bg(i,t);return y.file(r)}throw new Error("Cannot determine URI for module id!")}},Sb=new pT,bU=Object.freeze({"Cache-Control":"no-cache, no-store"}),xU=Object.freeze({"Document-Policy":"include-js-call-stacks-in-crash-reports"}),Eb;(function(e){const t=new Map([["1",{"Cross-Origin-Opener-Policy":"same-origin"}],["2",{"Cross-Origin-Embedder-Policy":"require-corp"}],["3",{"Cross-Origin-Opener-Policy":"same-origin","Cross-Origin-Embedder-Policy":"require-corp"}]]);e.CoopAndCoep=Object.freeze(t.get("3"));const i="vscode-coi";function r(s){let o;typeof s=="string"?o=new URL(s).searchParams:s instanceof URL?o=s.searchParams:y.isUri(s)&&(o=new URL(s.toString(!0)).searchParams);const a=o?.get(i);if(a)return t.get(a)}e.getHeadersFromQuery=r;function n(s,o,a){if(!globalThis.crossOriginIsolated)return;const l=o&&a?"3":a?"2":"1";s instanceof URLSearchParams?s.set(i,l):s[i]=l}e.addSearchParam=n})(Eb||(Eb={}));function rr(e){return Vu(e,!0)}var hl=class{constructor(e){this._ignorePathCasing=e}compare(e,t,i=!1){return e===t?0:gs(this.getComparisonKey(e,i),this.getComparisonKey(t,i))}isEqual(e,t,i=!1){return e===t?!0:!e||!t?!1:this.getComparisonKey(e,i)===this.getComparisonKey(t,i)}getComparisonKey(e,t=!1){return e.with({path:this._ignorePathCasing(e)?e.path.toLowerCase():void 0,fragment:t?null:void 0}).toString()}ignorePathCasing(e){return this._ignorePathCasing(e)}isEqualOrParent(e,t,i=!1){if(e.scheme===t.scheme){if(e.scheme===V.file)return Xu(rr(e),rr(t),this._ignorePathCasing(e))&&e.query===t.query&&(i||e.fragment===t.fragment);if(Db(e.authority,t.authority))return Xu(e.path,t.path,this._ignorePathCasing(e),"/")&&e.query===t.query&&(i||e.fragment===t.fragment)}return!1}joinPath(e,...t){return y.joinPath(e,...t)}basenameOrAuthority(e){return nr(e)||e.authority}basename(e){return Ne.basename(e.path)}extname(e){return Ne.extname(e.path)}dirname(e){if(e.path.length===0)return e;let t;return e.scheme===V.file?t=y.file(Po(rr(e))).path:(t=Ne.dirname(e.path),e.authority&&t.length&&t.charCodeAt(0)!==47&&(console.error(`dirname("${e.toString})) resulted in a relative path`),t="/")),e.with({path:t})}normalizePath(e){if(!e.path.length)return e;let t;return e.scheme===V.file?t=y.file(ko(rr(e))).path:t=Ne.normalize(e.path),e.with({path:t})}relativePath(e,t){if(e.scheme!==t.scheme||!Db(e.authority,t.authority))return;if(e.scheme===V.file){const n=ul(rr(e),rr(t));return oi?wb(n):n}let i=e.path||"/";const r=t.path||"/";if(this._ignorePathCasing(e)){let n=0;for(const s=Math.min(i.length,r.length);n<s&&!(i.charCodeAt(n)!==r.charCodeAt(n)&&i.charAt(n).toLowerCase()!==r.charAt(n).toLowerCase());n++);i=r.substr(0,n)+i.substr(n)}return Ne.relative(i,r)}resolvePath(e,t){if(e.scheme===V.file){const i=y.file(EP(rr(e),t));return e.with({authority:i.authority,path:i.path})}return t=tT(t),e.with({path:Ne.resolve(e.path,t)})}isAbsolutePath(e){return!!e.path&&e.path[0]==="/"}isEqualAuthority(e,t){return e===t||e!==void 0&&t!==void 0&&Pn(e,t)}hasTrailingPathSeparator(e,t=tr){if(e.scheme===V.file){const i=rr(e);return i.length>yb(i).length&&i[i.length-1]===t}else{const i=e.path;return i.length>1&&i.charCodeAt(i.length-1)===47&&!/^[a-zA-Z]:(\/$|\\$)/.test(e.fsPath)}}removeTrailingPathSeparator(e,t=tr){return Ib(e,t)?e.with({path:e.path.substr(0,e.path.length-1)}):e}addTrailingPathSeparator(e,t=tr){let i=!1;if(e.scheme===V.file){const r=rr(e);i=r!==void 0&&r.length===yb(r).length&&r[r.length-1]===t}else{t="/";const r=e.path;i=r.length===1&&r.charCodeAt(r.length-1)===47}return!i&&!Ib(e,t)?e.with({path:e.path+"/"}):e}},He=new hl(()=>!1),gT=new hl(e=>e.scheme===V.file?!Gr:!0),mT=new hl(e=>!0),ms=He.isEqual.bind(He),SU=He.isEqualOrParent.bind(He),EU=He.getComparisonKey.bind(He),Lg=He.basenameOrAuthority.bind(He),nr=He.basename.bind(He),vT=He.extname.bind(He),Zu=He.dirname.bind(He),Zt=He.joinPath.bind(He),CU=He.normalizePath.bind(He),Cb=He.relativePath.bind(He),DU=He.resolvePath.bind(He),_T=He.isAbsolutePath.bind(He),Db=He.isEqualAuthority.bind(He),Ib=He.hasTrailingPathSeparator.bind(He),IU=He.removeTrailingPathSeparator.bind(He),kU=He.addTrailingPathSeparator.bind(He),kb;(function(e){e.META_DATA_LABEL="label",e.META_DATA_DESCRIPTION="description",e.META_DATA_SIZE="size",e.META_DATA_MIME="mime";function t(i){const r=new Map;i.path.substring(i.path.indexOf(";")+1,i.path.lastIndexOf(";")).split(";").forEach(o=>{const[a,l]=o.split(":");a&&l&&r.set(a,l)});const s=i.path.substring(0,i.path.indexOf(";"));return s&&r.set(e.META_DATA_MIME,s),r}e.parseMetaData=t})(kb||(kb={}));var wT=Symbol("MicrotaskDelay");function An(e){return!!e&&typeof e.then=="function"}function yT(e){const t=new ft,i=e(t.token);let r=!1;const n=new Promise((s,o)=>{const a=t.token.onCancellationRequested(()=>{r=!0,a.dispose(),o(new xr)});Promise.resolve(i).then(l=>{a.dispose(),t.dispose(),r?hy(l)&&l.dispose():s(l)},l=>{a.dispose(),t.dispose(),o(l)})});return new class{cancel(){t.cancel(),t.dispose()}then(s,o){return n.then(s,o)}catch(s){return this.then(void 0,s)}finally(s){return n.finally(s)}}}function Pb(e,t,i){return new Promise((r,n)=>{const s=t.onCancellationRequested(()=>{s.dispose(),r(i)});e.then(r,n).finally(()=>s.dispose())})}function Ku(e,t){return new Promise((i,r)=>{const n=t.onCancellationRequested(()=>{n.dispose(),r(new xr)});e.then(i,r).finally(()=>n.dispose())})}function Kt(e){return new Promise((t,i)=>{const r=e();An(r)?r.then(t,i):t(r)})}function bT(){let e,t;return{promise:new Promise((r,n)=>{e=r,t=n}),resolve:e,reject:t}}var xT=class{constructor(){this.isDisposed=!1,this.activePromise=null,this.queuedPromise=null,this.queuedPromiseFactory=null}queue(e){if(this.isDisposed)return Promise.reject(new Error("Throttler is disposed"));if(this.activePromise){if(this.queuedPromiseFactory=e,!this.queuedPromise){const t=()=>{if(this.queuedPromise=null,this.isDisposed)return;const i=this.queue(this.queuedPromiseFactory);return this.queuedPromiseFactory=null,i};this.queuedPromise=new Promise(i=>{this.activePromise.then(t,t).then(i)})}return new Promise((t,i)=>{this.queuedPromise.then(t,i)})}return this.activePromise=e(),new Promise((t,i)=>{this.activePromise.then(r=>{this.activePromise=null,t(r)},r=>{this.activePromise=null,i(r)})})}dispose(){this.isDisposed=!0}},ST=class{constructor(){this.current=Promise.resolve(null)}queue(e){return this.current=this.current.then(()=>e(),()=>e())}},ET=(e,t)=>{let i=!0;const r=setTimeout(()=>{i=!1,t()},e);return{isTriggered:()=>i,dispose:()=>{clearTimeout(r),i=!1}}},CT=e=>{let t=!0;return queueMicrotask(()=>{t&&(t=!1,e())}),{isTriggered:()=>t,dispose:()=>{t=!1}}},DT=class{constructor(e){this.defaultDelay=e,this.deferred=null,this.completionPromise=null,this.doResolve=null,this.doReject=null,this.task=null}trigger(e,t=this.defaultDelay){this.task=e,this.cancelTimeout(),this.completionPromise||(this.completionPromise=new Promise((r,n)=>{this.doResolve=r,this.doReject=n}).then(()=>{if(this.completionPromise=null,this.doResolve=null,this.task){const r=this.task;return this.task=null,r()}}));const i=()=>{this.deferred=null,this.doResolve?.(null)};return this.deferred=t===wT?CT(i):ET(t,i),this.completionPromise}isTriggered(){return!!this.deferred?.isTriggered()}cancel(){this.cancelTimeout(),this.completionPromise&&(this.doReject?.(new xr),this.completionPromise=null)}cancelTimeout(){this.deferred?.dispose(),this.deferred=null}dispose(){this.cancel()}},IT=class{constructor(e){this.delayer=new DT(e),this.throttler=new xT}trigger(e,t){return this.delayer.trigger(()=>this.throttler.queue(e),t)}isTriggered(){return this.delayer.isTriggered()}cancel(){this.delayer.cancel()}dispose(){this.delayer.dispose(),this.throttler.dispose()}},Cr=class{constructor(){this._isOpen=!1,this._promise=new Promise((e,t)=>{this._completePromise=e})}isOpen(){return this._isOpen}open(){this._isOpen=!0,this._completePromise(!0)}wait(){return this._promise}};function sr(e,t){return t?new Promise((i,r)=>{const n=setTimeout(()=>{s.dispose(),i()},e),s=t.onCancellationRequested(()=>{clearTimeout(n),s.dispose(),r(new xr)})}):yT(i=>sr(e,i))}function kT(e,t=0,i){const r=setTimeout(()=>{e(),i&&n.dispose()},t),n=ne(()=>{clearTimeout(r),i?.delete(n)});return i?.add(n),n}var PT=class{constructor(e){this._size=0,this._isDisposed=!1,this.maxDegreeOfParalellism=e,this.outstandingPromises=[],this.runningPromises=0,this._onDrained=new P}whenIdle(){return this.size>0?ct.toPromise(this.onDrained):Promise.resolve()}get onDrained(){return this._onDrained.event}get size(){return this._size}queue(e){if(this._isDisposed)throw new Error("Object has been disposed");return this._size++,new Promise((t,i)=>{this.outstandingPromises.push({factory:e,c:t,e:i}),this.consume()})}consume(){for(;this.outstandingPromises.length&&this.runningPromises<this.maxDegreeOfParalellism;){const e=this.outstandingPromises.shift();this.runningPromises++;const t=e.factory();t.then(e.c,e.e),t.then(()=>this.consumed(),()=>this.consumed())}}consumed(){this._isDisposed||(this.runningPromises--,--this._size===0&&this._onDrained.fire(),this.outstandingPromises.length>0&&this.consume())}clear(){if(this._isDisposed)throw new Error("Object has been disposed");this.outstandingPromises.length=0,this._size=this.runningPromises}dispose(){this._isDisposed=!0,this.outstandingPromises.length=0,this._size=0,this._onDrained.dispose()}},TT=class extends PT{constructor(){super(1)}},AT=class{constructor(){this.queues=new Map,this.drainers=new Set,this.drainListeners=void 0,this.drainListenerCount=0}async whenDrained(){if(this.isDrained())return;const e=new Dr;return this.drainers.add(e),e.p}isDrained(){for(const[,e]of this.queues)if(e.size>0)return!1;return!0}queueSize(e,t=He){const i=t.getComparisonKey(e);return this.queues.get(i)?.size??0}queueFor(e,t,i=He){const r=i.getComparisonKey(e);let n=this.queues.get(r);if(!n){n=new TT;const s=this.drainListenerCount++,o=ct.once(n.onDrained)(()=>{n?.dispose(),this.queues.delete(r),this.onDidQueueDrain(),this.drainListeners?.deleteAndDispose(s),this.drainListeners?.size===0&&(this.drainListeners.dispose(),this.drainListeners=void 0)});this.drainListeners||(this.drainListeners=new Pu),this.drainListeners.set(s,o),this.queues.set(r,n)}return n.queue(t)}onDidQueueDrain(){this.isDrained()&&this.releaseDrainers()}releaseDrainers(){for(const e of this.drainers)e.complete();this.drainers.clear()}dispose(){for(const[,e]of this.queues)e.dispose();this.queues.clear(),this.releaseDrainers(),this.drainListeners?.dispose()}},RT=class{constructor(){this.disposable=void 0,this.isDisposed=!1}cancel(){this.disposable?.dispose(),this.disposable=void 0}cancelAndSet(e,t,i=globalThis){if(this.isDisposed)throw new Oi("Calling 'cancelAndSet' on a disposed IntervalTimer");this.cancel();const r=i.setInterval(()=>{e()},t);this.disposable=ne(()=>{i.clearInterval(r),this.disposable=void 0})}dispose(){this.cancel(),this.isDisposed=!0}},Ao=class{constructor(e,t){this.timeoutToken=-1,this.runner=e,this.timeout=t,this.timeoutHandler=this.onTimeout.bind(this)}dispose(){this.cancel(),this.runner=null}cancel(){this.isScheduled()&&(clearTimeout(this.timeoutToken),this.timeoutToken=-1)}schedule(e=this.timeout){this.cancel(),this.timeoutToken=setTimeout(this.timeoutHandler,e)}get delay(){return this.timeout}set delay(e){this.timeout=e}isScheduled(){return this.timeoutToken!==-1}flush(){this.isScheduled()&&(this.cancel(),this.doRun())}onTimeout(){this.timeoutToken=-1,this.runner&&this.doRun()}doRun(){this.runner?.()}},Tb,Yu;(function(){typeof globalThis.requestIdleCallback!="function"||typeof globalThis.cancelIdleCallback!="function"?Yu=(e,t,i)=>{Ny(()=>{if(r)return;const n=Date.now()+15;t(Object.freeze({didTimeout:!0,timeRemaining(){return Math.max(0,n-Date.now())}}))});let r=!1;return{dispose(){r||(r=!0)}}}:Yu=(e,t,i)=>{const r=e.requestIdleCallback(t,typeof i=="number"?{timeout:i}:void 0);let n=!1;return{dispose(){n||(n=!0,e.cancelIdleCallback(r))}}},Tb=(e,t)=>Yu(globalThis,e,t)})();var LT=class{constructor(e,t){this._didRun=!1,this._executor=()=>{try{this._value=t()}catch(i){this._error=i}finally{this._didRun=!0}},this._handle=Yu(e,()=>this._executor())}dispose(){this._handle.dispose()}get value(){if(this._didRun||(this._handle.dispose(),this._executor()),this._error)throw this._error;return this._value}get isInitialized(){return this._didRun}},NT=class extends LT{constructor(e){super(globalThis,e)}},Ab;(function(e){e[e.Resolved=0]="Resolved",e[e.Rejected=1]="Rejected"})(Ab||(Ab={}));var Dr=class{get isRejected(){return this.outcome?.outcome===1}get isResolved(){return this.outcome?.outcome===0}get isSettled(){return!!this.outcome}get value(){return this.outcome?.outcome===0?this.outcome?.value:void 0}constructor(){this.p=new Promise((e,t)=>{this.completeCallback=e,this.errorCallback=t})}complete(e){return new Promise(t=>{this.completeCallback(e),this.outcome={outcome:0,value:e},t()})}error(e){return new Promise(t=>{this.errorCallback(e),this.outcome={outcome:1,value:e},t()})}cancel(){return this.error(new xr)}},Ro;(function(e){async function t(r){let n;const s=await Promise.all(r.map(o=>o.then(a=>a,a=>{n||(n=a)})));if(typeof n<"u")throw n;return s}e.settled=t;function i(r){return new Promise(async(n,s)=>{try{await r(n,s)}catch(o){s(o)}})}e.withAsyncBody=i})(Ro||(Ro={}));var Rb;(function(e){e[e.Initial=0]="Initial",e[e.DoneOK=1]="DoneOK",e[e.DoneError=2]="DoneError"})(Rb||(Rb={}));var fl=class Vi{static fromArray(t){return new Vi(i=>{i.emitMany(t)})}static fromPromise(t){return new Vi(async i=>{i.emitMany(await t)})}static fromPromisesResolveOrder(t){return new Vi(async i=>{await Promise.all(t.map(async r=>i.emitOne(await r)))})}static merge(t){return new Vi(async i=>{await Promise.all(t.map(async r=>{for await(const n of r)i.emitOne(n)}))})}static{this.EMPTY=Vi.fromArray([])}constructor(t,i){this._state=0,this._results=[],this._error=null,this._onReturn=i,this._onStateChanged=new P,queueMicrotask(async()=>{const r={emitOne:n=>this.emitOne(n),emitMany:n=>this.emitMany(n),reject:n=>this.reject(n)};try{await Promise.resolve(t(r)),this.resolve()}catch(n){this.reject(n)}finally{r.emitOne=void 0,r.emitMany=void 0,r.reject=void 0}})}[Symbol.asyncIterator](){let t=0;return{next:async()=>{do{if(this._state===2)throw this._error;if(t<this._results.length)return{done:!1,value:this._results[t++]};if(this._state===1)return{done:!0,value:void 0};await ct.toPromise(this._onStateChanged.event)}while(!0)},return:async()=>(this._onReturn?.(),{done:!0,value:void 0})}}static map(t,i){return new Vi(async r=>{for await(const n of t)r.emitOne(i(n))})}map(t){return Vi.map(this,t)}static filter(t,i){return new Vi(async r=>{for await(const n of t)i(n)&&r.emitOne(n)})}filter(t){return Vi.filter(this,t)}static coalesce(t){return Vi.filter(t,i=>!!i)}coalesce(){return Vi.coalesce(this)}static async toPromise(t){const i=[];for await(const r of t)i.push(r);return i}toPromise(){return Vi.toPromise(this)}emitOne(t){this._state===0&&(this._results.push(t),this._onStateChanged.fire())}emitMany(t){this._state===0&&(this._results=this._results.concat(t),this._onStateChanged.fire())}resolve(){this._state===0&&(this._state=1,this._onStateChanged.fire())}reject(t){this._state===0&&(this._state=2,this._error=t,this._onStateChanged.fire())}},Ng=class{constructor(e){this._deferred=new Dr,this._asyncIterable=new fl(r=>{if(t){r.reject(t);return}return i&&r.emitMany(i),this._errorFn=n=>r.reject(n),this._emitFn=n=>r.emitOne(n),this._deferred.p},e);let t,i;this._emitFn=r=>{i||(i=[]),i.push(r)},this._errorFn=r=>{t||(t=r)}}get asyncIterable(){return this._asyncIterable}resolve(){this._deferred.complete()}reject(e){this._errorFn(e),this._deferred.complete()}emitOne(e){this._emitFn(e)}},PU=new class{transformIncoming(e){return e}transformOutgoing(e){return e}transformOutgoingURI(e){return e}transformOutgoingScheme(e){return e}};function Lb(e,t,i,r){if(!e||r>200)return null;if(typeof e=="object"){if(e.$mid===1)return i?y.revive(t.transformIncoming(e)):t.transformIncoming(e);if(e instanceof ae)return null;for(const n in e)if(Object.hasOwnProperty.call(e,n)){const s=Lb(e[n],t,i,r+1);s!==null&&(e[n]=s)}}return null}function pl(e,t){const i=Lb(e,t,!1,0);return i===null?e:i}var Nb=class{constructor(){this._actual=null,this._actualOk=null,this._actualErr=null,this._hasValue=!1,this._value=null,this._hasErr=!1,this._err=null}get[Symbol.toStringTag](){return this.toString()}_ensureActual(){return this._actual||(this._actual=new Promise((e,t)=>{this._actualOk=e,this._actualErr=t,this._hasValue&&this._actualOk(this._value),this._hasErr&&this._actualErr(this._err)})),this._actual}resolveOk(e){this._hasValue||this._hasErr||(this._hasValue=!0,this._value=e,this._actual&&this._actualOk(e))}resolveErr(e){this._hasValue||this._hasErr||(this._hasErr=!0,this._err=e,this._actual?this._actualErr(e):Qt(e))}then(e,t){return this._ensureActual().then(e,t)}catch(e){return this._ensureActual().then(void 0,e)}finally(e){return this._ensureActual().finally(e)}},MT=class extends Nb{constructor(){super(),this._hasErr=!0,this._err=new xr}},Mb;function Mg(e,t){try{return JSON.stringify(e,t)}catch{return"null"}}var Og="$$ref$$",OT={[Og]:-1};function Ob(e,t=null,i=!1){const r=[];return{jsonString:(i?Mg:JSON.stringify)(e,(s,o)=>{if(typeof o>"u")return OT;if(typeof o=="object"){if(o instanceof ae){const a=r.push(o)-1;return{[Og]:a}}if(t)return t(s,o)}return o}),referencedBuffers:r}}function Fb(e,t,i){return JSON.parse(e,(r,n)=>{if(n){const s=n[Og];if(typeof s=="number")return t[s];if(i&&n.$mid===1)return i.transformIncoming(n)}return n})}function $b(e,t){return JSON.stringify(e,t)}function FT(e){return e?(t,i)=>i&&i.$mid===1?e.transformOutgoing(i):i:null}var Hb;(function(e){e[e.LocalSide=0]="LocalSide",e[e.OtherSide=1]="OtherSide"})(Hb||(Hb={}));var Ub;(function(e){e[e.Responsive=0]="Responsive",e[e.Unresponsive=1]="Unresponsive"})(Ub||(Ub={}));var $T=()=>{},HT=Symbol.for("rpcProtocol"),UT=Symbol.for("rpcProxy"),BT=class bw extends se{static{Mb=HT}static{this.UNRESPONSIVE_TIME=3*1e3}constructor(t,i=null,r=null){super(),this[Mb]=!0,this._onDidChangeResponsiveState=this._register(new P),this.onDidChangeResponsiveState=this._onDidChangeResponsiveState.event,this._protocol=t,this._logger=i,this._uriTransformer=r,this._uriReplacer=FT(this._uriTransformer),this._isDisposed=!1,this._locals=[],this._proxies=[];for(let n=0,s=Gy.count;n<s;n++)this._locals[n]=null,this._proxies[n]=null;this._lastMessageId=0,this._cancelInvokedHandlers=Object.create(null),this._pendingRPCReplies={},this._responsiveState=0,this._unacknowledgedCount=0,this._unresponsiveTime=0,this._asyncCheckUresponsive=this._register(new Ao(()=>this._checkUnresponsive(),1e3)),this._register(this._protocol.onMessage(n=>this._receiveOneMessage(n)))}dispose(){this._isDisposed=!0,Object.keys(this._pendingRPCReplies).forEach(t=>{const i=this._pendingRPCReplies[t];delete this._pendingRPCReplies[t],i.resolveErr(Xw())}),super.dispose()}drain(){return typeof this._protocol.drain=="function"?this._protocol.drain():Promise.resolve()}_onWillSendRequest(t){this._unacknowledgedCount===0&&(this._unresponsiveTime=Date.now()+bw.UNRESPONSIVE_TIME),this._unacknowledgedCount++,this._asyncCheckUresponsive.isScheduled()||this._asyncCheckUresponsive.schedule()}_onDidReceiveAcknowledge(t){this._unresponsiveTime=Date.now()+bw.UNRESPONSIVE_TIME,this._unacknowledgedCount--,this._unacknowledgedCount===0&&this._asyncCheckUresponsive.cancel(),this._setResponsiveState(0)}_checkUnresponsive(){this._unacknowledgedCount!==0&&(Date.now()>this._unresponsiveTime?this._setResponsiveState(1):this._asyncCheckUresponsive.schedule())}_setResponsiveState(t){this._responsiveState!==t&&(this._responsiveState=t,this._onDidChangeResponsiveState.fire(this._responsiveState))}get responsiveState(){return this._responsiveState}transformIncomingURIs(t){return this._uriTransformer?pl(t,this._uriTransformer):t}getProxy(t){const{nid:i,sid:r}=t;return this._proxies[i]||(this._proxies[i]=this._createProxy(i,r)),this._proxies[i]}_createProxy(t,i){const r={get:(n,s)=>(typeof s=="string"&&!n[s]&&s.charCodeAt(0)===36&&(n[s]=(...o)=>this._remoteCall(t,s,o)),s===UT?i:n[s])};return new Proxy(Object.create(null),r)}set(t,i){return this._locals[t.nid]=i,i}assertRegistered(t){for(let i=0,r=t.length;i<r;i++){const n=t[i];if(!this._locals[n.nid])throw new Error(`Missing proxy instance ${n.sid}`)}}_receiveOneMessage(t){if(this._isDisposed)return;const i=t.byteLength,r=yt.read(t,0),n=r.readUInt8(),s=r.readUInt32();switch(n){case 1:case 2:{let{rpcId:o,method:a,args:l}=Gi.deserializeRequestJSONArgs(r);this._uriTransformer&&(l=pl(l,this._uriTransformer)),this._receiveRequest(i,s,o,a,l,n===2);break}case 3:case 4:{let{rpcId:o,method:a,args:l}=Gi.deserializeRequestMixedArgs(r);this._uriTransformer&&(l=pl(l,this._uriTransformer)),this._receiveRequest(i,s,o,a,l,n===4);break}case 5:{this._logger?.logIncoming(i,s,0,"ack"),this._onDidReceiveAcknowledge(s);break}case 6:{this._receiveCancel(i,s);break}case 7:{this._receiveReply(i,s,void 0);break}case 9:{let o=Gi.deserializeReplyOKJSON(r);this._uriTransformer&&(o=pl(o,this._uriTransformer)),this._receiveReply(i,s,o);break}case 10:{const o=Gi.deserializeReplyOKJSONWithBuffers(r,this._uriTransformer);this._receiveReply(i,s,o);break}case 8:{const o=Gi.deserializeReplyOKVSBuffer(r);this._receiveReply(i,s,o);break}case 11:{let o=Gi.deserializeReplyErrError(r);this._uriTransformer&&(o=pl(o,this._uriTransformer)),this._receiveReplyErr(i,s,o);break}case 12:{this._receiveReplyErr(i,s,void 0);break}default:console.error("received unexpected message"),console.error(t)}}_receiveRequest(t,i,r,n,s,o){this._logger?.logIncoming(t,i,1,`receiveRequest ${qu(r)}.${n}(`,s);const a=String(i);let l,c;if(o){const d=new ft;s.push(d.token),l=this._invokeHandler(r,n,s),c=()=>d.cancel()}else l=this._invokeHandler(r,n,s),c=$T;this._cancelInvokedHandlers[a]=c;const u=Gi.serializeAcknowledged(i);this._logger?.logOutgoing(u.byteLength,i,1,"ack"),this._protocol.send(u),l.then(d=>{delete this._cancelInvokedHandlers[a];const f=Gi.serializeReplyOK(i,d,this._uriReplacer);this._logger?.logOutgoing(f.byteLength,i,1,"reply:",d),this._protocol.send(f)},d=>{delete this._cancelInvokedHandlers[a];const f=Gi.serializeReplyErr(i,d);this._logger?.logOutgoing(f.byteLength,i,1,"replyErr:",d),this._protocol.send(f)})}_receiveCancel(t,i){this._logger?.logIncoming(t,i,1,"receiveCancel");const r=String(i);this._cancelInvokedHandlers[r]?.()}_receiveReply(t,i,r){this._logger?.logIncoming(t,i,0,"receiveReply:",r);const n=String(i);if(!this._pendingRPCReplies.hasOwnProperty(n))return;const s=this._pendingRPCReplies[n];delete this._pendingRPCReplies[n],s.resolveOk(r)}_receiveReplyErr(t,i,r){this._logger?.logIncoming(t,i,0,"receiveReplyErr:",r);const n=String(i);if(!this._pendingRPCReplies.hasOwnProperty(n))return;const s=this._pendingRPCReplies[n];delete this._pendingRPCReplies[n];let o;r&&(r.$isError?(o=new Error,o.name=r.name,o.message=r.message,o.stack=r.stack):o=r),s.resolveErr(o)}_invokeHandler(t,i,r){try{return Promise.resolve(this._doInvokeHandler(t,i,r))}catch(n){return Promise.reject(n)}}_doInvokeHandler(t,i,r){const n=this._locals[t];if(!n)throw new Error("Unknown actor "+qu(t));const s=n[i];if(typeof s!="function")throw new Error("Unknown method "+i+" on actor "+qu(t));return s.apply(n,r)}_remoteCall(t,i,r){if(this._isDisposed)return new MT;let n=null;if(r.length>0&&Xe.isCancellationToken(r[r.length-1])&&(n=r.pop()),n&&n.isCancellationRequested)return Promise.reject(Xw());const s=Gi.serializeRequestArguments(r,this._uriReplacer),o=++this._lastMessageId,a=String(o),l=new Nb,c=new he;n&&c.add(n.onCancellationRequested(()=>{const d=Gi.serializeCancel(o);this._logger?.logOutgoing(d.byteLength,o,0,"cancel"),this._protocol.send(d)})),this._pendingRPCReplies[a]=new WT(l,c),this._onWillSendRequest(o);const u=Gi.serializeRequest(o,t,i,s,!!n);return this._logger?.logOutgoing(u.byteLength,o,0,`request: ${qu(t)}.${i}(`,r),this._protocol.send(u),l}},WT=class{constructor(e,t){this._promise=e,this._disposable=t}resolveOk(e){this._promise.resolveOk(e),this._disposable.dispose()}resolveErr(e){this._promise.resolveErr(e),this._disposable.dispose()}},yt=class xw{static alloc(t,i,r){const n=new xw(ae.alloc(r+1+4),0);return n.writeUInt8(t),n.writeUInt32(i),n}static read(t,i){return new xw(t,i)}get buffer(){return this._buff}constructor(t,i){this._buff=t,this._offset=i}static sizeUInt8(){return 1}static{this.sizeUInt32=4}writeUInt8(t){this._buff.writeUInt8(t,this._offset),this._offset+=1}readUInt8(){const t=this._buff.readUInt8(this._offset);return this._offset+=1,t}writeUInt32(t){this._buff.writeUInt32BE(t,this._offset),this._offset+=4}readUInt32(){const t=this._buff.readUInt32BE(this._offset);return this._offset+=4,t}static sizeShortString(t){return 1+t.byteLength}writeShortString(t){this._buff.writeUInt8(t.byteLength,this._offset),this._offset+=1,this._buff.set(t,this._offset),this._offset+=t.byteLength}readShortString(){const t=this._buff.readUInt8(this._offset);this._offset+=1;const r=this._buff.slice(this._offset,this._offset+t).toString();return this._offset+=t,r}static sizeLongString(t){return 4+t.byteLength}writeLongString(t){this._buff.writeUInt32BE(t.byteLength,this._offset),this._offset+=4,this._buff.set(t,this._offset),this._offset+=t.byteLength}readLongString(){const t=this._buff.readUInt32BE(this._offset);this._offset+=4;const r=this._buff.slice(this._offset,this._offset+t).toString();return this._offset+=t,r}writeBuffer(t){this._buff.writeUInt32BE(t.byteLength,this._offset),this._offset+=4,this._buff.set(t,this._offset),this._offset+=t.byteLength}static sizeVSBuffer(t){return 4+t.byteLength}writeVSBuffer(t){this._buff.writeUInt32BE(t.byteLength,this._offset),this._offset+=4,this._buff.set(t,this._offset),this._offset+=t.byteLength}readVSBuffer(){const t=this._buff.readUInt32BE(this._offset);this._offset+=4;const i=this._buff.slice(this._offset,this._offset+t);return this._offset+=t,i}static sizeMixedArray(t){let i=0;i+=1;for(let r=0,n=t.length;r<n;r++){const s=t[r];switch(i+=1,s.type){case 1:i+=this.sizeLongString(s.value);break;case 2:i+=this.sizeVSBuffer(s.value);break;case 3:i+=this.sizeUInt32,i+=this.sizeLongString(s.value);for(let o=0;o<s.buffers.length;++o)i+=this.sizeVSBuffer(s.buffers[o]);break;case 4:break}}return i}writeMixedArray(t){this._buff.writeUInt8(t.length,this._offset),this._offset+=1;for(let i=0,r=t.length;i<r;i++){const n=t[i];switch(n.type){case 1:this.writeUInt8(1),this.writeLongString(n.value);break;case 2:this.writeUInt8(2),this.writeVSBuffer(n.value);break;case 3:this.writeUInt8(3),this.writeUInt32(n.buffers.length),this.writeLongString(n.value);for(let s=0;s<n.buffers.length;++s)this.writeBuffer(n.buffers[s]);break;case 4:this.writeUInt8(4);break}}}readMixedArray(){const t=this._buff.readUInt8(this._offset);this._offset+=1;const i=new Array(t);for(let r=0;r<t;r++)switch(this.readUInt8()){case 1:i[r]=this.readLongString();break;case 2:i[r]=this.readVSBuffer();break;case 3:{const s=this.readUInt32(),o=this.readLongString(),a=[];for(let l=0;l<s;++l)a.push(this.readVSBuffer());i[r]=new ai(Fb(o,a,null));break}case 4:i[r]=void 0;break}return i}},Bb;(function(e){e[e.Simple=0]="Simple",e[e.Mixed=1]="Mixed"})(Bb||(Bb={}));var Gi=class{static _useMixedArgSerialization(e){for(let t=0,i=e.length;t<i;t++)if(e[t]instanceof ae||e[t]instanceof ai||typeof e[t]>"u")return!0;return!1}static serializeRequestArguments(e,t){if(this._useMixedArgSerialization(e)){const i=[];for(let r=0,n=e.length;r<n;r++){const s=e[r];if(s instanceof ae)i[r]={type:2,value:s};else if(typeof s>"u")i[r]={type:4};else if(s instanceof ai){const{jsonString:o,referencedBuffers:a}=Ob(s.value,t);i[r]={type:3,value:ae.fromString(o),buffers:a}}else i[r]={type:1,value:ae.fromString($b(s,t))}}return{type:1,args:i}}return{type:0,args:$b(e,t)}}static serializeRequest(e,t,i,r,n){switch(r.type){case 0:return this._requestJSONArgs(e,t,i,r.args,n);case 1:return this._requestMixedArgs(e,t,i,r.args,n)}}static _requestJSONArgs(e,t,i,r,n){const s=ae.fromString(i),o=ae.fromString(r);let a=0;a+=yt.sizeUInt8(),a+=yt.sizeShortString(s),a+=yt.sizeLongString(o);const l=yt.alloc(n?2:1,e,a);return l.writeUInt8(t),l.writeShortString(s),l.writeLongString(o),l.buffer}static deserializeRequestJSONArgs(e){const t=e.readUInt8(),i=e.readShortString(),r=e.readLongString();return{rpcId:t,method:i,args:JSON.parse(r)}}static _requestMixedArgs(e,t,i,r,n){const s=ae.fromString(i);let o=0;o+=yt.sizeUInt8(),o+=yt.sizeShortString(s),o+=yt.sizeMixedArray(r);const a=yt.alloc(n?4:3,e,o);return a.writeUInt8(t),a.writeShortString(s),a.writeMixedArray(r),a.buffer}static deserializeRequestMixedArgs(e){const t=e.readUInt8(),i=e.readShortString(),r=e.readMixedArray(),n=new Array(r.length);for(let s=0,o=r.length;s<o;s++){const a=r[s];typeof a=="string"?n[s]=JSON.parse(a):n[s]=a}return{rpcId:t,method:i,args:n}}static serializeAcknowledged(e){return yt.alloc(5,e,0).buffer}static serializeCancel(e){return yt.alloc(6,e,0).buffer}static serializeReplyOK(e,t,i){if(typeof t>"u")return this._serializeReplyOKEmpty(e);if(t instanceof ae)return this._serializeReplyOKVSBuffer(e,t);if(t instanceof ai){const{jsonString:r,referencedBuffers:n}=Ob(t.value,i,!0);return this._serializeReplyOKJSONWithBuffers(e,r,n)}else return this._serializeReplyOKJSON(e,Mg(t,i))}static _serializeReplyOKEmpty(e){return yt.alloc(7,e,0).buffer}static _serializeReplyOKVSBuffer(e,t){let i=0;i+=yt.sizeVSBuffer(t);const r=yt.alloc(8,e,i);return r.writeVSBuffer(t),r.buffer}static deserializeReplyOKVSBuffer(e){return e.readVSBuffer()}static _serializeReplyOKJSON(e,t){const i=ae.fromString(t);let r=0;r+=yt.sizeLongString(i);const n=yt.alloc(9,e,r);return n.writeLongString(i),n.buffer}static _serializeReplyOKJSONWithBuffers(e,t,i){const r=ae.fromString(t);let n=0;n+=yt.sizeUInt32,n+=yt.sizeLongString(r);for(const o of i)n+=yt.sizeVSBuffer(o);const s=yt.alloc(10,e,n);s.writeUInt32(i.length),s.writeLongString(r);for(const o of i)s.writeBuffer(o);return s.buffer}static deserializeReplyOKJSON(e){const t=e.readLongString();return JSON.parse(t)}static deserializeReplyOKJSONWithBuffers(e,t){const i=e.readUInt32(),r=e.readLongString(),n=[];for(let s=0;s<i;++s)n.push(e.readVSBuffer());return new ai(Fb(r,n,t))}static serializeReplyErr(e,t){const i=t?Mg(wo(t),null):void 0;if(typeof i!="string")return this._serializeReplyErrEmpty(e);const r=ae.fromString(i);let n=0;n+=yt.sizeLongString(r);const s=yt.alloc(11,e,n);return s.writeLongString(r),s.buffer}static deserializeReplyErrError(e){const t=e.readLongString();return JSON.parse(t)}static _serializeReplyErrEmpty(e){return yt.alloc(12,e,0).buffer}},Wb;(function(e){e[e.RequestJSONArgs=1]="RequestJSONArgs",e[e.RequestJSONArgsWithCancellation=2]="RequestJSONArgsWithCancellation",e[e.RequestMixedArgs=3]="RequestMixedArgs",e[e.RequestMixedArgsWithCancellation=4]="RequestMixedArgsWithCancellation",e[e.Acknowledged=5]="Acknowledged",e[e.Cancel=6]="Cancel",e[e.ReplyOKEmpty=7]="ReplyOKEmpty",e[e.ReplyOKVSBuffer=8]="ReplyOKVSBuffer",e[e.ReplyOKJSON=9]="ReplyOKJSON",e[e.ReplyOKJSONWithBuffers=10]="ReplyOKJSONWithBuffers",e[e.ReplyErrError=11]="ReplyErrError",e[e.ReplyErrEmpty=12]="ReplyErrEmpty"})(Wb||(Wb={}));var Vb;(function(e){e[e.String=1]="String",e[e.VSBuffer=2]="VSBuffer",e[e.SerializedObjectWithBuffers=3]="SerializedObjectWithBuffers",e[e.Undefined=4]="Undefined"})(Vb||(Vb={}));var or;(function(e){e.serviceIds=new Map,e.DI_TARGET="$di$target",e.DI_DEPENDENCIES="$di$dependencies";function t(i){return i[e.DI_DEPENDENCIES]||[]}e.getServiceDependencies=t})(or||(or={}));var gl=U("instantiationService");function VT(e,t,i){t[or.DI_TARGET]===t?t[or.DI_DEPENDENCIES].push({id:e,index:i}):(t[or.DI_DEPENDENCIES]=[{id:e,index:i}],t[or.DI_TARGET]=t)}function U(e){if(or.serviceIds.has(e))return or.serviceIds.get(e);const t=function(i,r,n){if(arguments.length!==3)throw new Error("@IServiceName-decorator can only be used to decorate a parameter");VT(t,i,n)};return t.toString=()=>e,or.serviceIds.set(e,t),t}function TU(e){return e}function Fg(e){if(!e)return;const t=e.indexOf("+");return t<0?e:e.substr(0,t)}var zb=["AI","Azure","Chat","Data Science","Debuggers","Extension Packs","Education","Formatters","Keymaps","Language Packs","Linters","Machine Learning","Notebooks","Programming Languages","SCM Providers","Snippets","Testing","Themes","Visualization","Other"],qb;(function(e){e[e.System=0]="System",e[e.User=1]="User"})(qb||(qb={}));var jb;(function(e){e.WIN32_X64="win32-x64",e.WIN32_ARM64="win32-arm64",e.LINUX_X64="linux-x64",e.LINUX_ARM64="linux-arm64",e.LINUX_ARMHF="linux-armhf",e.ALPINE_X64="alpine-x64",e.ALPINE_ARM64="alpine-arm64",e.DARWIN_X64="darwin-x64",e.DARWIN_ARM64="darwin-arm64",e.WEB="web",e.UNIVERSAL="universal",e.UNKNOWN="unknown",e.UNDEFINED="undefined"})(jb||(jb={}));var Oe=class{constructor(e){this.value=e,this._lower=e.toLowerCase()}static equals(e,t){if(typeof e>"u"||e===null)return typeof t>"u"||t===null;if(typeof t>"u"||t===null)return!1;if(typeof e=="string"||typeof t=="string"){const i=typeof e=="string"?e:e.value,r=typeof t=="string"?t:t.value;return Pn(i,r)}return e._lower===t._lower}static toKey(e){return typeof e=="string"?e.toLowerCase():e._lower}},vs=class{get size(){return this._set.size}constructor(e){if(this._set=new Set,e)for(const t of e)this.add(t)}add(e){this._set.add(Oe.toKey(e))}delete(e){return this._set.delete(Oe.toKey(e))}has(e){return this._set.has(Oe.toKey(e))}},Xr=class{constructor(){this._map=new Map}clear(){this._map.clear()}delete(e){this._map.delete(Oe.toKey(e))}get(e){return this._map.get(Oe.toKey(e))}has(e){return this._map.has(Oe.toKey(e))}set(e,t){this._map.set(Oe.toKey(e),t)}values(){return this._map.values()}forEach(e){this._map.forEach(e)}[Symbol.iterator](){return this._map[Symbol.iterator]()}},Gb=class extends Error{constructor(e,t,i){super(`Error in extension ${Oe.toKey(e)}: ${i??t.message}`,{cause:t}),this.name="ExtensionError",this.extension=e}},AU=U("IBuiltinExtensionsScannerService");function $g(e,t){return t&&(e.stack||e.stacktrace)?h(112,null,Jb(e),Qb(e.stack)||Qb(e.stacktrace)):Jb(e)}function Qb(e){return Array.isArray(e)?e.join(`
`):e}function Jb(e){return e.code==="ERR_UNC_HOST_NOT_ALLOWED"?`${e.message}. Please update the 'security.allowedUNCHosts' setting if you want to allow this host.`:typeof e.code=="string"&&typeof e.errno=="number"&&typeof e.syscall=="string"?h(113,null,e.message):e.message||h(114,null)}function Lo(e=null,t=!1){if(!e)return h(115,null);if(Array.isArray(e)){const i=xt(e),r=Lo(i[0],t);return i.length>1?h(116,null,r,i.length):r}if(Me(e))return e;if(e.detail){const i=e.detail;if(i.error)return $g(i.error,t);if(i.exception)return $g(i.exception,t)}return e.stack?$g(e,t):e.message?e.message:h(117,null)}function ml(e){return Hg(e,0)}function Hg(e,t){switch(typeof e){case"object":return e===null?Zr(349,t):Array.isArray(e)?qT(e,t):jT(e,t);case"string":return Xb(e,t);case"boolean":return zT(e,t);case"number":return Zr(e,t);case"undefined":return Zr(937,t);default:return Zr(617,t)}}function Zr(e,t){return(t<<5)-t+e|0}function zT(e,t){return Zr(e?433:863,t)}function Xb(e,t){t=Zr(149417,t);for(let i=0,r=e.length;i<r;i++)t=Zr(e.charCodeAt(i),t);return t}function qT(e,t){return t=Zr(104579,t),e.reduce((i,r)=>Hg(r,i),t)}function jT(e,t){return t=Zr(181387,t),Object.keys(e).sort().reduce((i,r)=>(i=Xb(r,i),Hg(e[r],i)),t)}var Zb;(function(e){e[e.BLOCK_SIZE=64]="BLOCK_SIZE",e[e.UNICODE_REPLACEMENT=65533]="UNICODE_REPLACEMENT"})(Zb||(Zb={}));function Ug(e,t,i=32){const r=i-t,n=~((1<<r)-1);return(e<<t|(n&e)>>>r)>>>0}function vl(e,t=32){return e instanceof ArrayBuffer?Array.from(new Uint8Array(e)).map(i=>i.toString(16).padStart(2,"0")).join(""):(e>>>0).toString(16).padStart(t/4,"0")}var RU=class x6{static{this._bigBlock32=new DataView(new ArrayBuffer(320))}constructor(){this._h0=1732584193,this._h1=4023233417,this._h2=2562383102,this._h3=271733878,this._h4=3285377520,this._buff=new Uint8Array(67),this._buffDV=new DataView(this._buff.buffer),this._buffLen=0,this._totalLen=0,this._leftoverHighSurrogate=0,this._finished=!1}update(t){const i=t.length;if(i===0)return;const r=this._buff;let n=this._buffLen,s=this._leftoverHighSurrogate,o,a;for(s!==0?(o=s,a=-1,s=0):(o=t.charCodeAt(0),a=0);;){let l=o;if(Qu(o))if(a+1<i){const c=t.charCodeAt(a+1);Ju(c)?(a++,l=Tg(o,c)):l=65533}else{s=o;break}else Ju(o)&&(l=65533);if(n=this._push(r,n,l),a++,a<i)o=t.charCodeAt(a);else break}this._buffLen=n,this._leftoverHighSurrogate=s}_push(t,i,r){return r<128?t[i++]=r:r<2048?(t[i++]=192|(r&1984)>>>6,t[i++]=128|(r&63)>>>0):r<65536?(t[i++]=224|(r&61440)>>>12,t[i++]=128|(r&4032)>>>6,t[i++]=128|(r&63)>>>0):(t[i++]=240|(r&1835008)>>>18,t[i++]=128|(r&258048)>>>12,t[i++]=128|(r&4032)>>>6,t[i++]=128|(r&63)>>>0),i>=64&&(this._step(),i-=64,this._totalLen+=64,t[0]=t[64],t[1]=t[65],t[2]=t[66]),i}digest(){return this._finished||(this._finished=!0,this._leftoverHighSurrogate&&(this._leftoverHighSurrogate=0,this._buffLen=this._push(this._buff,this._buffLen,65533)),this._totalLen+=this._buffLen,this._wrapUp()),vl(this._h0)+vl(this._h1)+vl(this._h2)+vl(this._h3)+vl(this._h4)}_wrapUp(){this._buff[this._buffLen++]=128,this._buff.subarray(this._buffLen).fill(0),this._buffLen>56&&(this._step(),this._buff.fill(0));const t=8*this._totalLen;this._buffDV.setUint32(56,Math.floor(t/4294967296),!1),this._buffDV.setUint32(60,t%4294967296,!1),this._step()}_step(){const t=x6._bigBlock32,i=this._buffDV;for(let d=0;d<64;d+=4)t.setUint32(d,i.getUint32(d,!1),!1);for(let d=64;d<320;d+=4)t.setUint32(d,Ug(t.getUint32(d-12,!1)^t.getUint32(d-32,!1)^t.getUint32(d-56,!1)^t.getUint32(d-64,!1),1),!1);let r=this._h0,n=this._h1,s=this._h2,o=this._h3,a=this._h4,l,c,u;for(let d=0;d<80;d++)d<20?(l=n&s|~n&o,c=1518500249):d<40?(l=n^s^o,c=1859775393):d<60?(l=n&s|n&o|s&o,c=2400959708):(l=n^s^o,c=3395469782),u=Ug(r,5)+l+a+c+t.getUint32(d*4,!1)&4294967295,a=o,o=s,s=Ug(n,30),n=r,r=u;this._h0=this._h0+r&4294967295,this._h1=this._h1+n&4294967295,this._h2=this._h2+s&4294967295,this._h3=this._h3+o&4294967295,this._h4=this._h4+a&4294967295}},Kb;(function(e){e[e.LParen=0]="LParen",e[e.RParen=1]="RParen",e[e.Neg=2]="Neg",e[e.Eq=3]="Eq",e[e.NotEq=4]="NotEq",e[e.Lt=5]="Lt",e[e.LtEq=6]="LtEq",e[e.Gt=7]="Gt",e[e.GtEq=8]="GtEq",e[e.RegexOp=9]="RegexOp",e[e.RegexStr=10]="RegexStr",e[e.True=11]="True",e[e.False=12]="False",e[e.In=13]="In",e[e.Not=14]="Not",e[e.And=15]="And",e[e.Or=16]="Or",e[e.Str=17]="Str",e[e.QuotedStr=18]="QuotedStr",e[e.Error=19]="Error",e[e.EOF=20]="EOF"})(Kb||(Kb={}));function Bg(...e){switch(e.length){case 1:return h(1834,null,e[0]);case 2:return h(1835,null,e[0],e[1]);case 3:return h(1836,null,e[0],e[1],e[2]);default:return}}var GT=h(1837,null),QT=h(1838,null),_l=class Sw{constructor(){this._input="",this._start=0,this._current=0,this._tokens=[],this._errors=[],this.stringRe=/[a-zA-Z0-9_<>\-\./\\:\*\?\+\[\]\^,#@;"%\$\p{L}-]+/uy}static getLexeme(t){switch(t.type){case 0:return"(";case 1:return")";case 2:return"!";case 3:return t.isTripleEq?"===":"==";case 4:return t.isTripleEq?"!==":"!=";case 5:return"<";case 6:return"<=";case 7:return">=";case 8:return">=";case 9:return"=~";case 10:return t.lexeme;case 11:return"true";case 12:return"false";case 13:return"in";case 14:return"not";case 15:return"&&";case 16:return"||";case 17:return t.lexeme;case 18:return t.lexeme;case 19:return t.lexeme;case 20:return"EOF";default:throw Yp(`unhandled token type: ${JSON.stringify(t)}; have you forgotten to add a case?`)}}static{this._regexFlags=new Set(["i","g","s","m","y","u"].map(t=>t.charCodeAt(0)))}static{this._keywords=new Map([["not",14],["in",13],["false",12],["true",11]])}get errors(){return this._errors}reset(t){return this._input=t,this._start=0,this._current=0,this._tokens=[],this._errors=[],this}scan(){for(;!this._isAtEnd();)switch(this._start=this._current,this._advance()){case 40:this._addToken(0);break;case 41:this._addToken(1);break;case 33:if(this._match(61)){const i=this._match(61);this._tokens.push({type:4,offset:this._start,isTripleEq:i})}else this._addToken(2);break;case 39:this._quotedString();break;case 47:this._regex();break;case 61:if(this._match(61)){const i=this._match(61);this._tokens.push({type:3,offset:this._start,isTripleEq:i})}else this._match(126)?this._addToken(9):this._error(Bg("==","=~"));break;case 60:this._addToken(this._match(61)?6:5);break;case 62:this._addToken(this._match(61)?8:7);break;case 38:this._match(38)?this._addToken(15):this._error(Bg("&&"));break;case 124:this._match(124)?this._addToken(16):this._error(Bg("||"));break;case 32:case 13:case 9:case 10:case 160:break;default:this._string()}return this._start=this._current,this._addToken(20),Array.from(this._tokens)}_match(t){return this._isAtEnd()||this._input.charCodeAt(this._current)!==t?!1:(this._current++,!0)}_advance(){return this._input.charCodeAt(this._current++)}_peek(){return this._isAtEnd()?0:this._input.charCodeAt(this._current)}_addToken(t){this._tokens.push({type:t,offset:this._start})}_error(t){const i=this._start,r=this._input.substring(this._start,this._current),n={type:19,offset:this._start,lexeme:r};this._errors.push({offset:i,lexeme:r,additionalInfo:t}),this._tokens.push(n)}_string(){this.stringRe.lastIndex=this._start;const t=this.stringRe.exec(this._input);if(t){this._current=this._start+t[0].length;const i=this._input.substring(this._start,this._current),r=Sw._keywords.get(i);r?this._addToken(r):this._tokens.push({type:17,lexeme:i,offset:this._start})}}_quotedString(){for(;this._peek()!==39&&!this._isAtEnd();)this._advance();if(this._isAtEnd()){this._error(GT);return}this._advance(),this._tokens.push({type:18,lexeme:this._input.substring(this._start+1,this._current-1),offset:this._start+1})}_regex(){let t=this._current,i=!1,r=!1;for(;;){if(t>=this._input.length){this._current=t,this._error(QT);return}const s=this._input.charCodeAt(t);if(i)i=!1;else if(s===47&&!r){t++;break}else s===91?r=!0:s===92?i=!0:s===93&&(r=!1);t++}for(;t<this._input.length&&Sw._regexFlags.has(this._input.charCodeAt(t));)t++;this._current=t;const n=this._input.substring(this._start,this._current);this._tokens.push({type:10,lexeme:n,offset:this._start})}_isAtEnd(){return this._current>=this._input.length}},zt=new Map;zt.set("false",!1),zt.set("true",!0),zt.set("isMac",Hi),zt.set("isLinux",Gr),zt.set("isWindows",oi),zt.set("isWeb",Co),zt.set("isMacNative",Hi&&!Co),zt.set("isEdge",Hy),zt.set("isFirefox",fP),zt.set("isChrome",_g),zt.set("isSafari",pP);var JT=Object.prototype.hasOwnProperty,Yb;(function(e){e[e.False=0]="False",e[e.True=1]="True",e[e.Defined=2]="Defined",e[e.Not=3]="Not",e[e.Equals=4]="Equals",e[e.NotEquals=5]="NotEquals",e[e.And=6]="And",e[e.Regex=7]="Regex",e[e.NotRegex=8]="NotRegex",e[e.Or=9]="Or",e[e.In=10]="In",e[e.NotIn=11]="NotIn",e[e.Greater=12]="Greater",e[e.GreaterEquals=13]="GreaterEquals",e[e.Smaller=14]="Smaller",e[e.SmallerEquals=15]="SmallerEquals"})(Yb||(Yb={}));var XT={regexParsingWithErrorRecovery:!0},ZT=h(1814,null),KT=h(1815,null),YT=h(1816,null),ex=h(1817,null),e8=h(1818,null),t8=h(1819,null),i8=h(1820,null),r8=h(1821,null),tx=class vu{static{this._parseError=new Error}get lexingErrors(){return this._scanner.errors}get parsingErrors(){return this._parsingErrors}constructor(t=XT){this._config=t,this._scanner=new _l,this._tokens=[],this._current=0,this._parsingErrors=[],this._flagsGYRe=/g|y/g}parse(t){if(t===""){this._parsingErrors.push({message:ZT,offset:0,lexeme:"",additionalInfo:KT});return}this._tokens=this._scanner.reset(t).scan(),this._current=0,this._parsingErrors=[];try{const i=this._expr();if(!this._isAtEnd()){const r=this._peek(),n=r.type===17?t8:void 0;throw this._parsingErrors.push({message:e8,offset:r.offset,lexeme:_l.getLexeme(r),additionalInfo:n}),vu._parseError}return i}catch(i){if(i!==vu._parseError)throw i;return}}_expr(){return this._or()}_or(){const t=[this._and()];for(;this._matchOne(16);){const i=this._and();t.push(i)}return t.length===1?t[0]:It.or(...t)}_and(){const t=[this._term()];for(;this._matchOne(15);){const i=this._term();t.push(i)}return t.length===1?t[0]:It.and(...t)}_term(){if(this._matchOne(2)){const t=this._peek();switch(t.type){case 11:return this._advance(),hi.INSTANCE;case 12:return this._advance(),Pi.INSTANCE;case 0:{this._advance();const i=this._expr();return this._consume(1,ex),i?.negate()}case 17:return this._advance(),bl.create(t.lexeme);default:throw this._errExpectedButGot("KEY | true | false | '(' expression ')'",t)}}return this._primary()}_primary(){const t=this._peek();switch(t.type){case 11:return this._advance(),It.true();case 12:return this._advance(),It.false();case 0:{this._advance();const i=this._expr();return this._consume(1,ex),i}case 17:{const i=t.lexeme;if(this._advance(),this._matchOne(9)){const n=this._peek();if(!this._config.regexParsingWithErrorRecovery){if(this._advance(),n.type!==10)throw this._errExpectedButGot("REGEX",n);const s=n.lexeme,o=s.lastIndexOf("/"),a=o===s.length-1?void 0:this._removeFlagsGY(s.substring(o+1));let l;try{l=new RegExp(s.substring(1,o),a)}catch{throw this._errExpectedButGot("REGEX",n)}return Gg.create(i,l)}switch(n.type){case 10:case 19:{const s=[n.lexeme];this._advance();let o=this._peek(),a=0;for(let f=0;f<n.lexeme.length;f++)n.lexeme.charCodeAt(f)===40?a++:n.lexeme.charCodeAt(f)===41&&a--;for(;!this._isAtEnd()&&o.type!==15&&o.type!==16;){switch(o.type){case 0:a++;break;case 1:a--;break;case 10:case 18:for(let f=0;f<o.lexeme.length;f++)o.lexeme.charCodeAt(f)===40?a++:n.lexeme.charCodeAt(f)===41&&a--}if(a<0)break;s.push(_l.getLexeme(o)),this._advance(),o=this._peek()}const l=s.join(""),c=l.lastIndexOf("/"),u=c===l.length-1?void 0:this._removeFlagsGY(l.substring(c+1));let d;try{d=new RegExp(l.substring(1,c),u)}catch{throw this._errExpectedButGot("REGEX",n)}return It.regex(i,d)}case 18:{const s=n.lexeme;this._advance();let o=null;if(!Gu(s)){const a=s.indexOf("/"),l=s.lastIndexOf("/");if(a!==l&&a>=0){const c=s.slice(a+1,l),u=s[l+1]==="i"?"i":"";try{o=new RegExp(c,u)}catch{throw this._errExpectedButGot("REGEX",n)}}}if(o===null)throw this._errExpectedButGot("REGEX",n);return Gg.create(i,o)}default:throw this._errExpectedButGot("REGEX",this._peek())}}if(this._matchOne(14)){this._consume(13,YT);const n=this._value();return It.notIn(i,n)}switch(this._peek().type){case 3:{this._advance();const n=this._value();if(this._previous().type===18)return It.equals(i,n);switch(n){case"true":return It.has(i);case"false":return It.not(i);default:return It.equals(i,n)}}case 4:{this._advance();const n=this._value();if(this._previous().type===18)return It.notEquals(i,n);switch(n){case"true":return It.not(i);case"false":return It.has(i);default:return It.notEquals(i,n)}}case 5:return this._advance(),qg.create(i,this._value());case 6:return this._advance(),jg.create(i,this._value());case 7:return this._advance(),td.create(i,this._value());case 8:return this._advance(),zg.create(i,this._value());case 13:return this._advance(),It.in(i,this._value());default:return It.has(i)}}case 20:throw this._parsingErrors.push({message:i8,offset:t.offset,lexeme:"",additionalInfo:r8}),vu._parseError;default:throw this._errExpectedButGot(`true | false | KEY 
	| KEY '=~' REGEX 
	| KEY ('==' | '!=' | '<' | '<=' | '>' | '>=' | 'in' | 'not' 'in') value`,this._peek())}}_value(){const t=this._peek();switch(t.type){case 17:case 18:return this._advance(),t.lexeme;case 11:return this._advance(),"true";case 12:return this._advance(),"false";case 13:return this._advance(),"in";default:return""}}_removeFlagsGY(t){return t.replaceAll(this._flagsGYRe,"")}_previous(){return this._tokens[this._current-1]}_matchOne(t){return this._check(t)?(this._advance(),!0):!1}_advance(){return this._isAtEnd()||this._current++,this._previous()}_consume(t,i){if(this._check(t))return this._advance();throw this._errExpectedButGot(i,this._peek())}_errExpectedButGot(t,i,r){const n=h(1822,null,t,_l.getLexeme(i)),s=i.offset,o=_l.getLexeme(i);return this._parsingErrors.push({message:n,offset:s,lexeme:o,additionalInfo:r}),vu._parseError}_check(t){return this._peek().type===t}_peek(){return this._tokens[this._current]}_isAtEnd(){return this._peek().type===20}},It=class{static false(){return hi.INSTANCE}static true(){return Pi.INSTANCE}static has(e){return yl.create(e)}static equals(e,t){return Wg.create(e,t)}static notEquals(e,t){return Vg.create(e,t)}static regex(e,t){return Gg.create(e,t)}static in(e,t){return ix.create(e,t)}static notIn(e,t){return rx.create(e,t)}static not(e){return bl.create(e)}static and(...e){return sx.create(e,null,!0)}static or(...e){return Qg.create(e,null,!0)}static greater(e,t){return td.create(e,t)}static greaterEquals(e,t){return zg.create(e,t)}static smaller(e,t){return qg.create(e,t)}static smallerEquals(e,t){return jg.create(e,t)}static{this._parser=new tx({regexParsingWithErrorRecovery:!1})}static deserialize(e){return e==null?void 0:this._parser.parse(e)}};function n8(e){const t=new tx({regexParsingWithErrorRecovery:!1});return e.map(i=>(t.parse(i),t.lexingErrors.length>0?t.lexingErrors.map(r=>({errorMessage:r.additionalInfo?h(1823,null,r.additionalInfo):h(1824,null),offset:r.offset,length:r.lexeme.length})):t.parsingErrors.length>0?t.parsingErrors.map(r=>({errorMessage:r.additionalInfo?`${r.message}. ${r.additionalInfo}`:r.message,offset:r.offset,length:r.lexeme.length})):[]))}function wl(e,t){return e.cmp(t)}var hi=class S6{static{this.INSTANCE=new S6}constructor(){this.type=0}cmp(t){return this.type-t.type}equals(t){return t.type===this.type}substituteConstants(){return this}evaluate(t){return!1}serialize(){return"false"}keys(){return[]}map(t){return this}negate(){return Pi.INSTANCE}},Pi=class E6{static{this.INSTANCE=new E6}constructor(){this.type=1}cmp(t){return this.type-t.type}equals(t){return t.type===this.type}substituteConstants(){return this}evaluate(t){return!0}serialize(){return"true"}keys(){return[]}map(t){return this}negate(){return hi.INSTANCE}},yl=class C6{static create(t,i=null){const r=zt.get(t);return typeof r=="boolean"?r?Pi.INSTANCE:hi.INSTANCE:new C6(t,i)}constructor(t,i){this.key=t,this.negated=i,this.type=2}cmp(t){return t.type!==this.type?this.type-t.type:ox(this.key,t.key)}equals(t){return t.type===this.type?this.key===t.key:!1}substituteConstants(){const t=zt.get(this.key);return typeof t=="boolean"?t?Pi.INSTANCE:hi.INSTANCE:this}evaluate(t){return!!t.getValue(this.key)}serialize(){return this.key}keys(){return[this.key]}map(t){return t.mapDefined(this.key)}negate(){return this.negated||(this.negated=bl.create(this.key,this)),this.negated}},Wg=class D6{static create(t,i,r=null){if(typeof i=="boolean")return i?yl.create(t,r):bl.create(t,r);const n=zt.get(t);return typeof n=="boolean"?i===(n?"true":"false")?Pi.INSTANCE:hi.INSTANCE:new D6(t,i,r)}constructor(t,i,r){this.key=t,this.value=i,this.negated=r,this.type=4}cmp(t){return t.type!==this.type?this.type-t.type:_s(this.key,this.value,t.key,t.value)}equals(t){return t.type===this.type?this.key===t.key&&this.value===t.value:!1}substituteConstants(){const t=zt.get(this.key);if(typeof t=="boolean"){const i=t?"true":"false";return this.value===i?Pi.INSTANCE:hi.INSTANCE}return this}evaluate(t){return t.getValue(this.key)==this.value}serialize(){return`${this.key} == '${this.value}'`}keys(){return[this.key]}map(t){return t.mapEquals(this.key,this.value)}negate(){return this.negated||(this.negated=Vg.create(this.key,this.value,this)),this.negated}},ix=class I6{static create(t,i){return new I6(t,i)}constructor(t,i){this.key=t,this.valueKey=i,this.type=10,this.negated=null}cmp(t){return t.type!==this.type?this.type-t.type:_s(this.key,this.valueKey,t.key,t.valueKey)}equals(t){return t.type===this.type?this.key===t.key&&this.valueKey===t.valueKey:!1}substituteConstants(){return this}evaluate(t){const i=t.getValue(this.valueKey),r=t.getValue(this.key);return Array.isArray(i)?i.includes(r):typeof r=="string"&&typeof i=="object"&&i!==null?JT.call(i,r):!1}serialize(){return`${this.key} in '${this.valueKey}'`}keys(){return[this.key,this.valueKey]}map(t){return t.mapIn(this.key,this.valueKey)}negate(){return this.negated||(this.negated=rx.create(this.key,this.valueKey)),this.negated}},rx=class k6{static create(t,i){return new k6(t,i)}constructor(t,i){this.key=t,this.valueKey=i,this.type=11,this._negated=ix.create(t,i)}cmp(t){return t.type!==this.type?this.type-t.type:this._negated.cmp(t._negated)}equals(t){return t.type===this.type?this._negated.equals(t._negated):!1}substituteConstants(){return this}evaluate(t){return!this._negated.evaluate(t)}serialize(){return`${this.key} not in '${this.valueKey}'`}keys(){return this._negated.keys()}map(t){return t.mapNotIn(this.key,this.valueKey)}negate(){return this._negated}},Vg=class P6{static create(t,i,r=null){if(typeof i=="boolean")return i?bl.create(t,r):yl.create(t,r);const n=zt.get(t);return typeof n=="boolean"?i===(n?"true":"false")?hi.INSTANCE:Pi.INSTANCE:new P6(t,i,r)}constructor(t,i,r){this.key=t,this.value=i,this.negated=r,this.type=5}cmp(t){return t.type!==this.type?this.type-t.type:_s(this.key,this.value,t.key,t.value)}equals(t){return t.type===this.type?this.key===t.key&&this.value===t.value:!1}substituteConstants(){const t=zt.get(this.key);if(typeof t=="boolean"){const i=t?"true":"false";return this.value===i?hi.INSTANCE:Pi.INSTANCE}return this}evaluate(t){return t.getValue(this.key)!=this.value}serialize(){return`${this.key} != '${this.value}'`}keys(){return[this.key]}map(t){return t.mapNotEquals(this.key,this.value)}negate(){return this.negated||(this.negated=Wg.create(this.key,this.value,this)),this.negated}},bl=class T6{static create(t,i=null){const r=zt.get(t);return typeof r=="boolean"?r?hi.INSTANCE:Pi.INSTANCE:new T6(t,i)}constructor(t,i){this.key=t,this.negated=i,this.type=3}cmp(t){return t.type!==this.type?this.type-t.type:ox(this.key,t.key)}equals(t){return t.type===this.type?this.key===t.key:!1}substituteConstants(){const t=zt.get(this.key);return typeof t=="boolean"?t?hi.INSTANCE:Pi.INSTANCE:this}evaluate(t){return!t.getValue(this.key)}serialize(){return`!${this.key}`}keys(){return[this.key]}map(t){return t.mapNot(this.key)}negate(){return this.negated||(this.negated=yl.create(this.key,this)),this.negated}};function ed(e,t){if(typeof e=="string"){const i=parseFloat(e);isNaN(i)||(e=i)}return typeof e=="string"||typeof e=="number"?t(e):hi.INSTANCE}var td=class A6{static create(t,i,r=null){return ed(i,n=>new A6(t,n,r))}constructor(t,i,r){this.key=t,this.value=i,this.negated=r,this.type=12}cmp(t){return t.type!==this.type?this.type-t.type:_s(this.key,this.value,t.key,t.value)}equals(t){return t.type===this.type?this.key===t.key&&this.value===t.value:!1}substituteConstants(){return this}evaluate(t){return typeof this.value=="string"?!1:parseFloat(t.getValue(this.key))>this.value}serialize(){return`${this.key} > ${this.value}`}keys(){return[this.key]}map(t){return t.mapGreater(this.key,this.value)}negate(){return this.negated||(this.negated=jg.create(this.key,this.value,this)),this.negated}},zg=class R6{static create(t,i,r=null){return ed(i,n=>new R6(t,n,r))}constructor(t,i,r){this.key=t,this.value=i,this.negated=r,this.type=13}cmp(t){return t.type!==this.type?this.type-t.type:_s(this.key,this.value,t.key,t.value)}equals(t){return t.type===this.type?this.key===t.key&&this.value===t.value:!1}substituteConstants(){return this}evaluate(t){return typeof this.value=="string"?!1:parseFloat(t.getValue(this.key))>=this.value}serialize(){return`${this.key} >= ${this.value}`}keys(){return[this.key]}map(t){return t.mapGreaterEquals(this.key,this.value)}negate(){return this.negated||(this.negated=qg.create(this.key,this.value,this)),this.negated}},qg=class L6{static create(t,i,r=null){return ed(i,n=>new L6(t,n,r))}constructor(t,i,r){this.key=t,this.value=i,this.negated=r,this.type=14}cmp(t){return t.type!==this.type?this.type-t.type:_s(this.key,this.value,t.key,t.value)}equals(t){return t.type===this.type?this.key===t.key&&this.value===t.value:!1}substituteConstants(){return this}evaluate(t){return typeof this.value=="string"?!1:parseFloat(t.getValue(this.key))<this.value}serialize(){return`${this.key} < ${this.value}`}keys(){return[this.key]}map(t){return t.mapSmaller(this.key,this.value)}negate(){return this.negated||(this.negated=zg.create(this.key,this.value,this)),this.negated}},jg=class N6{static create(t,i,r=null){return ed(i,n=>new N6(t,n,r))}constructor(t,i,r){this.key=t,this.value=i,this.negated=r,this.type=15}cmp(t){return t.type!==this.type?this.type-t.type:_s(this.key,this.value,t.key,t.value)}equals(t){return t.type===this.type?this.key===t.key&&this.value===t.value:!1}substituteConstants(){return this}evaluate(t){return typeof this.value=="string"?!1:parseFloat(t.getValue(this.key))<=this.value}serialize(){return`${this.key} <= ${this.value}`}keys(){return[this.key]}map(t){return t.mapSmallerEquals(this.key,this.value)}negate(){return this.negated||(this.negated=td.create(this.key,this.value,this)),this.negated}},Gg=class M6{static create(t,i){return new M6(t,i)}constructor(t,i){this.key=t,this.regexp=i,this.type=7,this.negated=null}cmp(t){if(t.type!==this.type)return this.type-t.type;if(this.key<t.key)return-1;if(this.key>t.key)return 1;const i=this.regexp?this.regexp.source:"",r=t.regexp?t.regexp.source:"";return i<r?-1:i>r?1:0}equals(t){if(t.type===this.type){const i=this.regexp?this.regexp.source:"",r=t.regexp?t.regexp.source:"";return this.key===t.key&&i===r}return!1}substituteConstants(){return this}evaluate(t){const i=t.getValue(this.key);return this.regexp?this.regexp.test(i):!1}serialize(){const t=this.regexp?`/${this.regexp.source}/${this.regexp.flags}`:"/invalid/";return`${this.key} =~ ${t}`}keys(){return[this.key]}map(t){return t.mapRegex(this.key,this.regexp)}negate(){return this.negated||(this.negated=s8.create(this)),this.negated}},s8=class Ew{static create(t){return new Ew(t)}constructor(t){this._actual=t,this.type=8}cmp(t){return t.type!==this.type?this.type-t.type:this._actual.cmp(t._actual)}equals(t){return t.type===this.type?this._actual.equals(t._actual):!1}substituteConstants(){return this}evaluate(t){return!this._actual.evaluate(t)}serialize(){return`!(${this._actual.serialize()})`}keys(){return this._actual.keys()}map(t){return new Ew(this._actual.map(t))}negate(){return this._actual}};function nx(e){let t=null;for(let i=0,r=e.length;i<r;i++){const n=e[i].substituteConstants();if(e[i]!==n&&t===null){t=[];for(let s=0;s<i;s++)t[s]=e[s]}t!==null&&(t[i]=n)}return t===null?e:t}var sx=class Qa{static create(t,i,r){return Qa._normalizeArr(t,i,r)}constructor(t,i){this.expr=t,this.negated=i,this.type=6}cmp(t){if(t.type!==this.type)return this.type-t.type;if(this.expr.length<t.expr.length)return-1;if(this.expr.length>t.expr.length)return 1;for(let i=0,r=this.expr.length;i<r;i++){const n=wl(this.expr[i],t.expr[i]);if(n!==0)return n}return 0}equals(t){if(t.type===this.type){if(this.expr.length!==t.expr.length)return!1;for(let i=0,r=this.expr.length;i<r;i++)if(!this.expr[i].equals(t.expr[i]))return!1;return!0}return!1}substituteConstants(){const t=nx(this.expr);return t===this.expr?this:Qa.create(t,this.negated,!1)}evaluate(t){for(let i=0,r=this.expr.length;i<r;i++)if(!this.expr[i].evaluate(t))return!1;return!0}static _normalizeArr(t,i,r){const n=[];let s=!1;for(const o of t)if(o){if(o.type===1){s=!0;continue}if(o.type===0)return hi.INSTANCE;if(o.type===6){n.push(...o.expr);continue}n.push(o)}if(n.length===0&&s)return Pi.INSTANCE;if(n.length!==0){if(n.length===1)return n[0];n.sort(wl);for(let o=1;o<n.length;o++)n[o-1].equals(n[o])&&(n.splice(o,1),o--);if(n.length===1)return n[0];for(;n.length>1;){const o=n[n.length-1];if(o.type!==9)break;n.pop();const a=n.pop(),l=n.length===0,c=Qg.create(o.expr.map(u=>Qa.create([u,a],null,r)),null,l);c&&(n.push(c),n.sort(wl))}if(n.length===1)return n[0];if(r){for(let o=0;o<n.length;o++)for(let a=o+1;a<n.length;a++)if(n[o].negate().equals(n[a]))return hi.INSTANCE;if(n.length===1)return n[0]}return new Qa(n,i)}}serialize(){return this.expr.map(t=>t.serialize()).join(" && ")}keys(){const t=[];for(const i of this.expr)t.push(...i.keys());return t}map(t){return new Qa(this.expr.map(i=>i.map(t)),null)}negate(){if(!this.negated){const t=[];for(const i of this.expr)t.push(i.negate());this.negated=Qg.create(t,this,!0)}return this.negated}},Qg=class ho{static create(t,i,r){return ho._normalizeArr(t,i,r)}constructor(t,i){this.expr=t,this.negated=i,this.type=9}cmp(t){if(t.type!==this.type)return this.type-t.type;if(this.expr.length<t.expr.length)return-1;if(this.expr.length>t.expr.length)return 1;for(let i=0,r=this.expr.length;i<r;i++){const n=wl(this.expr[i],t.expr[i]);if(n!==0)return n}return 0}equals(t){if(t.type===this.type){if(this.expr.length!==t.expr.length)return!1;for(let i=0,r=this.expr.length;i<r;i++)if(!this.expr[i].equals(t.expr[i]))return!1;return!0}return!1}substituteConstants(){const t=nx(this.expr);return t===this.expr?this:ho.create(t,this.negated,!1)}evaluate(t){for(let i=0,r=this.expr.length;i<r;i++)if(this.expr[i].evaluate(t))return!0;return!1}static _normalizeArr(t,i,r){let n=[],s=!1;if(t){for(let o=0,a=t.length;o<a;o++){const l=t[o];if(l){if(l.type===0){s=!0;continue}if(l.type===1)return Pi.INSTANCE;if(l.type===9){n=n.concat(l.expr);continue}n.push(l)}}if(n.length===0&&s)return hi.INSTANCE;n.sort(wl)}if(n.length!==0){if(n.length===1)return n[0];for(let o=1;o<n.length;o++)n[o-1].equals(n[o])&&(n.splice(o,1),o--);if(n.length===1)return n[0];if(r){for(let o=0;o<n.length;o++)for(let a=o+1;a<n.length;a++)if(n[o].negate().equals(n[a]))return Pi.INSTANCE;if(n.length===1)return n[0]}return new ho(n,i)}}serialize(){return this.expr.map(t=>t.serialize()).join(" || ")}keys(){const t=[];for(const i of this.expr)t.push(...i.keys());return t}map(t){return new ho(this.expr.map(i=>i.map(t)),null)}negate(){if(!this.negated){const t=[];for(const i of this.expr)t.push(i.negate());for(;t.length>1;){const i=t.shift(),r=t.shift(),n=[];for(const s of ax(i))for(const o of ax(r))n.push(sx.create([s,o],null,!1));t.unshift(ho.create(n,null,!1))}this.negated=ho.create(t,this,!0)}return this.negated}},I=class Op extends yl{static{this._info=[]}static all(){return Op._info.values()}constructor(t,i,r){super(t,null),this._defaultValue=i,typeof r=="object"?Op._info.push({...r,key:t}):r!==!0&&Op._info.push({key:t,description:r,type:i!=null?typeof i:void 0})}bindTo(t){return t.createKey(this.key,this._defaultValue)}getValue(t){return t.getContextKeyValue(this.key)}toNegated(){return this.negate()}isEqualTo(t){return Wg.create(this.key,t)}notEqualsTo(t){return Vg.create(this.key,t)}greater(t){return td.create(this.key,t)}},Jg=U("contextKeyService");function ox(e,t){return e<t?-1:e>t?1:0}function _s(e,t,i,r){return e<i?-1:e>i?1:t<r?-1:t>r?1:0}function ax(e){return e.type===9?e.expr:[e]}var qe=U("logService"),xl=U("loggerService"),Ee;(function(e){e[e.Off=0]="Off",e[e.Trace=1]="Trace",e[e.Debug=2]="Debug",e[e.Info=3]="Info",e[e.Warning=4]="Warning",e[e.Error=5]="Error"})(Ee||(Ee={}));var o8=Ee.Info;function a8(e,t){return e!==Ee.Off&&e<=t}function l8(e,t,i){switch(t){case Ee.Trace:e.trace(i);break;case Ee.Debug:e.debug(i);break;case Ee.Info:e.info(i);break;case Ee.Warning:e.warn(i);break;case Ee.Error:e.error(i);break;case Ee.Off:break;default:throw new Error(`Invalid log level ${t}`)}}function No(e,t=!1){let i="";for(let r=0;r<e.length;r++){let n=e[r];if(n instanceof Error&&(n=Lo(n,t)),typeof n=="object")try{n=JSON.stringify(n)}catch{}i+=(r>0?" ":"")+n}return i}var lx=class extends se{constructor(){super(...arguments),this.level=o8,this._onDidChangeLogLevel=this._register(new P),this.onDidChangeLogLevel=this._onDidChangeLogLevel.event}setLevel(e){this.level!==e&&(this.level=e,this._onDidChangeLogLevel.fire(this.level))}getLevel(){return this.level}checkLogLevel(e){return a8(this.level,e)}canLog(e){return this._store.isDisposed?!1:this.checkLogLevel(e)}},cx=class extends lx{constructor(e){super(),this.logAlways=e}checkLogLevel(e){return this.logAlways||super.checkLogLevel(e)}trace(e,...t){this.canLog(Ee.Trace)&&this.log(Ee.Trace,No([e,...t],!0))}debug(e,...t){this.canLog(Ee.Debug)&&this.log(Ee.Debug,No([e,...t]))}info(e,...t){this.canLog(Ee.Info)&&this.log(Ee.Info,No([e,...t]))}warn(e,...t){this.canLog(Ee.Warning)&&this.log(Ee.Warning,No([e,...t]))}error(e,...t){if(this.canLog(Ee.Error))if(e instanceof Error){const i=Array.prototype.slice.call(arguments);i[0]=e.stack,this.log(Ee.Error,No(i))}else this.log(Ee.Error,No([e,...t]))}flush(){}},c8=class extends lx{constructor(e){super(),this.loggers=e,e.length&&this.setLevel(e[0].getLevel())}setLevel(e){for(const t of this.loggers)t.setLevel(e);super.setLevel(e)}trace(e,...t){for(const i of this.loggers)i.trace(e,...t)}debug(e,...t){for(const i of this.loggers)i.debug(e,...t)}info(e,...t){for(const i of this.loggers)i.info(e,...t)}warn(e,...t){for(const i of this.loggers)i.warn(e,...t)}error(e,...t){for(const i of this.loggers)i.error(e,...t)}flush(){for(const e of this.loggers)e.flush()}dispose(){for(const e of this.loggers)e.dispose();super.dispose()}},u8=class extends se{constructor(e,t,i){if(super(),this.logLevel=e,this.logsHome=t,this._loggers=new Ft,this._onDidChangeLoggers=this._register(new P),this.onDidChangeLoggers=this._onDidChangeLoggers.event,this._onDidChangeLogLevel=this._register(new P),this.onDidChangeLogLevel=this._onDidChangeLogLevel.event,this._onDidChangeVisibility=this._register(new P),this.onDidChangeVisibility=this._onDidChangeVisibility.event,i)for(const r of i)this._loggers.set(r.resource,{logger:void 0,info:r})}getLoggerEntry(e){return Me(e)?[...this._loggers.values()].find(t=>t.info.id===e):this._loggers.get(e)}getLogger(e){return this.getLoggerEntry(e)?.logger}createLogger(e,t){const i=this.toResource(e),r=Me(e)?e:t?.id??ml(i.toString()).toString(16);let n=this._loggers.get(i)?.logger;const s=t?.logLevel==="always"?Ee.Trace:t?.logLevel;n||(n=this.doCreateLogger(i,s??this.getLogLevel(i)??this.logLevel,{...t,id:r}));const o={logger:n,info:{resource:i,id:r,logLevel:s,name:t?.name,hidden:t?.hidden,group:t?.group,extensionId:t?.extensionId,when:t?.when}};return this.registerLogger(o.info),this._loggers.set(i,o),n}toResource(e){return Me(e)?Zt(this.logsHome,`${e}.log`):e}setLogLevel(e,t){if(y.isUri(e)){const i=e,r=t,n=this._loggers.get(i);n&&r!==n.info.logLevel&&(n.info.logLevel=r===this.logLevel?void 0:r,n.logger?.setLevel(r),this._loggers.set(n.info.resource,n),this._onDidChangeLogLevel.fire([i,r]))}else{this.logLevel=e;for(const[i,r]of this._loggers.entries())this._loggers.get(i)?.info.logLevel===void 0&&r.logger?.setLevel(this.logLevel);this._onDidChangeLogLevel.fire(this.logLevel)}}setVisibility(e,t){const i=this.getLoggerEntry(e);i&&t!==!i.info.hidden&&(i.info.hidden=!t,this._loggers.set(i.info.resource,i),this._onDidChangeVisibility.fire([i.info.resource,t]))}getLogLevel(e){let t;return e&&(t=this._loggers.get(e)?.info.logLevel),t??this.logLevel}registerLogger(e){const t=this._loggers.get(e.resource);t?t.info.hidden!==e.hidden&&this.setVisibility(e.resource,!e.hidden):(this._loggers.set(e.resource,{info:e,logger:void 0}),this._onDidChangeLoggers.fire({added:[e],removed:[]}))}deregisterLogger(e){const t=this.toResource(e),i=this._loggers.get(t);i&&(i.logger&&i.logger.dispose(),this._loggers.delete(t),this._onDidChangeLoggers.fire({added:[],removed:[i.info]}))}*getRegisteredLoggers(){for(const e of this._loggers.values())yield e.info}getRegisteredLogger(e){return this._loggers.get(e)?.info}dispose(){this._loggers.forEach(e=>e.logger?.dispose()),this._loggers.clear(),super.dispose()}};function d8(e){switch(e){case Ee.Trace:return"trace";case Ee.Debug:return"debug";case Ee.Info:return"info";case Ee.Warning:return"warn";case Ee.Error:return"error";case Ee.Off:return"off"}}function h8(e){switch(e){case"trace":return Ee.Trace;case"debug":return Ee.Debug;case"info":return Ee.Info;case"warn":return Ee.Warning;case"error":return Ee.Error;case"critical":return Ee.Error;case"off":return Ee.Off}}var LU=new I("logLevel",d8(Ee.Info)),Ir=class{constructor(e,t=[],i=!1){this.ctor=e,this.staticArguments=t,this.supportsDelayedInstantiation=i}},ux=[],dx;(function(e){e[e.Eager=0]="Eager",e[e.Delayed=1]="Delayed"})(dx||(dx={}));function Ze(e,t,i){t instanceof Ir||(t=new Ir(t,[],!!i)),ux.push([e,t])}function f8(){return ux}var Xg=class{constructor(...e){this._entries=new Map;for(const[t,i]of e)this.set(t,i)}set(e,t){const i=this._entries.get(e);return this._entries.set(e,t),i}has(e){return this._entries.has(e)}get(e){return this._entries.get(e)}},Yt=U("IExtHostInitDataService"),p8=class{constructor(e,t){this.key=e,this.data=t,this.incoming=new Map,this.outgoing=new Map}},hx=class{constructor(e){this._hashFn=e,this._nodes=new Map}roots(){const e=[];for(const t of this._nodes.values())t.outgoing.size===0&&e.push(t);return e}insertEdge(e,t){const i=this.lookupOrInsertNode(e),r=this.lookupOrInsertNode(t);i.outgoing.set(r.key,r),r.incoming.set(i.key,i)}removeNode(e){const t=this._hashFn(e);this._nodes.delete(t);for(const i of this._nodes.values())i.outgoing.delete(t),i.incoming.delete(t)}lookupOrInsertNode(e){const t=this._hashFn(e);let i=this._nodes.get(t);return i||(i=new p8(t,e),this._nodes.set(t,i)),i}lookup(e){return this._nodes.get(this._hashFn(e))}isEmpty(){return this._nodes.size===0}toString(){const e=[];for(const[t,i]of this._nodes)e.push(`${t}
	(-> incoming)[${[...i.incoming.keys()].join(", ")}]
	(outgoing ->)[${[...i.outgoing.keys()].join(",")}]
`);return e.join(`
`)}findCycleSlow(){for(const[e,t]of this._nodes){const i=new Set([e]),r=this._findCycle(t,i);if(r)return r}}_findCycle(e,t){for(const[i,r]of e.outgoing){if(t.has(i))return[...t,i].join(" -> ");t.add(i);const n=this._findCycle(r,t);if(n)return n;t.delete(i)}}},g8=!1,fx=class extends Error{constructor(e){super("cyclic dependency between services"),this.message=e.findCycleSlow()??`UNABLE to detect cycle, dumping graph: 
${e.toString()}`}},m8=class Cw{constructor(t=new Xg,i=!1,r,n=g8){this._services=t,this._strict=i,this._parent=r,this._enableTracing=n,this._isDisposed=!1,this._servicesToMaybeDispose=new Set,this._children=new Set,this._activeInstantiations=new Set,this._services.set(gl,this),this._globalGraph=n?r?._globalGraph??new hx(s=>s):void 0}dispose(){if(!this._isDisposed){this._isDisposed=!0,zr(this._children),this._children.clear();for(const t of this._servicesToMaybeDispose)hy(t)&&t.dispose();this._servicesToMaybeDispose.clear()}}_throwIfDisposed(){if(this._isDisposed)throw new Error("InstantiationService has been disposed")}createChild(t,i){this._throwIfDisposed();const r=this,n=new class extends Cw{dispose(){r._children.delete(n),super.dispose()}}(t,this._strict,this,this._enableTracing);return this._children.add(n),i?.add(n),n}invokeFunction(t,...i){this._throwIfDisposed();const r=Zg.traceInvocation(this._enableTracing,t);let n=!1;try{return t({get:o=>{if(n)throw Yp("service accessor is only valid during the invocation of its target method");const a=this._getOrCreateServiceInstance(o,r);if(!a)throw new Error(`[invokeFunction] unknown service '${o}'`);return a}},...i)}finally{n=!0,r.stop()}}createInstance(t,...i){this._throwIfDisposed();let r,n;return t instanceof Ir?(r=Zg.traceCreation(this._enableTracing,t.ctor),n=this._createInstance(t.ctor,t.staticArguments.concat(i),r)):(r=Zg.traceCreation(this._enableTracing,t),n=this._createInstance(t,i,r)),r.stop(),n}_createInstance(t,i=[],r){const n=or.getServiceDependencies(t).sort((a,l)=>a.index-l.index),s=[];for(const a of n){const l=this._getOrCreateServiceInstance(a.id,r);l||this._throwIfStrict(`[createInstance] ${t.name} depends on UNKNOWN service ${a.id}.`,!1),s.push(l)}const o=n.length>0?n[0].index:i.length;if(i.length!==o){console.trace(`[createInstance] First service dependency of ${t.name} at position ${o+1} conflicts with ${i.length} static arguments`);const a=o-i.length;a>0?i=i.concat(new Array(a)):i=i.slice(0,o)}return Reflect.construct(t,i.concat(s))}_setCreatedServiceInstance(t,i){if(this._services.get(t)instanceof Ir)this._services.set(t,i);else if(this._parent)this._parent._setCreatedServiceInstance(t,i);else throw new Error("illegalState - setting UNKNOWN service instance")}_getServiceInstanceOrDescriptor(t){const i=this._services.get(t);return!i&&this._parent?this._parent._getServiceInstanceOrDescriptor(t):i}_getOrCreateServiceInstance(t,i){this._globalGraph&&this._globalGraphImplicitDependency&&this._globalGraph.insertEdge(this._globalGraphImplicitDependency,String(t));const r=this._getServiceInstanceOrDescriptor(t);return r instanceof Ir?this._safeCreateAndCacheServiceInstance(t,r,i.branch(t,!0)):(i.branch(t,!1),r)}_safeCreateAndCacheServiceInstance(t,i,r){if(this._activeInstantiations.has(t))throw new Error(`illegal state - RECURSIVELY instantiating service '${t}'`);this._activeInstantiations.add(t);try{return this._createAndCacheServiceInstance(t,i,r)}finally{this._activeInstantiations.delete(t)}}_createAndCacheServiceInstance(t,i,r){const n=new hx(l=>l.id.toString());let s=0;const o=[{id:t,desc:i,_trace:r}],a=new Set;for(;o.length;){const l=o.pop();if(!a.has(String(l.id))){if(a.add(String(l.id)),n.lookupOrInsertNode(l),s++>1e3)throw new fx(n);for(const c of or.getServiceDependencies(l.desc.ctor)){const u=this._getServiceInstanceOrDescriptor(c.id);if(u||this._throwIfStrict(`[createInstance] ${t} depends on ${c.id} which is NOT registered.`,!0),this._globalGraph?.insertEdge(String(l.id),String(c.id)),u instanceof Ir){const d={id:c.id,desc:u,_trace:l._trace.branch(c.id,!0)};n.insertEdge(l,d),o.push(d)}}}}for(;;){const l=n.roots();if(l.length===0){if(!n.isEmpty())throw new fx(n);break}for(const{data:c}of l){if(this._getServiceInstanceOrDescriptor(c.id)instanceof Ir){const d=this._createServiceInstanceWithOwner(c.id,c.desc.ctor,c.desc.staticArguments,c.desc.supportsDelayedInstantiation,c._trace);this._setCreatedServiceInstance(c.id,d)}n.removeNode(c)}}return this._getServiceInstanceOrDescriptor(t)}_createServiceInstanceWithOwner(t,i,r=[],n,s){if(this._services.get(t)instanceof Ir)return this._createServiceInstance(t,i,r,n,s,this._servicesToMaybeDispose);if(this._parent)return this._parent._createServiceInstanceWithOwner(t,i,r,n,s);throw new Error(`illegalState - creating UNKNOWN service instance ${i.name}`)}_createServiceInstance(t,i,r=[],n,s,o){if(n){const a=new Cw(void 0,this._strict,this,this._enableTracing);a._globalGraphImplicitDependency=String(t);const l=new Map,c=new NT(()=>{const u=a._createInstance(i,r,s);for(const[d,f]of l){const p=u[d];if(typeof p=="function")for(const m of f)m.disposable=p.apply(u,m.listener)}return l.clear(),o.add(u),u});return new Proxy(Object.create(null),{get(u,d){if(!c.isInitialized&&typeof d=="string"&&(d.startsWith("onDid")||d.startsWith("onWill"))){let m=l.get(d);return m||(m=new Dn,l.set(d,m)),(b,E,C)=>{if(c.isInitialized)return c.value[d](b,E,C);{const T={listener:[b,E,C],disposable:void 0},j=m.push(T);return ne(()=>{j(),T.disposable?.dispose()})}}}if(d in u)return u[d];const f=c.value;let p=f[d];return typeof p!="function"||(p=p.bind(f),u[d]=p),p},set(u,d,f){return c.value[d]=f,!0},getPrototypeOf(u){return i.prototype}})}else{const a=this._createInstance(i,r,s);return o.add(a),a}}_throwIfStrict(t,i){if(i&&console.warn(t),this._strict)throw new Error(t)}},px;(function(e){e[e.None=0]="None",e[e.Creation=1]="Creation",e[e.Invocation=2]="Invocation",e[e.Branch=3]="Branch"})(px||(px={}));var Zg=class Hr{static{this.all=new Set}static{this._None=new class extends Hr{constructor(){super(0,null)}stop(){}branch(){return this}}}static traceInvocation(t,i){return t?new Hr(2,i.name||new Error().stack.split(`
`).slice(3,4).join(`
`)):Hr._None}static traceCreation(t,i){return t?new Hr(1,i.name):Hr._None}static{this._totals=0}constructor(t,i){this.type=t,this.name=i,this._start=Date.now(),this._dep=[]}branch(t,i){const r=new Hr(3,t.toString());return this._dep.push([t,i,r]),r}stop(){const t=Date.now()-this._start;Hr._totals+=t;let i=!1;function r(s,o){const a=[],l=new Array(s+1).join("	");for(const[c,u,d]of o._dep)if(u&&d){i=!0,a.push(`${l}CREATES -> ${c}`);const f=r(s+1,d);f&&a.push(f)}else a.push(`${l}uses -> ${c}`);return a.join(`
`)}const n=[`${this.type===1?"CREATE":"CALL"} ${this.name}`,`${r(1,this)}`,`DONE, took ${t.toFixed(2)}ms (grand total ${Hr._totals.toFixed(2)}ms)`];(t>2||i)&&Hr.all.add(n.join(`
`))}},Ue=U("IExtHostRpcService"),v8=class{constructor(e){this.getProxy=e.getProxy.bind(e),this.set=e.set.bind(e),this.dispose=e.dispose.bind(e),this.assertRegistered=e.assertRegistered.bind(e),this.drain=e.drain.bind(e)}},id=U("IURITransformerService"),_8=class{constructor(e){e?(this.transformIncoming=e.transformIncoming.bind(e),this.transformOutgoing=e.transformOutgoing.bind(e),this.transformOutgoingURI=e.transformOutgoingURI.bind(e),this.transformOutgoingScheme=e.transformOutgoingScheme.bind(e)):(this.transformIncoming=t=>t,this.transformOutgoing=t=>t,this.transformOutgoingURI=t=>t,this.transformOutgoingScheme=t=>t)}},w8=class{constructor(){this._value="",this._pos=0}reset(e){return this._value=e,this._pos=0,this}next(){return this._pos+=1,this}hasNext(){return this._pos<this._value.length-1}cmp(e){const t=e.charCodeAt(0),i=this._value.charCodeAt(this._pos);return t-i}value(){return this._value[this._pos]}},y8=class{constructor(e=!0){this._caseSensitive=e}reset(e){return this._value=e,this._from=0,this._to=0,this.next()}hasNext(){return this._to<this._value.length}next(){this._from=this._to;let e=!0;for(;this._to<this._value.length;this._to++)if(this._value.charCodeAt(this._to)===46)if(e)this._from++;else break;else e=!1;return this}cmp(e){return this._caseSensitive?Ig(e,this._value,0,e.length,this._from,this._to):dl(e,this._value,0,e.length,this._from,this._to)}value(){return this._value.substring(this._from,this._to)}},gx=class{constructor(e=!0,t=!0){this._splitOnBackslash=e,this._caseSensitive=t}reset(e){this._from=0,this._to=0,this._value=e,this._valueLen=e.length;for(let t=e.length-1;t>=0;t--,this._valueLen--){const i=this._value.charCodeAt(t);if(!(i===47||this._splitOnBackslash&&i===92))break}return this.next()}hasNext(){return this._to<this._valueLen}next(){this._from=this._to;let e=!0;for(;this._to<this._valueLen;this._to++){const t=this._value.charCodeAt(this._to);if(t===47||this._splitOnBackslash&&t===92)if(e)this._from++;else break;else e=!1}return this}cmp(e){return this._caseSensitive?Ig(e,this._value,0,e.length,this._from,this._to):dl(e,this._value,0,e.length,this._from,this._to)}value(){return this._value.substring(this._from,this._to)}},mx;(function(e){e[e.Scheme=1]="Scheme",e[e.Authority=2]="Authority",e[e.Path=3]="Path",e[e.Query=4]="Query",e[e.Fragment=5]="Fragment"})(mx||(mx={}));var vx=class{constructor(e,t){this._ignorePathCasing=e,this._ignoreQueryAndFragment=t,this._states=[],this._stateIdx=0}reset(e){return this._value=e,this._states=[],this._value.scheme&&this._states.push(1),this._value.authority&&this._states.push(2),this._value.path&&(this._pathIterator=new gx(!1,!this._ignorePathCasing(e)),this._pathIterator.reset(e.path),this._pathIterator.value()&&this._states.push(3)),this._ignoreQueryAndFragment(e)||(this._value.query&&this._states.push(4),this._value.fragment&&this._states.push(5)),this._stateIdx=0,this}next(){return this._states[this._stateIdx]===3&&this._pathIterator.hasNext()?this._pathIterator.next():this._stateIdx+=1,this}hasNext(){return this._states[this._stateIdx]===3&&this._pathIterator.hasNext()||this._stateIdx<this._states.length-1}cmp(e){if(this._states[this._stateIdx]===1)return kg(e,this._value.scheme);if(this._states[this._stateIdx]===2)return kg(e,this._value.authority);if(this._states[this._stateIdx]===3)return this._pathIterator.cmp(e);if(this._states[this._stateIdx]===4)return gs(e,this._value.query);if(this._states[this._stateIdx]===5)return gs(e,this._value.fragment);throw new Error}value(){if(this._states[this._stateIdx]===1)return this._value.scheme;if(this._states[this._stateIdx]===2)return this._value.authority;if(this._states[this._stateIdx]===3)return this._pathIterator.value();if(this._states[this._stateIdx]===4)return this._value.query;if(this._states[this._stateIdx]===5)return this._value.fragment;throw new Error}},ws=class Dw{static{this.Val=Symbol("undefined_placeholder")}static wrap(t){return t===void 0?Dw.Val:t}static unwrap(t){return t===Dw.Val?void 0:t}},rd=class{constructor(){this.height=1,this.value=void 0,this.key=void 0,this.left=void 0,this.mid=void 0,this.right=void 0}isEmpty(){return!this.left&&!this.mid&&!this.right&&this.value===void 0}rotateLeft(){const e=this.right;return this.right=e.left,e.left=this,this.updateHeight(),e.updateHeight(),e}rotateRight(){const e=this.left;return this.left=e.right,e.right=this,this.updateHeight(),e.updateHeight(),e}updateHeight(){this.height=1+Math.max(this.heightLeft,this.heightRight)}balanceFactor(){return this.heightRight-this.heightLeft}get heightLeft(){return this.left?.height??0}get heightRight(){return this.right?.height??0}},_x;(function(e){e[e.Left=-1]="Left",e[e.Mid=0]="Mid",e[e.Right=1]="Right"})(_x||(_x={}));var Rn=class _u{static forUris(t=()=>!1,i=()=>!1){return new _u(new vx(t,i))}static forPaths(t=!1){return new _u(new gx(void 0,!t))}static forStrings(){return new _u(new w8)}static forConfigKeys(){return new _u(new y8)}constructor(t){this._iter=t}clear(){this._root=void 0}fill(t,i){if(i){const r=i.slice(0);Kw(r);for(const n of r)this.set(n,t)}else{const r=t.slice(0);Kw(r);for(const n of r)this.set(n[0],n[1])}}set(t,i){const r=this._iter.reset(t);let n;this._root||(this._root=new rd,this._root.segment=r.value());const s=[];for(n=this._root;;){const a=r.cmp(n.segment);if(a>0)n.left||(n.left=new rd,n.left.segment=r.value()),s.push([-1,n]),n=n.left;else if(a<0)n.right||(n.right=new rd,n.right.segment=r.value()),s.push([1,n]),n=n.right;else if(r.hasNext())r.next(),n.mid||(n.mid=new rd,n.mid.segment=r.value()),s.push([0,n]),n=n.mid;else break}const o=ws.unwrap(n.value);n.value=ws.wrap(i),n.key=t;for(let a=s.length-1;a>=0;a--){const l=s[a][1];l.updateHeight();const c=l.balanceFactor();if(c<-1||c>1){const u=s[a][0],d=s[a+1][0];if(u===1&&d===1)s[a][1]=l.rotateLeft();else if(u===-1&&d===-1)s[a][1]=l.rotateRight();else if(u===1&&d===-1)l.right=s[a+1][1]=s[a+1][1].rotateRight(),s[a][1]=l.rotateLeft();else if(u===-1&&d===1)l.left=s[a+1][1]=s[a+1][1].rotateLeft(),s[a][1]=l.rotateRight();else throw new Error;if(a>0)switch(s[a-1][0]){case-1:s[a-1][1].left=s[a][1];break;case 1:s[a-1][1].right=s[a][1];break;case 0:s[a-1][1].mid=s[a][1];break}else this._root=s[0][1]}}return o}get(t){return ws.unwrap(this._getNode(t)?.value)}_getNode(t){const i=this._iter.reset(t);let r=this._root;for(;r;){const n=i.cmp(r.segment);if(n>0)r=r.left;else if(n<0)r=r.right;else if(i.hasNext())i.next(),r=r.mid;else break}return r}has(t){const i=this._getNode(t);return!(i?.value===void 0&&i?.mid===void 0)}delete(t){return this._delete(t,!1)}deleteSuperstr(t){return this._delete(t,!0)}_delete(t,i){const r=this._iter.reset(t),n=[];let s=this._root;for(;s;){const o=r.cmp(s.segment);if(o>0)n.push([-1,s]),s=s.left;else if(o<0)n.push([1,s]),s=s.right;else if(r.hasNext())r.next(),n.push([0,s]),s=s.mid;else break}if(s){if(i?(s.left=void 0,s.mid=void 0,s.right=void 0,s.height=1):(s.key=void 0,s.value=void 0),!s.mid&&!s.value)if(s.left&&s.right){const o=[[1,s]],a=this._min(s.right,o);if(a.key){s.key=a.key,s.value=a.value,s.segment=a.segment;const l=a.right;if(o.length>1){const[u,d]=o[o.length-1];switch(u){case-1:d.left=l;break;case 0:ag(!1);case 1:ag(!1)}}else s.right=l;const c=this._balanceByStack(o);if(n.length>0){const[u,d]=n[n.length-1];switch(u){case-1:d.left=c;break;case 0:d.mid=c;break;case 1:d.right=c;break}}else this._root=c}}else{const o=s.left??s.right;if(n.length>0){const[a,l]=n[n.length-1];switch(a){case-1:l.left=o;break;case 0:l.mid=o;break;case 1:l.right=o;break}}else this._root=o}this._root=this._balanceByStack(n)??this._root}}_min(t,i){for(;t.left;)i.push([-1,t]),t=t.left;return t}_balanceByStack(t){for(let i=t.length-1;i>=0;i--){const r=t[i][1];r.updateHeight();const n=r.balanceFactor();if(n>1?(r.right.balanceFactor()>=0||(r.right=r.right.rotateRight()),t[i][1]=r.rotateLeft()):n<-1&&(r.left.balanceFactor()<=0||(r.left=r.left.rotateLeft()),t[i][1]=r.rotateRight()),i>0)switch(t[i-1][0]){case-1:t[i-1][1].left=t[i][1];break;case 1:t[i-1][1].right=t[i][1];break;case 0:t[i-1][1].mid=t[i][1];break}else return t[0][1]}}findSubstr(t){const i=this._iter.reset(t);let r=this._root,n;for(;r;){const s=i.cmp(r.segment);if(s>0)r=r.left;else if(s<0)r=r.right;else if(i.hasNext())i.next(),n=ws.unwrap(r.value)||n,r=r.mid;else break}return r&&ws.unwrap(r.value)||n}findSuperstr(t){return this._findSuperstrOrElement(t,!1)}_findSuperstrOrElement(t,i){const r=this._iter.reset(t);let n=this._root;for(;n;){const s=r.cmp(n.segment);if(s>0)n=n.left;else if(s<0)n=n.right;else if(r.hasNext())r.next(),n=n.mid;else return n.mid?this._entries(n.mid):i?ws.unwrap(n.value):void 0}}hasElementOrSubtree(t){return this._findSuperstrOrElement(t,!0)!==void 0}forEach(t){for(const[i,r]of this)t(r,i)}*[Symbol.iterator](){yield*this._entries(this._root)}_entries(t){const i=[];return this._dfsEntries(t,i),i[Symbol.iterator]()}_dfsEntries(t,i){t&&(t.left&&this._dfsEntries(t.left,i),t.value!==void 0&&i.push([t.key,ws.unwrap(t.value)]),t.mid&&this._dfsEntries(t.mid,i),t.right&&this._dfsEntries(t.right,i))}_isBalanced(){const t=i=>{if(!i)return!0;const r=i.balanceFactor();return r<-1||r>1?!1:t(i.left)&&t(i.right)};return t(this._root)}};function nt(e){if(!e||typeof e!="object"||e instanceof RegExp)return e;const t=Array.isArray(e)?[]:{};return Object.entries(e).forEach(([i,r])=>{t[i]=r&&typeof r=="object"?nt(r):r}),t}function wx(e){if(!e||typeof e!="object")return e;const t=[e];for(;t.length>0;){const i=t.shift();Object.freeze(i);for(const r in i)if(yx.call(i,r)){const n=i[r];typeof n=="object"&&!Object.isFrozen(n)&&!v9(n)&&t.push(n)}}return e}var yx=Object.prototype.hasOwnProperty;function Mo(e,t){return Kg(e,t,new Set)}function Kg(e,t,i){if(Et(e))return e;const r=t(e);if(typeof r<"u")return r;if(Array.isArray(e)){const n=[];for(const s of e)n.push(Kg(s,t,i));return n}if(St(e)){if(i.has(e))throw new Error("Cannot clone recursive data-structure");i.add(e);const n={};for(const s in e)yx.call(e,s)&&(n[s]=Kg(e[s],t,i));return i.delete(e),n}return e}function ys(e,t,i=!0){return St(e)?(St(t)&&Object.keys(t).forEach(r=>{r in e?i&&(St(e[r])&&St(t[r])?ys(e[r],t[r],i):e[r]=t[r]):e[r]=t[r]}),e):t}function fi(e,t){if(e===t)return!0;if(e==null||t===null||t===void 0||typeof e!=typeof t||typeof e!="object"||Array.isArray(e)!==Array.isArray(t))return!1;let i,r;if(Array.isArray(e)){if(e.length!==t.length)return!1;for(i=0;i<e.length;i++)if(!fi(e[i],t[i]))return!1}else{const n=[];for(r in e)n.push(r);n.sort();const s=[];for(r in t)s.push(r);if(s.sort(),!fi(n,s))return!1;for(i=0;i<n.length;i++)if(!fi(e[n[i]],t[n[i]]))return!1}return!0}function b8(e){const t=new Set;return JSON.stringify(e,(i,r)=>{if(St(r)||Array.isArray(r)){if(t.has(r))return"[Circular]";t.add(r)}return typeof r=="bigint"?`[BigInt ${r.toString()}]`:r})}function bx(e,t){const i=Object.create(null);for(const[r,n]of Object.entries(e))t(r,n)&&(i[r]=n);return i}var x8=class{constructor(){this._next=0}getNext(){return this._next++}},Sl;(function(e){e[e.Ignore=0]="Ignore",e[e.Info=1]="Info",e[e.Warning=2]="Warning",e[e.Error=3]="Error"})(Sl||(Sl={})),function(e){const t="error",i="warning",r="warn",n="info",s="ignore";function o(l){return l?Pn(t,l)?e.Error:Pn(i,l)||Pn(r,l)?e.Warning:Pn(n,l)?e.Info:e.Ignore:e.Ignore}e.fromValue=o;function a(l){switch(l){case e.Error:return t;case e.Warning:return i;case e.Info:return n;default:return s}}e.toString=a}(Sl||(Sl={}));var bt=Sl,S8=bt,NU=U("notificationService"),xx;(function(e){e[e.DEFAULT=0]="DEFAULT",e[e.OPTIONAL=1]="OPTIONAL",e[e.SILENT=2]="SILENT",e[e.URGENT=3]="URGENT"})(xx||(xx={}));var Sx;(function(e){e[e.WORKSPACE=0]="WORKSPACE",e[e.PROFILE=1]="PROFILE",e[e.APPLICATION=2]="APPLICATION"})(Sx||(Sx={}));var Ex;(function(e){e[e.OFF=0]="OFF",e[e.ERROR=1]="ERROR"})(Ex||(Ex={}));var Yg=U("contextService");function E8(e){const t=e;return typeof t?.id=="string"&&y.isUri(t.uri)}function C8(e){const t=e;return typeof t?.id=="string"&&y.isUri(t.configPath)}var Cx;(function(e){e[e.EMPTY=1]="EMPTY",e[e.FOLDER=2]="FOLDER",e[e.WORKSPACE=3]="WORKSPACE"})(Cx||(Cx={}));var D8=class{get folders(){return this._folders}set folders(e){this._folders=e,this.updateFoldersMap()}constructor(e,t,i,r,n){this._id=e,this._transient=i,this._configuration=r,this.ignorePathCasing=n,this.foldersMap=Rn.forUris(this.ignorePathCasing,()=>!0),this.folders=t}update(e){this._id=e.id,this._configuration=e.configuration,this._transient=e.transient,this.ignorePathCasing=e.ignorePathCasing,this.folders=e.folders}get id(){return this._id}get transient(){return this._transient}get configuration(){return this._configuration}set configuration(e){this._configuration=e}getFolder(e){return e&&this.foldersMap.findSubstr(e)||null}updateFoldersMap(){this.foldersMap=Rn.forUris(this.ignorePathCasing,()=>!0);for(const e of this.folders)this.foldersMap.set(e.uri,e)}toJSON(){return{id:this.id,folders:this.folders,transient:this.transient,configuration:this.configuration}}},Dx=class{constructor(e,t){this.raw=t,this.uri=e.uri,this.index=e.index,this.name=e.name}toResource(e){return Zt(this.uri,e)}toJSON(){return{uri:this.uri,name:this.name,index:this.index}}};function em(e){return new Dx({uri:e,index:0,name:Lg(e)},{uri:e.toString()})}var Ix="code-workspace",MU=`.${Ix}`,OU=[{name:h(2684,null),extensions:[Ix]}],I8=class{constructor(){this._systemSchemes=new Set(Object.keys(V)),this._providerInfo=new Map,this.extUri=new hl(e=>{const t=this._providerInfo.get(e.scheme);return!(t===void 0||t&1024)})}$acceptProviderInfos(e,t){t===null?this._providerInfo.delete(e.scheme):this._providerInfo.set(e.scheme,t)}isFreeScheme(e){return!this._providerInfo.has(e)&&!this._systemSchemes.has(e)}getCapabilities(e){return this._providerInfo.get(e)}},Oo=U("IExtHostFileSystemInfo"),$t=function(){if(typeof crypto.randomUUID=="function")return crypto.randomUUID.bind(crypto);const e=new Uint8Array(16),t=[];for(let i=0;i<256;i++)t.push(i.toString(16).padStart(2,"0"));return function(){crypto.getRandomValues(e),e[6]=e[6]&15|64,e[8]=e[8]&63|128;let r=0,n="";return n+=t[e[r++]],n+=t[e[r++]],n+=t[e[r++]],n+=t[e[r++]],n+="-",n+=t[e[r++]],n+=t[e[r++]],n+="-",n+=t[e[r++]],n+=t[e[r++]],n+="-",n+=t[e[r++]],n+=t[e[r++]],n+="-",n+=t[e[r++]],n+=t[e[r++]],n+=t[e[r++]],n+=t[e[r++]],n+=t[e[r++]],n+=t[e[r++]],n}}(),tm=Object.freeze({create:e=>bo(e.map(t=>t.toString())).join(`\r
`),split:e=>e.split(`\r
`),parse:e=>tm.split(e).filter(t=>!t.startsWith("#"))}),FU=new Uint32Array(10),kx;(function(e){e[e.InitialConsonant=4352]="InitialConsonant",e[e.Vowel=4449]="Vowel",e[e.FinalConsonant=4520]="FinalConsonant",e[e.CompatibilityJamo=12593]="CompatibilityJamo"})(kx||(kx={}));var Px;(function(e){e[e.NUL=0]="NUL",e[e.A=65]="A",e[e.B=66]="B",e[e.C=67]="C",e[e.D=68]="D",e[e.E=69]="E",e[e.F=70]="F",e[e.G=71]="G",e[e.H=72]="H",e[e.I=73]="I",e[e.J=74]="J",e[e.K=75]="K",e[e.L=76]="L",e[e.M=77]="M",e[e.N=78]="N",e[e.O=79]="O",e[e.P=80]="P",e[e.Q=81]="Q",e[e.R=82]="R",e[e.S=83]="S",e[e.T=84]="T",e[e.U=85]="U",e[e.V=86]="V",e[e.W=87]="W",e[e.X=88]="X",e[e.Y=89]="Y",e[e.Z=90]="Z",e[e.a=97]="a",e[e.b=98]="b",e[e.c=99]="c",e[e.d=100]="d",e[e.e=101]="e",e[e.f=102]="f",e[e.g=103]="g",e[e.h=104]="h",e[e.i=105]="i",e[e.j=106]="j",e[e.k=107]="k",e[e.l=108]="l",e[e.m=109]="m",e[e.n=110]="n",e[e.o=111]="o",e[e.p=112]="p",e[e.q=113]="q",e[e.r=114]="r",e[e.s=115]="s",e[e.t=116]="t",e[e.u=117]="u",e[e.v=118]="v",e[e.w=119]="w",e[e.x=120]="x",e[e.y=121]="y",e[e.z=122]="z"})(Px||(Px={}));var Tx;(function(e){e[e.fa=24934]="fa",e[e.fg=26470]="fg",e[e.fq=29030]="fq",e[e.fr=29286]="fr",e[e.ft=29798]="ft",e[e.fv=30310]="fv",e[e.fx=30822]="fx",e[e.hk=27496]="hk",e[e.hl=27752]="hl",e[e.ho=28520]="ho",e[e.ml=27757]="ml",e[e.nj=27246]="nj",e[e.nl=27758]="nl",e[e.np=28782]="np",e[e.qt=29809]="qt",e[e.rt=29810]="rt",e[e.sg=26483]="sg",e[e.sw=30579]="sw"})(Tx||(Tx={}));var $U=new Uint8Array([114,82,115,101,69,102,97,113,81,116,84,100,119,87,99,122,120,118,103]),HU=new Uint16Array([107,111,105,79,106,112,117,80,104,27496,28520,27752,121,110,27246,28782,27758,98,109,27757,108]),UU=new Uint16Array([114,82,29810,115,30579,26483,101,102,29286,24934,29030,29798,30822,30310,26470,97,113,29809,116,84,100,119,99,122,120,118,103]),BU=new Uint16Array([114,82,29810,115,30579,26483,101,69,102,29286,24934,29030,29798,30822,30310,26470,97,113,81,29809,116,84,100,119,87,99,122,120,118,103,107,111,105,79,106,112,117,80,104,27496,28520,27752,121,110,27246,28782,27758,98,109,27757,108]);function Ax(...e){return function(t,i){for(let r=0,n=e.length;r<n;r++){const s=e[r](t,i);if(s)return s}return null}}var WU=Lx.bind(void 0,!1),Rx=Lx.bind(void 0,!0);function Lx(e,t,i){if(!i||i.length<t.length)return null;let r;return e?r=Pg(i,t):r=i.indexOf(t)===0,r?t.length>0?[{start:0,end:t.length}]:[]:null}function k8(e,t){const i=t.toLowerCase().indexOf(e.toLowerCase());return i===-1?null:[{start:i,end:i+e.length}]}function P8(e,t){return im(e.toLowerCase(),t.toLowerCase(),0,0)}function im(e,t,i,r){if(i===e.length)return[];if(r===t.length)return null;if(e[i]===t[r]){let n=null;return(n=im(e,t,i+1,r+1))?Mx({start:r,end:r+1},n):null}return im(e,t,i,r+1)}function rm(e){return 97<=e&&e<=122}function nd(e){return 65<=e&&e<=90}function nm(e){return 48<=e&&e<=57}function T8(e){return e===32||e===9||e===10||e===13}var A8=new Set;"()[]{}<>`'\"-/;:,.?!".split("").forEach(e=>A8.add(e.charCodeAt(0)));function Nx(e){return rm(e)||nd(e)||nm(e)}function Mx(e,t){return t.length===0?t=[e]:e.end===t[0].start?t[0].start=e.start:t.unshift(e),t}function Ox(e,t){for(let i=t;i<e.length;i++){const r=e.charCodeAt(i);if(nd(r)||nm(r)||i>0&&!Nx(e.charCodeAt(i-1)))return i}return e.length}function sm(e,t,i,r){if(i===e.length)return[];if(r===t.length)return null;if(e[i]!==t[r].toLowerCase())return null;{let n=null,s=r+1;for(n=sm(e,t,i+1,r+1);!n&&(s=Ox(t,s))<t.length;)n=sm(e,t,i+1,s),s++;return n===null?null:Mx({start:r,end:r+1},n)}}function R8(e){let t=0,i=0,r=0,n=0,s=0;for(let u=0;u<e.length;u++)s=e.charCodeAt(u),nd(s)&&t++,rm(s)&&i++,Nx(s)&&r++,nm(s)&&n++;const o=t/e.length,a=i/e.length,l=r/e.length,c=n/e.length;return{upperPercent:o,lowerPercent:a,alphaPercent:l,numericPercent:c}}function L8(e){const{upperPercent:t,lowerPercent:i}=e;return i===0&&t>.6}function N8(e){const{upperPercent:t,lowerPercent:i,alphaPercent:r,numericPercent:n}=e;return i>.2&&t<.8&&r>.6&&n<.2}function M8(e){let t=0,i=0,r=0,n=0;for(let s=0;s<e.length;s++)r=e.charCodeAt(s),nd(r)&&t++,rm(r)&&i++,T8(r)&&n++;return(t===0||i===0)&&n===0?e.length<=30:t<=5}function Fx(e,t){if(!t||(t=t.trim(),t.length===0)||!M8(e))return null;t.length>60&&(t=t.substring(0,60));const i=R8(t);if(!N8(i)){if(!L8(i))return null;t=t.toLowerCase()}let r=null,n=0;for(e=e.toLowerCase();n<t.length&&(r=sm(e,t,0,n))===null;)n=Ox(t,n+1);return r}var VU=Ax(Rx,Fx,k8),zU=Ax(Rx,Fx,P8),qU=new ng(1e4),sd=128;function om(){const e=[],t=[];for(let i=0;i<=sd;i++)t[i]=0;for(let i=0;i<=sd;i++)e.push(t.slice(0));return e}function $x(e){const t=[];for(let i=0;i<=e;i++)t[i]=0;return t}var jU=$x(2*sd),GU=$x(2*sd),QU=om(),JU=om(),XU=om(),Hx;(function(e){e[e.Diag=1]="Diag",e[e.Left=2]="Left",e[e.LeftLeft=3]="LeftLeft"})(Hx||(Hx={}));var Ux;(function(e){e.Default=[-100,0];function t(i){return!i||i.length===2&&i[0]===-100&&i[1]===0}e.isDefault=t})(Ux||(Ux={}));var ZU=class{static{this.default={boostFullMatch:!0,firstMatchCanBeWeak:!1}}constructor(e,t){this.firstMatchCanBeWeak=e,this.boostFullMatch=t}},am=Object.create(null);function g(e,t){if(Me(t)){const i=am[t];if(i===void 0)throw new Error(`${e} references an unknown codicon: ${t}`);t=i}return am[e]=t,{id:e}}function O8(){return am}var F8={add:g("add",6e4),plus:g("plus",6e4),gistNew:g("gist-new",6e4),repoCreate:g("repo-create",6e4),lightbulb:g("lightbulb",60001),lightBulb:g("light-bulb",60001),repo:g("repo",60002),repoDelete:g("repo-delete",60002),gistFork:g("gist-fork",60003),repoForked:g("repo-forked",60003),gitPullRequest:g("git-pull-request",60004),gitPullRequestAbandoned:g("git-pull-request-abandoned",60004),recordKeys:g("record-keys",60005),keyboard:g("keyboard",60005),tag:g("tag",60006),gitPullRequestLabel:g("git-pull-request-label",60006),tagAdd:g("tag-add",60006),tagRemove:g("tag-remove",60006),person:g("person",60007),personFollow:g("person-follow",60007),personOutline:g("person-outline",60007),personFilled:g("person-filled",60007),gitBranch:g("git-branch",60008),gitBranchCreate:g("git-branch-create",60008),gitBranchDelete:g("git-branch-delete",60008),sourceControl:g("source-control",60008),mirror:g("mirror",60009),mirrorPublic:g("mirror-public",60009),star:g("star",60010),starAdd:g("star-add",60010),starDelete:g("star-delete",60010),starEmpty:g("star-empty",60010),comment:g("comment",60011),commentAdd:g("comment-add",60011),alert:g("alert",60012),warning:g("warning",60012),search:g("search",60013),searchSave:g("search-save",60013),logOut:g("log-out",60014),signOut:g("sign-out",60014),logIn:g("log-in",60015),signIn:g("sign-in",60015),eye:g("eye",60016),eyeUnwatch:g("eye-unwatch",60016),eyeWatch:g("eye-watch",60016),circleFilled:g("circle-filled",60017),primitiveDot:g("primitive-dot",60017),closeDirty:g("close-dirty",60017),debugBreakpoint:g("debug-breakpoint",60017),debugBreakpointDisabled:g("debug-breakpoint-disabled",60017),debugHint:g("debug-hint",60017),terminalDecorationSuccess:g("terminal-decoration-success",60017),primitiveSquare:g("primitive-square",60018),edit:g("edit",60019),pencil:g("pencil",60019),info:g("info",60020),issueOpened:g("issue-opened",60020),gistPrivate:g("gist-private",60021),gitForkPrivate:g("git-fork-private",60021),lock:g("lock",60021),mirrorPrivate:g("mirror-private",60021),close:g("close",60022),removeClose:g("remove-close",60022),x:g("x",60022),repoSync:g("repo-sync",60023),sync:g("sync",60023),clone:g("clone",60024),desktopDownload:g("desktop-download",60024),beaker:g("beaker",60025),microscope:g("microscope",60025),vm:g("vm",60026),deviceDesktop:g("device-desktop",60026),file:g("file",60027),fileText:g("file-text",60027),more:g("more",60028),ellipsis:g("ellipsis",60028),kebabHorizontal:g("kebab-horizontal",60028),mailReply:g("mail-reply",60029),reply:g("reply",60029),organization:g("organization",60030),organizationFilled:g("organization-filled",60030),organizationOutline:g("organization-outline",60030),newFile:g("new-file",60031),fileAdd:g("file-add",60031),newFolder:g("new-folder",60032),fileDirectoryCreate:g("file-directory-create",60032),trash:g("trash",60033),trashcan:g("trashcan",60033),history:g("history",60034),clock:g("clock",60034),folder:g("folder",60035),fileDirectory:g("file-directory",60035),symbolFolder:g("symbol-folder",60035),logoGithub:g("logo-github",60036),markGithub:g("mark-github",60036),github:g("github",60036),terminal:g("terminal",60037),console:g("console",60037),repl:g("repl",60037),zap:g("zap",60038),symbolEvent:g("symbol-event",60038),error:g("error",60039),stop:g("stop",60039),variable:g("variable",60040),symbolVariable:g("symbol-variable",60040),array:g("array",60042),symbolArray:g("symbol-array",60042),symbolModule:g("symbol-module",60043),symbolPackage:g("symbol-package",60043),symbolNamespace:g("symbol-namespace",60043),symbolObject:g("symbol-object",60043),symbolMethod:g("symbol-method",60044),symbolFunction:g("symbol-function",60044),symbolConstructor:g("symbol-constructor",60044),symbolBoolean:g("symbol-boolean",60047),symbolNull:g("symbol-null",60047),symbolNumeric:g("symbol-numeric",60048),symbolNumber:g("symbol-number",60048),symbolStructure:g("symbol-structure",60049),symbolStruct:g("symbol-struct",60049),symbolParameter:g("symbol-parameter",60050),symbolTypeParameter:g("symbol-type-parameter",60050),symbolKey:g("symbol-key",60051),symbolText:g("symbol-text",60051),symbolReference:g("symbol-reference",60052),goToFile:g("go-to-file",60052),symbolEnum:g("symbol-enum",60053),symbolValue:g("symbol-value",60053),symbolRuler:g("symbol-ruler",60054),symbolUnit:g("symbol-unit",60054),activateBreakpoints:g("activate-breakpoints",60055),archive:g("archive",60056),arrowBoth:g("arrow-both",60057),arrowDown:g("arrow-down",60058),arrowLeft:g("arrow-left",60059),arrowRight:g("arrow-right",60060),arrowSmallDown:g("arrow-small-down",60061),arrowSmallLeft:g("arrow-small-left",60062),arrowSmallRight:g("arrow-small-right",60063),arrowSmallUp:g("arrow-small-up",60064),arrowUp:g("arrow-up",60065),bell:g("bell",60066),bold:g("bold",60067),book:g("book",60068),bookmark:g("bookmark",60069),debugBreakpointConditionalUnverified:g("debug-breakpoint-conditional-unverified",60070),debugBreakpointConditional:g("debug-breakpoint-conditional",60071),debugBreakpointConditionalDisabled:g("debug-breakpoint-conditional-disabled",60071),debugBreakpointDataUnverified:g("debug-breakpoint-data-unverified",60072),debugBreakpointData:g("debug-breakpoint-data",60073),debugBreakpointDataDisabled:g("debug-breakpoint-data-disabled",60073),debugBreakpointLogUnverified:g("debug-breakpoint-log-unverified",60074),debugBreakpointLog:g("debug-breakpoint-log",60075),debugBreakpointLogDisabled:g("debug-breakpoint-log-disabled",60075),briefcase:g("briefcase",60076),broadcast:g("broadcast",60077),browser:g("browser",60078),bug:g("bug",60079),calendar:g("calendar",60080),caseSensitive:g("case-sensitive",60081),check:g("check",60082),checklist:g("checklist",60083),chevronDown:g("chevron-down",60084),chevronLeft:g("chevron-left",60085),chevronRight:g("chevron-right",60086),chevronUp:g("chevron-up",60087),chromeClose:g("chrome-close",60088),chromeMaximize:g("chrome-maximize",60089),chromeMinimize:g("chrome-minimize",60090),chromeRestore:g("chrome-restore",60091),circleOutline:g("circle-outline",60092),circle:g("circle",60092),debugBreakpointUnverified:g("debug-breakpoint-unverified",60092),terminalDecorationIncomplete:g("terminal-decoration-incomplete",60092),circleSlash:g("circle-slash",60093),circuitBoard:g("circuit-board",60094),clearAll:g("clear-all",60095),clippy:g("clippy",60096),closeAll:g("close-all",60097),cloudDownload:g("cloud-download",60098),cloudUpload:g("cloud-upload",60099),code:g("code",60100),collapseAll:g("collapse-all",60101),colorMode:g("color-mode",60102),commentDiscussion:g("comment-discussion",60103),creditCard:g("credit-card",60105),dash:g("dash",60108),dashboard:g("dashboard",60109),database:g("database",60110),debugContinue:g("debug-continue",60111),debugDisconnect:g("debug-disconnect",60112),debugPause:g("debug-pause",60113),debugRestart:g("debug-restart",60114),debugStart:g("debug-start",60115),debugStepInto:g("debug-step-into",60116),debugStepOut:g("debug-step-out",60117),debugStepOver:g("debug-step-over",60118),debugStop:g("debug-stop",60119),debug:g("debug",60120),deviceCameraVideo:g("device-camera-video",60121),deviceCamera:g("device-camera",60122),deviceMobile:g("device-mobile",60123),diffAdded:g("diff-added",60124),diffIgnored:g("diff-ignored",60125),diffModified:g("diff-modified",60126),diffRemoved:g("diff-removed",60127),diffRenamed:g("diff-renamed",60128),diff:g("diff",60129),diffSidebyside:g("diff-sidebyside",60129),discard:g("discard",60130),editorLayout:g("editor-layout",60131),emptyWindow:g("empty-window",60132),exclude:g("exclude",60133),extensions:g("extensions",60134),eyeClosed:g("eye-closed",60135),fileBinary:g("file-binary",60136),fileCode:g("file-code",60137),fileMedia:g("file-media",60138),filePdf:g("file-pdf",60139),fileSubmodule:g("file-submodule",60140),fileSymlinkDirectory:g("file-symlink-directory",60141),fileSymlinkFile:g("file-symlink-file",60142),fileZip:g("file-zip",60143),files:g("files",60144),filter:g("filter",60145),flame:g("flame",60146),foldDown:g("fold-down",60147),foldUp:g("fold-up",60148),fold:g("fold",60149),folderActive:g("folder-active",60150),folderOpened:g("folder-opened",60151),gear:g("gear",60152),gift:g("gift",60153),gistSecret:g("gist-secret",60154),gist:g("gist",60155),gitCommit:g("git-commit",60156),gitCompare:g("git-compare",60157),compareChanges:g("compare-changes",60157),gitMerge:g("git-merge",60158),githubAction:g("github-action",60159),githubAlt:g("github-alt",60160),globe:g("globe",60161),grabber:g("grabber",60162),graph:g("graph",60163),gripper:g("gripper",60164),heart:g("heart",60165),home:g("home",60166),horizontalRule:g("horizontal-rule",60167),hubot:g("hubot",60168),inbox:g("inbox",60169),issueReopened:g("issue-reopened",60171),issues:g("issues",60172),italic:g("italic",60173),jersey:g("jersey",60174),json:g("json",60175),kebabVertical:g("kebab-vertical",60176),key:g("key",60177),law:g("law",60178),lightbulbAutofix:g("lightbulb-autofix",60179),linkExternal:g("link-external",60180),link:g("link",60181),listOrdered:g("list-ordered",60182),listUnordered:g("list-unordered",60183),liveShare:g("live-share",60184),loading:g("loading",60185),location:g("location",60186),mailRead:g("mail-read",60187),mail:g("mail",60188),markdown:g("markdown",60189),megaphone:g("megaphone",60190),mention:g("mention",60191),milestone:g("milestone",60192),gitPullRequestMilestone:g("git-pull-request-milestone",60192),mortarBoard:g("mortar-board",60193),move:g("move",60194),multipleWindows:g("multiple-windows",60195),mute:g("mute",60196),noNewline:g("no-newline",60197),note:g("note",60198),octoface:g("octoface",60199),openPreview:g("open-preview",60200),package:g("package",60201),paintcan:g("paintcan",60202),pin:g("pin",60203),play:g("play",60204),run:g("run",60204),plug:g("plug",60205),preserveCase:g("preserve-case",60206),preview:g("preview",60207),project:g("project",60208),pulse:g("pulse",60209),question:g("question",60210),quote:g("quote",60211),radioTower:g("radio-tower",60212),reactions:g("reactions",60213),references:g("references",60214),refresh:g("refresh",60215),regex:g("regex",60216),remoteExplorer:g("remote-explorer",60217),remote:g("remote",60218),remove:g("remove",60219),replaceAll:g("replace-all",60220),replace:g("replace",60221),repoClone:g("repo-clone",60222),repoForcePush:g("repo-force-push",60223),repoPull:g("repo-pull",60224),repoPush:g("repo-push",60225),report:g("report",60226),requestChanges:g("request-changes",60227),rocket:g("rocket",60228),rootFolderOpened:g("root-folder-opened",60229),rootFolder:g("root-folder",60230),rss:g("rss",60231),ruby:g("ruby",60232),saveAll:g("save-all",60233),saveAs:g("save-as",60234),save:g("save",60235),screenFull:g("screen-full",60236),screenNormal:g("screen-normal",60237),searchStop:g("search-stop",60238),server:g("server",60240),settingsGear:g("settings-gear",60241),settings:g("settings",60242),shield:g("shield",60243),smiley:g("smiley",60244),sortPrecedence:g("sort-precedence",60245),splitHorizontal:g("split-horizontal",60246),splitVertical:g("split-vertical",60247),squirrel:g("squirrel",60248),starFull:g("star-full",60249),starHalf:g("star-half",60250),symbolClass:g("symbol-class",60251),symbolColor:g("symbol-color",60252),symbolConstant:g("symbol-constant",60253),symbolEnumMember:g("symbol-enum-member",60254),symbolField:g("symbol-field",60255),symbolFile:g("symbol-file",60256),symbolInterface:g("symbol-interface",60257),symbolKeyword:g("symbol-keyword",60258),symbolMisc:g("symbol-misc",60259),symbolOperator:g("symbol-operator",60260),symbolProperty:g("symbol-property",60261),wrench:g("wrench",60261),wrenchSubaction:g("wrench-subaction",60261),symbolSnippet:g("symbol-snippet",60262),tasklist:g("tasklist",60263),telescope:g("telescope",60264),textSize:g("text-size",60265),threeBars:g("three-bars",60266),thumbsdown:g("thumbsdown",60267),thumbsup:g("thumbsup",60268),tools:g("tools",60269),triangleDown:g("triangle-down",60270),triangleLeft:g("triangle-left",60271),triangleRight:g("triangle-right",60272),triangleUp:g("triangle-up",60273),twitter:g("twitter",60274),unfold:g("unfold",60275),unlock:g("unlock",60276),unmute:g("unmute",60277),unverified:g("unverified",60278),verified:g("verified",60279),versions:g("versions",60280),vmActive:g("vm-active",60281),vmOutline:g("vm-outline",60282),vmRunning:g("vm-running",60283),watch:g("watch",60284),whitespace:g("whitespace",60285),wholeWord:g("whole-word",60286),window:g("window",60287),wordWrap:g("word-wrap",60288),zoomIn:g("zoom-in",60289),zoomOut:g("zoom-out",60290),listFilter:g("list-filter",60291),listFlat:g("list-flat",60292),listSelection:g("list-selection",60293),selection:g("selection",60293),listTree:g("list-tree",60294),debugBreakpointFunctionUnverified:g("debug-breakpoint-function-unverified",60295),debugBreakpointFunction:g("debug-breakpoint-function",60296),debugBreakpointFunctionDisabled:g("debug-breakpoint-function-disabled",60296),debugStackframeActive:g("debug-stackframe-active",60297),circleSmallFilled:g("circle-small-filled",60298),debugStackframeDot:g("debug-stackframe-dot",60298),terminalDecorationMark:g("terminal-decoration-mark",60298),debugStackframe:g("debug-stackframe",60299),debugStackframeFocused:g("debug-stackframe-focused",60299),debugBreakpointUnsupported:g("debug-breakpoint-unsupported",60300),symbolString:g("symbol-string",60301),debugReverseContinue:g("debug-reverse-continue",60302),debugStepBack:g("debug-step-back",60303),debugRestartFrame:g("debug-restart-frame",60304),debugAlt:g("debug-alt",60305),callIncoming:g("call-incoming",60306),callOutgoing:g("call-outgoing",60307),menu:g("menu",60308),expandAll:g("expand-all",60309),feedback:g("feedback",60310),gitPullRequestReviewer:g("git-pull-request-reviewer",60310),groupByRefType:g("group-by-ref-type",60311),ungroupByRefType:g("ungroup-by-ref-type",60312),account:g("account",60313),gitPullRequestAssignee:g("git-pull-request-assignee",60313),bellDot:g("bell-dot",60314),debugConsole:g("debug-console",60315),library:g("library",60316),output:g("output",60317),runAll:g("run-all",60318),syncIgnored:g("sync-ignored",60319),pinned:g("pinned",60320),githubInverted:g("github-inverted",60321),serverProcess:g("server-process",60322),serverEnvironment:g("server-environment",60323),pass:g("pass",60324),issueClosed:g("issue-closed",60324),stopCircle:g("stop-circle",60325),playCircle:g("play-circle",60326),record:g("record",60327),debugAltSmall:g("debug-alt-small",60328),vmConnect:g("vm-connect",60329),cloud:g("cloud",60330),merge:g("merge",60331),export:g("export",60332),graphLeft:g("graph-left",60333),magnet:g("magnet",60334),notebook:g("notebook",60335),redo:g("redo",60336),checkAll:g("check-all",60337),pinnedDirty:g("pinned-dirty",60338),passFilled:g("pass-filled",60339),circleLargeFilled:g("circle-large-filled",60340),circleLarge:g("circle-large",60341),circleLargeOutline:g("circle-large-outline",60341),combine:g("combine",60342),gather:g("gather",60342),table:g("table",60343),variableGroup:g("variable-group",60344),typeHierarchy:g("type-hierarchy",60345),typeHierarchySub:g("type-hierarchy-sub",60346),typeHierarchySuper:g("type-hierarchy-super",60347),gitPullRequestCreate:g("git-pull-request-create",60348),runAbove:g("run-above",60349),runBelow:g("run-below",60350),notebookTemplate:g("notebook-template",60351),debugRerun:g("debug-rerun",60352),workspaceTrusted:g("workspace-trusted",60353),workspaceUntrusted:g("workspace-untrusted",60354),workspaceUnknown:g("workspace-unknown",60355),terminalCmd:g("terminal-cmd",60356),terminalDebian:g("terminal-debian",60357),terminalLinux:g("terminal-linux",60358),terminalPowershell:g("terminal-powershell",60359),terminalTmux:g("terminal-tmux",60360),terminalUbuntu:g("terminal-ubuntu",60361),terminalBash:g("terminal-bash",60362),arrowSwap:g("arrow-swap",60363),copy:g("copy",60364),personAdd:g("person-add",60365),filterFilled:g("filter-filled",60366),wand:g("wand",60367),debugLineByLine:g("debug-line-by-line",60368),inspect:g("inspect",60369),layers:g("layers",60370),layersDot:g("layers-dot",60371),layersActive:g("layers-active",60372),compass:g("compass",60373),compassDot:g("compass-dot",60374),compassActive:g("compass-active",60375),azure:g("azure",60376),issueDraft:g("issue-draft",60377),gitPullRequestClosed:g("git-pull-request-closed",60378),gitPullRequestDraft:g("git-pull-request-draft",60379),debugAll:g("debug-all",60380),debugCoverage:g("debug-coverage",60381),runErrors:g("run-errors",60382),folderLibrary:g("folder-library",60383),debugContinueSmall:g("debug-continue-small",60384),beakerStop:g("beaker-stop",60385),graphLine:g("graph-line",60386),graphScatter:g("graph-scatter",60387),pieChart:g("pie-chart",60388),bracket:g("bracket",60175),bracketDot:g("bracket-dot",60389),bracketError:g("bracket-error",60390),lockSmall:g("lock-small",60391),azureDevops:g("azure-devops",60392),verifiedFilled:g("verified-filled",60393),newline:g("newline",60394),layout:g("layout",60395),layoutActivitybarLeft:g("layout-activitybar-left",60396),layoutActivitybarRight:g("layout-activitybar-right",60397),layoutPanelLeft:g("layout-panel-left",60398),layoutPanelCenter:g("layout-panel-center",60399),layoutPanelJustify:g("layout-panel-justify",60400),layoutPanelRight:g("layout-panel-right",60401),layoutPanel:g("layout-panel",60402),layoutSidebarLeft:g("layout-sidebar-left",60403),layoutSidebarRight:g("layout-sidebar-right",60404),layoutStatusbar:g("layout-statusbar",60405),layoutMenubar:g("layout-menubar",60406),layoutCentered:g("layout-centered",60407),target:g("target",60408),indent:g("indent",60409),recordSmall:g("record-small",60410),errorSmall:g("error-small",60411),terminalDecorationError:g("terminal-decoration-error",60411),arrowCircleDown:g("arrow-circle-down",60412),arrowCircleLeft:g("arrow-circle-left",60413),arrowCircleRight:g("arrow-circle-right",60414),arrowCircleUp:g("arrow-circle-up",60415),layoutSidebarRightOff:g("layout-sidebar-right-off",60416),layoutPanelOff:g("layout-panel-off",60417),layoutSidebarLeftOff:g("layout-sidebar-left-off",60418),blank:g("blank",60419),heartFilled:g("heart-filled",60420),map:g("map",60421),mapHorizontal:g("map-horizontal",60421),foldHorizontal:g("fold-horizontal",60421),mapFilled:g("map-filled",60422),mapHorizontalFilled:g("map-horizontal-filled",60422),foldHorizontalFilled:g("fold-horizontal-filled",60422),circleSmall:g("circle-small",60423),bellSlash:g("bell-slash",60424),bellSlashDot:g("bell-slash-dot",60425),commentUnresolved:g("comment-unresolved",60426),gitPullRequestGoToChanges:g("git-pull-request-go-to-changes",60427),gitPullRequestNewChanges:g("git-pull-request-new-changes",60428),searchFuzzy:g("search-fuzzy",60429),commentDraft:g("comment-draft",60430),send:g("send",60431),sparkle:g("sparkle",60432),insert:g("insert",60433),mic:g("mic",60434),thumbsdownFilled:g("thumbsdown-filled",60435),thumbsupFilled:g("thumbsup-filled",60436),coffee:g("coffee",60437),snake:g("snake",60438),game:g("game",60439),vr:g("vr",60440),chip:g("chip",60441),piano:g("piano",60442),music:g("music",60443),micFilled:g("mic-filled",60444),repoFetch:g("repo-fetch",60445),copilot:g("copilot",60446),lightbulbSparkle:g("lightbulb-sparkle",60447),robot:g("robot",60448),sparkleFilled:g("sparkle-filled",60449),diffSingle:g("diff-single",60450),diffMultiple:g("diff-multiple",60451),surroundWith:g("surround-with",60452),share:g("share",60453),gitStash:g("git-stash",60454),gitStashApply:g("git-stash-apply",60455),gitStashPop:g("git-stash-pop",60456),vscode:g("vscode",60457),vscodeInsiders:g("vscode-insiders",60458),codeOss:g("code-oss",60459),runCoverage:g("run-coverage",60460),runAllCoverage:g("run-all-coverage",60461),coverage:g("coverage",60462),githubProject:g("github-project",60463),mapVertical:g("map-vertical",60464),foldVertical:g("fold-vertical",60464),mapVerticalFilled:g("map-vertical-filled",60465),foldVerticalFilled:g("fold-vertical-filled",60465),goToSearch:g("go-to-search",60466),percentage:g("percentage",60467),sortPercentage:g("sort-percentage",60467),attach:g("attach",60468),goToEditingSession:g("go-to-editing-session",60469),editSession:g("edit-session",60470),codeReview:g("code-review",60471),copilotWarning:g("copilot-warning",60472),python:g("python",60473),copilotLarge:g("copilot-large",60474),copilotWarningLarge:g("copilot-warning-large",60475),keyboardTab:g("keyboard-tab",60476),copilotBlocked:g("copilot-blocked",60477),copilotNotConnected:g("copilot-not-connected",60478),flag:g("flag",60479),lightbulbEmpty:g("lightbulb-empty",60480),symbolMethodArrow:g("symbol-method-arrow",60481),copilotUnavailable:g("copilot-unavailable",60482),repoPinned:g("repo-pinned",60483),keyboardTabAbove:g("keyboard-tab-above",60484),keyboardTabBelow:g("keyboard-tab-below",60485),gitPullRequestDone:g("git-pull-request-done",60486),mcp:g("mcp",60487),extensionsLarge:g("extensions-large",60488),genieChevronLeft:g("genie-chevron-left",70001),genieChevronRight:g("genie-chevron-right",70002)},$8={dialogError:g("dialog-error","error"),dialogWarning:g("dialog-warning","warning"),dialogInfo:g("dialog-info","info"),dialogClose:g("dialog-close","close"),treeItemExpanded:g("tree-item-expanded","chevron-down"),treeFilterOnTypeOn:g("tree-filter-on-type-on","list-filter"),treeFilterOnTypeOff:g("tree-filter-on-type-off","list-selection"),treeFilterClear:g("tree-filter-clear","close"),treeItemLoading:g("tree-item-loading","loading"),menuSelection:g("menu-selection","check"),menuSubmenu:g("menu-submenu","chevron-right"),menuBarMore:g("menubar-more","more"),scrollbarButtonLeft:g("scrollbar-button-left","triangle-left"),scrollbarButtonRight:g("scrollbar-button-right","triangle-right"),scrollbarButtonUp:g("scrollbar-button-up","triangle-up"),scrollbarButtonDown:g("scrollbar-button-down","triangle-down"),toolBarMore:g("toolbar-more","more"),quickInputBack:g("quick-input-back","arrow-left"),dropDownButton:g("drop-down-button",60084),symbolCustomColor:g("symbol-customcolor",60252),exportIcon:g("export",60332),workspaceUnspecified:g("workspace-unspecified",60355),newLine:g("newline",60394),thumbsDownFilled:g("thumbsdown-filled",60435),thumbsUpFilled:g("thumbsup-filled",60436),gitFetch:g("git-fetch",60445),lightbulbSparkleAutofix:g("lightbulb-sparkle-autofix",60447),debugBreakpointPending:g("debug-breakpoint-pending",60377)},re={...F8,...$8},Fo;(function(e){function t(i){return i&&typeof i=="object"&&typeof i.id=="string"}e.isThemeColor=t})(Fo||(Fo={}));var kt;(function(e){e.iconNameSegment="[A-Za-z0-9]+",e.iconNameExpression="[A-Za-z0-9-]+",e.iconModifierExpression="~[A-Za-z]+",e.iconNameCharacter="[A-Za-z0-9~-]";const t=new RegExp(`^(${e.iconNameExpression})(${e.iconModifierExpression})?$`);function i(f){const p=t.exec(f.id);if(!p)return i(re.error);const[,m,_]=p,b=["codicon","codicon-"+m];return _&&b.push("codicon-modifier-"+_.substring(1)),b}e.asClassNameArray=i;function r(f){return i(f).join(" ")}e.asClassName=r;function n(f){return"."+i(f).join(".")}e.asCSSSelector=n;function s(f){return f&&typeof f=="object"&&typeof f.id=="string"&&(typeof f.color>"u"||Fo.isThemeColor(f.color))}e.isThemeIcon=s;const o=new RegExp(`^\\$\\((${e.iconNameExpression}(?:${e.iconModifierExpression})?)\\)$`);function a(f){const p=o.exec(f);if(!p)return;const[,m]=p;return{id:m}}e.fromString=a;function l(f){return{id:f}}e.fromId=l;function c(f,p){let m=f.id;const _=m.lastIndexOf("~");return _!==-1&&(m=m.substring(0,_)),p&&(m=`${m}~${p}`),{id:m}}e.modify=c;function u(f){const p=f.id.lastIndexOf("~");if(p!==-1)return f.id.substring(p+1)}e.getModifier=u;function d(f,p){return f.id===p.id&&f.color?.id===p.color?.id}e.isEqual=d})(kt||(kt={}));var lm=new RegExp(`\\$\\(${kt.iconNameExpression}(?:${kt.iconModifierExpression})?\\)`,"g"),H8=new RegExp(`(\\\\)?${lm.source}`,"g");function U8(e){return e.replace(H8,(t,i)=>i?t:`\\${t}`)}var KU=new RegExp(`\\\\${lm.source}`,"g"),YU=new RegExp(`(\\s)?(\\\\)?${lm.source}(\\s)?`,"g"),eB=new RegExp(`\\$\\(${kt.iconNameCharacter}+\\)`,"g"),Bx;(function(e){e[e.Paragraph=0]="Paragraph",e[e.Break=1]="Break"})(Bx||(Bx={}));var $o=class O6{static lift(t){const i=new O6(t.value,t);return i.uris=t.uris,i.baseUri=t.baseUri?y.revive(t.baseUri):void 0,i}constructor(t="",i=!1){if(this.value=t,typeof this.value!="string")throw Se("value");typeof i=="boolean"?(this.isTrusted=i,this.supportThemeIcons=!1,this.supportHtml=!1):(this.isTrusted=i.isTrusted??void 0,this.supportThemeIcons=i.supportThemeIcons??!1,this.supportHtml=i.supportHtml??!1)}appendText(t,i=0){return this.value+=B8(this.supportThemeIcons?U8(t):t).replace(/([ \t]+)/g,(r,n)=>"&nbsp;".repeat(n.length)).replace(/\>/gm,"\\>").replace(/\n/g,i===1?`\\
`:`

`),this}appendMarkdown(t){return this.value+=t,this}appendCodeblock(t,i){return this.value+=`
${W8(i,t)}
`,this}appendLink(t,i,r){return this.value+="[",this.value+=this._escape(i,"]"),this.value+="](",this.value+=this._escape(String(t),")"),r&&(this.value+=` "${this._escape(this._escape(r,'"'),")")}"`),this.value+=")",this}_escape(t,i){const r=new RegExp(ps(i),"g");return t.replace(r,(n,s)=>t.charAt(s-1)!=="\\"?`\\${n}`:n)}};function Kr(e){return e instanceof $o?!0:e&&typeof e=="object"?typeof e.value=="string"&&(typeof e.isTrusted=="boolean"||typeof e.isTrusted=="object"||e.isTrusted===void 0)&&(typeof e.supportThemeIcons=="boolean"||e.supportThemeIcons===void 0):!1}function B8(e){return e.replace(/[\\`*_{}[\]()#+\-!~]/g,"\\$&")}function W8(e,t){const i=e.match(/^`+/gm)?.reduce((n,s)=>n.length>s.length?n:s).length??0,r=i>=3?i+1:3;return[`${"`".repeat(r)}${t}`,e,`${"`".repeat(r)}`].join(`
`)}function V8(e){const t=[],i=e.split("|").map(n=>n.trim());e=i[0];const r=i[1];if(r){const n=/height=(\d+)/.exec(r),s=/width=(\d+)/.exec(r),o=n?n[1]:"",a=s?s[1]:"",l=isFinite(parseInt(a)),c=isFinite(parseInt(o));l&&t.push(`width="${a}"`),c&&t.push(`height="${o}"`)}return{href:e,dimensions:t}}function cm(){return{async:!1,breaks:!1,extensions:null,gfm:!0,hooks:null,pedantic:!1,renderer:null,silent:!1,tokenizer:null,walkTokens:null}}var bs=cm();function Wx(e){bs=e}var Vx=/[&<>"']/,z8=new RegExp(Vx.source,"g"),zx=/[<>"']|&(?!(#\d{1,7}|#[Xx][a-fA-F0-9]{1,6}|\w+);)/,q8=new RegExp(zx.source,"g"),j8={"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#39;"},qx=e=>j8[e];function Ui(e,t){if(t){if(Vx.test(e))return e.replace(z8,qx)}else if(zx.test(e))return e.replace(q8,qx);return e}var G8=/(^|[^\[])\^/g;function lt(e,t){let i=typeof e=="string"?e:e.source;t=t||"";const r={replace:(n,s)=>{let o=typeof s=="string"?s:s.source;return o=o.replace(G8,"$1"),i=i.replace(n,o),r},getRegex:()=>new RegExp(i,t)};return r}function jx(e){try{e=encodeURI(e).replace(/%25/g,"%")}catch{return null}return e}var El={exec:()=>null};function Gx(e,t){const i=e.replace(/\|/g,(s,o,a)=>{let l=!1,c=o;for(;--c>=0&&a[c]==="\\";)l=!l;return l?"|":" |"}),r=i.split(/ \|/);let n=0;if(r[0].trim()||r.shift(),r.length>0&&!r[r.length-1].trim()&&r.pop(),t)if(r.length>t)r.splice(t);else for(;r.length<t;)r.push("");for(;n<r.length;n++)r[n]=r[n].trim().replace(/\\\|/g,"|");return r}function Cl(e,t,i){const r=e.length;if(r===0)return"";let n=0;for(;n<r;){const s=e.charAt(r-n-1);if(s===t&&!i)n++;else if(s!==t&&i)n++;else break}return e.slice(0,r-n)}function Q8(e,t){if(e.indexOf(t[1])===-1)return-1;let i=0;for(let r=0;r<e.length;r++)if(e[r]==="\\")r++;else if(e[r]===t[0])i++;else if(e[r]===t[1]&&(i--,i<0))return r;return-1}function Qx(e,t,i,r){const n=t.href,s=t.title?Ui(t.title):null,o=e[1].replace(/\\([\[\]])/g,"$1");if(e[0].charAt(0)!=="!"){r.state.inLink=!0;const a={type:"link",raw:i,href:n,title:s,text:o,tokens:r.inlineTokens(o)};return r.state.inLink=!1,a}return{type:"image",raw:i,href:n,title:s,text:Ui(o)}}function J8(e,t){const i=e.match(/^(\s+)(?:```)/);if(i===null)return t;const r=i[1];return t.split(`
`).map(n=>{const s=n.match(/^\s+/);if(s===null)return n;const[o]=s;return o.length>=r.length?n.slice(r.length):n}).join(`
`)}var od=class{options;rules;lexer;constructor(e){this.options=e||bs}space(e){const t=this.rules.block.newline.exec(e);if(t&&t[0].length>0)return{type:"space",raw:t[0]}}code(e){const t=this.rules.block.code.exec(e);if(t){const i=t[0].replace(/^ {1,4}/gm,"");return{type:"code",raw:t[0],codeBlockStyle:"indented",text:this.options.pedantic?i:Cl(i,`
`)}}}fences(e){const t=this.rules.block.fences.exec(e);if(t){const i=t[0],r=J8(i,t[3]||"");return{type:"code",raw:i,lang:t[2]?t[2].trim().replace(this.rules.inline.anyPunctuation,"$1"):t[2],text:r}}}heading(e){const t=this.rules.block.heading.exec(e);if(t){let i=t[2].trim();if(/#$/.test(i)){const r=Cl(i,"#");(this.options.pedantic||!r||/ $/.test(r))&&(i=r.trim())}return{type:"heading",raw:t[0],depth:t[1].length,text:i,tokens:this.lexer.inline(i)}}}hr(e){const t=this.rules.block.hr.exec(e);if(t)return{type:"hr",raw:Cl(t[0],`
`)}}blockquote(e){const t=this.rules.block.blockquote.exec(e);if(t){let i=Cl(t[0],`
`).split(`
`),r="",n="";const s=[];for(;i.length>0;){let o=!1;const a=[];let l;for(l=0;l<i.length;l++)if(/^ {0,3}>/.test(i[l]))a.push(i[l]),o=!0;else if(!o)a.push(i[l]);else break;i=i.slice(l);const c=a.join(`
`),u=c.replace(/\n {0,3}((?:=+|-+) *)(?=\n|$)/g,`
    $1`).replace(/^ {0,3}>[ \t]?/gm,"");r=r?`${r}
${c}`:c,n=n?`${n}
${u}`:u;const d=this.lexer.state.top;if(this.lexer.state.top=!0,this.lexer.blockTokens(u,s,!0),this.lexer.state.top=d,i.length===0)break;const f=s[s.length-1];if(f?.type==="code")break;if(f?.type==="blockquote"){const p=f,m=p.raw+`
`+i.join(`
`),_=this.blockquote(m);s[s.length-1]=_,r=r.substring(0,r.length-p.raw.length)+_.raw,n=n.substring(0,n.length-p.text.length)+_.text;break}else if(f?.type==="list"){const p=f,m=p.raw+`
`+i.join(`
`),_=this.list(m);s[s.length-1]=_,r=r.substring(0,r.length-f.raw.length)+_.raw,n=n.substring(0,n.length-p.raw.length)+_.raw,i=m.substring(s[s.length-1].raw.length).split(`
`);continue}}return{type:"blockquote",raw:r,tokens:s,text:n}}}list(e){let t=this.rules.block.list.exec(e);if(t){let i=t[1].trim();const r=i.length>1,n={type:"list",raw:"",ordered:r,start:r?+i.slice(0,-1):"",loose:!1,items:[]};i=r?`\\d{1,9}\\${i.slice(-1)}`:`\\${i}`,this.options.pedantic&&(i=r?i:"[*+-]");const s=new RegExp(`^( {0,3}${i})((?:[	 ][^\\n]*)?(?:\\n|$))`);let o=!1;for(;e;){let a=!1,l="",c="";if(!(t=s.exec(e))||this.rules.block.hr.test(e))break;l=t[0],e=e.substring(l.length);let u=t[2].split(`
`,1)[0].replace(/^\t+/,b=>" ".repeat(3*b.length)),d=e.split(`
`,1)[0],f=!u.trim(),p=0;if(this.options.pedantic?(p=2,c=u.trimStart()):f?p=t[1].length+1:(p=t[2].search(/[^ ]/),p=p>4?1:p,c=u.slice(p),p+=t[1].length),f&&/^ *$/.test(d)&&(l+=d+`
`,e=e.substring(d.length+1),a=!0),!a){const b=new RegExp(`^ {0,${Math.min(3,p-1)}}(?:[*+-]|\\d{1,9}[.)])((?:[ 	][^\\n]*)?(?:\\n|$))`),E=new RegExp(`^ {0,${Math.min(3,p-1)}}((?:- *){3,}|(?:_ *){3,}|(?:\\* *){3,})(?:\\n+|$)`),C=new RegExp(`^ {0,${Math.min(3,p-1)}}(?:\`\`\`|~~~)`),T=new RegExp(`^ {0,${Math.min(3,p-1)}}#`);for(;e;){const j=e.split(`
`,1)[0];if(d=j,this.options.pedantic&&(d=d.replace(/^ {1,4}(?=( {4})*[^ ])/g,"  ")),C.test(d)||T.test(d)||b.test(d)||E.test(e))break;if(d.search(/[^ ]/)>=p||!d.trim())c+=`
`+d.slice(p);else{if(f||u.search(/[^ ]/)>=4||C.test(u)||T.test(u)||E.test(u))break;c+=`
`+d}!f&&!d.trim()&&(f=!0),l+=j+`
`,e=e.substring(j.length+1),u=d.slice(p)}}n.loose||(o?n.loose=!0:/\n *\n *$/.test(l)&&(o=!0));let m=null,_;this.options.gfm&&(m=/^\[[ xX]\] /.exec(c),m&&(_=m[0]!=="[ ] ",c=c.replace(/^\[[ xX]\] +/,""))),n.items.push({type:"list_item",raw:l,task:!!m,checked:_,loose:!1,text:c,tokens:[]}),n.raw+=l}n.items[n.items.length-1].raw=n.items[n.items.length-1].raw.trimEnd(),n.items[n.items.length-1].text=n.items[n.items.length-1].text.trimEnd(),n.raw=n.raw.trimEnd();for(let a=0;a<n.items.length;a++)if(this.lexer.state.top=!1,n.items[a].tokens=this.lexer.blockTokens(n.items[a].text,[]),!n.loose){const l=n.items[a].tokens.filter(u=>u.type==="space"),c=l.length>0&&l.some(u=>/\n.*\n/.test(u.raw));n.loose=c}if(n.loose)for(let a=0;a<n.items.length;a++)n.items[a].loose=!0;return n}}html(e){const t=this.rules.block.html.exec(e);if(t)return{type:"html",block:!0,raw:t[0],pre:t[1]==="pre"||t[1]==="script"||t[1]==="style",text:t[0]}}def(e){const t=this.rules.block.def.exec(e);if(t){const i=t[1].toLowerCase().replace(/\s+/g," "),r=t[2]?t[2].replace(/^<(.*)>$/,"$1").replace(this.rules.inline.anyPunctuation,"$1"):"",n=t[3]?t[3].substring(1,t[3].length-1).replace(this.rules.inline.anyPunctuation,"$1"):t[3];return{type:"def",tag:i,raw:t[0],href:r,title:n}}}table(e){const t=this.rules.block.table.exec(e);if(!t||!/[:|]/.test(t[2]))return;const i=Gx(t[1]),r=t[2].replace(/^\||\| *$/g,"").split("|"),n=t[3]&&t[3].trim()?t[3].replace(/\n[ \t]*$/,"").split(`
`):[],s={type:"table",raw:t[0],header:[],align:[],rows:[]};if(i.length===r.length){for(const o of r)/^ *-+: *$/.test(o)?s.align.push("right"):/^ *:-+: *$/.test(o)?s.align.push("center"):/^ *:-+ *$/.test(o)?s.align.push("left"):s.align.push(null);for(let o=0;o<i.length;o++)s.header.push({text:i[o],tokens:this.lexer.inline(i[o]),header:!0,align:s.align[o]});for(const o of n)s.rows.push(Gx(o,s.header.length).map((a,l)=>({text:a,tokens:this.lexer.inline(a),header:!1,align:s.align[l]})));return s}}lheading(e){const t=this.rules.block.lheading.exec(e);if(t)return{type:"heading",raw:t[0],depth:t[2].charAt(0)==="="?1:2,text:t[1],tokens:this.lexer.inline(t[1])}}paragraph(e){const t=this.rules.block.paragraph.exec(e);if(t){const i=t[1].charAt(t[1].length-1)===`
`?t[1].slice(0,-1):t[1];return{type:"paragraph",raw:t[0],text:i,tokens:this.lexer.inline(i)}}}text(e){const t=this.rules.block.text.exec(e);if(t)return{type:"text",raw:t[0],text:t[0],tokens:this.lexer.inline(t[0])}}escape(e){const t=this.rules.inline.escape.exec(e);if(t)return{type:"escape",raw:t[0],text:Ui(t[1])}}tag(e){const t=this.rules.inline.tag.exec(e);if(t)return!this.lexer.state.inLink&&/^<a /i.test(t[0])?this.lexer.state.inLink=!0:this.lexer.state.inLink&&/^<\/a>/i.test(t[0])&&(this.lexer.state.inLink=!1),!this.lexer.state.inRawBlock&&/^<(pre|code|kbd|script)(\s|>)/i.test(t[0])?this.lexer.state.inRawBlock=!0:this.lexer.state.inRawBlock&&/^<\/(pre|code|kbd|script)(\s|>)/i.test(t[0])&&(this.lexer.state.inRawBlock=!1),{type:"html",raw:t[0],inLink:this.lexer.state.inLink,inRawBlock:this.lexer.state.inRawBlock,block:!1,text:t[0]}}link(e){const t=this.rules.inline.link.exec(e);if(t){const i=t[2].trim();if(!this.options.pedantic&&/^</.test(i)){if(!/>$/.test(i))return;const s=Cl(i.slice(0,-1),"\\");if((i.length-s.length)%2===0)return}else{const s=Q8(t[2],"()");if(s>-1){const a=(t[0].indexOf("!")===0?5:4)+t[1].length+s;t[2]=t[2].substring(0,s),t[0]=t[0].substring(0,a).trim(),t[3]=""}}let r=t[2],n="";if(this.options.pedantic){const s=/^([^'"]*[^\s])\s+(['"])(.*)\2/.exec(r);s&&(r=s[1],n=s[3])}else n=t[3]?t[3].slice(1,-1):"";return r=r.trim(),/^</.test(r)&&(this.options.pedantic&&!/>$/.test(i)?r=r.slice(1):r=r.slice(1,-1)),Qx(t,{href:r&&r.replace(this.rules.inline.anyPunctuation,"$1"),title:n&&n.replace(this.rules.inline.anyPunctuation,"$1")},t[0],this.lexer)}}reflink(e,t){let i;if((i=this.rules.inline.reflink.exec(e))||(i=this.rules.inline.nolink.exec(e))){const r=(i[2]||i[1]).replace(/\s+/g," "),n=t[r.toLowerCase()];if(!n){const s=i[0].charAt(0);return{type:"text",raw:s,text:s}}return Qx(i,n,i[0],this.lexer)}}emStrong(e,t,i=""){let r=this.rules.inline.emStrongLDelim.exec(e);if(!r||r[3]&&i.match(/[\p{L}\p{N}]/u))return;if(!(r[1]||r[2]||"")||!i||this.rules.inline.punctuation.exec(i)){const s=[...r[0]].length-1;let o,a,l=s,c=0;const u=r[0][0]==="*"?this.rules.inline.emStrongRDelimAst:this.rules.inline.emStrongRDelimUnd;for(u.lastIndex=0,t=t.slice(-1*e.length+s);(r=u.exec(t))!=null;){if(o=r[1]||r[2]||r[3]||r[4]||r[5]||r[6],!o)continue;if(a=[...o].length,r[3]||r[4]){l+=a;continue}else if((r[5]||r[6])&&s%3&&!((s+a)%3)){c+=a;continue}if(l-=a,l>0)continue;a=Math.min(a,a+l+c);const d=[...r[0]][0].length,f=e.slice(0,s+r.index+d+a);if(Math.min(s,a)%2){const m=f.slice(1,-1);return{type:"em",raw:f,text:m,tokens:this.lexer.inlineTokens(m)}}const p=f.slice(2,-2);return{type:"strong",raw:f,text:p,tokens:this.lexer.inlineTokens(p)}}}}codespan(e){const t=this.rules.inline.code.exec(e);if(t){let i=t[2].replace(/\n/g," ");const r=/[^ ]/.test(i),n=/^ /.test(i)&&/ $/.test(i);return r&&n&&(i=i.substring(1,i.length-1)),i=Ui(i,!0),{type:"codespan",raw:t[0],text:i}}}br(e){const t=this.rules.inline.br.exec(e);if(t)return{type:"br",raw:t[0]}}del(e){const t=this.rules.inline.del.exec(e);if(t)return{type:"del",raw:t[0],text:t[2],tokens:this.lexer.inlineTokens(t[2])}}autolink(e){const t=this.rules.inline.autolink.exec(e);if(t){let i,r;return t[2]==="@"?(i=Ui(t[1]),r="mailto:"+i):(i=Ui(t[1]),r=i),{type:"link",raw:t[0],text:i,href:r,tokens:[{type:"text",raw:i,text:i}]}}}url(e){let t;if(t=this.rules.inline.url.exec(e)){let i,r;if(t[2]==="@")i=Ui(t[0]),r="mailto:"+i;else{let n;do n=t[0],t[0]=this.rules.inline._backpedal.exec(t[0])?.[0]??"";while(n!==t[0]);i=Ui(t[0]),t[1]==="www."?r="http://"+t[0]:r=t[0]}return{type:"link",raw:t[0],text:i,href:r,tokens:[{type:"text",raw:i,text:i}]}}}inlineText(e){const t=this.rules.inline.text.exec(e);if(t){let i;return this.lexer.state.inRawBlock?i=t[0]:i=Ui(t[0]),{type:"text",raw:t[0],text:i}}}},X8=/^(?: *(?:\n|$))+/,Z8=/^( {4}[^\n]+(?:\n(?: *(?:\n|$))*)?)+/,K8=/^ {0,3}(`{3,}(?=[^`\n]*(?:\n|$))|~{3,})([^\n]*)(?:\n|$)(?:|([\s\S]*?)(?:\n|$))(?: {0,3}\1[~`]* *(?=\n|$)|$)/,Dl=/^ {0,3}((?:-[\t ]*){3,}|(?:_[ \t]*){3,}|(?:\*[ \t]*){3,})(?:\n+|$)/,Y8=/^ {0,3}(#{1,6})(?=\s|$)(.*)(?:\n+|$)/,Jx=/(?:[*+-]|\d{1,9}[.)])/,Xx=lt(/^(?!bull |blockCode|fences|blockquote|heading|html)((?:.|\n(?!\s*?\n|bull |blockCode|fences|blockquote|heading|html))+?)\n {0,3}(=+|-+) *(?:\n+|$)/).replace(/bull/g,Jx).replace(/blockCode/g,/ {4}/).replace(/fences/g,/ {0,3}(?:`{3,}|~{3,})/).replace(/blockquote/g,/ {0,3}>/).replace(/heading/g,/ {0,3}#{1,6}/).replace(/html/g,/ {0,3}<[^\n>]+>\n/).getRegex(),um=/^([^\n]+(?:\n(?!hr|heading|lheading|blockquote|fences|list|html|table| +\n)[^\n]+)*)/,eA=/^[^\n]+/,dm=/(?!\s*\])(?:\\.|[^\[\]\\])+/,tA=lt(/^ {0,3}\[(label)\]: *(?:\n *)?([^<\s][^\s]*|<.*?>)(?:(?: +(?:\n *)?| *\n *)(title))? *(?:\n+|$)/).replace("label",dm).replace("title",/(?:"(?:\\"?|[^"\\])*"|'[^'\n]*(?:\n[^'\n]+)*\n?'|\([^()]*\))/).getRegex(),iA=lt(/^( {0,3}bull)([ \t][^\n]+?)?(?:\n|$)/).replace(/bull/g,Jx).getRegex(),ad="address|article|aside|base|basefont|blockquote|body|caption|center|col|colgroup|dd|details|dialog|dir|div|dl|dt|fieldset|figcaption|figure|footer|form|frame|frameset|h[1-6]|head|header|hr|html|iframe|legend|li|link|main|menu|menuitem|meta|nav|noframes|ol|optgroup|option|p|param|search|section|summary|table|tbody|td|tfoot|th|thead|title|tr|track|ul",hm=/<!--(?:-?>|[\s\S]*?(?:-->|$))/,rA=lt("^ {0,3}(?:<(script|pre|style|textarea)[\\s>][\\s\\S]*?(?:</\\1>[^\\n]*\\n+|$)|comment[^\\n]*(\\n+|$)|<\\?[\\s\\S]*?(?:\\?>\\n*|$)|<![A-Z][\\s\\S]*?(?:>\\n*|$)|<!\\[CDATA\\[[\\s\\S]*?(?:\\]\\]>\\n*|$)|</?(tag)(?: +|\\n|/?>)[\\s\\S]*?(?:(?:\\n *)+\\n|$)|<(?!script|pre|style|textarea)([a-z][\\w-]*)(?:attribute)*? */?>(?=[ \\t]*(?:\\n|$))[\\s\\S]*?(?:(?:\\n *)+\\n|$)|</(?!script|pre|style|textarea)[a-z][\\w-]*\\s*>(?=[ \\t]*(?:\\n|$))[\\s\\S]*?(?:(?:\\n *)+\\n|$))","i").replace("comment",hm).replace("tag",ad).replace("attribute",/ +[a-zA-Z:_][\w.:-]*(?: *= *"[^"\n]*"| *= *'[^'\n]*'| *= *[^\s"'=<>`]+)?/).getRegex(),Zx=lt(um).replace("hr",Dl).replace("heading"," {0,3}#{1,6}(?:\\s|$)").replace("|lheading","").replace("|table","").replace("blockquote"," {0,3}>").replace("fences"," {0,3}(?:`{3,}(?=[^`\\n]*\\n)|~{3,})[^\\n]*\\n").replace("list"," {0,3}(?:[*+-]|1[.)]) ").replace("html","</?(?:tag)(?: +|\\n|/?>)|<(?:script|pre|style|textarea|!--)").replace("tag",ad).getRegex(),nA=lt(/^( {0,3}> ?(paragraph|[^\n]*)(?:\n|$))+/).replace("paragraph",Zx).getRegex(),fm={blockquote:nA,code:Z8,def:tA,fences:K8,heading:Y8,hr:Dl,html:rA,lheading:Xx,list:iA,newline:X8,paragraph:Zx,table:El,text:eA},Kx=lt("^ *([^\\n ].*)\\n {0,3}((?:\\| *)?:?-+:? *(?:\\| *:?-+:? *)*(?:\\| *)?)(?:\\n((?:(?! *\\n|hr|heading|blockquote|code|fences|list|html).*(?:\\n|$))*)\\n*|$)").replace("hr",Dl).replace("heading"," {0,3}#{1,6}(?:\\s|$)").replace("blockquote"," {0,3}>").replace("code"," {4}[^\\n]").replace("fences"," {0,3}(?:`{3,}(?=[^`\\n]*\\n)|~{3,})[^\\n]*\\n").replace("list"," {0,3}(?:[*+-]|1[.)]) ").replace("html","</?(?:tag)(?: +|\\n|/?>)|<(?:script|pre|style|textarea|!--)").replace("tag",ad).getRegex(),sA={...fm,table:Kx,paragraph:lt(um).replace("hr",Dl).replace("heading"," {0,3}#{1,6}(?:\\s|$)").replace("|lheading","").replace("table",Kx).replace("blockquote"," {0,3}>").replace("fences"," {0,3}(?:`{3,}(?=[^`\\n]*\\n)|~{3,})[^\\n]*\\n").replace("list"," {0,3}(?:[*+-]|1[.)]) ").replace("html","</?(?:tag)(?: +|\\n|/?>)|<(?:script|pre|style|textarea|!--)").replace("tag",ad).getRegex()},oA={...fm,html:lt(`^ *(?:comment *(?:\\n|\\s*$)|<(tag)[\\s\\S]+?</\\1> *(?:\\n{2,}|\\s*$)|<tag(?:"[^"]*"|'[^']*'|\\s[^'"/>\\s]*)*?/?> *(?:\\n{2,}|\\s*$))`).replace("comment",hm).replace(/tag/g,"(?!(?:a|em|strong|small|s|cite|q|dfn|abbr|data|time|code|var|samp|kbd|sub|sup|i|b|u|mark|ruby|rt|rp|bdi|bdo|span|br|wbr|ins|del|img)\\b)\\w+(?!:|[^\\w\\s@]*@)\\b").getRegex(),def:/^ *\[([^\]]+)\]: *<?([^\s>]+)>?(?: +(["(][^\n]+[")]))? *(?:\n+|$)/,heading:/^(#{1,6})(.*)(?:\n+|$)/,fences:El,lheading:/^(.+?)\n {0,3}(=+|-+) *(?:\n+|$)/,paragraph:lt(um).replace("hr",Dl).replace("heading",` *#{1,6} *[^
]`).replace("lheading",Xx).replace("|table","").replace("blockquote"," {0,3}>").replace("|fences","").replace("|list","").replace("|html","").replace("|tag","").getRegex()},Yx=/^\\([!"#$%&'()*+,\-./:;<=>?@\[\]\\^_`{|}~])/,aA=/^(`+)([^`]|[^`][\s\S]*?[^`])\1(?!`)/,eS=/^( {2,}|\\)\n(?!\s*$)/,lA=/^(`+|[^`])(?:(?= {2,}\n)|[\s\S]*?(?:(?=[\\<!\[`*_]|\b_|$)|[^ ](?= {2,}\n)))/,Il="\\p{P}\\p{S}",cA=lt(/^((?![*_])[\spunctuation])/,"u").replace(/punctuation/g,Il).getRegex(),uA=/\[[^[\]]*?\]\([^\(\)]*?\)|`[^`]*?`|<[^<>]*?>/g,dA=lt(/^(?:\*+(?:((?!\*)[punct])|[^\s*]))|^_+(?:((?!_)[punct])|([^\s_]))/,"u").replace(/punct/g,Il).getRegex(),hA=lt("^[^_*]*?__[^_*]*?\\*[^_*]*?(?=__)|[^*]+(?=[^*])|(?!\\*)[punct](\\*+)(?=[\\s]|$)|[^punct\\s](\\*+)(?!\\*)(?=[punct\\s]|$)|(?!\\*)[punct\\s](\\*+)(?=[^punct\\s])|[\\s](\\*+)(?!\\*)(?=[punct])|(?!\\*)[punct](\\*+)(?!\\*)(?=[punct])|[^punct\\s](\\*+)(?=[^punct\\s])","gu").replace(/punct/g,Il).getRegex(),fA=lt("^[^_*]*?\\*\\*[^_*]*?_[^_*]*?(?=\\*\\*)|[^_]+(?=[^_])|(?!_)[punct](_+)(?=[\\s]|$)|[^punct\\s](_+)(?!_)(?=[punct\\s]|$)|(?!_)[punct\\s](_+)(?=[^punct\\s])|[\\s](_+)(?!_)(?=[punct])|(?!_)[punct](_+)(?!_)(?=[punct])","gu").replace(/punct/g,Il).getRegex(),pA=lt(/\\([punct])/,"gu").replace(/punct/g,Il).getRegex(),gA=lt(/^<(scheme:[^\s\x00-\x1f<>]*|email)>/).replace("scheme",/[a-zA-Z][a-zA-Z0-9+.-]{1,31}/).replace("email",/[a-zA-Z0-9.!#$%&'*+/=?^_`{|}~-]+(@)[a-zA-Z0-9](?:[a-zA-Z0-9-]{0,61}[a-zA-Z0-9])?(?:\.[a-zA-Z0-9](?:[a-zA-Z0-9-]{0,61}[a-zA-Z0-9])?)+(?![-_])/).getRegex(),mA=lt(hm).replace("(?:-->|$)","-->").getRegex(),vA=lt("^comment|^</[a-zA-Z][\\w:-]*\\s*>|^<[a-zA-Z][\\w-]*(?:attribute)*?\\s*/?>|^<\\?[\\s\\S]*?\\?>|^<![a-zA-Z]+\\s[\\s\\S]*?>|^<!\\[CDATA\\[[\\s\\S]*?\\]\\]>").replace("comment",mA).replace("attribute",/\s+[a-zA-Z:_][\w.:-]*(?:\s*=\s*"[^"]*"|\s*=\s*'[^']*'|\s*=\s*[^\s"'=<>`]+)?/).getRegex(),ld=/(?:\[(?:\\.|[^\[\]\\])*\]|\\.|`[^`]*`|[^\[\]\\`])*?/,_A=lt(/^!?\[(label)\]\(\s*(href)(?:\s+(title))?\s*\)/).replace("label",ld).replace("href",/<(?:\\.|[^\n<>\\])+>|[^\s\x00-\x1f]*/).replace("title",/"(?:\\"?|[^"\\])*"|'(?:\\'?|[^'\\])*'|\((?:\\\)?|[^)\\])*\)/).getRegex(),tS=lt(/^!?\[(label)\]\[(ref)\]/).replace("label",ld).replace("ref",dm).getRegex(),iS=lt(/^!?\[(ref)\](?:\[\])?/).replace("ref",dm).getRegex(),wA=lt("reflink|nolink(?!\\()","g").replace("reflink",tS).replace("nolink",iS).getRegex(),pm={_backpedal:El,anyPunctuation:pA,autolink:gA,blockSkip:uA,br:eS,code:aA,del:El,emStrongLDelim:dA,emStrongRDelimAst:hA,emStrongRDelimUnd:fA,escape:Yx,link:_A,nolink:iS,punctuation:cA,reflink:tS,reflinkSearch:wA,tag:vA,text:lA,url:El},yA={...pm,link:lt(/^!?\[(label)\]\((.*?)\)/).replace("label",ld).getRegex(),reflink:lt(/^!?\[(label)\]\s*\[([^\]]*)\]/).replace("label",ld).getRegex()},gm={...pm,escape:lt(Yx).replace("])","~|])").getRegex(),url:lt(/^((?:ftp|https?):\/\/|www\.)(?:[a-zA-Z0-9\-]+\.?)+[^\s<]*|^email/,"i").replace("email",/[A-Za-z0-9._+-]+(@)[a-zA-Z0-9-_]+(?:\.[a-zA-Z0-9-_]*[a-zA-Z0-9])+(?![-_])/).getRegex(),_backpedal:/(?:[^?!.,:;*_'"~()&]+|\([^)]*\)|&(?![a-zA-Z0-9]+;$)|[?!.,:;*_'"~)]+(?!$))+/,del:/^(~~?)(?=[^\s~])([\s\S]*?[^\s~])\1(?=[^~]|$)/,text:/^([`~]+|[^`~])(?:(?= {2,}\n)|(?=[a-zA-Z0-9.!#$%&'*+\/=?_`{\|}~-]+@)|[\s\S]*?(?:(?=[\\<!\[`*~_]|\b_|https?:\/\/|ftp:\/\/|www\.|$)|[^ ](?= {2,}\n)|[^a-zA-Z0-9.!#$%&'*+\/=?_`{\|}~-](?=[a-zA-Z0-9.!#$%&'*+\/=?_`{\|}~-]+@)))/},bA={...gm,br:lt(eS).replace("{2,}","*").getRegex(),text:lt(gm.text).replace("\\b_","\\b_| {2,}\\n").replace(/\{2,\}/g,"*").getRegex()},cd={normal:fm,gfm:sA,pedantic:oA},kl={normal:pm,gfm:gm,breaks:bA,pedantic:yA},xs=class Iw{tokens;options;state;tokenizer;inlineQueue;constructor(t){this.tokens=[],this.tokens.links=Object.create(null),this.options=t||bs,this.options.tokenizer=this.options.tokenizer||new od,this.tokenizer=this.options.tokenizer,this.tokenizer.options=this.options,this.tokenizer.lexer=this,this.inlineQueue=[],this.state={inLink:!1,inRawBlock:!1,top:!0};const i={block:cd.normal,inline:kl.normal};this.options.pedantic?(i.block=cd.pedantic,i.inline=kl.pedantic):this.options.gfm&&(i.block=cd.gfm,this.options.breaks?i.inline=kl.breaks:i.inline=kl.gfm),this.tokenizer.rules=i}static get rules(){return{block:cd,inline:kl}}static lex(t,i){return new Iw(i).lex(t)}static lexInline(t,i){return new Iw(i).inlineTokens(t)}lex(t){t=t.replace(/\r\n|\r/g,`
`),this.blockTokens(t,this.tokens);for(let i=0;i<this.inlineQueue.length;i++){const r=this.inlineQueue[i];this.inlineTokens(r.src,r.tokens)}return this.inlineQueue=[],this.tokens}blockTokens(t,i=[],r=!1){this.options.pedantic?t=t.replace(/\t/g,"    ").replace(/^ +$/gm,""):t=t.replace(/^( *)(\t+)/gm,(a,l,c)=>l+"    ".repeat(c.length));let n,s,o;for(;t;)if(!(this.options.extensions&&this.options.extensions.block&&this.options.extensions.block.some(a=>(n=a.call({lexer:this},t,i))?(t=t.substring(n.raw.length),i.push(n),!0):!1))){if(n=this.tokenizer.space(t)){t=t.substring(n.raw.length),n.raw.length===1&&i.length>0?i[i.length-1].raw+=`
`:i.push(n);continue}if(n=this.tokenizer.code(t)){t=t.substring(n.raw.length),s=i[i.length-1],s&&(s.type==="paragraph"||s.type==="text")?(s.raw+=`
`+n.raw,s.text+=`
`+n.text,this.inlineQueue[this.inlineQueue.length-1].src=s.text):i.push(n);continue}if(n=this.tokenizer.fences(t)){t=t.substring(n.raw.length),i.push(n);continue}if(n=this.tokenizer.heading(t)){t=t.substring(n.raw.length),i.push(n);continue}if(n=this.tokenizer.hr(t)){t=t.substring(n.raw.length),i.push(n);continue}if(n=this.tokenizer.blockquote(t)){t=t.substring(n.raw.length),i.push(n);continue}if(n=this.tokenizer.list(t)){t=t.substring(n.raw.length),i.push(n);continue}if(n=this.tokenizer.html(t)){t=t.substring(n.raw.length),i.push(n);continue}if(n=this.tokenizer.def(t)){t=t.substring(n.raw.length),s=i[i.length-1],s&&(s.type==="paragraph"||s.type==="text")?(s.raw+=`
`+n.raw,s.text+=`
`+n.raw,this.inlineQueue[this.inlineQueue.length-1].src=s.text):this.tokens.links[n.tag]||(this.tokens.links[n.tag]={href:n.href,title:n.title});continue}if(n=this.tokenizer.table(t)){t=t.substring(n.raw.length),i.push(n);continue}if(n=this.tokenizer.lheading(t)){t=t.substring(n.raw.length),i.push(n);continue}if(o=t,this.options.extensions&&this.options.extensions.startBlock){let a=1/0;const l=t.slice(1);let c;this.options.extensions.startBlock.forEach(u=>{c=u.call({lexer:this},l),typeof c=="number"&&c>=0&&(a=Math.min(a,c))}),a<1/0&&a>=0&&(o=t.substring(0,a+1))}if(this.state.top&&(n=this.tokenizer.paragraph(o))){s=i[i.length-1],r&&s?.type==="paragraph"?(s.raw+=`
`+n.raw,s.text+=`
`+n.text,this.inlineQueue.pop(),this.inlineQueue[this.inlineQueue.length-1].src=s.text):i.push(n),r=o.length!==t.length,t=t.substring(n.raw.length);continue}if(n=this.tokenizer.text(t)){t=t.substring(n.raw.length),s=i[i.length-1],s&&s.type==="text"?(s.raw+=`
`+n.raw,s.text+=`
`+n.text,this.inlineQueue.pop(),this.inlineQueue[this.inlineQueue.length-1].src=s.text):i.push(n);continue}if(t){const a="Infinite loop on byte: "+t.charCodeAt(0);if(this.options.silent){console.error(a);break}else throw new Error(a)}}return this.state.top=!0,i}inline(t,i=[]){return this.inlineQueue.push({src:t,tokens:i}),i}inlineTokens(t,i=[]){let r,n,s,o=t,a,l,c;if(this.tokens.links){const u=Object.keys(this.tokens.links);if(u.length>0)for(;(a=this.tokenizer.rules.inline.reflinkSearch.exec(o))!=null;)u.includes(a[0].slice(a[0].lastIndexOf("[")+1,-1))&&(o=o.slice(0,a.index)+"["+"a".repeat(a[0].length-2)+"]"+o.slice(this.tokenizer.rules.inline.reflinkSearch.lastIndex))}for(;(a=this.tokenizer.rules.inline.blockSkip.exec(o))!=null;)o=o.slice(0,a.index)+"["+"a".repeat(a[0].length-2)+"]"+o.slice(this.tokenizer.rules.inline.blockSkip.lastIndex);for(;(a=this.tokenizer.rules.inline.anyPunctuation.exec(o))!=null;)o=o.slice(0,a.index)+"++"+o.slice(this.tokenizer.rules.inline.anyPunctuation.lastIndex);for(;t;)if(l||(c=""),l=!1,!(this.options.extensions&&this.options.extensions.inline&&this.options.extensions.inline.some(u=>(r=u.call({lexer:this},t,i))?(t=t.substring(r.raw.length),i.push(r),!0):!1))){if(r=this.tokenizer.escape(t)){t=t.substring(r.raw.length),i.push(r);continue}if(r=this.tokenizer.tag(t)){t=t.substring(r.raw.length),n=i[i.length-1],n&&r.type==="text"&&n.type==="text"?(n.raw+=r.raw,n.text+=r.text):i.push(r);continue}if(r=this.tokenizer.link(t)){t=t.substring(r.raw.length),i.push(r);continue}if(r=this.tokenizer.reflink(t,this.tokens.links)){t=t.substring(r.raw.length),n=i[i.length-1],n&&r.type==="text"&&n.type==="text"?(n.raw+=r.raw,n.text+=r.text):i.push(r);continue}if(r=this.tokenizer.emStrong(t,o,c)){t=t.substring(r.raw.length),i.push(r);continue}if(r=this.tokenizer.codespan(t)){t=t.substring(r.raw.length),i.push(r);continue}if(r=this.tokenizer.br(t)){t=t.substring(r.raw.length),i.push(r);continue}if(r=this.tokenizer.del(t)){t=t.substring(r.raw.length),i.push(r);continue}if(r=this.tokenizer.autolink(t)){t=t.substring(r.raw.length),i.push(r);continue}if(!this.state.inLink&&(r=this.tokenizer.url(t))){t=t.substring(r.raw.length),i.push(r);continue}if(s=t,this.options.extensions&&this.options.extensions.startInline){let u=1/0;const d=t.slice(1);let f;this.options.extensions.startInline.forEach(p=>{f=p.call({lexer:this},d),typeof f=="number"&&f>=0&&(u=Math.min(u,f))}),u<1/0&&u>=0&&(s=t.substring(0,u+1))}if(r=this.tokenizer.inlineText(s)){t=t.substring(r.raw.length),r.raw.slice(-1)!=="_"&&(c=r.raw.slice(-1)),l=!0,n=i[i.length-1],n&&n.type==="text"?(n.raw+=r.raw,n.text+=r.text):i.push(r);continue}if(t){const u="Infinite loop on byte: "+t.charCodeAt(0);if(this.options.silent){console.error(u);break}else throw new Error(u)}}return i}},ud=class{options;parser;constructor(e){this.options=e||bs}space(e){return""}code({text:e,lang:t,escaped:i}){const r=(t||"").match(/^\S*/)?.[0],n=e.replace(/\n$/,"")+`
`;return r?'<pre><code class="language-'+Ui(r)+'">'+(i?n:Ui(n,!0))+`</code></pre>
`:"<pre><code>"+(i?n:Ui(n,!0))+`</code></pre>
`}blockquote({tokens:e}){return`<blockquote>
${this.parser.parse(e)}</blockquote>
`}html({text:e}){return e}heading({tokens:e,depth:t}){return`<h${t}>${this.parser.parseInline(e)}</h${t}>
`}hr(e){return`<hr>
`}list(e){const t=e.ordered,i=e.start;let r="";for(let o=0;o<e.items.length;o++){const a=e.items[o];r+=this.listitem(a)}const n=t?"ol":"ul",s=t&&i!==1?' start="'+i+'"':"";return"<"+n+s+`>
`+r+"</"+n+`>
`}listitem(e){let t="";if(e.task){const i=this.checkbox({checked:!!e.checked});e.loose?e.tokens.length>0&&e.tokens[0].type==="paragraph"?(e.tokens[0].text=i+" "+e.tokens[0].text,e.tokens[0].tokens&&e.tokens[0].tokens.length>0&&e.tokens[0].tokens[0].type==="text"&&(e.tokens[0].tokens[0].text=i+" "+e.tokens[0].tokens[0].text)):e.tokens.unshift({type:"text",raw:i+" ",text:i+" "}):t+=i+" "}return t+=this.parser.parse(e.tokens,!!e.loose),`<li>${t}</li>
`}checkbox({checked:e}){return"<input "+(e?'checked="" ':"")+'disabled="" type="checkbox">'}paragraph({tokens:e}){return`<p>${this.parser.parseInline(e)}</p>
`}table(e){let t="",i="";for(let n=0;n<e.header.length;n++)i+=this.tablecell(e.header[n]);t+=this.tablerow({text:i});let r="";for(let n=0;n<e.rows.length;n++){const s=e.rows[n];i="";for(let o=0;o<s.length;o++)i+=this.tablecell(s[o]);r+=this.tablerow({text:i})}return r&&(r=`<tbody>${r}</tbody>`),`<table>
<thead>
`+t+`</thead>
`+r+`</table>
`}tablerow({text:e}){return`<tr>
${e}</tr>
`}tablecell(e){const t=this.parser.parseInline(e.tokens),i=e.header?"th":"td";return(e.align?`<${i} align="${e.align}">`:`<${i}>`)+t+`</${i}>
`}strong({tokens:e}){return`<strong>${this.parser.parseInline(e)}</strong>`}em({tokens:e}){return`<em>${this.parser.parseInline(e)}</em>`}codespan({text:e}){return`<code>${e}</code>`}br(e){return"<br>"}del({tokens:e}){return`<del>${this.parser.parseInline(e)}</del>`}link({href:e,title:t,tokens:i}){const r=this.parser.parseInline(i),n=jx(e);if(n===null)return r;e=n;let s='<a href="'+e+'"';return t&&(s+=' title="'+t+'"'),s+=">"+r+"</a>",s}image({href:e,title:t,text:i}){const r=jx(e);if(r===null)return i;e=r;let n=`<img src="${e}" alt="${i}"`;return t&&(n+=` title="${t}"`),n+=">",n}text(e){return"tokens"in e&&e.tokens?this.parser.parseInline(e.tokens):e.text}},mm=class{strong({text:e}){return e}em({text:e}){return e}codespan({text:e}){return e}del({text:e}){return e}html({text:e}){return e}text({text:e}){return e}link({text:e}){return""+e}image({text:e}){return""+e}br(){return""}},Ss=class kw{options;renderer;textRenderer;constructor(t){this.options=t||bs,this.options.renderer=this.options.renderer||new ud,this.renderer=this.options.renderer,this.renderer.options=this.options,this.renderer.parser=this,this.textRenderer=new mm}static parse(t,i){return new kw(i).parse(t)}static parseInline(t,i){return new kw(i).parseInline(t)}parse(t,i=!0){let r="";for(let n=0;n<t.length;n++){const s=t[n];if(this.options.extensions&&this.options.extensions.renderers&&this.options.extensions.renderers[s.type]){const a=s,l=this.options.extensions.renderers[a.type].call({parser:this},a);if(l!==!1||!["space","hr","heading","code","table","blockquote","list","html","paragraph","text"].includes(a.type)){r+=l||"";continue}}const o=s;switch(o.type){case"space":{r+=this.renderer.space(o);continue}case"hr":{r+=this.renderer.hr(o);continue}case"heading":{r+=this.renderer.heading(o);continue}case"code":{r+=this.renderer.code(o);continue}case"table":{r+=this.renderer.table(o);continue}case"blockquote":{r+=this.renderer.blockquote(o);continue}case"list":{r+=this.renderer.list(o);continue}case"html":{r+=this.renderer.html(o);continue}case"paragraph":{r+=this.renderer.paragraph(o);continue}case"text":{let a=o,l=this.renderer.text(a);for(;n+1<t.length&&t[n+1].type==="text";)a=t[++n],l+=`
`+this.renderer.text(a);i?r+=this.renderer.paragraph({type:"paragraph",raw:l,text:l,tokens:[{type:"text",raw:l,text:l}]}):r+=l;continue}default:{const a='Token with "'+o.type+'" type was not found.';if(this.options.silent)return console.error(a),"";throw new Error(a)}}}return r}parseInline(t,i){i=i||this.renderer;let r="";for(let n=0;n<t.length;n++){const s=t[n];if(this.options.extensions&&this.options.extensions.renderers&&this.options.extensions.renderers[s.type]){const a=this.options.extensions.renderers[s.type].call({parser:this},s);if(a!==!1||!["escape","html","link","image","strong","em","codespan","br","del","text"].includes(s.type)){r+=a||"";continue}}const o=s;switch(o.type){case"escape":{r+=i.text(o);break}case"html":{r+=i.html(o);break}case"link":{r+=i.link(o);break}case"image":{r+=i.image(o);break}case"strong":{r+=i.strong(o);break}case"em":{r+=i.em(o);break}case"codespan":{r+=i.codespan(o);break}case"br":{r+=i.br(o);break}case"del":{r+=i.del(o);break}case"text":{r+=i.text(o);break}default:{const a='Token with "'+o.type+'" type was not found.';if(this.options.silent)return console.error(a),"";throw new Error(a)}}}return r}},dd=class{options;constructor(e){this.options=e||bs}static passThroughHooks=new Set(["preprocess","postprocess","processAllTokens"]);preprocess(e){return e}postprocess(e){return e}processAllTokens(e){return e}},xA=class{defaults=cm();options=this.setOptions;parse=this.parseMarkdown(xs.lex,Ss.parse);parseInline=this.parseMarkdown(xs.lexInline,Ss.parseInline);Parser=Ss;Renderer=ud;TextRenderer=mm;Lexer=xs;Tokenizer=od;Hooks=dd;constructor(...e){this.use(...e)}walkTokens(e,t){let i=[];for(const r of e)switch(i=i.concat(t.call(this,r)),r.type){case"table":{const n=r;for(const s of n.header)i=i.concat(this.walkTokens(s.tokens,t));for(const s of n.rows)for(const o of s)i=i.concat(this.walkTokens(o.tokens,t));break}case"list":{const n=r;i=i.concat(this.walkTokens(n.items,t));break}default:{const n=r;this.defaults.extensions?.childTokens?.[n.type]?this.defaults.extensions.childTokens[n.type].forEach(s=>{const o=n[s].flat(1/0);i=i.concat(this.walkTokens(o,t))}):n.tokens&&(i=i.concat(this.walkTokens(n.tokens,t)))}}return i}use(...e){const t=this.defaults.extensions||{renderers:{},childTokens:{}};return e.forEach(i=>{const r={...i};if(r.async=this.defaults.async||r.async||!1,i.extensions&&(i.extensions.forEach(n=>{if(!n.name)throw new Error("extension name required");if("renderer"in n){const s=t.renderers[n.name];s?t.renderers[n.name]=function(...o){let a=n.renderer.apply(this,o);return a===!1&&(a=s.apply(this,o)),a}:t.renderers[n.name]=n.renderer}if("tokenizer"in n){if(!n.level||n.level!=="block"&&n.level!=="inline")throw new Error("extension level must be 'block' or 'inline'");const s=t[n.level];s?s.unshift(n.tokenizer):t[n.level]=[n.tokenizer],n.start&&(n.level==="block"?t.startBlock?t.startBlock.push(n.start):t.startBlock=[n.start]:n.level==="inline"&&(t.startInline?t.startInline.push(n.start):t.startInline=[n.start]))}"childTokens"in n&&n.childTokens&&(t.childTokens[n.name]=n.childTokens)}),r.extensions=t),i.renderer){const n=this.defaults.renderer||new ud(this.defaults);for(const s in i.renderer){if(!(s in n))throw new Error(`renderer '${s}' does not exist`);if(["options","parser"].includes(s))continue;const o=s,a=i.renderer[o],l=n[o];n[o]=(...c)=>{let u=a.apply(n,c);return u===!1&&(u=l.apply(n,c)),u||""}}r.renderer=n}if(i.tokenizer){const n=this.defaults.tokenizer||new od(this.defaults);for(const s in i.tokenizer){if(!(s in n))throw new Error(`tokenizer '${s}' does not exist`);if(["options","rules","lexer"].includes(s))continue;const o=s,a=i.tokenizer[o],l=n[o];n[o]=(...c)=>{let u=a.apply(n,c);return u===!1&&(u=l.apply(n,c)),u}}r.tokenizer=n}if(i.hooks){const n=this.defaults.hooks||new dd;for(const s in i.hooks){if(!(s in n))throw new Error(`hook '${s}' does not exist`);if(s==="options")continue;const o=s,a=i.hooks[o],l=n[o];dd.passThroughHooks.has(s)?n[o]=c=>{if(this.defaults.async)return Promise.resolve(a.call(n,c)).then(d=>l.call(n,d));const u=a.call(n,c);return l.call(n,u)}:n[o]=(...c)=>{let u=a.apply(n,c);return u===!1&&(u=l.apply(n,c)),u}}r.hooks=n}if(i.walkTokens){const n=this.defaults.walkTokens,s=i.walkTokens;r.walkTokens=function(o){let a=[];return a.push(s.call(this,o)),n&&(a=a.concat(n.call(this,o))),a}}this.defaults={...this.defaults,...r}}),this}setOptions(e){return this.defaults={...this.defaults,...e},this}lexer(e,t){return xs.lex(e,t??this.defaults)}parser(e,t){return Ss.parse(e,t??this.defaults)}parseMarkdown(e,t){return(r,n)=>{const s={...n},o={...this.defaults,...s},a=this.onError(!!o.silent,!!o.async);if(this.defaults.async===!0&&s.async===!1)return a(new Error("marked(): The async option was set to true by an extension. Remove async: false from the parse options object to return a Promise."));if(typeof r>"u"||r===null)return a(new Error("marked(): input parameter is undefined or null"));if(typeof r!="string")return a(new Error("marked(): input parameter is of type "+Object.prototype.toString.call(r)+", string expected"));if(o.hooks&&(o.hooks.options=o),o.async)return Promise.resolve(o.hooks?o.hooks.preprocess(r):r).then(l=>e(l,o)).then(l=>o.hooks?o.hooks.processAllTokens(l):l).then(l=>o.walkTokens?Promise.all(this.walkTokens(l,o.walkTokens)).then(()=>l):l).then(l=>t(l,o)).then(l=>o.hooks?o.hooks.postprocess(l):l).catch(a);try{o.hooks&&(r=o.hooks.preprocess(r));let l=e(r,o);o.hooks&&(l=o.hooks.processAllTokens(l)),o.walkTokens&&this.walkTokens(l,o.walkTokens);let c=t(l,o);return o.hooks&&(c=o.hooks.postprocess(c)),c}catch(l){return a(l)}}}onError(e,t){return i=>{if(i.message+=`
Please report this to https://github.com/markedjs/marked.`,e){const r="<p>An error occurred:</p><pre>"+Ui(i.message+"",!0)+"</pre>";return t?Promise.resolve(r):r}if(t)return Promise.reject(i);throw i}}},Es=new xA;function st(e,t){return Es.parse(e,t)}st.options=st.setOptions=function(e){return Es.setOptions(e),st.defaults=Es.defaults,Wx(st.defaults),st},st.getDefaults=cm,st.defaults=bs,st.use=function(...e){return Es.use(...e),st.defaults=Es.defaults,Wx(st.defaults),st},st.walkTokens=function(e,t){return Es.walkTokens(e,t)},st.parseInline=Es.parseInline,st.Parser=Ss,st.parser=Ss.parse,st.Renderer=ud,st.TextRenderer=mm,st.Lexer=xs,st.lexer=xs.lex,st.Tokenizer=od,st.Hooks=dd,st.parse=st;var tB=st.options,iB=st.setOptions,rB=st.use,nB=st.walkTokens,sB=st.parseInline,oB=Ss.parse,aB=xs.lex;function SA(e){return JSON.stringify(e,EA)}function rS(e){let t=JSON.parse(e);return t=Pt(t),t}function EA(e,t){return t instanceof RegExp?{$mid:2,source:t.source,flags:t.flags}:t}function Pt(e,t=0){if(!e||t>200)return e;if(typeof e=="object"){switch(e.$mid){case 1:return y.revive(e);case 2:return new RegExp(e.source,e.flags);case 17:return new Date(e.source)}if(e instanceof ae||e instanceof Uint8Array)return e;if(Array.isArray(e))for(let i=0;i<e.length;++i)e[i]=Pt(e[i],t+1);else for(const i in e)Object.hasOwnProperty.call(e,i)&&(e[i]=Pt(e[i],t+1))}return e}var Yr=Object.freeze({text:"text/plain",binary:"application/octet-stream",unknown:"application/unknown",markdown:"text/markdown",latex:"text/latex",uriList:"text/uri-list",html:"text/html"}),CA=/^(.+)\/(.+?)(;.+)?$/;function nS(e,t){const i=CA.exec(e);return i?`${i[1].toLowerCase()}/${i[2].toLowerCase()}${i[3]??""}`:t?void 0:e}var li=Symbol("unset"),DA=class{constructor(){this.root=new vm,this._size=0}get size(){return this._size}get nodes(){return this.root.children?.values()||Jt.empty()}get entries(){return this.root.children?.entries()||Jt.empty()}insert(e,t,i){this.opNode(e,r=>r._value=t,i)}mutate(e,t){this.opNode(e,i=>i._value=t(i._value===li?void 0:i._value))}mutatePath(e,t){this.opNode(e,()=>{},i=>t(i))}delete(e){const t=this.getPathToKey(e);if(!t)return;let i=t.length-1;const r=t[i].node._value;if(r!==li){for(this._size--,t[i].node._value=li;i>0;i--){const{node:n,part:s}=t[i];if(n.children?.size||n._value!==li)break;t[i-1].node.children.delete(s)}return r}}*deleteRecursive(e){const t=this.getPathToKey(e);if(!t)return;const i=t[t.length-1].node;for(let r=t.length-1;r>0;r--){const n=t[r-1];if(n.node.children.delete(t[r].part),n.node.children.size>0||n.node._value!==li)break}for(const r of sS(i))r._value!==li&&(this._size--,yield r._value);i===this.root&&(this.root._value=li,this.root.children=void 0)}find(e){let t=this.root;for(const i of e){const r=t.children?.get(i);if(!r)return;t=r}return t._value===li?void 0:t._value}hasKeyOrParent(e){let t=this.root;for(const i of e){const r=t.children?.get(i);if(!r)return!1;if(r._value!==li)return!0;t=r}return!1}hasKeyOrChildren(e){let t=this.root;for(const i of e){const r=t.children?.get(i);if(!r)return!1;t=r}return!0}hasKey(e){let t=this.root;for(const i of e){const r=t.children?.get(i);if(!r)return!1;t=r}return t._value!==li}getPathToKey(e){const t=[{part:"",node:this.root}];let i=0;for(const r of e){const n=t[i].node.children?.get(r);if(!n)return;t.push({part:r,node:n}),i++}return t}opNode(e,t,i){let r=this.root;for(const o of e){if(r.children)if(r.children.has(o))r=r.children.get(o);else{const a=new vm;r.children.set(o,a),r=a}else{const a=new vm;r.children=new Map([[o,a]]),r=a}i?.(r)}const n=r._value===li?0:1;t(r);const s=r._value===li?0:1;this._size+=s-n}*values(){for(const{_value:e}of sS(this.root))e!==li&&(yield e)}};function*sS(e){const t=[e];for(;t.length>0;){const i=t.pop();if(yield i,i.children)for(const r of i.children.values())t.push(r)}}var vm=class{constructor(){this._value=li}get value(){return this._value===li?void 0:this._value}set value(e){this._value=e===void 0?li:e}},Bi=class fo{constructor(t,i){this.lineNumber=t,this.column=i}with(t=this.lineNumber,i=this.column){return t===this.lineNumber&&i===this.column?this:new fo(t,i)}delta(t=0,i=0){return this.with(Math.max(1,this.lineNumber+t),Math.max(1,this.column+i))}equals(t){return fo.equals(this,t)}static equals(t,i){return!t&&!i?!0:!!t&&!!i&&t.lineNumber===i.lineNumber&&t.column===i.column}isBefore(t){return fo.isBefore(this,t)}static isBefore(t,i){return t.lineNumber<i.lineNumber?!0:i.lineNumber<t.lineNumber?!1:t.column<i.column}isBeforeOrEqual(t){return fo.isBeforeOrEqual(this,t)}static isBeforeOrEqual(t,i){return t.lineNumber<i.lineNumber?!0:i.lineNumber<t.lineNumber?!1:t.column<=i.column}static compare(t,i){const r=t.lineNumber|0,n=i.lineNumber|0;if(r===n){const s=t.column|0,o=i.column|0;return s-o}return r-n}clone(){return new fo(this.lineNumber,this.column)}toString(){return"("+this.lineNumber+","+this.column+")"}static lift(t){return new fo(t.lineNumber,t.column)}static isIPosition(t){return t&&typeof t.lineNumber=="number"&&typeof t.column=="number"}toJSON(){return{lineNumber:this.lineNumber,column:this.column}}},Fe=class Nt{constructor(t,i,r,n){t>r||t===r&&i>n?(this.startLineNumber=r,this.startColumn=n,this.endLineNumber=t,this.endColumn=i):(this.startLineNumber=t,this.startColumn=i,this.endLineNumber=r,this.endColumn=n)}isEmpty(){return Nt.isEmpty(this)}static isEmpty(t){return t.startLineNumber===t.endLineNumber&&t.startColumn===t.endColumn}containsPosition(t){return Nt.containsPosition(this,t)}static containsPosition(t,i){return!(i.lineNumber<t.startLineNumber||i.lineNumber>t.endLineNumber||i.lineNumber===t.startLineNumber&&i.column<t.startColumn||i.lineNumber===t.endLineNumber&&i.column>t.endColumn)}static strictContainsPosition(t,i){return!(i.lineNumber<t.startLineNumber||i.lineNumber>t.endLineNumber||i.lineNumber===t.startLineNumber&&i.column<=t.startColumn||i.lineNumber===t.endLineNumber&&i.column>=t.endColumn)}containsRange(t){return Nt.containsRange(this,t)}static containsRange(t,i){return!(i.startLineNumber<t.startLineNumber||i.endLineNumber<t.startLineNumber||i.startLineNumber>t.endLineNumber||i.endLineNumber>t.endLineNumber||i.startLineNumber===t.startLineNumber&&i.startColumn<t.startColumn||i.endLineNumber===t.endLineNumber&&i.endColumn>t.endColumn)}strictContainsRange(t){return Nt.strictContainsRange(this,t)}static strictContainsRange(t,i){return!(i.startLineNumber<t.startLineNumber||i.endLineNumber<t.startLineNumber||i.startLineNumber>t.endLineNumber||i.endLineNumber>t.endLineNumber||i.startLineNumber===t.startLineNumber&&i.startColumn<=t.startColumn||i.endLineNumber===t.endLineNumber&&i.endColumn>=t.endColumn)}plusRange(t){return Nt.plusRange(this,t)}static plusRange(t,i){let r,n,s,o;return i.startLineNumber<t.startLineNumber?(r=i.startLineNumber,n=i.startColumn):i.startLineNumber===t.startLineNumber?(r=i.startLineNumber,n=Math.min(i.startColumn,t.startColumn)):(r=t.startLineNumber,n=t.startColumn),i.endLineNumber>t.endLineNumber?(s=i.endLineNumber,o=i.endColumn):i.endLineNumber===t.endLineNumber?(s=i.endLineNumber,o=Math.max(i.endColumn,t.endColumn)):(s=t.endLineNumber,o=t.endColumn),new Nt(r,n,s,o)}intersectRanges(t){return Nt.intersectRanges(this,t)}static intersectRanges(t,i){let r=t.startLineNumber,n=t.startColumn,s=t.endLineNumber,o=t.endColumn;const a=i.startLineNumber,l=i.startColumn,c=i.endLineNumber,u=i.endColumn;return r<a?(r=a,n=l):r===a&&(n=Math.max(n,l)),s>c?(s=c,o=u):s===c&&(o=Math.min(o,u)),r>s||r===s&&n>o?null:new Nt(r,n,s,o)}equalsRange(t){return Nt.equalsRange(this,t)}static equalsRange(t,i){return!t&&!i?!0:!!t&&!!i&&t.startLineNumber===i.startLineNumber&&t.startColumn===i.startColumn&&t.endLineNumber===i.endLineNumber&&t.endColumn===i.endColumn}getEndPosition(){return Nt.getEndPosition(this)}static getEndPosition(t){return new Bi(t.endLineNumber,t.endColumn)}getStartPosition(){return Nt.getStartPosition(this)}static getStartPosition(t){return new Bi(t.startLineNumber,t.startColumn)}toString(){return"["+this.startLineNumber+","+this.startColumn+" -> "+this.endLineNumber+","+this.endColumn+"]"}setEndPosition(t,i){return new Nt(this.startLineNumber,this.startColumn,t,i)}setStartPosition(t,i){return new Nt(t,i,this.endLineNumber,this.endColumn)}collapseToStart(){return Nt.collapseToStart(this)}static collapseToStart(t){return new Nt(t.startLineNumber,t.startColumn,t.startLineNumber,t.startColumn)}collapseToEnd(){return Nt.collapseToEnd(this)}static collapseToEnd(t){return new Nt(t.endLineNumber,t.endColumn,t.endLineNumber,t.endColumn)}delta(t){return new Nt(this.startLineNumber+t,this.startColumn,this.endLineNumber+t,this.endColumn)}isSingleLine(){return this.startLineNumber===this.endLineNumber}static fromPositions(t,i=t){return new Nt(t.lineNumber,t.column,i.lineNumber,i.column)}static lift(t){return t?new Nt(t.startLineNumber,t.startColumn,t.endLineNumber,t.endColumn):null}static isIRange(t){return t&&typeof t.startLineNumber=="number"&&typeof t.startColumn=="number"&&typeof t.endLineNumber=="number"&&typeof t.endColumn=="number"}static areIntersectingOrTouching(t,i){return!(t.endLineNumber<i.startLineNumber||t.endLineNumber===i.startLineNumber&&t.endColumn<i.startColumn||i.endLineNumber<t.startLineNumber||i.endLineNumber===t.startLineNumber&&i.endColumn<t.startColumn)}static areIntersecting(t,i){return!(t.endLineNumber<i.startLineNumber||t.endLineNumber===i.startLineNumber&&t.endColumn<=i.startColumn||i.endLineNumber<t.startLineNumber||i.endLineNumber===t.startLineNumber&&i.endColumn<=t.startColumn)}static areOnlyIntersecting(t,i){return!(t.endLineNumber<i.startLineNumber-1||t.endLineNumber===i.startLineNumber&&t.endColumn<i.startColumn-1||i.endLineNumber<t.startLineNumber-1||i.endLineNumber===t.startLineNumber&&i.endColumn<t.startColumn-1)}static compareRangesUsingStarts(t,i){if(t&&i){const s=t.startLineNumber|0,o=i.startLineNumber|0;if(s===o){const a=t.startColumn|0,l=i.startColumn|0;if(a===l){const c=t.endLineNumber|0,u=i.endLineNumber|0;if(c===u){const d=t.endColumn|0,f=i.endColumn|0;return d-f}return c-u}return a-l}return s-o}return(t?1:0)-(i?1:0)}static compareRangesUsingEnds(t,i){return t.endLineNumber===i.endLineNumber?t.endColumn===i.endColumn?t.startLineNumber===i.startLineNumber?t.startColumn-i.startColumn:t.startLineNumber-i.startLineNumber:t.endColumn-i.endColumn:t.endLineNumber-i.endLineNumber}static spansMultipleLines(t){return t.endLineNumber>t.startLineNumber}toJSON(){return this}},IA=class{static insert(e,t){return{range:new Fe(e.lineNumber,e.column,e.lineNumber,e.column),text:t,forceMoveMarkers:!0}}static delete(e){return{range:e,text:null}}static replace(e,t){return{range:e,text:t}}static replaceMove(e,t){return{range:e,text:t,forceMoveMarkers:!0}}},oS=class{constructor(){this._tokenizationSupports=new Map,this._factories=new Map,this._onDidChange=new P,this.onDidChange=this._onDidChange.event,this._colorMap=null}handleChange(e){this._onDidChange.fire({changedLanguages:e,changedColorMap:!1})}register(e,t){return this._tokenizationSupports.set(e,t),this.handleChange([e]),ne(()=>{this._tokenizationSupports.get(e)===t&&(this._tokenizationSupports.delete(e),this.handleChange([e]))})}get(e){return this._tokenizationSupports.get(e)||null}registerFactory(e,t){this._factories.get(e)?.dispose();const i=new kA(this,e,t);return this._factories.set(e,i),ne(()=>{const r=this._factories.get(e);!r||r!==i||(this._factories.delete(e),r.dispose())})}async getOrCreate(e){const t=this.get(e);if(t)return t;const i=this._factories.get(e);return!i||i.isResolved?null:(await i.resolve(),this.get(e))}isResolved(e){if(this.get(e))return!0;const i=this._factories.get(e);return!!(!i||i.isResolved)}setColorMap(e){this._colorMap=e,this._onDidChange.fire({changedLanguages:Array.from(this._tokenizationSupports.keys()),changedColorMap:!0})}getColorMap(){return this._colorMap}getDefaultBackground(){return this._colorMap&&this._colorMap.length>2?this._colorMap[2]:null}},kA=class extends se{get isResolved(){return this._isResolved}constructor(e,t,i){super(),this._registry=e,this._languageId=t,this._factory=i,this._isDisposed=!1,this._resolvePromise=null,this._isResolved=!1}dispose(){this._isDisposed=!0,super.dispose()}async resolve(){return this._resolvePromise||(this._resolvePromise=this._create()),this._resolvePromise}async _create(){const e=await this._factory.tokenizationSupport;this._isResolved=!0,e&&!this._isDisposed&&this._register(this._registry.register(this._languageId,e))}},aS;(function(e){e[e.Increase=0]="Increase",e[e.Decrease=1]="Decrease"})(aS||(aS={}));var lS;(function(e){e[e.Method=0]="Method",e[e.Function=1]="Function",e[e.Constructor=2]="Constructor",e[e.Field=3]="Field",e[e.Variable=4]="Variable",e[e.Class=5]="Class",e[e.Struct=6]="Struct",e[e.Interface=7]="Interface",e[e.Module=8]="Module",e[e.Property=9]="Property",e[e.Event=10]="Event",e[e.Operator=11]="Operator",e[e.Unit=12]="Unit",e[e.Value=13]="Value",e[e.Constant=14]="Constant",e[e.Enum=15]="Enum",e[e.EnumMember=16]="EnumMember",e[e.Keyword=17]="Keyword",e[e.Text=18]="Text",e[e.Color=19]="Color",e[e.File=20]="File",e[e.Reference=21]="Reference",e[e.Customcolor=22]="Customcolor",e[e.Folder=23]="Folder",e[e.TypeParameter=24]="TypeParameter",e[e.User=25]="User",e[e.Issue=26]="Issue",e[e.Snippet=27]="Snippet"})(lS||(lS={}));var cS;(function(e){const t=new Map;t.set(0,re.symbolMethod),t.set(1,re.symbolFunction),t.set(2,re.symbolConstructor),t.set(3,re.symbolField),t.set(4,re.symbolVariable),t.set(5,re.symbolClass),t.set(6,re.symbolStruct),t.set(7,re.symbolInterface),t.set(8,re.symbolModule),t.set(9,re.symbolProperty),t.set(10,re.symbolEvent),t.set(11,re.symbolOperator),t.set(12,re.symbolUnit),t.set(13,re.symbolValue),t.set(15,re.symbolEnum),t.set(14,re.symbolConstant),t.set(15,re.symbolEnum),t.set(16,re.symbolEnumMember),t.set(17,re.symbolKeyword),t.set(27,re.symbolSnippet),t.set(18,re.symbolText),t.set(19,re.symbolColor),t.set(20,re.symbolFile),t.set(21,re.symbolReference),t.set(22,re.symbolCustomColor),t.set(23,re.symbolFolder),t.set(24,re.symbolTypeParameter),t.set(25,re.account),t.set(26,re.issues);function i(o){let a=t.get(o);return a||(console.info("No codicon found for CompletionItemKind "+o),a=re.symbolProperty),a}e.toIcon=i;function r(o){switch(o){case 0:return h(822,null);case 1:return h(823,null);case 2:return h(824,null);case 3:return h(825,null);case 4:return h(826,null);case 5:return h(827,null);case 6:return h(828,null);case 7:return h(829,null);case 8:return h(830,null);case 9:return h(831,null);case 10:return h(832,null);case 11:return h(833,null);case 12:return h(834,null);case 13:return h(835,null);case 14:return h(836,null);case 15:return h(837,null);case 16:return h(838,null);case 17:return h(839,null);case 18:return h(840,null);case 19:return h(841,null);case 20:return h(842,null);case 21:return h(843,null);case 22:return h(844,null);case 23:return h(845,null);case 24:return h(846,null);case 25:return h(847,null);case 26:return h(848,null);case 27:return h(849,null);default:return""}}e.toLabel=r;const n=new Map;n.set("method",0),n.set("function",1),n.set("constructor",2),n.set("field",3),n.set("variable",4),n.set("class",5),n.set("struct",6),n.set("interface",7),n.set("module",8),n.set("property",9),n.set("event",10),n.set("operator",11),n.set("unit",12),n.set("value",13),n.set("constant",14),n.set("enum",15),n.set("enum-member",16),n.set("enumMember",16),n.set("keyword",17),n.set("snippet",27),n.set("text",18),n.set("color",19),n.set("file",20),n.set("reference",21),n.set("customcolor",22),n.set("folder",23),n.set("type-parameter",24),n.set("typeParameter",24),n.set("account",25),n.set("issue",26);function s(o,a){let l=n.get(o);return typeof l>"u"&&!a&&(l=9),l}e.fromString=s})(cS||(cS={}));var uS;(function(e){e[e.Deprecated=1]="Deprecated"})(uS||(uS={}));var dS;(function(e){e[e.None=0]="None",e[e.KeepWhitespace=1]="KeepWhitespace",e[e.InsertAsSnippet=4]="InsertAsSnippet"})(dS||(dS={}));var hS;(function(e){e[e.Word=0]="Word",e[e.Line=1]="Line",e[e.Suggest=2]="Suggest"})(hS||(hS={}));var fS;(function(e){e[e.Invoke=0]="Invoke",e[e.TriggerCharacter=1]="TriggerCharacter",e[e.TriggerForIncompleteCompletions=2]="TriggerForIncompleteCompletions"})(fS||(fS={}));var hd;(function(e){e[e.Automatic=0]="Automatic",e[e.Explicit=1]="Explicit"})(hd||(hd={}));var fd;(function(e){e[e.Accepted=0]="Accepted",e[e.Rejected=1]="Rejected",e[e.Ignored=2]="Ignored"})(fd||(fd={}));var pS;(function(e){e[e.Invoke=1]="Invoke",e[e.Auto=2]="Auto"})(pS||(pS={}));var gS;(function(e){e[e.Automatic=0]="Automatic",e[e.PasteAs=1]="PasteAs"})(gS||(gS={}));var mS;(function(e){e[e.Invoke=1]="Invoke",e[e.TriggerCharacter=2]="TriggerCharacter",e[e.ContentChange=3]="ContentChange"})(mS||(mS={}));var vS;(function(e){e[e.Text=0]="Text",e[e.Read=1]="Read",e[e.Write=2]="Write"})(vS||(vS={}));function PA(e){return e&&y.isUri(e.uri)&&Fe.isIRange(e.range)&&(Fe.isIRange(e.originSelectionRange)||Fe.isIRange(e.targetSelectionRange))}var _S;(function(e){e[e.File=0]="File",e[e.Module=1]="Module",e[e.Namespace=2]="Namespace",e[e.Package=3]="Package",e[e.Class=4]="Class",e[e.Method=5]="Method",e[e.Property=6]="Property",e[e.Field=7]="Field",e[e.Constructor=8]="Constructor",e[e.Enum=9]="Enum",e[e.Interface=10]="Interface",e[e.Function=11]="Function",e[e.Variable=12]="Variable",e[e.Constant=13]="Constant",e[e.String=14]="String",e[e.Number=15]="Number",e[e.Boolean=16]="Boolean",e[e.Array=17]="Array",e[e.Object=18]="Object",e[e.Key=19]="Key",e[e.Null=20]="Null",e[e.EnumMember=21]="EnumMember",e[e.Struct=22]="Struct",e[e.Event=23]="Event",e[e.Operator=24]="Operator",e[e.TypeParameter=25]="TypeParameter"})(_S||(_S={}));var lB={17:h(850,null),16:h(851,null),4:h(852,null),13:h(853,null),8:h(854,null),9:h(855,null),21:h(856,null),23:h(857,null),7:h(858,null),0:h(859,null),11:h(860,null),10:h(861,null),19:h(862,null),5:h(863,null),1:h(864,null),2:h(865,null),20:h(866,null),15:h(867,null),18:h(868,null),24:h(869,null),3:h(870,null),6:h(871,null),14:h(872,null),22:h(873,null),25:h(874,null),12:h(875,null)},wS;(function(e){e[e.Deprecated=1]="Deprecated"})(wS||(wS={}));var yS;(function(e){const t=new Map;t.set(0,re.symbolFile),t.set(1,re.symbolModule),t.set(2,re.symbolNamespace),t.set(3,re.symbolPackage),t.set(4,re.symbolClass),t.set(5,re.symbolMethod),t.set(6,re.symbolProperty),t.set(7,re.symbolField),t.set(8,re.symbolConstructor),t.set(9,re.symbolEnum),t.set(10,re.symbolInterface),t.set(11,re.symbolFunction),t.set(12,re.symbolVariable),t.set(13,re.symbolConstant),t.set(14,re.symbolString),t.set(15,re.symbolNumber),t.set(16,re.symbolBoolean),t.set(17,re.symbolArray),t.set(18,re.symbolObject),t.set(19,re.symbolKey),t.set(20,re.symbolNull),t.set(21,re.symbolEnumMember),t.set(22,re.symbolStruct),t.set(23,re.symbolEvent),t.set(24,re.symbolOperator),t.set(25,re.symbolTypeParameter);function i(s){let o=t.get(s);return o||(console.info("No codicon found for SymbolKind "+s),o=re.symbolProperty),o}e.toIcon=i;const r=new Map;r.set(0,20),r.set(1,8),r.set(2,8),r.set(3,8),r.set(4,5),r.set(5,0),r.set(6,9),r.set(7,3),r.set(8,2),r.set(9,15),r.set(10,7),r.set(11,1),r.set(12,4),r.set(13,14),r.set(14,18),r.set(15,13),r.set(16,13),r.set(17,13),r.set(18,13),r.set(19,17),r.set(20,13),r.set(21,16),r.set(22,6),r.set(23,10),r.set(24,11),r.set(25,24);function n(s){let o=r.get(s);return o===void 0&&(console.info("No completion kind found for SymbolKind "+s),o=20),o}e.toCompletionKind=n})(yS||(yS={}));var TA=class{static asEditOperation(e){return IA.replace(Fe.lift(e.range),e.text)}static isTextEdit(e){const t=e;return typeof t.text=="string"&&Fe.isIRange(t.range)}},Ho=class rs{static{this.Comment=new rs("comment")}static{this.Imports=new rs("imports")}static{this.Region=new rs("region")}static fromValue(t){switch(t){case"comment":return rs.Comment;case"imports":return rs.Imports;case"region":return rs.Region}return new rs(t)}constructor(t){this.value=t}},bS;(function(e){e[e.AIGenerated=1]="AIGenerated"})(bS||(bS={}));var pd;(function(e){e[e.Invoke=0]="Invoke",e[e.Automatic=1]="Automatic"})(pd||(pd={}));var _m;(function(e){function t(i){return!i||typeof i!="object"?!1:typeof i.id=="string"&&typeof i.title=="string"}e.is=t})(_m||(_m={}));var Uo;(function(e){e[e.Collapsed=0]="Collapsed",e[e.Expanded=1]="Expanded"})(Uo||(Uo={}));var Pl;(function(e){e[e.Unresolved=0]="Unresolved",e[e.Resolved=1]="Resolved"})(Pl||(Pl={}));var Tl;(function(e){e[e.Current=0]="Current",e[e.Outdated=1]="Outdated"})(Tl||(Tl={}));var xS;(function(e){e[e.Editing=0]="Editing",e[e.Preview=1]="Preview"})(xS||(xS={}));var SS;(function(e){e[e.Published=0]="Published",e[e.Draft=1]="Draft"})(SS||(SS={}));var ES;(function(e){e[e.Type=1]="Type",e[e.Parameter=2]="Parameter"})(ES||(ES={}));var cB=new oS,uB=new oS,CS;(function(e){e[e.None=0]="None",e[e.Option=1]="Option",e[e.Default=2]="Default",e[e.Preferred=3]="Preferred"})(CS||(CS={}));var gd;(function(e){e[e.Invoke=0]="Invoke",e[e.Automatic=1]="Automatic"})(gd||(gd={}));var DS;(function(e){e[e.Unnecessary=1]="Unnecessary",e[e.Deprecated=2]="Deprecated"})(DS||(DS={}));var pi;(function(e){e[e.Hint=1]="Hint",e[e.Info=2]="Info",e[e.Warning=4]="Warning",e[e.Error=8]="Error"})(pi||(pi={})),function(e){function t(l,c){return c-l}e.compare=t;const i=Object.create(null);i[e.Error]=h(2131,null),i[e.Warning]=h(2132,null),i[e.Info]=h(2133,null);function r(l){return i[l]||""}e.toString=r;const n=Object.create(null);n[e.Error]=h(2134,null),n[e.Warning]=h(2135,null),n[e.Info]=h(2136,null);function s(l){return n[l]||""}e.toStringPlural=s;function o(l){switch(l){case bt.Error:return e.Error;case bt.Warning:return e.Warning;case bt.Info:return e.Info;case bt.Ignore:return e.Hint}}e.fromSeverity=o;function a(l){switch(l){case e.Error:return bt.Error;case e.Warning:return bt.Warning;case e.Info:return bt.Info;case e.Hint:return bt.Ignore}}e.toSeverity=a}(pi||(pi={}));var IS;(function(e){const t="";function i(n){return r(n,!0)}e.makeKey=i;function r(n,s){const o=[t];return n.source?o.push(n.source.replace("\xA6","\\\xA6")):o.push(t),n.code?typeof n.code=="string"?o.push(n.code.replace("\xA6","\\\xA6")):o.push(n.code.value.replace("\xA6","\\\xA6")):o.push(t),n.severity!==void 0&&n.severity!==null?o.push(pi.toString(n.severity)):o.push(t),n.message&&s?o.push(n.message.replace("\xA6","\\\xA6")):o.push(t),n.startLineNumber!==void 0&&n.startLineNumber!==null?o.push(n.startLineNumber.toString()):o.push(t),n.startColumn!==void 0&&n.startColumn!==null?o.push(n.startColumn.toString()):o.push(t),n.endLineNumber!==void 0&&n.endLineNumber!==null?o.push(n.endLineNumber.toString()):o.push(t),n.endColumn!==void 0&&n.endColumn!==null?o.push(n.endColumn.toString()):o.push(t),o.push(t),o.join("\xA6")}e.makeKeyOptionalMessage=r})(IS||(IS={}));var dB=U("markerService"),AA=class{constructor(){this.data=new Map}add(e,t){si(Me(e)),si(St(t)),si(!this.data.has(e),"There is already an extension with this id"),this.data.set(e,t)}knows(e){return this.data.has(e)}as(e){return this.data.get(e)||null}dispose(){this.data.forEach(e=>{uy(e.dispose)&&e.dispose()}),this.data.clear()}},Ht=new AA,kS=U("fileService"),Cs;(function(e){e[e.Unknown=0]="Unknown",e[e.File=1]="File",e[e.Directory=2]="Directory",e[e.SymbolicLink=64]="SymbolicLink"})(Cs||(Cs={}));var Bo;(function(e){e[e.Readonly=1]="Readonly",e[e.Locked=2]="Locked"})(Bo||(Bo={}));var PS;(function(e){e[e.UPDATED=2]="UPDATED",e[e.ADDED=4]="ADDED",e[e.DELETED=8]="DELETED"})(PS||(PS={}));var TS;(function(e){e[e.None=0]="None",e[e.FileReadWrite=2]="FileReadWrite",e[e.FileOpenReadWriteClose=4]="FileOpenReadWriteClose",e[e.FileReadStream=16]="FileReadStream",e[e.FileFolderCopy=8]="FileFolderCopy",e[e.PathCaseSensitive=1024]="PathCaseSensitive",e[e.Readonly=2048]="Readonly",e[e.Trash=4096]="Trash",e[e.FileWriteUnlock=8192]="FileWriteUnlock",e[e.FileAtomicRead=16384]="FileAtomicRead",e[e.FileAtomicWrite=32768]="FileAtomicWrite",e[e.FileAtomicDelete=65536]="FileAtomicDelete",e[e.FileClone=131072]="FileClone"})(TS||(TS={}));var _e;(function(e){e.FileExists="EntryExists",e.FileNotFound="EntryNotFound",e.FileNotADirectory="EntryNotADirectory",e.FileIsADirectory="EntryIsADirectory",e.FileExceedsStorageQuota="EntryExceedsStorageQuota",e.FileTooLarge="EntryTooLarge",e.FileWriteLocked="EntryWriteLocked",e.NoPermissions="NoPermissions",e.Unavailable="Unavailable",e.Unknown="Unknown"})(_e||(_e={}));var AS=class F6 extends Error{static create(t,i){const r=new F6(t.toString(),i);return RS(r,i),r}constructor(t,i){super(t),this.code=i}};function RS(e,t){return e.name=t?`${t} (FileSystemError)`:"FileSystemError",e}function md(e){if(!e)return _e.Unknown;if(e instanceof AS)return e.code;const t=/^(.+) \(FileSystemError\)$/.exec(e.name);if(!t)return _e.Unknown;switch(t[1]){case _e.FileExists:return _e.FileExists;case _e.FileIsADirectory:return _e.FileIsADirectory;case _e.FileNotADirectory:return _e.FileNotADirectory;case _e.FileNotFound:return _e.FileNotFound;case _e.FileTooLarge:return _e.FileTooLarge;case _e.FileWriteLocked:return _e.FileWriteLocked;case _e.NoPermissions:return _e.NoPermissions;case _e.Unavailable:return _e.Unavailable}return _e.Unknown}function RA(e){if(e instanceof wm)return e.fileOperationResult;switch(md(e)){case _e.FileNotFound:return 1;case _e.FileIsADirectory:return 0;case _e.FileNotADirectory:return 9;case _e.FileWriteLocked:return 5;case _e.NoPermissions:return 6;case _e.FileExists:return 4;case _e.FileTooLarge:return 7;default:return 10}}var LS;(function(e){e[e.CREATE=0]="CREATE",e[e.DELETE=1]="DELETE",e[e.MOVE=2]="MOVE",e[e.COPY=3]="COPY",e[e.WRITE=4]="WRITE"})(LS||(LS={}));var NS;(function(e){e[e.UPDATED=0]="UPDATED",e[e.ADDED=1]="ADDED",e[e.DELETED=2]="DELETED"})(NS||(NS={}));var hB=class Fp{static{this.MIXED_CORRELATION=null}constructor(t,i){this.ignorePathCasing=i,this.correlationId=void 0,this.added=new Ci(()=>{const r=Rn.forUris(()=>this.ignorePathCasing);return r.fill(this.rawAdded.map(n=>[n,!0])),r}),this.updated=new Ci(()=>{const r=Rn.forUris(()=>this.ignorePathCasing);return r.fill(this.rawUpdated.map(n=>[n,!0])),r}),this.deleted=new Ci(()=>{const r=Rn.forUris(()=>this.ignorePathCasing);return r.fill(this.rawDeleted.map(n=>[n,!0])),r}),this.rawAdded=[],this.rawUpdated=[],this.rawDeleted=[];for(const r of t){switch(r.type){case 1:this.rawAdded.push(r.resource);break;case 0:this.rawUpdated.push(r.resource);break;case 2:this.rawDeleted.push(r.resource);break}this.correlationId!==Fp.MIXED_CORRELATION&&(typeof r.cId=="number"?this.correlationId===void 0?this.correlationId=r.cId:this.correlationId!==r.cId&&(this.correlationId=Fp.MIXED_CORRELATION):this.correlationId!==void 0&&(this.correlationId=Fp.MIXED_CORRELATION))}}contains(t,...i){return this.doContains(t,{includeChildren:!1},...i)}affects(t,...i){return this.doContains(t,{includeChildren:!0},...i)}doContains(t,i,...r){if(!t)return!1;const n=r.length>0;return!!((!n||r.includes(1))&&(this.added.value.get(t)||i.includeChildren&&this.added.value.findSuperstr(t))||(!n||r.includes(0))&&(this.updated.value.get(t)||i.includeChildren&&this.updated.value.findSuperstr(t))||(!n||r.includes(2))&&(this.deleted.value.findSubstr(t)||i.includeChildren&&this.deleted.value.findSuperstr(t)))}gotAdded(){return this.rawAdded.length>0}gotDeleted(){return this.rawDeleted.length>0}gotUpdated(){return this.rawUpdated.length>0}correlates(t){return this.correlationId===t}hasCorrelation(){return typeof this.correlationId=="number"}},wm=class extends Error{constructor(e,t,i){super(e),this.fileOperationResult=t,this.options=i}},MS;(function(e){e[e.FILE_IS_DIRECTORY=0]="FILE_IS_DIRECTORY",e[e.FILE_NOT_FOUND=1]="FILE_NOT_FOUND",e[e.FILE_NOT_MODIFIED_SINCE=2]="FILE_NOT_MODIFIED_SINCE",e[e.FILE_MODIFIED_SINCE=3]="FILE_MODIFIED_SINCE",e[e.FILE_MOVE_CONFLICT=4]="FILE_MOVE_CONFLICT",e[e.FILE_WRITE_LOCKED=5]="FILE_WRITE_LOCKED",e[e.FILE_PERMISSION_DENIED=6]="FILE_PERMISSION_DENIED",e[e.FILE_TOO_LARGE=7]="FILE_TOO_LARGE",e[e.FILE_INVALID_PATH=8]="FILE_INVALID_PATH",e[e.FILE_NOT_DIRECTORY=9]="FILE_NOT_DIRECTORY",e[e.FILE_OTHER_ERROR=10]="FILE_OTHER_ERROR"})(MS||(MS={}));var OS;(function(e){e[e.FILE=0]="FILE",e[e.FOLDER=1]="FOLDER",e[e.ROOT_FOLDER=2]="ROOT_FOLDER"})(OS||(OS={}));var LA="";function FS(e){if(!(typeof e.size!="number"||typeof e.mtime!="number"))return e.mtime.toString(29)+e.size.toString(31)}var fB=class bi{static{this.KB=1024}static{this.MB=bi.KB*bi.KB}static{this.GB=bi.MB*bi.KB}static{this.TB=bi.GB*bi.KB}static formatSize(t){return ls(t)||(t=0),t<bi.KB?h(2044,null,t.toFixed(0)):t<bi.MB?h(2045,null,(t/bi.KB).toFixed(2)):t<bi.GB?h(2046,null,(t/bi.MB).toFixed(2)):t<bi.TB?h(2047,null,(t/bi.GB).toFixed(2)):h(2048,null,(t/bi.TB).toFixed(2))}},NA=class extends se{constructor(e,t="",i="",r=!0,n){super(),this._onDidChange=this._register(new P),this.onDidChange=this._onDidChange.event,this._enabled=!0,this._id=e,this._label=t,this._cssClass=i,this._enabled=r,this._actionCallback=n}get id(){return this._id}get label(){return this._label}set label(e){this._setLabel(e)}_setLabel(e){this._label!==e&&(this._label=e,this._onDidChange.fire({label:e}))}get tooltip(){return this._tooltip||""}set tooltip(e){this._setTooltip(e)}_setTooltip(e){this._tooltip!==e&&(this._tooltip=e,this._onDidChange.fire({tooltip:e}))}get class(){return this._cssClass}set class(e){this._setClass(e)}_setClass(e){this._cssClass!==e&&(this._cssClass=e,this._onDidChange.fire({class:e}))}get enabled(){return this._enabled}set enabled(e){this._setEnabled(e)}_setEnabled(e){this._enabled!==e&&(this._enabled=e,this._onDidChange.fire({enabled:e}))}get checked(){return this._checked}set checked(e){this._setChecked(e)}_setChecked(e){this._checked!==e&&(this._checked=e,this._onDidChange.fire({checked:e}))}async run(e,t){this._actionCallback&&await this._actionCallback(e)}},pB=class Pw{constructor(){this.id=Pw.ID,this.label="",this.tooltip="",this.class="separator",this.enabled=!1,this.checked=!1}static join(...t){let i=[];for(const r of t)r.length&&(i.length?i=[...i,new Pw,...r]:i=r);return i}static{this.ID="vs.actions.separator"}async run(){}},gB=class $6 extends NA{static{this.ID="vs.actions.empty"}constructor(){super($6.ID,h(46,null),void 0,!1)}},MA={EditorPane:"workbench.contributions.editors",EditorFactory:"workbench.contributions.editor.inputFactories"},OA={id:"default",displayName:h(4328,null),providerDisplayName:h(4329,null)},$S;(function(e){e[e.PROGRAMMATIC=1]="PROGRAMMATIC",e[e.USER=2]="USER",e[e.EDIT=3]="EDIT",e[e.NAVIGATION=4]="NAVIGATION",e[e.JUMP=5]="JUMP"})($S||($S={}));var HS;(function(e){e[e.IDENTICAL=1]="IDENTICAL",e[e.SIMILAR=2]="SIMILAR",e[e.DIFFERENT=3]="DIFFERENT"})(HS||(HS={}));function vd(e){if(Ln(e))return!1;const t=e;return t?.original!==void 0&&t.modified!==void 0}function US(e){if(Ln(e))return!1;const t=e;return!t||t.resources&&!Array.isArray(t.resources)?!1:!!t.resources||!!t.multiDiffSource}function ym(e){if(Ln(e)||vd(e))return!1;const t=e;return t?.primary!==void 0&&t.secondary!==void 0}function _d(e){if(Ln(e))return!1;const t=e;return y.isUri(t?.base?.resource)&&y.isUri(t?.input1?.resource)&&y.isUri(t?.input2?.resource)&&y.isUri(t?.result?.resource)}var BS;(function(e){e[e.SHORT=0]="SHORT",e[e.MEDIUM=1]="MEDIUM",e[e.LONG=2]="LONG"})(BS||(BS={}));var WS;(function(e){e[e.EXPLICIT=1]="EXPLICIT",e[e.AUTO=2]="AUTO",e[e.FOCUS_CHANGE=3]="FOCUS_CHANGE",e[e.WINDOW_CHANGE=4]="WINDOW_CHANGE"})(WS||(WS={}));var FA=class{constructor(){this.mapIdToSaveSource=new Map}registerSource(e,t){let i=this.mapIdToSaveSource.get(e);return i||(i={source:e,label:t},this.mapIdToSaveSource.set(e,i)),i.source}getSourceLabel(e){return this.mapIdToSaveSource.get(e)?.label??e}},mB=new FA,VS;(function(e){e[e.None=0]="None",e[e.Readonly=2]="Readonly",e[e.Untitled=4]="Untitled",e[e.Singleton=8]="Singleton",e[e.RequiresTrust=16]="RequiresTrust",e[e.CanSplitInGroup=32]="CanSplitInGroup",e[e.ForceDescription=64]="ForceDescription",e[e.CanDropIntoEditor=128]="CanDropIntoEditor",e[e.MultipleEditors=256]="MultipleEditors",e[e.Scratchpad=512]="Scratchpad"})(VS||(VS={}));var $A=class extends se{};function Ln(e){return e instanceof $A}function HA(e){const t=e;return y.isUri(t?.preferredResource)}function UA(e){const t=e;return Ln(t?.primary)&&Ln(t?.secondary)}function BA(e){const t=e;return Ln(t?.modified)&&Ln(t?.original)}var zS;(function(e){e[e.UNKNOWN=0]="UNKNOWN",e[e.REPLACE=1]="REPLACE",e[e.MOVE=2]="MOVE",e[e.UNPIN=3]="UNPIN"})(zS||(zS={}));var qS;(function(e){e[e.GROUP_ACTIVE=0]="GROUP_ACTIVE",e[e.GROUP_INDEX=1]="GROUP_INDEX",e[e.GROUP_LABEL=2]="GROUP_LABEL",e[e.GROUP_LOCKED=3]="GROUP_LOCKED",e[e.EDITORS_SELECTION=4]="EDITORS_SELECTION",e[e.EDITOR_OPEN=5]="EDITOR_OPEN",e[e.EDITOR_CLOSE=6]="EDITOR_CLOSE",e[e.EDITOR_MOVE=7]="EDITOR_MOVE",e[e.EDITOR_ACTIVE=8]="EDITOR_ACTIVE",e[e.EDITOR_LABEL=9]="EDITOR_LABEL",e[e.EDITOR_CAPABILITIES=10]="EDITOR_CAPABILITIES",e[e.EDITOR_PIN=11]="EDITOR_PIN",e[e.EDITOR_TRANSIENT=12]="EDITOR_TRANSIENT",e[e.EDITOR_STICKY=13]="EDITOR_STICKY",e[e.EDITOR_DIRTY=14]="EDITOR_DIRTY",e[e.EDITOR_WILL_DISPOSE=15]="EDITOR_WILL_DISPOSE"})(qS||(qS={}));var Nn;(function(e){e[e.PRIMARY=1]="PRIMARY",e[e.SECONDARY=2]="SECONDARY",e[e.BOTH=3]="BOTH",e[e.ANY=4]="ANY"})(Nn||(Nn={}));var WA=class{getOriginalUri(e,t){if(!e)return;if(_d(e))return GS.getOriginalUri(e.result,t);if(t?.supportSideBySide){const{primary:r,secondary:n}=this.getSideEditors(e);if(r&&n){if(t?.supportSideBySide===Nn.BOTH)return{primary:this.getOriginalUri(r,{filterByScheme:t.filterByScheme}),secondary:this.getOriginalUri(n,{filterByScheme:t.filterByScheme})};if(t?.supportSideBySide===Nn.ANY)return this.getOriginalUri(r,{filterByScheme:t.filterByScheme})??this.getOriginalUri(n,{filterByScheme:t.filterByScheme});e=t.supportSideBySide===Nn.PRIMARY?r:n}}if(vd(e)||US(e)||ym(e)||_d(e))return;const i=HA(e)?e.preferredResource:e.resource;return!i||!t||!t.filterByScheme?i:this.filterUri(i,t.filterByScheme)}getSideEditors(e){return UA(e)||ym(e)?{primary:e.primary,secondary:e.secondary}:BA(e)||vd(e)?{primary:e.modified,secondary:e.original}:{primary:void 0,secondary:void 0}}getCanonicalUri(e,t){if(!e)return;if(_d(e))return GS.getCanonicalUri(e.result,t);if(t?.supportSideBySide){const{primary:r,secondary:n}=this.getSideEditors(e);if(r&&n){if(t?.supportSideBySide===Nn.BOTH)return{primary:this.getCanonicalUri(r,{filterByScheme:t.filterByScheme}),secondary:this.getCanonicalUri(n,{filterByScheme:t.filterByScheme})};if(t?.supportSideBySide===Nn.ANY)return this.getCanonicalUri(r,{filterByScheme:t.filterByScheme})??this.getCanonicalUri(n,{filterByScheme:t.filterByScheme});e=t.supportSideBySide===Nn.PRIMARY?r:n}}if(vd(e)||US(e)||ym(e)||_d(e))return;const i=e.resource;return!i||!t||!t.filterByScheme?i:this.filterUri(i,t.filterByScheme)}filterUri(e,t){if(Array.isArray(t)){if(t.some(i=>e.scheme===i))return e}else if(t===e.scheme)return e}},jS;(function(e){e[e.UNKNOWN=0]="UNKNOWN",e[e.KEYBOARD=1]="KEYBOARD",e[e.MOUSE=2]="MOUSE"})(jS||(jS={}));var GS=new WA,QS;(function(e){e[e.LEFT=0]="LEFT",e[e.RIGHT=1]="RIGHT"})(QS||(QS={}));var VA=class{constructor(){this.editorSerializerConstructors=new Map,this.editorSerializerInstances=new Map}start(e){const t=this.instantiationService=e.get(gl);for(const[i,r]of this.editorSerializerConstructors)this.createEditorSerializer(i,r,t);this.editorSerializerConstructors.clear()}createEditorSerializer(e,t,i){const r=i.createInstance(t);this.editorSerializerInstances.set(e,r)}registerFileEditorFactory(e){if(this.fileEditorFactory)throw new Error("Can only register one file editor factory.");this.fileEditorFactory=e}getFileEditorFactory(){return xo(this.fileEditorFactory)}registerEditorSerializer(e,t){if(this.editorSerializerConstructors.has(e)||this.editorSerializerInstances.has(e))throw new Error(`A editor serializer with type ID '${e}' was already registered.`);return this.instantiationService?this.createEditorSerializer(e,t,this.instantiationService):this.editorSerializerConstructors.set(e,t),ne(()=>{this.editorSerializerConstructors.delete(e),this.editorSerializerInstances.delete(e)})}getEditorSerializer(e){return this.editorSerializerInstances.get(typeof e=="string"?e:e.typeId)}};Ht.add(MA.EditorFactory,new VA);var JS;(function(e){e[e.MOST_RECENTLY_ACTIVE=0]="MOST_RECENTLY_ACTIVE",e[e.SEQUENTIAL=1]="SEQUENTIAL"})(JS||(JS={}));var Al=class{constructor(e,t,i){this.owner=e,this.debugNameSource=t,this.referenceFn=i}getDebugName(e){return zA(e,this)}},XS=new Map,bm=new WeakMap;function zA(e,t){const i=bm.get(e);if(i)return i;const r=qA(e,t);if(r){let n=XS.get(r)??0;n++,XS.set(r,n);const s=n===1?r:`${r}#${n}`;return bm.set(e,s),s}}function qA(e,t){const i=bm.get(e);if(i)return i;const r=t.owner?GA(t.owner)+".":"";let n;const s=t.debugNameSource;if(s!==void 0)if(typeof s=="function"){if(n=s(),n!==void 0)return r+n}else return r+s;const o=t.referenceFn;if(o!==void 0&&(n=xm(o),n!==void 0))return r+n;if(t.owner!==void 0){const a=jA(t.owner,e);if(a!==void 0)return r+a}}function jA(e,t){for(const i in e)if(e[i]===t)return i}var ZS=new Map,KS=new WeakMap;function GA(e){const t=KS.get(e);if(t)return t;const i=YS(e)??"Object";let r=ZS.get(i)??0;r++,ZS.set(i,r);const n=r===1?i:`${i}#${r}`;return KS.set(e,n),n}function YS(e){const t=e.constructor;if(t)return t.name==="Object"?void 0:t.name}function xm(e){const t=e.toString(),r=/\/\*\*\s*@description\s*([^*]*)\*\//.exec(t);return(r?r[1]:void 0)?.trim()}var Sm=(e,t)=>e===t;function Em(e,t){if(e===t)return!0;if(Array.isArray(e)&&Array.isArray(t)){if(e.length!==t.length)return!1;for(let i=0;i<e.length;i++)if(!Em(e[i],t[i]))return!1;return!0}if(e&&typeof e=="object"&&t&&typeof t=="object"&&Object.getPrototypeOf(e)===Object.prototype&&Object.getPrototypeOf(t)===Object.prototype){const i=e,r=t,n=Object.keys(i),s=Object.keys(r),o=new Set(s);if(n.length!==s.length)return!1;for(const a of n)if(!o.has(a)||!Em(i[a],r[a]))return!1;return!0}return!1}var Ds;function Cm(e){Ds?Ds instanceof eE?Ds.loggers.push(e):Ds=new eE([Ds,e]):Ds=e}function qt(){return Ds}var Dm=void 0;function QA(e){Dm=e}function JA(e){Dm&&Dm(e)}var eE=class{constructor(e){this.loggers=e}handleObservableCreated(e){for(const t of this.loggers)t.handleObservableCreated(e)}handleOnListenerCountChanged(e,t){for(const i of this.loggers)i.handleOnListenerCountChanged(e,t)}handleObservableUpdated(e,t){for(const i of this.loggers)i.handleObservableUpdated(e,t)}handleAutorunCreated(e){for(const t of this.loggers)t.handleAutorunCreated(e)}handleAutorunDisposed(e){for(const t of this.loggers)t.handleAutorunDisposed(e)}handleAutorunDependencyChanged(e,t,i){for(const r of this.loggers)r.handleAutorunDependencyChanged(e,t,i)}handleAutorunStarted(e){for(const t of this.loggers)t.handleAutorunStarted(e)}handleAutorunFinished(e){for(const t of this.loggers)t.handleAutorunFinished(e)}handleDerivedDependencyChanged(e,t,i){for(const r of this.loggers)r.handleDerivedDependencyChanged(e,t,i)}handleDerivedCleared(e){for(const t of this.loggers)t.handleDerivedCleared(e)}handleBeginTransaction(e){for(const t of this.loggers)t.handleBeginTransaction(e)}handleEndTransaction(e){for(const t of this.loggers)t.handleEndTransaction(e)}},tE;function XA(e){tE=e}var iE;function ZA(e){iE=e}var Im;function KA(e){Im=e}var YA=class{get TChange(){return null}reportChanges(){this.get()}read(e){return e?e.readObservable(this):this.get()}map(e,t){const i=t===void 0?void 0:e,r=t===void 0?e:t;return Im({owner:i,debugName:()=>{const n=xm(r);if(n!==void 0)return n;const o=/^\s*\(?\s*([a-zA-Z_$][a-zA-Z_$0-9]*)\s*\)?\s*=>\s*\1(?:\??)\.([a-zA-Z_$][a-zA-Z_$0-9]*)\s*$/.exec(r.toString());if(o)return`${this.debugName}.${o[2]}`;if(!i)return`${this.debugName} (mapped)`},debugReferenceFn:r},n=>r(this.read(n),n))}flatten(){return Im({owner:void 0,debugName:()=>`${this.debugName} (flattened)`},e=>this.read(e).read(e))}recomputeInitiallyAndOnChange(e,t){return e.add(tE(this,t)),this}keepObserved(e){return e.add(iE(this)),this}get debugValue(){return this.get()}},km=class extends YA{constructor(){super(),this._observers=new Set,qt()?.handleObservableCreated(this)}addObserver(e){const t=this._observers.size;this._observers.add(e),t===0&&this.onFirstObserverAdded(),t!==this._observers.size&&qt()?.handleOnListenerCountChanged(this,this._observers.size)}removeObserver(e){const t=this._observers.delete(e);t&&this._observers.size===0&&this.onLastObserverRemoved(),t&&qt()?.handleOnListenerCountChanged(this,this._observers.size)}onFirstObserverAdded(){}onLastObserverRemoved(){}log(){const e=!!qt();return JA(this),e||qt()?.handleObservableCreated(this),this}debugGetObservers(){return this._observers}};function wd(e,t){const i=new rE(e,t);try{e(i)}finally{i.finish()}}function e3(e,t,i){e?t(e):wd(t,i)}var rE=class{constructor(e,t){this._fn=e,this._getDebugName=t,this._updatingObservers=[],qt()?.handleBeginTransaction(this)}getDebugName(){return this._getDebugName?this._getDebugName():xm(this._fn)}updateObserver(e,t){if(!this._updatingObservers){nE("Transaction already finished!"),wd(i=>{i.updateObserver(e,t)});return}this._updatingObservers.push({observer:e,observable:t}),e.beginUpdate(t)}finish(){const e=this._updatingObservers;if(!e){nE("transaction.finish() has already been called!");return}for(let t=0;t<e.length;t++){const{observer:i,observable:r}=e[t];i.endUpdate(r)}this._updatingObservers=null,qt()?.handleEndTransaction(this)}debugGetUpdatingObservers(){return this._updatingObservers}};function nE(e){const t=new Error("BugIndicatingErrorRecovery: "+e);Qt(t),console.error("recovered from an error that indicates a bug",t)}function Pm(e,t){let i;return typeof e=="string"?i=new Al(void 0,e,void 0):i=new Al(e,void 0,void 0),new Tm(i,t,Sm)}var Tm=class extends km{get debugName(){return this._debugNameData.getDebugName(this)??"ObservableValue"}constructor(e,t,i){super(),this._debugNameData=e,this._equalityComparator=i,this._value=t,qt()?.handleObservableUpdated(this,{hadValue:!1,newValue:t,change:void 0,didChange:!0,oldValue:void 0})}get(){return this._value}set(e,t,i){if(i===void 0&&this._equalityComparator(this._value,e))return;let r;t||(t=r=new rE(()=>{},()=>`Setting ${this.debugName}`));try{const n=this._value;this._setValue(e),qt()?.handleObservableUpdated(this,{oldValue:n,newValue:e,change:i,didChange:!0,hadValue:!0});for(const s of this._observers)t.updateObserver(s,this),s.handleChange(this,i)}finally{r&&r.finish()}}toString(){return`${this.debugName}: ${this._value}`}_setValue(e){this._value=e}debugGetState(){return{value:this._value}}debugSetValue(e){this._value=e}};function Am(e){return new Rm(new Al(void 0,void 0,e),e,void 0)}var sE;(function(e){e[e.dependenciesMightHaveChanged=1]="dependenciesMightHaveChanged",e[e.stale=2]="stale",e[e.upToDate=3]="upToDate"})(sE||(sE={}));var Rm=class{get debugName(){return this._debugNameData.getDebugName(this)??"(anonymous)"}constructor(e,t,i){this._debugNameData=e,this._runFn=t,this._changeTracker=i,this._state=2,this._updateCount=0,this._disposed=!1,this._dependencies=new Set,this._dependenciesToBeRemoved=new Set,this._isRunning=!1,this._changeSummary=this._changeTracker?.createChangeSummary(void 0),qt()?.handleAutorunCreated(this),this._run(),So(this)}dispose(){if(!this._disposed){this._disposed=!0;for(const e of this._dependencies)e.removeObserver(this);this._dependencies.clear(),qt()?.handleAutorunDisposed(this),Eo(this)}}_run(){const e=this._dependenciesToBeRemoved;this._dependenciesToBeRemoved=this._dependencies,this._dependencies=e,this._state=3;try{if(!this._disposed){qt()?.handleAutorunStarted(this);const t=this._changeSummary;try{this._isRunning=!0,this._changeTracker&&(this._changeTracker.beforeUpdate?.(this,t),this._changeSummary=this._changeTracker.createChangeSummary(t)),this._runFn(this,t)}catch(i){Iu(i)}finally{this._isRunning=!1}}}finally{this._disposed||qt()?.handleAutorunFinished(this);for(const t of this._dependenciesToBeRemoved)t.removeObserver(this);this._dependenciesToBeRemoved.clear()}}toString(){return`Autorun<${this.debugName}>`}beginUpdate(e){this._state===3&&(this._state=1),this._updateCount++}endUpdate(e){try{if(this._updateCount===1)do{if(this._state===1){this._state=3;for(const t of this._dependencies)if(t.reportChanges(),this._state===2)break}this._state!==3&&this._run()}while(this._state!==3)}finally{this._updateCount--}ay(()=>this._updateCount>=0)}handlePossibleChange(e){this._state===3&&this._isDependency(e)&&(this._state=1)}handleChange(e,t){if(this._isDependency(e)){qt()?.handleAutorunDependencyChanged(this,e,t);try{(this._changeTracker?this._changeTracker.handleChange({changedObservable:e,change:t,didChange:r=>r===e},this._changeSummary):!0)&&(this._state=2)}catch(i){Iu(i)}}}_isDependency(e){return this._dependencies.has(e)&&!this._dependenciesToBeRemoved.has(e)}readObservable(e){if(!this._isRunning)throw new Oi("The reader object cannot be used outside its compute function!");if(this._disposed)return e.get();e.addObserver(this);const t=e.get();return this._dependencies.add(e),this._dependenciesToBeRemoved.delete(e),t}debugGetState(){return{isRunning:this._isRunning,updateCount:this._updateCount,dependencies:this._dependencies,state:this._state}}debugRerun(){this._isRunning?this._state=2:this._run()}};(function(e){e.Observer=Rm})(Am||(Am={}));function t3(e,t){return new en(new Al(e.owner,e.debugName,e.debugReferenceFn),t,void 0,e.onLastObserverRemoved,e.equalsFn??Sm)}KA(t3);var oE;(function(e){e[e.initial=0]="initial",e[e.dependenciesMightHaveChanged=1]="dependenciesMightHaveChanged",e[e.stale=2]="stale",e[e.upToDate=3]="upToDate"})(oE||(oE={}));var en=class extends km{get debugName(){return this._debugNameData.getDebugName(this)??"(anonymous)"}constructor(e,t,i,r=void 0,n){super(),this._debugNameData=e,this._computeFn=t,this._changeTracker=i,this._handleLastObserverRemoved=r,this._equalityComparator=n,this._state=0,this._value=void 0,this._updateCount=0,this._dependencies=new Set,this._dependenciesToBeRemoved=new Set,this._changeSummary=void 0,this._isUpdating=!1,this._isComputing=!1,this._didReportChange=!1,this._removedObserverToCallEndUpdateOn=null,this._isReaderValid=!1,this._changeSummary=this._changeTracker?.createChangeSummary(void 0)}onLastObserverRemoved(){this._state=0,this._value=void 0,qt()?.handleDerivedCleared(this);for(const e of this._dependencies)e.removeObserver(this);this._dependencies.clear(),this._handleLastObserverRemoved?.()}get(){if(this._isComputing,this._observers.size===0){let t;try{this._isReaderValid=!0;let i;this._changeTracker&&(i=this._changeTracker.createChangeSummary(void 0),this._changeTracker.beforeUpdate?.(this,i)),t=this._computeFn(this,i)}finally{this._isReaderValid=!1}return this.onLastObserverRemoved(),t}else{do{if(this._state===1){for(const t of this._dependencies)if(t.reportChanges(),this._state===2)break}this._state===1&&(this._state=3),this._state!==3&&this._recompute()}while(this._state!==3);return this._value}}_recompute(){const e=this._dependenciesToBeRemoved;this._dependenciesToBeRemoved=this._dependencies,this._dependencies=e;const t=this._state!==0,i=this._value;this._state=3;let r=!1;this._isComputing=!0,this._didReportChange=!1;try{const n=this._changeSummary;try{this._isReaderValid=!0,this._changeTracker&&(this._changeTracker.beforeUpdate?.(this,n),this._changeSummary=this._changeTracker?.createChangeSummary(n)),this._value=this._computeFn(this,n)}finally{this._isReaderValid=!1;for(const s of this._dependenciesToBeRemoved)s.removeObserver(this);this._dependenciesToBeRemoved.clear()}r=this._didReportChange||t&&!this._equalityComparator(i,this._value),qt()?.handleObservableUpdated(this,{oldValue:i,newValue:this._value,change:void 0,didChange:r,hadValue:t})}catch(n){Iu(n)}if(this._isComputing=!1,!this._didReportChange&&r)for(const n of this._observers)n.handleChange(this,void 0);else this._didReportChange=!1}toString(){return`LazyDerived<${this.debugName}>`}beginUpdate(e){if(this._isUpdating)throw new Oi("Cyclic deriveds are not supported yet!");this._updateCount++,this._isUpdating=!0;try{const t=this._updateCount===1;if(this._state===3&&(this._state=1,!t))for(const i of this._observers)i.handlePossibleChange(this);if(t)for(const i of this._observers)i.beginUpdate(this)}finally{this._isUpdating=!1}}endUpdate(e){if(this._updateCount--,this._updateCount===0){const t=[...this._observers];for(const i of t)i.endUpdate(this);if(this._removedObserverToCallEndUpdateOn){const i=[...this._removedObserverToCallEndUpdateOn];this._removedObserverToCallEndUpdateOn=null;for(const r of i)r.endUpdate(this)}}ay(()=>this._updateCount>=0)}handlePossibleChange(e){if(this._state===3&&this._dependencies.has(e)&&!this._dependenciesToBeRemoved.has(e)){this._state=1;for(const t of this._observers)t.handlePossibleChange(this)}}handleChange(e,t){if(this._dependencies.has(e)&&!this._dependenciesToBeRemoved.has(e)){qt()?.handleDerivedDependencyChanged(this,e,t);let i=!1;try{i=this._changeTracker?this._changeTracker.handleChange({changedObservable:e,change:t,didChange:n=>n===e},this._changeSummary):!0}catch(n){Iu(n)}const r=this._state===3;if(i&&(this._state===1||r)&&(this._state=2,r))for(const n of this._observers)n.handlePossibleChange(this)}}readObservable(e){if(!this._isReaderValid)throw new Oi("The reader object cannot be used outside its compute function!");e.addObserver(this);const t=e.get();return this._dependencies.add(e),this._dependenciesToBeRemoved.delete(e),t}reportChange(e){if(!this._isReaderValid)throw new Oi("The reader object cannot be used outside its compute function!");this._didReportChange=!0;for(const t of this._observers)t.handleChange(this,e)}addObserver(e){const t=!this._observers.has(e)&&this._updateCount>0;super.addObserver(e),t&&(this._removedObserverToCallEndUpdateOn&&this._removedObserverToCallEndUpdateOn.has(e)?this._removedObserverToCallEndUpdateOn.delete(e):e.beginUpdate(this))}removeObserver(e){this._observers.has(e)&&this._updateCount>0&&(this._removedObserverToCallEndUpdateOn||(this._removedObserverToCallEndUpdateOn=new Set),this._removedObserverToCallEndUpdateOn.add(e)),super.removeObserver(e)}debugGetState(){return{state:this._state,updateCount:this._updateCount,isComputing:this._isComputing,dependencies:this._dependencies,value:this._value}}debugSetValue(e){this._value=e}setValue(e,t,i){this._value=e;const r=this._observers;t.updateObserver(this,this);for(const n of r)n.handleChange(this,i)}},i3=class H6{static fromFn(t){return new H6(t())}constructor(t){this._value=Pm(this,void 0),this.promiseResult=this._value,this.promise=t.then(i=>(wd(r=>{this._value.set(new aE(i,void 0),r)}),i),i=>{throw wd(r=>{this._value.set(new aE(void 0,i),r)}),i})}},aE=class{constructor(e,t){this.data=e,this.error=t}getDataOrThrow(){if(this.error)throw this.error;return this.data}};function lE(...e){let t,i,r;return e.length===3?[t,i,r]=e:[i,r]=e,new Is(new Al(t,void 0,r),i,r,()=>Is.globalTransaction,Sm)}var Is=class extends km{constructor(e,t,i,r,n){super(),this._debugNameData=e,this.event=t,this._getValue=i,this._getTransaction=r,this._equalityComparator=n,this._hasValue=!1,this.handleEvent=s=>{const o=this._getValue(s),a=this._value,l=!this._hasValue||!this._equalityComparator(a,o);let c=!1;l&&(this._value=o,this._hasValue&&(c=!0,e3(this._getTransaction(),u=>{qt()?.handleObservableUpdated(this,{oldValue:a,newValue:o,change:void 0,didChange:l,hadValue:this._hasValue});for(const d of this._observers)u.updateObserver(d,this),d.handleChange(this,void 0)},()=>{const u=this.getDebugName();return"Event fired"+(u?`: ${u}`:"")})),this._hasValue=!0),c||qt()?.handleObservableUpdated(this,{oldValue:a,newValue:o,change:void 0,didChange:l,hadValue:this._hasValue})}}getDebugName(){return this._debugNameData.getDebugName(this)}get debugName(){const e=this.getDebugName();return"From Event"+(e?`: ${e}`:"")}onFirstObserverAdded(){this._subscription=this.event(this.handleEvent)}onLastObserverRemoved(){this._subscription.dispose(),this._subscription=void 0,this._hasValue=!1,this._value=void 0}get(){return this._subscription?(this._hasValue||this.handleEvent(void 0),this._value):this._getValue(void 0)}debugSetValue(e){this._value=e}};(function(e){e.Observer=Is;function t(i,r){let n=!1;Is.globalTransaction===void 0&&(Is.globalTransaction=i,n=!0);try{r()}finally{n&&(Is.globalTransaction=void 0)}}e.batchEventsGlobally=t})(lE||(lE={}));function r3(e){const t=new cE(!1,void 0);return e.addObserver(t),ne(()=>{e.removeObserver(t)})}ZA(r3);function n3(e,t){const i=new cE(!0,t);e.addObserver(i);try{i.beginUpdate(e)}finally{i.endUpdate(e)}return ne(()=>{e.removeObserver(i)})}XA(n3);var cE=class{constructor(e,t){this._forceRecompute=e,this._handleValue=t,this._counter=0}beginUpdate(e){this._counter++}endUpdate(e){this._counter===1&&this._forceRecompute&&(this._handleValue?this._handleValue(e.get()):e.reportChanges()),this._counter--}handlePossibleChange(e){}handleChange(e,t){}},yd;function s3(e){yd||(yd=new uE,Cm(yd)),yd.addFilteredObj(e)}var uE=class{constructor(){this.indentation=0,this.changedObservablesSets=new WeakMap}addFilteredObj(e){this._filteredObjects||(this._filteredObjects=new Set),this._filteredObjects.add(e)}_isIncluded(e){return this._filteredObjects?.has(e)??!0}textToConsoleArgs(e){return o3([Wo(c3("|  ",this.indentation)),e])}formatInfo(e){return e.hadValue?e.didChange?[Wo(" "),Qi(tn(e.oldValue,70),{color:"red",strikeThrough:!0}),Wo(" "),Qi(tn(e.newValue,60),{color:"green"})]:[Wo(" (unchanged)")]:[Wo(" "),Qi(tn(e.newValue,60),{color:"green"}),Wo(" (initial)")]}handleObservableCreated(e){if(e instanceof en){const t=e;if(this.changedObservablesSets.set(t,new Set),!1){const r=[];t.__debugUpdating=r;const n=t.beginUpdate;t.beginUpdate=o=>(r.push(o),n.apply(t,[o]));const s=t.endUpdate;t.endUpdate=o=>{const a=r.indexOf(o);return a===-1&&console.error("endUpdate called without beginUpdate",t.debugName,o.debugName),r.splice(a,1),s.apply(t,[o])}}}}handleOnListenerCountChanged(e,t){}handleObservableUpdated(e,t){if(this._isIncluded(e)){if(e instanceof en){this._handleDerivedRecomputed(e,t);return}console.log(...this.textToConsoleArgs([Vo("observable value changed"),Qi(e.debugName,{color:"BlueViolet"}),...this.formatInfo(t)]))}}formatChanges(e){if(e.size!==0)return Qi(" (changed deps: "+[...e].map(t=>t.debugName).join(", ")+")",{color:"gray"})}handleDerivedDependencyChanged(e,t,i){this._isIncluded(e)&&this.changedObservablesSets.get(e)?.add(t)}_handleDerivedRecomputed(e,t){if(!this._isIncluded(e))return;const i=this.changedObservablesSets.get(e);i&&(console.log(...this.textToConsoleArgs([Vo("derived recomputed"),Qi(e.debugName,{color:"BlueViolet"}),...this.formatInfo(t),this.formatChanges(i),{data:[{fn:e._debugNameData.referenceFn??e._computeFn}]}])),i.clear())}handleDerivedCleared(e){this._isIncluded(e)&&console.log(...this.textToConsoleArgs([Vo("derived cleared"),Qi(e.debugName,{color:"BlueViolet"})]))}handleFromEventObservableTriggered(e,t){this._isIncluded(e)&&console.log(...this.textToConsoleArgs([Vo("observable from event triggered"),Qi(e.debugName,{color:"BlueViolet"}),...this.formatInfo(t),{data:[{fn:e._getValue}]}]))}handleAutorunCreated(e){this._isIncluded(e)&&this.changedObservablesSets.set(e,new Set)}handleAutorunDisposed(e){}handleAutorunDependencyChanged(e,t,i){this._isIncluded(e)&&this.changedObservablesSets.get(e).add(t)}handleAutorunStarted(e){const t=this.changedObservablesSets.get(e);t&&(this._isIncluded(e)&&console.log(...this.textToConsoleArgs([Vo("autorun"),Qi(e.debugName,{color:"BlueViolet"}),this.formatChanges(t),{data:[{fn:e._debugNameData.referenceFn??e._runFn}]}])),t.clear(),this.indentation++)}handleAutorunFinished(e){this.indentation--}handleBeginTransaction(e){let t=e.getDebugName();t===void 0&&(t=""),this._isIncluded(e)&&console.log(...this.textToConsoleArgs([Vo("transaction"),Qi(t,{color:"BlueViolet"}),{data:[{fn:e._fn}]}])),this.indentation++}handleEndTransaction(){this.indentation--}};function o3(e){const t=new Array,i=[];let r="";function n(o){if("length"in o)for(const a of o)a&&n(a);else"text"in o?(r+=`%c${o.text}`,t.push(o.style),o.data&&i.push(...o.data)):"data"in o&&i.push(...o.data)}n(e);const s=[r,...t];return s.push(...i),s}function Wo(e){return Qi(e,{color:"black"})}function Vo(e){return Qi(u3(`${e}: `,10),{color:"black",bold:!0})}function Qi(e,t={color:"black"}){function i(n){return Object.entries(n).reduce((s,[o,a])=>`${s}${o}:${a};`,"")}const r={color:t.color};return t.strikeThrough&&(r["text-decoration"]="line-through"),t.bold&&(r["font-weight"]="bold"),{text:e,style:i(r)}}function tn(e,t){switch(typeof e){case"number":return""+e;case"string":return e.length+2<=t?`"${e}"`:`"${e.substr(0,t-7)}"+...`;case"boolean":return e?"true":"false";case"undefined":return"undefined";case"object":return e===null?"null":Array.isArray(e)?a3(e,t):l3(e,t);case"symbol":return e.toString();case"function":return`[[Function${e.name?" "+e.name:""}]]`;default:return""+e}}function a3(e,t){let i="[ ",r=!0;for(const n of e){if(r||(i+=", "),i.length-5>t){i+="...";break}r=!1,i+=`${tn(n,t-i.length)}`}return i+=" ]",i}function l3(e,t){if(typeof e.toString=="function"&&e.toString!==Object.prototype.toString){const s=e.toString();return s.length<=t?s:s.substring(0,t-3)+"..."}const i=YS(e);let r=i?i+"(":"{ ",n=!0;for(const[s,o]of Object.entries(e)){if(n||(r+=", "),r.length-5>t){r+="...";break}n=!1,r+=`${s}: ${tn(o,t-r.length)}`}return r+=i?")":" }",r}function c3(e,t){let i="";for(let r=1;r<=t;r++)i+=e;return i}function u3(e,t){for(;e.length<t;)e+=" ";return e}var d3=class Tw{static createHost(t,i){return new Tw(t,i)}static createClient(t,i){return new Tw(t,i)}constructor(t,i){this._channelFactory=t,this._getHandler=i,this._channel=this._channelFactory({handleNotification:s=>{const o=s,a=this._getHandler().notifications[o[0]];if(!a)throw new Error(`Unknown notification "${o[0]}"!`);a(...o[1])},handleRequest:s=>{const o=s;try{return{type:"result",value:this._getHandler().requests[o[0]](...o[1])}}catch(a){return{type:"error",value:a}}}});const r=new Proxy({},{get:(s,o)=>async(...a)=>{const l=await this._channel.sendRequest([o,a]);if(l.type==="error")throw l.value;return l.value}}),n=new Proxy({},{get:(s,o)=>(...a)=>{this._channel.sendNotification([o,a])}});this.api={notifications:n,requests:r}}};function h3(e,t){const i=globalThis;let r=[],n;const{channel:s,handler:o}=f3({sendNotification:l=>{n?n.sendNotification(l):r.push(l)}});let a;return(i.$$debugValueEditor_debugChannels??(i.$$debugValueEditor_debugChannels={}))[e]=l=>{a=t(),n=l;for(const c of r)l.sendNotification(c);return r=[],o},d3.createClient(s,()=>{if(!a)throw new Error("Not supported");return a})}function f3(e){let t;return{channel:r=>(t=r,{sendNotification:n=>{e.sendNotification(n)},sendRequest:n=>{throw new Error("not supported")}}),handler:{handleRequest:r=>r.type==="notification"?t?.handleNotification(r.data):t?.handleRequest(r.data)}}}function dE(e,t){const i=e.split(`
`);let r=-1;for(const n of i.slice(1)){if(r++,t&&t.test(n))continue;const s=p3(n);if(s)return s}}function p3(e){const t=e.match(/\((.*):(\d+):(\d+)\)/);if(t)return{fileName:t[1],line:parseInt(t[2]),column:parseInt(t[3]),id:e};const i=e.match(/at ([^\(\)]*):(\d+):(\d+)/);if(i)return{fileName:i[1],line:parseInt(i[2]),column:parseInt(i[3]),id:e}}var g3=class{constructor(){this._timeout=void 0}throttle(e,t){this._timeout===void 0&&(this._timeout=setTimeout(()=>{this._timeout=void 0,e()},t))}dispose(){this._timeout!==void 0&&clearTimeout(this._timeout)}};function hE(e,t){for(const i in t)e[i]&&typeof e[i]=="object"&&t[i]&&typeof t[i]=="object"?hE(e[i],t[i]):e[i]=t[i]}function fE(e,t){for(const i in t)t[i]===null?delete e[i]:e[i]&&typeof e[i]=="object"&&t[i]&&typeof t[i]=="object"?fE(e[i],t[i]):e[i]=t[i]}var m3=class wu{static{this._instance=void 0}static getInstance(){return wu._instance===void 0&&(wu._instance=new wu),wu._instance}getTransactionState(){const t=[],i=[...this._activeTransactions];if(i.length===0)return;const r=i.flatMap(s=>s.debugGetUpdatingObservers()??[]).map(s=>s.observer),n=new Set;for(;r.length>0;){const s=r.shift();if(n.has(s))continue;n.add(s);const o=this._getInfo(s,a=>{n.has(a)||r.push(a)});o&&t.push(o)}return{names:i.map(s=>s.getDebugName()??"tx"),affected:t}}_getObservableInfo(t){const i=this._instanceInfos.get(t);if(!i){Qt(new Oi("No info found"));return}return i}_getAutorunInfo(t){const i=this._instanceInfos.get(t);if(!i){Qt(new Oi("No info found"));return}return i}_getInfo(t,i){if(t instanceof en){const r=[...t.debugGetObservers()];for(const l of r)i(l);const n=this._getObservableInfo(t);if(!n)return;const s=t.debugGetState(),o={name:t.debugName,instanceId:n.instanceId,updateCount:s.updateCount},a=[...n.changedObservables].map(l=>this._instanceInfos.get(l)?.instanceId).filter(ji);if(s.isComputing)return{...o,type:"observable/derived",state:"updating",changedDependencies:a,initialComputation:!1};switch(s.state){case 0:return{...o,type:"observable/derived",state:"noValue"};case 3:return{...o,type:"observable/derived",state:"upToDate"};case 2:return{...o,type:"observable/derived",state:"stale",changedDependencies:a};case 1:return{...o,type:"observable/derived",state:"possiblyStale"}}}else if(t instanceof Rm){const r=this._getAutorunInfo(t);if(!r)return;const n={name:t.debugName,instanceId:r.instanceId,updateCount:r.updateCount},s=[...r.changedObservables].map(o=>this._instanceInfos.get(o).instanceId);if(t.debugGetState().isRunning)return{...n,type:"autorun",state:"updating",changedDependencies:s};switch(t.debugGetState().state){case 3:return{...n,type:"autorun",state:"upToDate"};case 2:return{...n,type:"autorun",state:"stale",changedDependencies:s};case 1:return{...n,type:"autorun",state:"possiblyStale"}}}}_formatObservable(t){const i=this._getObservableInfo(t);if(i)return{name:t.debugName,instanceId:i.instanceId}}_formatObserver(t){if(t instanceof en)return{name:t.toString(),instanceId:this._getObservableInfo(t)?.instanceId};const i=this._getAutorunInfo(t);if(i)return{name:t.toString(),instanceId:i.instanceId}}constructor(){this._declarationId=0,this._instanceId=0,this._declarations=new Map,this._instanceInfos=new WeakMap,this._aliveInstances=new Map,this._activeTransactions=new Set,this._channel=h3("observableDevTools",()=>({notifications:{setDeclarationIdFilter:t=>{},logObservableValue:t=>{console.log("logObservableValue",t)},flushUpdates:()=>{this._flushUpdates()},resetUpdates:()=>{this._pendingChanges=null,this._channel.api.notifications.handleChange(this._fullState,!0)}},requests:{getDeclarations:()=>{const t={};for(const i of this._declarations.values())t[i.id]=i;return{decls:t}},getSummarizedInstances:()=>null,getObservableValueInfo:t=>({observers:[...this._aliveInstances.get(t).debugGetObservers()].map(r=>this._formatObserver(r)).filter(ji)}),getDerivedInfo:t=>{const i=this._aliveInstances.get(t);return{dependencies:[...i.debugGetState().dependencies].map(r=>this._formatObservable(r)).filter(ji),observers:[...i.debugGetObservers()].map(r=>this._formatObserver(r)).filter(ji)}},getAutorunInfo:t=>({dependencies:[...this._aliveInstances.get(t).debugGetState().dependencies].map(r=>this._formatObservable(r)).filter(ji)}),getTransactionState:()=>this.getTransactionState(),setValue:(t,i)=>{const r=this._aliveInstances.get(t);if(r instanceof en)r.debugSetValue(i);else if(r instanceof Tm)r.debugSetValue(i);else if(r instanceof Is)r.debugSetValue(i);else throw new Oi("Observable is not supported");const n=[...r.debugGetObservers()];for(const s of n)s.beginUpdate(r);for(const s of n)s.handleChange(r,void 0);for(const s of n)s.endUpdate(r)},getValue:t=>{const i=this._aliveInstances.get(t);if(i instanceof en)return tn(i.debugGetState().value,200);if(i instanceof Tm)return tn(i.debugGetState().value,200)}}})),this._pendingChanges=null,this._changeThrottler=new g3,this._fullState={},this._flushUpdates=()=>{this._pendingChanges!==null&&(this._channel.api.notifications.handleChange(this._pendingChanges,!1),this._pendingChanges=null)}}_handleChange(t){fE(this._fullState,t),this._pendingChanges===null?this._pendingChanges=t:hE(this._pendingChanges,t),this._changeThrottler.throttle(this._flushUpdates,10)}_getDeclarationId(t){let i=!0,r;const n=Error;for(;;){const o=n.stackTraceLimit;n.stackTraceLimit=i?6:20;const a=new Error().stack;n.stackTraceLimit=o;let l=dE(a,/[/\\]observableInternal[/\\]|\.observe|[/\\]util(s)?\./);if(!i&&!l&&(l=dE(a,/[/\\]observableInternal[/\\]|\.observe/)),l){r=l;break}if(!i){console.error("Could not find location for declaration",new Error().stack),r={fileName:"unknown",line:0,column:0,id:"unknown"};break}i=!1}let s=this._declarations.get(r.id);return s===void 0&&(s={id:this._declarationId++,type:t,url:r.fileName,line:r.line,column:r.column},this._declarations.set(r.id,s),this._handleChange({decls:{[s.id]:s}})),s.id}handleObservableCreated(t){const r={declarationId:this._getDeclarationId("observable/value"),instanceId:this._instanceId++,listenerCount:0,lastValue:void 0,updateCount:0,changedObservables:new Set};this._instanceInfos.set(t,r)}handleOnListenerCountChanged(t,i){const r=this._getObservableInfo(t);if(r){if(r.listenerCount===0&&i>0){const n=t instanceof en?"observable/derived":"observable/value";this._aliveInstances.set(r.instanceId,t),this._handleChange({instances:{[r.instanceId]:{instanceId:r.instanceId,declarationId:r.declarationId,formattedValue:r.lastValue,type:n,name:t.debugName}}})}else r.listenerCount>0&&i===0&&(this._handleChange({instances:{[r.instanceId]:null}}),this._aliveInstances.delete(r.instanceId));r.listenerCount=i}}handleObservableUpdated(t,i){if(t instanceof en){this._handleDerivedRecomputed(t,i);return}const r=this._getObservableInfo(t);r&&i.didChange&&(r.lastValue=tn(i.newValue,30),r.listenerCount>0&&this._handleChange({instances:{[r.instanceId]:{formattedValue:r.lastValue}}}))}handleAutorunCreated(t){const r={declarationId:this._getDeclarationId("autorun"),instanceId:this._instanceId++,updateCount:0,changedObservables:new Set};this._instanceInfos.set(t,r),this._aliveInstances.set(r.instanceId,t),r&&this._handleChange({instances:{[r.instanceId]:{instanceId:r.instanceId,declarationId:r.declarationId,runCount:0,type:"autorun",name:t.debugName}}})}handleAutorunDisposed(t){const i=this._getAutorunInfo(t);i&&(this._handleChange({instances:{[i.instanceId]:null}}),this._instanceInfos.delete(t),this._aliveInstances.delete(i.instanceId))}handleAutorunDependencyChanged(t,i,r){const n=this._getAutorunInfo(t);n&&n.changedObservables.add(i)}handleAutorunStarted(t){}handleAutorunFinished(t){const i=this._getAutorunInfo(t);i&&(i.changedObservables.clear(),i.updateCount++,this._handleChange({instances:{[i.instanceId]:{runCount:i.updateCount}}}))}handleDerivedDependencyChanged(t,i,r){const n=this._getObservableInfo(t);n&&n.changedObservables.add(i)}_handleDerivedRecomputed(t,i){const r=this._getObservableInfo(t);if(!r)return;const n=tn(i.newValue,30);r.updateCount++,r.changedObservables.clear(),r.lastValue=n,r.listenerCount>0&&this._handleChange({instances:{[r.instanceId]:{formattedValue:n,recomputationCount:r.updateCount}}})}handleDerivedCleared(t){const i=this._getObservableInfo(t);i&&(i.lastValue=void 0,i.changedObservables.clear(),i.listenerCount>0&&this._handleChange({instances:{[i.instanceId]:{formattedValue:void 0}}}))}handleBeginTransaction(t){this._activeTransactions.add(t)}handleEndTransaction(t){this._activeTransactions.delete(t)}};QA(s3);var v3=!1;v3&&Cm(new uE),Io&&Io.VSCODE_DEV_DEBUG&&Cm(m3.getInstance());var rn=class Ki{static fromTo(t,i){return new Ki(t,i)}static addRange(t,i){let r=0;for(;r<i.length&&i[r].endExclusive<t.start;)r++;let n=r;for(;n<i.length&&i[n].start<=t.endExclusive;)n++;if(r===n)i.splice(r,0,t);else{const s=Math.min(t.start,i[r].start),o=Math.max(t.endExclusive,i[n-1].endExclusive);i.splice(r,n-r,new Ki(s,o))}}static tryCreate(t,i){if(!(t>i))return new Ki(t,i)}static ofLength(t){return new Ki(0,t)}static ofStartAndLength(t,i){return new Ki(t,t+i)}static emptyAt(t){return new Ki(t,t)}constructor(t,i){if(this.start=t,this.endExclusive=i,t>i)throw new Oi(`Invalid range: ${this.toString()}`)}get isEmpty(){return this.start===this.endExclusive}delta(t){return new Ki(this.start+t,this.endExclusive+t)}deltaStart(t){return new Ki(this.start+t,this.endExclusive)}deltaEnd(t){return new Ki(this.start,this.endExclusive+t)}get length(){return this.endExclusive-this.start}toString(){return`[${this.start}, ${this.endExclusive})`}equals(t){return this.start===t.start&&this.endExclusive===t.endExclusive}containsRange(t){return this.start<=t.start&&t.endExclusive<=this.endExclusive}contains(t){return this.start<=t&&t<this.endExclusive}join(t){return new Ki(Math.min(this.start,t.start),Math.max(this.endExclusive,t.endExclusive))}intersect(t){const i=Math.max(this.start,t.start),r=Math.min(this.endExclusive,t.endExclusive);if(i<=r)return new Ki(i,r)}intersectionLength(t){const i=Math.max(this.start,t.start),r=Math.min(this.endExclusive,t.endExclusive);return Math.max(0,r-i)}intersects(t){const i=Math.max(this.start,t.start),r=Math.min(this.endExclusive,t.endExclusive);return i<r}intersectsOrTouches(t){const i=Math.max(this.start,t.start),r=Math.min(this.endExclusive,t.endExclusive);return i<=r}isBefore(t){return this.endExclusive<=t.start}isAfter(t){return this.start>=t.endExclusive}slice(t){return t.slice(this.start,this.endExclusive)}substring(t){return t.substring(this.start,this.endExclusive)}clip(t){if(this.isEmpty)throw new Oi(`Invalid clipping range: ${this.toString()}`);return Math.max(this.start,Math.min(this.endExclusive-1,t))}clipCyclic(t){if(this.isEmpty)throw new Oi(`Invalid clipping range: ${this.toString()}`);return t<this.start?this.endExclusive-(this.start-t)%this.length:t>=this.endExclusive?this.start+(t-this.start)%this.length:t}map(t){const i=[];for(let r=this.start;r<this.endExclusive;r++)i.push(t(r));return i}forEach(t){for(let i=this.start;i<this.endExclusive;i++)t(i)}},ks="**",Lm="/",bd="[/\\\\]",xd="[^/\\\\]",_3=/\//g;function pE(e,t){switch(e){case 0:return"";case 1:return`${xd}*?`;default:return`(?:${bd}|${xd}+${bd}${t?`|${bd}${xd}+`:""})*?`}}function Nm(e,t){if(!e)return[];const i=[];let r=!1,n=!1,s="";for(const o of e){switch(o){case t:if(!r&&!n){i.push(s),s="";continue}break;case"{":r=!0;break;case"}":r=!1;break;case"[":n=!0;break;case"]":n=!1;break}s+=o}return s&&i.push(s),i}function gE(e){if(!e)return"";let t="";const i=Nm(e,Lm);if(i.every(r=>r===ks))t=".*";else{let r=!1;i.forEach((n,s)=>{if(n===ks){if(r)return;t+=pE(2,s===i.length-1)}else{let o=!1,a="",l=!1,c="";for(const u of n){if(u!=="}"&&o){a+=u;continue}if(l&&(u!=="]"||!c)){let d;u==="-"?d=u:(u==="^"||u==="!")&&!c?d="^":u===Lm?d="":d=ps(u),c+=d;continue}switch(u){case"{":o=!0;continue;case"[":l=!0;continue;case"}":{const f=`(?:${Nm(a,",").map(p=>gE(p)).join("|")})`;t+=f,o=!1,a="";break}case"]":{t+="["+c+"]",l=!1,c="";break}case"?":t+=xd;continue;case"*":t+=pE(1);continue;default:t+=ps(u)}}s<i.length-1&&(i[s+1]!==ks||s+2<i.length)&&(t+=bd)}r=n===ks})}return t}var w3=/^\*\*\/\*\.[\w\.-]+$/,y3=/^\*\*\/([\w\.-]+)\/?$/,b3=/^{\*\*\/\*?[\w\.-]+\/?(,\*\*\/\*?[\w\.-]+\/?)*}$/,x3=/^{\*\*\/\*?[\w\.-]+(\/(\*\*)?)?(,\*\*\/\*?[\w\.-]+(\/(\*\*)?)?)*}$/,S3=/^\*\*((\/[\w\.-]+)+)\/?$/,E3=/^([\w\.-]+(\/[\w\.-]+)*)\/?$/,mE=new ng(1e4),vE=function(){return!1},kr=function(){return null};function Mm(e,t){if(!e)return kr;let i;typeof e!="string"?i=e.pattern:i=e,i=i.trim();const r=`${i}_${!!t.trimForExclusions}`;let n=mE.get(r);if(n)return _E(n,e);let s;return w3.test(i)?n=C3(i.substr(4),i):(s=y3.exec(Om(i,t)))?n=D3(s[1],i):(t.trimForExclusions?x3:b3).test(i)?n=I3(i,t):(s=S3.exec(Om(i,t)))?n=wE(s[1].substr(1),i,!0):(s=E3.exec(Om(i,t)))?n=wE(s[1],i,!1):n=k3(i),mE.set(r,n),_E(n,e)}function _E(e,t){if(typeof t=="string")return e;const i=function(r,n){return Xu(r,t.base,!Gr)?e(FP(r.substr(t.base.length),tr),n):null};return i.allBasenames=e.allBasenames,i.allPaths=e.allPaths,i.basenames=e.basenames,i.patterns=e.patterns,i}function Om(e,t){return t.trimForExclusions&&e.endsWith("/**")?e.substr(0,e.length-2):e}function C3(e,t){return function(i,r){return typeof i=="string"&&i.endsWith(e)?t:null}}function D3(e,t){const i=`/${e}`,r=`\\${e}`,n=function(o,a){return typeof o!="string"?null:a?a===e?t:null:o===e||o.endsWith(i)||o.endsWith(r)?t:null},s=[e];return n.basenames=s,n.patterns=[t],n.allBasenames=s,n}function I3(e,t){const i=yE(e.slice(1,-1).split(",").map(a=>Mm(a,t)).filter(a=>a!==kr),e),r=i.length;if(!r)return kr;if(r===1)return i[0];const n=function(a,l){for(let c=0,u=i.length;c<u;c++)if(i[c](a,l))return e;return null},s=i.find(a=>!!a.allBasenames);s&&(n.allBasenames=s.allBasenames);const o=i.reduce((a,l)=>l.allPaths?a.concat(l.allPaths):a,[]);return o.length&&(n.allPaths=o),n}function wE(e,t,i){const r=tr===Ne.sep,n=r?e:e.replace(_3,tr),s=tr+n,o=Ne.sep+e;let a;return i?a=function(l,c){return typeof l=="string"&&(l===n||l.endsWith(s)||!r&&(l===e||l.endsWith(o)))?t:null}:a=function(l,c){return typeof l=="string"&&(l===n||!r&&l===e)?t:null},a.allPaths=[(i?"*/":"./")+e],a}function k3(e){try{const t=new RegExp(`^${gE(e)}$`);return function(i){return t.lastIndex=0,typeof i=="string"&&t.test(i)?e:null}}catch{return kr}}function Rl(e,t,i){return!e||typeof t!="string"?!1:zo(e)(t,void 0,i)}function zo(e,t={}){if(!e)return vE;if(typeof e=="string"||P3(e)){const i=Mm(e,t);if(i===kr)return vE;const r=function(n,s){return!!i(n,s)};return i.allBasenames&&(r.allBasenames=i.allBasenames),i.allPaths&&(r.allPaths=i.allPaths),r}return T3(e,t)}function P3(e){const t=e;return t?typeof t.base=="string"&&typeof t.pattern=="string":!1}function T3(e,t){const i=yE(Object.getOwnPropertyNames(e).map(a=>A3(a,e[a],t)).filter(a=>a!==kr)),r=i.length;if(!r)return kr;if(!i.some(a=>!!a.requiresSiblings)){if(r===1)return i[0];const a=function(u,d){let f;for(let p=0,m=i.length;p<m;p++){const _=i[p](u,d);if(typeof _=="string")return _;An(_)&&(f||(f=[]),f.push(_))}return f?(async()=>{for(const p of f){const m=await p;if(typeof m=="string")return m}return null})():null},l=i.find(u=>!!u.allBasenames);l&&(a.allBasenames=l.allBasenames);const c=i.reduce((u,d)=>d.allPaths?u.concat(d.allPaths):u,[]);return c.length&&(a.allPaths=c),a}const n=function(a,l,c){let u,d;for(let f=0,p=i.length;f<p;f++){const m=i[f];m.requiresSiblings&&c&&(l||(l=ki(a)),u||(u=l.substr(0,l.length-xg(a).length)));const _=m(a,l,u,c);if(typeof _=="string")return _;An(_)&&(d||(d=[]),d.push(_))}return d?(async()=>{for(const f of d){const p=await f;if(typeof p=="string")return p}return null})():null},s=i.find(a=>!!a.allBasenames);s&&(n.allBasenames=s.allBasenames);const o=i.reduce((a,l)=>l.allPaths?a.concat(l.allPaths):a,[]);return o.length&&(n.allPaths=o),n}function A3(e,t,i){if(t===!1)return kr;const r=Mm(e,i);if(r===kr)return kr;if(typeof t=="boolean")return r;if(t){const n=t.when;if(typeof n=="string"){const s=(o,a,l,c)=>{if(!c||!r(o,a))return null;const u=n.replace("$(basename)",()=>l),d=c(u);return An(d)?d.then(f=>f?e:null):d?e:null};return s.requiresSiblings=!0,s}}return r}function yE(e,t){const i=e.filter(a=>!!a.basenames);if(i.length<2)return e;const r=i.reduce((a,l)=>{const c=l.basenames;return c?a.concat(c):a},[]);let n;if(t){n=[];for(let a=0,l=r.length;a<l;a++)n.push(t)}else n=i.reduce((a,l)=>{const c=l.patterns;return c?a.concat(c):a},[]);const s=function(a,l){if(typeof a!="string")return null;if(!l){let u;for(u=a.length;u>0;u--){const d=a.charCodeAt(u-1);if(d===47||d===92)break}l=a.substr(u)}const c=r.indexOf(l);return c!==-1?n[c]:null};s.basenames=r,s.patterns=n,s.allBasenames=r;const o=e.filter(a=>!a.basenames);return o.push(s),o}var R3=U("notebookDocumentService"),Fm=["W","X","Y","Z","a","b","c","d","e","f"],L3=new RegExp(`^[${Fm.join("")}]+`),bE=7;function $m(e){if(e.scheme!==V.vscodeNotebookCell)return;const t=e.fragment.indexOf("s");if(t<0)return;const i=parseInt(e.fragment.substring(0,t).replace(L3,""),bE),r=Lu(e.fragment.substring(t+1)).toString();if(!isNaN(i))return{handle:i,notebook:e.with({scheme:r,fragment:null})}}function N3(e,t){const i=t.toString(bE),n=`${i.length<Fm.length?Fm[i.length-1]:"z"}${i}s${hg(ae.fromString(e.scheme),!0,!0)}`;return e.with({scheme:V.vscodeNotebookCell,fragment:n})}function M3(e){if(e.scheme!==V.vscodeNotebookMetadata)return;const t=Lu(e.fragment).toString();return e.with({scheme:t,fragment:null})}function O3(e){const t=`${hg(ae.fromString(e.scheme),!0,!0)}`;return e.with({scheme:V.vscodeNotebookMetadata,fragment:t})}function xE(e){if(e.scheme!==V.vscodeNotebookCellOutput)return;const t=new URLSearchParams(e.query),i=t.get("openIn");if(!i)return;const r=t.get("outputId")??void 0,n=$m(e.with({scheme:V.vscodeNotebookCell,query:null})),s=t.get("outputIndex")?parseInt(t.get("outputIndex")||"",10):void 0,o=n?n.notebook:e.with({scheme:t.get("notebookScheme")||V.file,fragment:null,query:null}),a=t.get("cellIndex")?parseInt(t.get("cellIndex")||"",10):void 0;return{notebook:o,openIn:i,outputId:r,outputIndex:s,cellHandle:n?.handle,cellFragment:e.fragment,cellIndex:a}}var F3=class{constructor(){this._documents=new Ft}getNotebook(e){if(e.scheme===V.vscodeNotebookCell){const t=$m(e);if(t){const i=this._documents.get(t.notebook);if(i)return i}}if(e.scheme===V.vscodeNotebookCellOutput){const t=xE(e);if(t){const i=this._documents.get(t.notebook);if(i)return i}}return this._documents.get(e)}addNotebookDocument(e){this._documents.set(e.uri,e)}removeNotebookDocument(e){this._documents.delete(e.uri)}};Ze(R3,F3,1);var qo;(function(e){e[e.Markup=1]="Markup",e[e.Code=2]="Code"})(qo||(qo={}));var vB=["application/json","application/javascript","text/html","image/svg+xml",Yr.latex,Yr.markdown,"image/png","image/jpeg",Yr.text],_B=[Yr.latex,Yr.markdown,"application/json","text/html","image/svg+xml","image/png","image/jpeg",Yr.text],SE;(function(e){e[e.Running=1]="Running",e[e.Idle=2]="Idle"})(SE||(SE={}));var Ll;(function(e){e[e.Unconfirmed=1]="Unconfirmed",e[e.Pending=2]="Pending",e[e.Executing=3]="Executing"})(Ll||(Ll={}));var EE;(function(e){e[e.Unconfirmed=1]="Unconfirmed",e[e.Pending=2]="Pending",e[e.Executing=3]="Executing"})(EE||(EE={}));var CE;(function(e){e[e.WithHardKernelDependency=0]="WithHardKernelDependency",e[e.WithOptionalKernelDependency=1]="WithOptionalKernelDependency",e[e.Pure=2]="Pure",e[e.Never=3]="Never"})(CE||(CE={}));var DE;(function(e){e.Always="always",e.Never="never",e.Optional="optional"})(DE||(DE={}));var ar;(function(e){e[e.ModelChange=1]="ModelChange",e[e.Move=2]="Move",e[e.ChangeCellLanguage=5]="ChangeCellLanguage",e[e.Initialize=6]="Initialize",e[e.ChangeCellMetadata=7]="ChangeCellMetadata",e[e.Output=8]="Output",e[e.OutputItem=9]="OutputItem",e[e.ChangeCellContent=10]="ChangeCellContent",e[e.ChangeDocumentMetadata=11]="ChangeDocumentMetadata",e[e.ChangeCellInternalMetadata=12]="ChangeCellInternalMetadata",e[e.ChangeCellMime=13]="ChangeCellMime",e[e.Unknown=100]="Unknown"})(ar||(ar={}));var IE;(function(e){e[e.Handle=0]="Handle",e[e.Index=1]="Index"})(IE||(IE={}));var kE;(function(e){e[e.Replace=1]="Replace",e[e.Output=2]="Output",e[e.Metadata=3]="Metadata",e[e.CellLanguage=4]="CellLanguage",e[e.DocumentMetadata=5]="DocumentMetadata",e[e.Move=6]="Move",e[e.OutputItems=7]="OutputItems",e[e.PartialMetadata=8]="PartialMetadata",e[e.PartialInternalMetadata=9]="PartialInternalMetadata"})(kE||(kE={}));var PE;(function(e){e.scheme=V.vscodeNotebookMetadata;function t(r){return O3(r)}e.generate=t;function i(r){return M3(r)}e.parse=i})(PE||(PE={}));var Sd;(function(e){e.scheme=V.vscodeNotebookCell;function t(c,u){return N3(c,u)}e.generate=t;function i(c){return $m(c)}e.parse=i;function r(c,u){return c.with({scheme:V.vscodeNotebookCellOutput,query:new URLSearchParams({openIn:"editor",outputId:u??"",notebookScheme:c.scheme!==V.file?c.scheme:""}).toString()})}e.generateCellOutputUriWithId=r;function n(c,u,d){return c.with({scheme:V.vscodeNotebookCellOutput,fragment:u.fragment,query:new URLSearchParams({openIn:"notebook",outputIndex:String(d)}).toString()})}e.generateCellOutputUriWithIndex=n;function s(c,u,d,f,p){return c.with({scheme:V.vscodeNotebookCellOutput,query:new URLSearchParams({openIn:"notebookOutputEditor",notebook:c.toString(),cellIndex:String(d),outputId:f,outputIndex:String(p)}).toString()})}e.generateOutputEditorUri=s;function o(c){return xE(c)}e.parseCellOutputUri=o;function a(c,u,d){return e.generate(c,u).with({scheme:d})}e.generateCellPropertyUri=a;function l(c,u){if(c.scheme===u)return e.parse(c.with({scheme:e.scheme}))}e.parseCellPropertyUri=l})(Sd||(Sd={}));var wB=new I("notebookEditorCursorAtBoundary","none"),yB=new I("notebookEditorCursorAtLineBoundary","none"),TE;(function(e){e.default="default",e.option="option"})(TE||(TE={}));var AE;(function(e){e.Cells="cells",e.Text="text",e.None="none"})(AE||(AE={}));var RE;(function(e){e[e.Left=1]="Left",e[e.Right=2]="Right"})(RE||(RE={}));var bB=class $p{static{this._prefix="notebook/"}static create(t,i){return`${$p._prefix}${t}/${i??t}`}static parse(t){if(t.startsWith($p._prefix)){const i=t.substring($p._prefix.length).split("/");if(i.length===2)return{notebookType:i[0],viewType:i[1]}}}};function LE(e){return["application/vnd.code.notebook.stdout","application/vnd.code.notebook.stderr"].includes(e)}var $3=new TextDecoder;function H3(e){const t=[];let i=!1;for(const o of e)(t.length===0||i)&&(t.push(o),i=!0);let r=B3(t);const n=ae.concat(t.map(o=>ae.wrap(o))),s=j3(n);return r=r||s.byteLength!==n.byteLength,{data:s,didCompression:r}}var Ed="\x1B[A",Hm=Ed.split("").map(e=>e.charCodeAt(0)),U3=10;function B3(e){let t=!1;return e.forEach((i,r)=>{if(r===0||i.length<Ed.length)return;const n=e[r-1],s=i.subarray(0,Ed.length);if(s[0]===Hm[0]&&s[1]===Hm[1]&&s[2]===Hm[2]){const o=n.lastIndexOf(U3);if(o===-1)return;t=!0,e[r-1]=n.subarray(0,o),e[r]=i.subarray(Ed.length)}}),t}function W3(e){let t=e;do e=t,t=e.replace(/[^\n]\x08/gm,"");while(t.length<e.length);return e}function V3(e){for(e=e.replace(/\r+\n/gm,`
`);e.search(/\r[^$]/g)>-1;){const t=e.match(/^(.*)\r+/m)[1];let i=e.match(/\r+(.*)$/m)[1];i=i+t.slice(i.length,t.length),e=e.replace(/\r+.*$/m,"\r").replace(/^.*\r/m,i)}return e}var z3=8,q3=13;function j3(e){return!e.buffer.includes(z3)&&!e.buffer.includes(q3)?e:ae.fromString(V3(W3($3.decode(e.buffer))))}var G3=U("productService"),Q3="vscode://schemas/vscode-product",Cd=U("configurationService"),NE;(function(e){e[e.APPLICATION=1]="APPLICATION",e[e.USER=2]="USER",e[e.USER_LOCAL=3]="USER_LOCAL",e[e.USER_REMOTE=4]="USER_REMOTE",e[e.WORKSPACE=5]="WORKSPACE",e[e.WORKSPACE_FOLDER=6]="WORKSPACE_FOLDER",e[e.DEFAULT=7]="DEFAULT",e[e.MEMORY=8]="MEMORY"})(NE||(NE={}));function Um(e,t){const i=Object.create(null);for(const r in e)ME(i,r,e[r],t);return i}function ME(e,t,i,r){const n=t.split("."),s=n.pop();let o=e;for(let a=0;a<n.length;a++){const l=n[a];let c=o[l];switch(typeof c){case"undefined":c=o[l]=Object.create(null);break;case"object":if(c===null){r(`Ignoring ${t} as ${n.slice(0,a+1).join(".")} is null`);return}break;default:r(`Ignoring ${t} as ${n.slice(0,a+1).join(".")} is ${JSON.stringify(c)}`);return}o=c}if(typeof o=="object"&&o!==null)try{o[s]=i}catch{r(`Ignoring ${t} as ${n.join(".")} is ${JSON.stringify(o)}`)}else r(`Ignoring ${t} as ${n.join(".")} is ${JSON.stringify(o)}`)}function J3(e,t){const i=t.split(".");OE(e,i)}function OE(e,t){if(!e)return;const i=t.shift();if(t.length===0){delete e[i];return}if(Object.keys(e).indexOf(i)!==-1){const r=e[i];typeof r=="object"&&!Array.isArray(r)&&(OE(r,t),Object.keys(r).length===0&&delete e[i])}}function Dd(e,t,i){function r(o,a){let l=o;for(const c of a){if(typeof l!="object"||l===null)return;l=l[c]}return l}const n=t.split("."),s=r(e,n);return typeof s>"u"?i:s}function X3(e){return e.replace(/[\[\]]/g,"")}function Z3(e){let t=!1;const i=new Map,r=new Map;if(K3(e,u=>{if(e===u)return!0;const d=JSON.stringify(u);if(d.length<30)return!0;const f=i.get(d);if(!f){const p={schemas:[u]};return i.set(d,p),r.set(u,p),!0}return f.schemas.push(u),r.set(u,f),t=!0,!1}),i.clear(),!t)return JSON.stringify(e);let s="$defs";for(;e.hasOwnProperty(s);)s+="_";const o=[];function a(u){return JSON.stringify(u,(d,f)=>{if(f!==u){const p=r.get(f);if(p&&p.schemas.length>1)return p.id||(p.id=`_${o.length}`,o.push(p.schemas[0])),{$ref:`#/${s}/${p.id}`}}return f})}const l=a(e),c=[];for(let u=0;u<o.length;u++)c.push(`"_${u}":${a(o[u])}`);return c.length?`${l.substring(0,l.length-1)},"${s}":{${c.join(",")}}}`:l}function jo(e){return typeof e=="object"&&e!==null}function K3(e,t){if(!e||typeof e!="object")return;const i=(...l)=>{for(const c of l)jo(c)&&o.push(c)},r=(...l)=>{for(const c of l)if(jo(c))for(const u in c){const d=c[u];jo(d)&&o.push(d)}},n=(...l)=>{for(const c of l)if(Array.isArray(c))for(const u of c)jo(u)&&o.push(u)},s=l=>{if(Array.isArray(l))for(const c of l)jo(c)&&o.push(c);else jo(l)&&o.push(l)},o=[e];let a=o.pop();for(;a;)t(a)&&(i(a.additionalItems,a.additionalProperties,a.not,a.contains,a.propertyNames,a.if,a.then,a.else,a.unevaluatedItems,a.unevaluatedProperties),r(a.definitions,a.$defs,a.properties,a.patternProperties,a.dependencies,a.dependentSchemas),n(a.anyOf,a.allOf,a.oneOf,a.prefixItems),s(a.items)),a=o.pop()}var Id={JSONContribution:"base.contributions.json"};function FE(e){return e.length>0&&e.charAt(e.length-1)==="#"?e.substring(0,e.length-1):e}var Y3=class extends se{constructor(){super(...arguments),this.schemasById={},this.schemaAssociations={},this._onDidChangeSchema=this._register(new P),this.onDidChangeSchema=this._onDidChangeSchema.event,this._onDidChangeSchemaAssociations=this._register(new P),this.onDidChangeSchemaAssociations=this._onDidChangeSchemaAssociations.event}registerSchema(e,t,i){const r=FE(e);this.schemasById[r]=t,this._onDidChangeSchema.fire(e),i&&i.add(ne(()=>{delete this.schemasById[r],this._onDidChangeSchema.fire(e)}))}registerSchemaAssociation(e,t){const i=FE(e);return this.schemaAssociations[i]||(this.schemaAssociations[i]=[]),this.schemaAssociations[i].includes(t)||(this.schemaAssociations[i].push(t),this._onDidChangeSchemaAssociations.fire()),ne(()=>{const r=this.schemaAssociations[i];if(r){const n=r.indexOf(t);n!==-1&&(r.splice(n,1),r.length===0&&delete this.schemaAssociations[i],this._onDidChangeSchemaAssociations.fire())}})}notifySchemaChanged(e){this._onDidChangeSchema.fire(e)}getSchemaContributions(){return{schemas:this.schemasById}}getSchemaContent(e){const t=this.schemasById[e];return t?Z3(t):void 0}hasSchemaContent(e){return!!this.schemasById[e]}getSchemaAssociations(){return this.schemaAssociations}},eR=new Y3;Ht.add(Id.JSONContribution,eR);var $E;(function(e){e.Multiline="multilineText",e.Singleline="singlelineText"})($E||($E={}));var Ps={Configuration:"base.contributions.configuration"},HE;(function(e){e[e.APPLICATION=1]="APPLICATION",e[e.MACHINE=2]="MACHINE",e[e.APPLICATION_MACHINE=3]="APPLICATION_MACHINE",e[e.WINDOW=4]="WINDOW",e[e.RESOURCE=5]="RESOURCE",e[e.LANGUAGE_OVERRIDABLE=6]="LANGUAGE_OVERRIDABLE",e[e.MACHINE_OVERRIDABLE=7]="MACHINE_OVERRIDABLE"})(HE||(HE={}));var kd={properties:{},patternProperties:{}},Pd={properties:{},patternProperties:{}},Td={properties:{},patternProperties:{}},Ad={properties:{},patternProperties:{}},Rd={properties:{},patternProperties:{}},Ld={properties:{},patternProperties:{}},Nl={properties:{},patternProperties:{}},Ts="vscode://schemas/settings/resourceLanguage",Nd=Ht.as(Id.JSONContribution),tR=class extends se{constructor(){super(),this.registeredConfigurationDefaults=[],this.overrideIdentifiers=new Set,this._onDidSchemaChange=this._register(new P),this.onDidSchemaChange=this._onDidSchemaChange.event,this._onDidUpdateConfiguration=this._register(new P),this.onDidUpdateConfiguration=this._onDidUpdateConfiguration.event,this.configurationDefaultsOverrides=new Map,this.defaultLanguageConfigurationOverridesNode={id:"defaultOverrides",title:h(1803,null),properties:{}},this.configurationContributors=[this.defaultLanguageConfigurationOverridesNode],this.resourceLanguageSettingsSchema={properties:{},patternProperties:{},additionalProperties:!0,allowTrailingCommas:!0,allowComments:!0},this.configurationProperties={},this.policyConfigurations=new Map,this.excludedConfigurationProperties={},Nd.registerSchema(Ts,this.resourceLanguageSettingsSchema),this.registerOverridePropertyPatternKey()}registerConfiguration(e,t=!0){return this.registerConfigurations([e],t),e}registerConfigurations(e,t=!0){const i=new Set;this.doRegisterConfigurations(e,t,i),Nd.registerSchema(Ts,this.resourceLanguageSettingsSchema),this._onDidSchemaChange.fire(),this._onDidUpdateConfiguration.fire({properties:i})}deregisterConfigurations(e){const t=new Set;this.doDeregisterConfigurations(e,t),Nd.registerSchema(Ts,this.resourceLanguageSettingsSchema),this._onDidSchemaChange.fire(),this._onDidUpdateConfiguration.fire({properties:t})}updateConfigurations({add:e,remove:t}){const i=new Set;this.doDeregisterConfigurations(t,i),this.doRegisterConfigurations(e,!1,i),Nd.registerSchema(Ts,this.resourceLanguageSettingsSchema),this._onDidSchemaChange.fire(),this._onDidUpdateConfiguration.fire({properties:i})}registerDefaultConfigurations(e){const t=new Set;this.doRegisterDefaultConfigurations(e,t),this._onDidSchemaChange.fire(),this._onDidUpdateConfiguration.fire({properties:t,defaultsOverrides:!0})}doRegisterDefaultConfigurations(e,t){this.registeredConfigurationDefaults.push(...e);const i=[];for(const{overrides:r,source:n}of e)for(const s in r){t.add(s);const o=this.configurationDefaultsOverrides.get(s)??this.configurationDefaultsOverrides.set(s,{configurationDefaultOverrides:[]}).get(s),a=r[s];if(o.configurationDefaultOverrides.push({value:a,source:n}),Pr.test(s)){const l=this.mergeDefaultConfigurationsForOverrideIdentifier(s,a,n,o.configurationDefaultOverrideValue);if(!l)continue;o.configurationDefaultOverrideValue=l,this.updateDefaultOverrideProperty(s,l,n),i.push(...Ml(s))}else{const l=this.mergeDefaultConfigurationsForConfigurationProperty(s,a,n,o.configurationDefaultOverrideValue);if(!l)continue;o.configurationDefaultOverrideValue=l;const c=this.configurationProperties[s];c&&(this.updatePropertyDefaultValue(s,c),this.updateSchema(s,c))}}this.doRegisterOverrideIdentifiers(i)}deregisterDefaultConfigurations(e){const t=new Set;this.doDeregisterDefaultConfigurations(e,t),this._onDidSchemaChange.fire(),this._onDidUpdateConfiguration.fire({properties:t,defaultsOverrides:!0})}doDeregisterDefaultConfigurations(e,t){for(const i of e){const r=this.registeredConfigurationDefaults.indexOf(i);r!==-1&&this.registeredConfigurationDefaults.splice(r,1)}for(const{overrides:i,source:r}of e)for(const n in i){const s=this.configurationDefaultsOverrides.get(n);if(!s)continue;const o=s.configurationDefaultOverrides.findIndex(a=>r?a.source?.id===r.id:a.value===i[n]);if(o!==-1){if(s.configurationDefaultOverrides.splice(o,1),s.configurationDefaultOverrides.length===0&&this.configurationDefaultsOverrides.delete(n),Pr.test(n)){let a;for(const l of s.configurationDefaultOverrides)a=this.mergeDefaultConfigurationsForOverrideIdentifier(n,l.value,l.source,a);a&&!cy(a.value)?(s.configurationDefaultOverrideValue=a,this.updateDefaultOverrideProperty(n,a,r)):(this.configurationDefaultsOverrides.delete(n),delete this.configurationProperties[n],delete this.defaultLanguageConfigurationOverridesNode.properties[n])}else{let a;for(const c of s.configurationDefaultOverrides)a=this.mergeDefaultConfigurationsForConfigurationProperty(n,c.value,c.source,a);s.configurationDefaultOverrideValue=a;const l=this.configurationProperties[n];l&&(this.updatePropertyDefaultValue(n,l),this.updateSchema(n,l))}t.add(n)}}this.updateOverridePropertyPatternKey()}updateDefaultOverrideProperty(e,t,i){const r={type:"object",default:t.value,description:h(1804,null,X3(e)),$ref:Ts,defaultDefaultValue:t.value,source:i,defaultValueSource:i};this.configurationProperties[e]=r,this.defaultLanguageConfigurationOverridesNode.properties[e]=r}mergeDefaultConfigurationsForOverrideIdentifier(e,t,i,r){const n=r?.value||{},s=r?.source??new Map;if(!(s instanceof Map)){console.error("objectConfigurationSources is not a Map");return}for(const o of Object.keys(t)){const a=t[o];if(St(a)&&(il(n[o])||St(n[o]))){if(n[o]={...n[o]??{},...a},i)for(const c in a)s.set(`${o}.${c}`,i)}else n[o]=a,i?s.set(o,i):s.delete(o)}return{value:n,source:s}}mergeDefaultConfigurationsForConfigurationProperty(e,t,i,r){const n=this.configurationProperties[e],s=r?.value??n?.defaultDefaultValue;let o=i;if(St(t)&&(n!==void 0&&n.type==="object"||n===void 0&&(il(s)||St(s)))){if(o=r?.source??new Map,!(o instanceof Map)){console.error("defaultValueSource is not a Map");return}for(const l in t)i&&o.set(`${e}.${l}`,i);t={...St(s)?s:{},...t}}return{value:t,source:o}}deltaConfiguration(e){let t=!1;const i=new Set;e.removedDefaults&&(this.doDeregisterDefaultConfigurations(e.removedDefaults,i),t=!0),e.addedDefaults&&(this.doRegisterDefaultConfigurations(e.addedDefaults,i),t=!0),e.removedConfigurations&&this.doDeregisterConfigurations(e.removedConfigurations,i),e.addedConfigurations&&this.doRegisterConfigurations(e.addedConfigurations,!1,i),this._onDidSchemaChange.fire(),this._onDidUpdateConfiguration.fire({properties:i,defaultsOverrides:t})}notifyConfigurationSchemaUpdated(...e){this._onDidSchemaChange.fire()}registerOverrideIdentifiers(e){this.doRegisterOverrideIdentifiers(e),this._onDidSchemaChange.fire()}doRegisterOverrideIdentifiers(e){for(const t of e)this.overrideIdentifiers.add(t);this.updateOverridePropertyPatternKey()}doRegisterConfigurations(e,t,i){e.forEach(r=>{this.validateAndRegisterProperties(r,t,r.extensionInfo,r.restrictedProperties,void 0,i),this.configurationContributors.push(r),this.registerJSONConfiguration(r)})}doDeregisterConfigurations(e,t){const i=r=>{if(r.properties)for(const n in r.properties){t.add(n);const s=this.configurationProperties[n];s?.policy?.name&&this.policyConfigurations.delete(s.policy.name),delete this.configurationProperties[n],this.removeFromSchema(n,r.properties[n])}r.allOf?.forEach(n=>i(n))};for(const r of e){i(r);const n=this.configurationContributors.indexOf(r);n!==-1&&this.configurationContributors.splice(n,1)}}validateAndRegisterProperties(e,t=!0,i,r,n=4,s){n=Et(e.scope)?n:e.scope;const o=e.properties;if(o)for(const l in o){const c=o[l];if(t&&rR(l,c)){delete o[l];continue}c.source=i,c.defaultDefaultValue=o[l].default,this.updatePropertyDefaultValue(l,c),Pr.test(l)?c.scope=void 0:(c.scope=Et(c.scope)?n:c.scope,c.restricted=Et(c.restricted)?!!r?.includes(l):c.restricted);const u=o[l].hasOwnProperty("included")&&!o[l].included,d=o[l].policy?.name;u?(this.excludedConfigurationProperties[l]=o[l],d&&(this.policyConfigurations.set(d,l),s.add(l)),delete o[l]):(s.add(l),d&&this.policyConfigurations.set(d,l),this.configurationProperties[l]=o[l],!o[l].deprecationMessage&&o[l].markdownDeprecationMessage&&(o[l].deprecationMessage=o[l].markdownDeprecationMessage))}const a=e.allOf;if(a)for(const l of a)this.validateAndRegisterProperties(l,t,i,r,n,s)}getConfigurations(){return this.configurationContributors}getConfigurationProperties(){return this.configurationProperties}getPolicyConfigurations(){return this.policyConfigurations}getExcludedConfigurationProperties(){return this.excludedConfigurationProperties}getRegisteredDefaultConfigurations(){return[...this.registeredConfigurationDefaults]}getConfigurationDefaultsOverrides(){const e=new Map;for(const[t,i]of this.configurationDefaultsOverrides)i.configurationDefaultOverrideValue&&e.set(t,i.configurationDefaultOverrideValue);return e}registerJSONConfiguration(e){const t=i=>{const r=i.properties;if(r)for(const s in r)this.updateSchema(s,r[s]);i.allOf?.forEach(t)};t(e)}updateSchema(e,t){switch(kd.properties[e]=t,t.scope){case 1:Pd.properties[e]=t;break;case 2:Ad.properties[e]=t;break;case 3:Td.properties[e]=t;break;case 7:Rd.properties[e]=t;break;case 4:Ld.properties[e]=t;break;case 5:Nl.properties[e]=t;break;case 6:Nl.properties[e]=t,this.resourceLanguageSettingsSchema.properties[e]=t;break}}removeFromSchema(e,t){switch(delete kd.properties[e],t.scope){case 1:delete Pd.properties[e];break;case 2:delete Ad.properties[e];break;case 3:delete Td.properties[e];break;case 7:delete Rd.properties[e];break;case 4:delete Ld.properties[e];break;case 5:case 6:delete Nl.properties[e],delete this.resourceLanguageSettingsSchema.properties[e];break}}updateOverridePropertyPatternKey(){for(const e of this.overrideIdentifiers.values()){const t=`[${e}]`,i={type:"object",description:h(1805,null),errorMessage:h(1806,null),$ref:Ts};this.updatePropertyDefaultValue(t,i),kd.properties[t]=i,Pd.properties[t]=i,Td.properties[t]=i,Ad.properties[t]=i,Rd.properties[t]=i,Ld.properties[t]=i,Nl.properties[t]=i}}registerOverridePropertyPatternKey(){const e={type:"object",description:h(1807,null),errorMessage:h(1808,null),$ref:Ts};kd.patternProperties[Mn]=e,Pd.patternProperties[Mn]=e,Td.patternProperties[Mn]=e,Ad.patternProperties[Mn]=e,Rd.patternProperties[Mn]=e,Ld.patternProperties[Mn]=e,Nl.patternProperties[Mn]=e,this._onDidSchemaChange.fire()}updatePropertyDefaultValue(e,t){const i=this.configurationDefaultsOverrides.get(e)?.configurationDefaultOverrideValue;let r,n;i&&(!t.disallowConfigurationDefault||!i.source)&&(r=i.value,n=i.source),il(r)&&(r=t.defaultDefaultValue,n=void 0),il(r)&&(r=iR(t.type)),t.default=r,t.defaultValueSource=n}},UE="\\[([^\\]]+)\\]",BE=new RegExp(UE,"g"),Mn=`^(${UE})+$`,Pr=new RegExp(Mn);function Ml(e){const t=[];if(Pr.test(e)){let i=BE.exec(e);for(;i?.length;){const r=i[1].trim();r&&t.push(r),i=BE.exec(e)}}return bo(t)}function iR(e){switch(Array.isArray(e)?e[0]:e){case"boolean":return!1;case"integer":case"number":return 0;case"string":return"";case"array":return[];case"object":return{};default:return null}}var Md=new tR;Ht.add(Ps.Configuration,Md);function rR(e,t){return e.trim()?Pr.test(e)?h(1810,null,e):Md.getConfigurationProperties()[e]!==void 0?h(1811,null,e):t.policy?.name&&Md.getPolicyConfigurations().get(t.policy?.name)!==void 0?h(1812,null,e,t.policy?.name,Md.getPolicyConfigurations().get(t.policy?.name)):null:h(1809,null)}var nR=U("requestService");function sR(e){return e.res.statusCode&&e.res.statusCode>=200&&e.res.statusCode<300||e.res.statusCode===1223}function oR(e){return e.res.statusCode===204}async function aR(e){if(!sR(e))throw new Error("Server returned "+e.res.statusCode);if(oR(e))return null;const i=(await O9(e.stream)).toString();try{return JSON.parse(i)}catch(r){throw r.message+=`:
`+i,r}}var Bm=[],WE=void 0,VE=void 0;function lR(e=!0,t=!0){if(WE===e&&VE===t)return;WE=e,VE=t;const i=Ht.as(Ps.Configuration),r=Bm;Bm=[{id:"http",order:15,title:h(2228,null),type:"object",scope:2,properties:{"http.useLocalProxyConfiguration":{type:"boolean",default:t,markdownDescription:h(2229,null),restricted:!0}}},{id:"http",order:15,title:h(2230,null),type:"object",scope:1,properties:{"http.electronFetch":{type:"boolean",default:!1,description:h(2231,null),restricted:!0}}},{id:"http",order:15,title:h(2232,null),type:"object",scope:e?1:2,properties:{"http.proxy":{type:"string",pattern:"^(https?|socks|socks4a?|socks5h?)://([^:]*(:[^@]*)?@)?([^:]+|\\[[:0-9a-fA-F]+\\])(:\\d+)?/?$|^$",markdownDescription:h(2233,null,"`#http.useLocalProxyConfiguration#`"),restricted:!0},"http.proxyStrictSSL":{type:"boolean",default:!0,markdownDescription:h(2234,null,"`#http.useLocalProxyConfiguration#`"),restricted:!0},"http.proxyKerberosServicePrincipal":{type:"string",markdownDescription:h(2235,null,"`#http.useLocalProxyConfiguration#`"),restricted:!0},"http.noProxy":{type:"array",items:{type:"string"},markdownDescription:h(2236,null,"`#http.useLocalProxyConfiguration#`"),restricted:!0},"http.proxyAuthorization":{type:["null","string"],default:null,markdownDescription:h(2237,null,"`#http.useLocalProxyConfiguration#`"),restricted:!0},"http.proxySupport":{type:"string",enum:["off","on","fallback","override"],enumDescriptions:[h(2238,null),h(2239,null),h(2240,null),h(2241,null)],default:"override",markdownDescription:h(2242,null,"`#http.useLocalProxyConfiguration#`"),restricted:!0},"http.systemCertificates":{type:"boolean",default:!0,markdownDescription:h(2243,null,"`#http.useLocalProxyConfiguration#`"),restricted:!0},"http.experimental.systemCertificatesV2":{type:"boolean",tags:["experimental"],default:!1,markdownDescription:h(2244,null,"`#http.useLocalProxyConfiguration#`"),restricted:!0},"http.fetchAdditionalSupport":{type:"boolean",default:!0,markdownDescription:h(2245,null,"`#http.useLocalProxyConfiguration#`","`#http.proxySupport#`","`#http.systemCertificates#`"),restricted:!0}}}],i.updateConfigurations({add:Bm,remove:r})}lR();var Ol;(function(e){e[e.STORAGE_DOES_NOT_EXIST=0]="STORAGE_DOES_NOT_EXIST",e[e.STORAGE_IN_MEMORY=1]="STORAGE_IN_MEMORY"})(Ol||(Ol={}));var lr;(function(e){e[e.None=0]="None",e[e.Initialized=1]="Initialized",e[e.Closed=2]="Closed"})(lr||(lr={}));var xB=class U6 extends se{static{this.DEFAULT_FLUSH_DELAY=100}constructor(t,i=Object.create(null)){super(),this.database=t,this.options=i,this._onDidChangeStorage=this._register(new Mu),this.onDidChangeStorage=this._onDidChangeStorage.event,this.state=lr.None,this.cache=new Map,this.flushDelayer=this._register(new IT(U6.DEFAULT_FLUSH_DELAY)),this.pendingDeletes=new Set,this.pendingInserts=new Map,this.pendingClose=void 0,this.whenFlushedCallbacks=[],this.registerListeners()}registerListeners(){this._register(this.database.onDidChangeItemsExternal(t=>this.onDidChangeItemsExternal(t)))}onDidChangeItemsExternal(t){this._onDidChangeStorage.pause();try{t.changed?.forEach((i,r)=>this.acceptExternal(r,i)),t.deleted?.forEach(i=>this.acceptExternal(i,void 0))}finally{this._onDidChangeStorage.resume()}}acceptExternal(t,i){if(this.state===lr.Closed)return;let r=!1;Et(i)?r=this.cache.delete(t):this.cache.get(t)!==i&&(this.cache.set(t,i),r=!0),r&&this._onDidChangeStorage.fire({key:t,external:!0})}get items(){return this.cache}get size(){return this.cache.size}async init(){this.state===lr.None&&(this.state=lr.Initialized,this.options.hint!==Ol.STORAGE_DOES_NOT_EXIST&&(this.cache=await this.database.getItems()))}get(t,i){const r=this.cache.get(t);return Et(r)?i:r}getBoolean(t,i){const r=this.get(t);return Et(r)?i:r==="true"}getNumber(t,i){const r=this.get(t);return Et(r)?i:parseInt(r,10)}getObject(t,i){const r=this.get(t);return Et(r)?i:rS(r)}async set(t,i,r=!1){if(this.state===lr.Closed)return;if(Et(i))return this.delete(t,r);const n=St(i)||Array.isArray(i)?SA(i):String(i);if(this.cache.get(t)!==n)return this.cache.set(t,n),this.pendingInserts.set(t,n),this.pendingDeletes.delete(t),this._onDidChangeStorage.fire({key:t,external:r}),this.doFlush()}async delete(t,i=!1){if(!(this.state===lr.Closed||!this.cache.delete(t)))return this.pendingDeletes.has(t)||this.pendingDeletes.add(t),this.pendingInserts.delete(t),this._onDidChangeStorage.fire({key:t,external:i}),this.doFlush()}async optimize(){if(this.state!==lr.Closed)return await this.flush(0),this.database.optimize()}async close(){return this.pendingClose||(this.pendingClose=this.doClose()),this.pendingClose}async doClose(){this.state=lr.Closed;try{await this.doFlush(0)}catch{}await this.database.close(()=>this.cache)}get hasPending(){return this.pendingInserts.size>0||this.pendingDeletes.size>0}async flushPending(){if(!this.hasPending)return;const t={insert:this.pendingInserts,delete:this.pendingDeletes};return this.pendingDeletes=new Set,this.pendingInserts=new Map,this.database.updateItems(t).finally(()=>{if(!this.hasPending)for(;this.whenFlushedCallbacks.length;)this.whenFlushedCallbacks.pop()?.()})}async flush(t){if(!(this.state===lr.Closed||this.pendingClose))return this.doFlush(t)}async doFlush(t){return this.options.hint===Ol.STORAGE_IN_MEMORY?this.flushPending():this.flushDelayer.trigger(()=>this.flushPending(),t)}async whenFlushed(){if(this.hasPending)return new Promise(t=>this.whenFlushedCallbacks.push(t))}isInMemory(){return this.options.hint===Ol.STORAGE_IN_MEMORY}},Wm=U("environmentService"),SB=Wm,zE=U("IUriIdentityService"),qE;(function(e){e.Settings="settings",e.Keybindings="keybindings",e.Snippets="snippets",e.Prompts="prompts",e.Tasks="tasks",e.Extensions="extensions",e.GlobalState="globalState"})(qE||(qE={}));function cR(e){const t=e;return!!(t&&typeof t=="object"&&typeof t.id=="string"&&typeof t.isDefault=="boolean"&&typeof t.name=="string"&&y.isUri(t.location)&&y.isUri(t.globalStorageHome)&&y.isUri(t.settingsResource)&&y.isUri(t.keybindingsResource)&&y.isUri(t.tasksResource)&&y.isUri(t.snippetsHome)&&y.isUri(t.promptsHome)&&y.isUri(t.extensionsResource))}var uR=U("IUserDataProfilesService");function Od(e,t,i,r,n,s){return{id:e,name:t,location:i,isDefault:!1,icon:n?.icon,globalStorageHome:s&&n?.useDefaultFlags?.globalState?s.globalStorageHome:Zt(i,"globalStorage"),settingsResource:s&&n?.useDefaultFlags?.settings?s.settingsResource:Zt(i,"settings.json"),keybindingsResource:s&&n?.useDefaultFlags?.keybindings?s.keybindingsResource:Zt(i,"keybindings.json"),tasksResource:s&&n?.useDefaultFlags?.tasks?s.tasksResource:Zt(i,"tasks.json"),snippetsHome:s&&n?.useDefaultFlags?.snippets?s.snippetsHome:Zt(i,"snippets"),promptsHome:s&&n?.useDefaultFlags?.prompts?s.promptsHome:Zt(i,"prompts"),extensionsResource:s&&n?.useDefaultFlags?.extensions?s.extensionsResource:Zt(i,"extensions.json"),cacheHome:Zt(r,e),useDefaultFlags:n?.useDefaultFlags,isTransient:n?.transient,workspaces:n?.workspaces}}var jE=class extends se{static{this.PROFILES_KEY="userDataProfiles"}static{this.PROFILE_ASSOCIATIONS_KEY="profileAssociations"}get defaultProfile(){return this.profiles[0]}get profiles(){return[...this.profilesObject.profiles,...this.transientProfilesObject.profiles]}constructor(t,i,r,n){super(),this.environmentService=t,this.fileService=i,this.uriIdentityService=r,this.logService=n,this._onDidChangeProfiles=this._register(new P),this.onDidChangeProfiles=this._onDidChangeProfiles.event,this._onWillCreateProfile=this._register(new P),this.onWillCreateProfile=this._onWillCreateProfile.event,this._onWillRemoveProfile=this._register(new P),this.onWillRemoveProfile=this._onWillRemoveProfile.event,this._onDidResetWorkspaces=this._register(new P),this.onDidResetWorkspaces=this._onDidResetWorkspaces.event,this.profileCreationPromises=new Map,this.transientProfilesObject={profiles:[],emptyWindows:new Map},this.profilesHome=Zt(this.environmentService.userRoamingDataHome,"profiles"),this.profilesCacheHome=Zt(this.environmentService.cacheHome,"CachedProfilesData")}init(){this._profilesObject=void 0}get profilesObject(){if(!this._profilesObject){const t=this.createDefaultProfile(),i=[t];try{for(const n of this.getStoredProfiles()){if(!n.name||!Me(n.name)||!n.location){this.logService.warn("Skipping the invalid stored profile",n.location||n.name);continue}i.push(Od(nr(n.location),n.name,n.location,this.profilesCacheHome,{icon:n.icon,useDefaultFlags:n.useDefaultFlags},t))}}catch(n){this.logService.error(n)}const r=new Map;if(i.length)try{const n=this.getStoredProfileAssociations();if(n.workspaces)for(const[s,o]of Object.entries(n.workspaces)){const a=y.parse(s),l=i.find(c=>c.id===o);if(l){const c=l.workspaces?l.workspaces.slice(0):[];c.push(a),l.workspaces=c}}if(n.emptyWindows)for(const[s,o]of Object.entries(n.emptyWindows)){const a=i.find(l=>l.id===o);a&&r.set(s,a)}}catch(n){this.logService.error(n)}this._profilesObject={profiles:i,emptyWindows:r}}return this._profilesObject}createDefaultProfile(){const t=Od("__default__profile__",h(2637,null),this.environmentService.userRoamingDataHome,this.profilesCacheHome);return{...t,extensionsResource:this.getDefaultProfileExtensionsLocation()??t.extensionsResource,isDefault:!0}}async createTransientProfile(t){const i="Temp",r=new RegExp(`${ps(i)}\\s(\\d+)`);let n=0;for(const o of this.profiles){const a=r.exec(o.name),l=a?parseInt(a[1]):0;n=l>n?l:n}const s=`${i} ${n+1}`;return this.createProfile(ml($t()).toString(16),s,{transient:!0},t)}async createNamedProfile(t,i,r){return this.createProfile(ml($t()).toString(16),t,i,r)}async createProfile(t,i,r,n){return await this.doCreateProfile(t,i,r,n)}async doCreateProfile(t,i,r,n){if(!Me(i)||!i)throw new Error("Name of the profile is mandatory and must be of type `string`");let s=this.profileCreationPromises.get(i);return s||(s=(async()=>{try{if(this.profiles.find(u=>u.id===t||!u.isTransient&&!r?.transient&&u.name===i))throw new Error(`Profile with ${i} name already exists`);const a=n?this.getWorkspace(n):void 0;y.isUri(a)&&(r={...r,workspaces:[a]});const l=Od(t,i,Zt(this.profilesHome,t),this.profilesCacheHome,r,this.defaultProfile);await this.fileService.createFolder(l.location);const c=[];return this._onWillCreateProfile.fire({profile:l,join(u){c.push(u)}}),await Ro.settled(c),a&&!y.isUri(a)&&this.updateEmptyWindowAssociation(a,l,!!l.isTransient),this.updateProfiles([l],[],[]),l}finally{this.profileCreationPromises.delete(i)}})(),this.profileCreationPromises.set(i,s)),s}async updateProfile(t,i){const r=[];for(const s of this.profiles){let o;if(t.id===s.id)s.isDefault?i.workspaces&&(o=s,o.workspaces=i.workspaces):o=Od(s.id,i.name??s.name,s.location,this.profilesCacheHome,{icon:i.icon===null?void 0:i.icon??s.icon,transient:i.transient??s.isTransient,useDefaultFlags:i.useDefaultFlags??s.useDefaultFlags,workspaces:i.workspaces??s.workspaces},this.defaultProfile);else if(i.workspaces){const a=s.workspaces?.filter(l=>!i.workspaces?.some(c=>this.uriIdentityService.extUri.isEqual(l,c)));s.workspaces?.length!==a?.length&&(o=s,o.workspaces=a)}o&&r.push(o)}if(!r.length)throw t.isDefault?new Error("Cannot update default profile"):new Error(`Profile '${t.name}' does not exist`);this.updateProfiles([],[],r);const n=this.profiles.find(s=>s.id===t.id);if(!n)throw new Error(`Profile '${t.name}' was not updated`);return n}async removeProfile(t){if(t.isDefault)throw new Error("Cannot remove default profile");const i=this.profiles.find(n=>n.id===t.id);if(!i)throw new Error(`Profile '${t.name}' does not exist`);const r=[];this._onWillRemoveProfile.fire({profile:i,join(n){r.push(n)}});try{await Promise.allSettled(r)}catch(n){this.logService.error(n)}this.updateProfiles([],[i],[]);try{await this.fileService.del(i.cacheHome,{recursive:!0})}catch(n){RA(n)!==1&&this.logService.error(n)}}async setProfileForWorkspace(t,i){const r=this.profiles.find(s=>s.id===i.id);if(!r)throw new Error(`Profile '${i.name}' does not exist`);const n=this.getWorkspace(t);if(y.isUri(n)){const s=r.workspaces?[...r.workspaces]:[];s.some(o=>this.uriIdentityService.extUri.isEqual(o,n))||(s.push(n),await this.updateProfile(r,{workspaces:s}))}else this.updateEmptyWindowAssociation(n,r,!1),this.updateStoredProfiles(this.profiles)}unsetWorkspace(t,i=!1){const r=this.getWorkspace(t);if(y.isUri(r)){const n=this.getProfileForWorkspace(t);n&&this.updateProfile(n,{workspaces:n.workspaces?.filter(s=>!this.uriIdentityService.extUri.isEqual(s,r))})}else this.updateEmptyWindowAssociation(r,void 0,i),this.updateStoredProfiles(this.profiles)}async resetWorkspaces(){this.transientProfilesObject.emptyWindows.clear(),this.profilesObject.emptyWindows.clear();for(const t of this.profiles)t.workspaces=void 0;this.updateProfiles([],[],this.profiles),this._onDidResetWorkspaces.fire()}async cleanUp(){if(await this.fileService.exists(this.profilesHome)){const t=await this.fileService.resolve(this.profilesHome);await Promise.all((t.children||[]).filter(i=>i.isDirectory&&this.profiles.every(r=>!this.uriIdentityService.extUri.isEqual(r.location,i.resource))).map(i=>this.fileService.del(i.resource,{recursive:!0})))}}async cleanUpTransientProfiles(){const t=this.transientProfilesObject.profiles.filter(i=>!this.isProfileAssociatedToWorkspace(i));await Promise.allSettled(t.map(i=>this.removeProfile(i)))}getProfileForWorkspace(t){const i=this.getWorkspace(t);return y.isUri(i)?this.profiles.find(r=>r.workspaces?.some(n=>this.uriIdentityService.extUri.isEqual(n,i))):this.profilesObject.emptyWindows.get(i)??this.transientProfilesObject.emptyWindows.get(i)}getWorkspace(t){return E8(t)?t.uri:C8(t)?t.configPath:t.id}isProfileAssociatedToWorkspace(t){return!!(t.workspaces?.length||[...this.profilesObject.emptyWindows.values()].some(i=>this.uriIdentityService.extUri.isEqual(i.location,t.location))||[...this.transientProfilesObject.emptyWindows.values()].some(i=>this.uriIdentityService.extUri.isEqual(i.location,t.location)))}updateProfiles(t,i,r){const n=[...this.profiles,...t],s=this.transientProfilesObject.profiles;this.transientProfilesObject.profiles=[];const o=[];for(let a of n){if(i.some(l=>a.id===l.id)){for(const l of[...this.profilesObject.emptyWindows.keys()])a.id===this.profilesObject.emptyWindows.get(l)?.id&&this.profilesObject.emptyWindows.delete(l);continue}if(!a.isDefault){a=r.find(c=>a.id===c.id)??a;const l=s.find(c=>a.id===c.id);if(a.isTransient)this.transientProfilesObject.profiles.push(a);else if(l){for(const[c,u]of this.transientProfilesObject.emptyWindows.entries())if(a.id===u.id){this.transientProfilesObject.emptyWindows.delete(c),this.profilesObject.emptyWindows.set(c,a);break}}}a.workspaces?.length===0&&(a.workspaces=void 0),o.push(a)}this.updateStoredProfiles(o),this.triggerProfilesChanges(t,i,r)}triggerProfilesChanges(t,i,r){this._onDidChangeProfiles.fire({added:t,removed:i,updated:r,all:this.profiles})}updateEmptyWindowAssociation(t,i,r){r=i?.isTransient?!0:r,r?i?this.transientProfilesObject.emptyWindows.set(t,i):this.transientProfilesObject.emptyWindows.delete(t):(this.transientProfilesObject.emptyWindows.delete(t),i?this.profilesObject.emptyWindows.set(t,i):this.profilesObject.emptyWindows.delete(t))}updateStoredProfiles(t){const i=[],r={},n={};for(const s of t)if(!s.isTransient&&(s.isDefault||i.push({location:s.location,name:s.name,icon:s.icon,useDefaultFlags:s.useDefaultFlags}),s.workspaces))for(const o of s.workspaces)r[o.toString()]=s.id;for(const[s,o]of this.profilesObject.emptyWindows.entries())n[s.toString()]=o.id;this.saveStoredProfileAssociations({workspaces:r,emptyWindows:n}),this.saveStoredProfiles(i),this._profilesObject=void 0}getStoredProfiles(){return[]}saveStoredProfiles(t){throw new Error("not implemented")}getStoredProfileAssociations(){return{}}saveStoredProfileAssociations(t){throw new Error("not implemented")}getDefaultProfileExtensionsLocation(){}};jE=__decorate([__param(0,Wm),__param(1,kS),__param(2,zE),__param(3,qe)],jE);var dR="__$__isNewStorageMarker",Fd="__$__targetStorageMarker",hR=U("storageService"),Go;(function(e){e[e.NONE=0]="NONE",e[e.SHUTDOWN=1]="SHUTDOWN"})(Go||(Go={}));var GE;(function(e){e[e.APPLICATION=-1]="APPLICATION",e[e.PROFILE=0]="PROFILE",e[e.WORKSPACE=1]="WORKSPACE"})(GE||(GE={}));var QE;(function(e){e[e.USER=0]="USER",e[e.MACHINE=1]="MACHINE"})(QE||(QE={}));function fR(e){const t=e.get(Fd);if(t)try{return JSON.parse(t)}catch{}return Object.create(null)}var CB=class B6 extends se{static{this.DEFAULT_FLUSH_INTERVAL=60*1e3}constructor(t={flushInterval:B6.DEFAULT_FLUSH_INTERVAL}){super(),this._onDidChangeValue=this._register(new Mu),this._onDidChangeTarget=this._register(new Mu),this.onDidChangeTarget=this._onDidChangeTarget.event,this._onWillSaveState=this._register(new P),this.onWillSaveState=this._onWillSaveState.event,this.runFlushWhenIdle=this._register(new Cn),this._workspaceKeyTargets=void 0,this._profileKeyTargets=void 0,this._applicationKeyTargets=void 0,this.flushWhenIdleScheduler=this._register(new Ao(()=>this.doFlushWhenIdle(),t.flushInterval))}onDidChangeValue(t,i,r){return ct.filter(this._onDidChangeValue.event,n=>n.scope===t&&(i===void 0||n.key===i),r)}doFlushWhenIdle(){this.runFlushWhenIdle.value=Tb(()=>{this.shouldFlushWhenIdle()&&this.flush(),this.flushWhenIdleScheduler.schedule()})}shouldFlushWhenIdle(){return!0}stopFlushWhenIdle(){zr([this.runFlushWhenIdle,this.flushWhenIdleScheduler])}initialize(){return this.initializationPromise||(this.initializationPromise=(async()=>{di("code/willInitStorage");try{await this.doInitialize()}finally{di("code/didInitStorage")}this.flushWhenIdleScheduler.schedule()})()),this.initializationPromise}emitDidChangeValue(t,i){const{key:r,external:n}=i;if(r===Fd){switch(t){case-1:this._applicationKeyTargets=void 0;break;case 0:this._profileKeyTargets=void 0;break;case 1:this._workspaceKeyTargets=void 0;break}this._onDidChangeTarget.fire({scope:t})}else this._onDidChangeValue.fire({scope:t,key:r,target:this.getKeyTargets(t)[r],external:n})}emitWillSaveState(t){this._onWillSaveState.fire({reason:t})}get(t,i,r){return this.getStorage(i)?.get(t,r)}getBoolean(t,i,r){return this.getStorage(i)?.getBoolean(t,r)}getNumber(t,i,r){return this.getStorage(i)?.getNumber(t,r)}getObject(t,i,r){return this.getStorage(i)?.getObject(t,r)}storeAll(t,i){this.withPausedEmitters(()=>{for(const r of t)this.store(r.key,r.value,r.scope,r.target,i)})}store(t,i,r,n,s=!1){if(Et(i)){this.remove(t,r,s);return}this.withPausedEmitters(()=>{this.updateKeyTarget(t,r,n),this.getStorage(r)?.set(t,i,s)})}remove(t,i,r=!1){this.withPausedEmitters(()=>{this.updateKeyTarget(t,i,void 0),this.getStorage(i)?.delete(t,r)})}withPausedEmitters(t){this._onDidChangeValue.pause(),this._onDidChangeTarget.pause();try{t()}finally{this._onDidChangeValue.resume(),this._onDidChangeTarget.resume()}}keys(t,i){const r=[],n=this.getKeyTargets(t);for(const s of Object.keys(n))n[s]===i&&r.push(s);return r}updateKeyTarget(t,i,r,n=!1){const s=this.getKeyTargets(i);typeof r=="number"?s[t]!==r&&(s[t]=r,this.getStorage(i)?.set(Fd,JSON.stringify(s),n)):typeof s[t]=="number"&&(delete s[t],this.getStorage(i)?.set(Fd,JSON.stringify(s),n))}get workspaceKeyTargets(){return this._workspaceKeyTargets||(this._workspaceKeyTargets=this.loadKeyTargets(1)),this._workspaceKeyTargets}get profileKeyTargets(){return this._profileKeyTargets||(this._profileKeyTargets=this.loadKeyTargets(0)),this._profileKeyTargets}get applicationKeyTargets(){return this._applicationKeyTargets||(this._applicationKeyTargets=this.loadKeyTargets(-1)),this._applicationKeyTargets}getKeyTargets(t){switch(t){case-1:return this.applicationKeyTargets;case 0:return this.profileKeyTargets;default:return this.workspaceKeyTargets}}loadKeyTargets(t){const i=this.getStorage(t);return i?fR(i):Object.create(null)}isNew(t){return this.getBoolean(dR,t)===!0}async flush(t=Go.NONE){this._onWillSaveState.fire({reason:t});const i=this.getStorage(-1),r=this.getStorage(0),n=this.getStorage(1);switch(t){case Go.NONE:await Ro.settled([i?.whenFlushed()??Promise.resolve(),r?.whenFlushed()??Promise.resolve(),n?.whenFlushed()??Promise.resolve()]);break;case Go.SHUTDOWN:await Ro.settled([i?.flush(0)??Promise.resolve(),r?.flush(0)??Promise.resolve(),n?.flush(0)??Promise.resolve()]);break}}async log(){const t=this.getStorage(-1)?.items??new Map,i=this.getStorage(0)?.items??new Map,r=this.getStorage(1)?.items??new Map;return pR(t,i,r,this.getLogDetails(-1)??"",this.getLogDetails(0)??"",this.getLogDetails(1)??"")}async optimize(t){return await this.flush(),this.getStorage(t)?.optimize()}async switch(t,i){return this.emitWillSaveState(Go.NONE),cR(t)?this.switchToProfile(t,i):this.switchToWorkspace(t,i)}canSwitchProfile(t,i){return!(t.id===i.id||JE(i)&&JE(t))}switchData(t,i,r){this.withPausedEmitters(()=>{const n=new Set;for(const[s,o]of t)n.add(s),i.get(s)!==o&&this.emitDidChangeValue(r,{key:s,external:!0});for(const[s]of i.items)n.has(s)||this.emitDidChangeValue(r,{key:s,external:!0})})}};function JE(e){return e.isDefault||!!e.useDefaultFlags?.globalState}async function pR(e,t,i,r,n,s){const o=_=>{try{return JSON.parse(_)}catch{return _}},a=new Map,l=new Map;e.forEach((_,b)=>{a.set(b,_),l.set(b,o(_))});const c=new Map,u=new Map;t.forEach((_,b)=>{c.set(b,_),u.set(b,o(_))});const d=new Map,f=new Map;i.forEach((_,b)=>{d.set(b,_),f.set(b,o(_))}),console.group(r!==n?`Storage: Application (path: ${r})`:`Storage: Application & Profile (path: ${r}, default profile)`);const p=[];if(a.forEach((_,b)=>{p.push({key:b,value:_})}),console.table(p),console.groupEnd(),console.log(l),r!==n){console.group(`Storage: Profile (path: ${n}, profile specific)`);const _=[];c.forEach((b,E)=>{_.push({key:E,value:b})}),console.table(_),console.groupEnd(),console.log(u)}console.group(`Storage: Workspace (path: ${s})`);const m=[];d.forEach((_,b)=>{m.push({key:b,value:_})}),console.table(m),console.groupEnd(),console.log(f)}var DB=new I("isMac",Hi,h(1825,null)),IB=new I("isLinux",Gr,h(1826,null)),kB=new I("isWindows",oi,h(1827,null)),gR=new I("isWeb",Co,h(1828,null)),PB=new I("isMacNative",Hi&&!Co,h(1829,null)),TB=new I("isIOS",uP,h(1830,null)),AB=new I("isMobile",dP,h(1831,null)),RB=new I("isDevelopment",!1,!0),LB=new I("productQualityType","",h(1832,null)),mR="inputFocus",NB=new I(mR,!1,h(1833,null)),vR=U("languageService"),_R=U("modelService"),cr,MB=new I("workbenchState",void 0,{type:"string",description:h(4255,null)}),OB=new I("workspaceFolderCount",0,h(4256,null)),FB=new I("openFolderWorkspaceSupport",!0,!0),$B=new I("enterMultiRootWorkspaceSupport",!0,!0),HB=new I("emptyWorkspaceSupport",!0,!0),UB=new I("dirtyWorkingCopies",!1,h(4257,null)),wR=new I("remoteName","",h(4258,null)),BB=new I("virtualWorkspace","",h(4259,null)),WB=new I("temporaryWorkspace",!1,h(4260,null)),VB=new I("isFullscreen",!1,h(4261,null)),zB=new I("isAuxiliaryWindowFocusedContext",!1,h(4262,null)),qB=new I("isWindowAlwaysOnTop",!1,h(4263,null)),jB=new I("hasWebFileSystemAccess",!1,!0),GB=new I("embedderIdentifier",void 0,h(4264,null)),QB=new I("activeEditorIsDirty",!1,h(4265,null)),JB=new I("activeEditorIsNotPreview",!1,h(4266,null)),XB=new I("activeEditorIsFirstInGroup",!1,h(4267,null)),ZB=new I("activeEditorIsLastInGroup",!1,h(4268,null)),KB=new I("activeEditorIsPinned",!1,h(4269,null)),YB=new I("activeEditorIsReadonly",!1,h(4270,null)),eW=new I("activeCompareEditorCanSwap",!1,h(4271,null)),tW=new I("activeEditorCanToggleReadonly",!0,h(4272,null)),iW=new I("activeEditorCanRevert",!1,h(4273,null)),rW=new I("activeEditorCanSplitInGroup",!0),nW=new I("activeEditor",null,{type:"string",description:h(4274,null)}),sW=new I("activeEditorAvailableEditorIds","",h(4275,null)),oW=new I("textCompareEditorVisible",!1,h(4276,null)),aW=new I("textCompareEditorActive",!1,h(4277,null)),lW=new I("sideBySideEditorActive",!1,h(4278,null)),cW=new I("groupEditorsCount",0,h(4279,null)),uW=new I("activeEditorGroupEmpty",!1,h(4280,null)),dW=new I("activeEditorGroupIndex",0,h(4281,null)),hW=new I("activeEditorGroupLast",!1,h(4282,null)),fW=new I("activeEditorGroupLocked",!1,h(4283,null)),yR=new I("multipleEditorGroups",!1,h(4284,null)),pW=yR.toNegated(),gW=new I("multipleEditorsSelectedInGroup",!1,h(4285,null)),mW=new I("twoEditorsSelectedInGroup",!1,h(4286,null)),vW=new I("SelectedEditorsInGroupFileOrUntitledResourceContextKey",!0,h(4287,null)),bR=new I("editorPartMultipleEditorGroups",!1,h(4288,null)),_W=bR.toNegated(),wW=new I("editorPartMaximizedEditorGroup",!1,h(4289,null)),yW=new I("isAuxiliaryEditorPart",!1,h(4290,null)),bW=new I("editorIsOpen",!1,h(4291,null)),xW=new I("inZenMode",!1,h(4292,null)),SW=new I("isCenteredLayout",!1,h(4293,null)),EW=new I("splitEditorsVertically",!1,h(4294,null)),CW=new I("mainEditorAreaVisible",!0,h(4295,null)),DW=new I("editorTabsVisible",!0,h(4296,null)),IW=new I("sideBarVisible",!1,h(4297,null)),kW=new I("sideBarFocus",!1,h(4298,null)),PW=new I("activeViewlet","",h(4299,null)),TW=new I("statusBarFocused",!1,h(4300,null)),AW=new I("titleBarStyle","custom",h(4301,null)),RW=new I("titleBarVisible",!1,h(4302,null)),LW=new I("isAuxiliaryTitleBar",!1,h(4303,null)),NW=new I("isCompactTitleBar",!1,h(4304,null)),MW=new I("bannerFocused",!1,h(4305,null)),OW=new I("notificationFocus",!0,h(4306,null)),FW=new I("notificationCenterVisible",!1,h(4307,null)),$W=new I("notificationToastsVisible",!1,h(4308,null)),HW=new I("activeAuxiliary","",h(4309,null)),UW=new I("auxiliaryBarFocus",!1,h(4310,null)),BW=new I("auxiliaryBarVisible",!1,h(4311,null)),WW=new I("activePanel","",h(4312,null)),VW=new I("panelFocus",!1,h(4313,null)),zW=new I("panelPosition","bottom",h(4314,null)),qW=new I("panelAlignment","center",h(4315,null)),jW=new I("panelVisible",!1,h(4316,null)),GW=new I("panelMaximized",!1,h(4317,null)),QW=new I("focusedView","",h(4318,null)),XE=class{static{cr=this}static{this.Scheme=new I("resourceScheme",void 0,{type:"string",description:h(4319,null)})}static{this.Filename=new I("resourceFilename",void 0,{type:"string",description:h(4320,null)})}static{this.Dirname=new I("resourceDirname",void 0,{type:"string",description:h(4321,null)})}static{this.Path=new I("resourcePath",void 0,{type:"string",description:h(4322,null)})}static{this.LangId=new I("resourceLangId",void 0,{type:"string",description:h(4323,null)})}static{this.Resource=new I("resource",void 0,{type:"URI",description:h(4324,null)})}static{this.Extension=new I("resourceExtname",void 0,{type:"string",description:h(4325,null)})}static{this.HasResource=new I("resourceSet",void 0,{type:"boolean",description:h(4326,null)})}static{this.IsFileSystemResource=new I("isFileSystemResource",void 0,{type:"boolean",description:h(4327,null)})}constructor(t,i,r,n){this._contextKeyService=t,this._fileService=i,this._languageService=r,this._modelService=n,this._disposables=new he,this._schemeKey=cr.Scheme.bindTo(this._contextKeyService),this._filenameKey=cr.Filename.bindTo(this._contextKeyService),this._dirnameKey=cr.Dirname.bindTo(this._contextKeyService),this._pathKey=cr.Path.bindTo(this._contextKeyService),this._langIdKey=cr.LangId.bindTo(this._contextKeyService),this._resourceKey=cr.Resource.bindTo(this._contextKeyService),this._extensionKey=cr.Extension.bindTo(this._contextKeyService),this._hasResource=cr.HasResource.bindTo(this._contextKeyService),this._isFileSystemResource=cr.IsFileSystemResource.bindTo(this._contextKeyService),this._disposables.add(i.onDidChangeFileSystemProviderRegistrations(()=>{const s=this.get();this._isFileSystemResource.set(!!(s&&i.hasProvider(s)))})),this._disposables.add(n.onModelAdded(s=>{ms(s.uri,this.get())&&this._setLangId()})),this._disposables.add(n.onModelLanguageChanged(s=>{ms(s.model.uri,this.get())&&this._setLangId()}))}dispose(){this._disposables.dispose()}_setLangId(){const t=this.get();if(!t){this._langIdKey.set(null);return}const i=this._modelService.getModel(t)?.getLanguageId()??this._languageService.guessLanguageIdByFilepathOrFirstLine(t);this._langIdKey.set(i)}set(t){t=t??void 0,!ms(this._value,t)&&(this._value=t,this._contextKeyService.bufferChangeEvents(()=>{this._resourceKey.set(t?t.toString():null),this._schemeKey.set(t?t.scheme:null),this._filenameKey.set(t?nr(t):null),this._dirnameKey.set(t?this.uriToPath(Zu(t)):null),this._pathKey.set(t?this.uriToPath(t):null),this._setLangId(),this._extensionKey.set(t?vT(t):null),this._hasResource.set(!!t),this._isFileSystemResource.set(t?this._fileService.hasProvider(t):!1)}))}uriToPath(t){return t.scheme===V.file?t.fsPath:t.path}reset(){this._value=void 0,this._contextKeyService.bufferChangeEvents(()=>{this._resourceKey.reset(),this._schemeKey.reset(),this._filenameKey.reset(),this._dirnameKey.reset(),this._pathKey.reset(),this._langIdKey.reset(),this._extensionKey.reset(),this._hasResource.reset(),this._isFileSystemResource.reset()})}get(){return this._value}};XE=cr=__decorate([__param(0,Jg),__param(1,kS),__param(2,vR),__param(3,_R)],XE);var ZE;(function(e){e.UseFileStorage="chat.useFileStorage",e.AgentEnabled="chat.agent.enabled",e.Edits2Enabled="chat.edits2.enabled",e.ExtensionToolsEnabled="chat.extensionTools.enabled"})(ZE||(ZE={}));var Tr;(function(e){e.Ask="ask",e.Edit="edit",e.Agent="agent"})(Tr||(Tr={}));var ii;(function(e){e.Panel="panel",e.Terminal="terminal",e.Notebook="notebook",e.Editor="editor"})(ii||(ii={})),function(e){function t(i){switch(i){case"panel":return e.Panel;case"terminal":return e.Terminal;case"notebook":return e.Notebook;case"editor":return e.Editor}return e.Panel}e.fromRaw=t}(ii||(ii={}));var On;(function(e){e.responseVote=new I("chatSessionResponseVote","",{type:"string",description:h(5546,null)}),e.responseDetectedAgentCommand=new I("chatSessionResponseDetectedAgentOrCommand",!1,{type:"boolean",description:h(5547,null)}),e.responseSupportsIssueReporting=new I("chatResponseSupportsIssueReporting",!1,{type:"boolean",description:h(5548,null)}),e.responseIsFiltered=new I("chatSessionResponseFiltered",!1,{type:"boolean",description:h(5549,null)}),e.responseHasError=new I("chatSessionResponseError",!1,{type:"boolean",description:h(5550,null)}),e.requestInProgress=new I("chatSessionRequestInProgress",!1,{type:"boolean",description:h(5551,null)}),e.isRequestPaused=new I("chatRequestIsPaused",!1,{type:"boolean",description:h(5552,null)}),e.canRequestBePaused=new I("chatCanRequestBePaused",!1,{type:"boolean",description:h(5553,null)}),e.isResponse=new I("chatResponse",!1,{type:"boolean",description:h(5554,null)}),e.isRequest=new I("chatRequest",!1,{type:"boolean",description:h(5555,null)}),e.itemId=new I("chatItemId","",{type:"string",description:h(5556,null)}),e.lastItemId=new I("chatLastItemId",[],{type:"string",description:h(5557,null)}),e.editApplied=new I("chatEditApplied",!1,{type:"boolean",description:h(5558,null)}),e.inputHasText=new I("chatInputHasText",!1,{type:"boolean",description:h(5559,null)}),e.inputHasFocus=new I("chatInputHasFocus",!1,{type:"boolean",description:h(5560,null)}),e.inChatInput=new I("inChatInput",!1,{type:"boolean",description:h(5561,null)}),e.inChatSession=new I("inChat",!1,{type:"boolean",description:h(5562,null)}),e.hasPromptFile=new I("chatPromptFileAttached",!1,{type:"boolean",description:h(5563,null)}),e.chatMode=new I("chatMode",Tr.Ask,{type:"string",description:h(5564,null)}),e.supported=It.or(gR.negate(),wR.notEqualsTo("")),e.enabled=new I("chatIsEnabled",!1,{type:"boolean",description:h(5565,null)}),e.extensionParticipantRegistered=new I("chatPanelExtensionParticipantRegistered",!1,{type:"boolean",description:h(5566,null)}),e.panelParticipantRegistered=new I("chatPanelParticipantRegistered",!1,{type:"boolean",description:h(5567,null)}),e.editingParticipantRegistered=new I("chatEditingParticipantRegistered",!1,{type:"boolean",description:h(5568,null)}),e.chatEditingCanUndo=new I("chatEditingCanUndo",!1,{type:"boolean",description:h(5569,null)}),e.chatEditingCanRedo=new I("chatEditingCanRedo",!1,{type:"boolean",description:h(5570,null)}),e.extensionInvalid=new I("chatExtensionInvalid",!1,{type:"boolean",description:h(5571,null)}),e.inputCursorAtTop=new I("chatCursorAtTop",!1),e.inputHasAgent=new I("chatInputHasAgent",!1),e.location=new I("chatLocation",void 0),e.inQuickChat=new I("quickChatHasFocus",!1,{type:"boolean",description:h(5572,null)}),e.hasFileAttachments=new I("chatHasFileAttachments",!1,{type:"boolean",description:h(5573,null)}),e.languageModelsAreUserSelectable=new I("chatModelsAreUserSelectable",!1,{type:"boolean",description:h(5574,null)}),e.Setup={hidden:new I("chatSetupHidden",!1,!0),installed:new I("chatSetupInstalled",!1,!0),disabled:new I("chatSetupDisabled",!1,!0)},e.Entitlement={signedOut:new I("chatSetupSignedOut",!1,!0),canSignUp:new I("chatPlanCanSignUp",!1,!0),limited:new I("chatPlanLimited",!1,!0),pro:new I("chatPlanPro",!1,!0),proPlus:new I("chatPlanProPlus",!1,!0),business:new I("chatPlanBusiness",!1,!0),enterprise:new I("chatPlanEnterprise",!1,!0)},e.chatQuotaExceeded=new I("chatQuotaExceeded",!1,!0),e.completionsQuotaExceeded=new I("completionsQuotaExceeded",!1,!0),e.Editing={agentModeDisallowed:new I("chatAgentModeDisallowed",void 0,{type:"boolean",description:h(5575,null)}),hasToolConfirmation:new I("chatHasToolConfirmation",!1,{type:"boolean",description:h(5576,null)})},e.Tools={toolsCount:new I("toolsCount",0,{type:"number",description:h(5577,null)})}})(On||(On={}));var KE;(function(e){e.inEditingMode=It.or(On.chatMode.isEqualTo(Tr.Edit),On.chatMode.isEqualTo(Tr.Agent))})(KE||(KE={}));var Fl,xR=U("chatAgentService"),YE=class extends se{static{this.AGENT_LEADER="@"}constructor(t){super(),this.contextKeyService=t,this._agents=new Map,this._onDidChangeAgents=new P,this.onDidChangeAgents=this._onDidChangeAgents.event,this._agentsContextKeys=new Set,this._hasToolsAgent=!1,this._chatParticipantDetectionProviders=new Map,this._agentCompletionProviders=new Map,this._hasDefaultAgent=On.enabled.bindTo(this.contextKeyService),this._extensionAgentRegistered=On.extensionParticipantRegistered.bindTo(this.contextKeyService),this._defaultAgentRegistered=On.panelParticipantRegistered.bindTo(this.contextKeyService),this._editingAgentRegistered=On.editingParticipantRegistered.bindTo(this.contextKeyService),this._register(t.onDidChangeContext(i=>{i.affectsSome(this._agentsContextKeys)&&this._updateContextKeys()}))}registerAgent(t,i){if(this.getAgent(t))throw new Error(`Agent already registered: ${JSON.stringify(t)}`);const n=this,s=i.slashCommands;i={...i,get slashCommands(){return s.filter(a=>!a.when||n.contextKeyService.contextMatchesRules(It.deserialize(a.when)))}};const o={data:i};return this._agents.set(t,o),this._updateAgentsContextKeys(),this._updateContextKeys(),this._onDidChangeAgents.fire(void 0),ne(()=>{this._agents.delete(t),this._updateAgentsContextKeys(),this._updateContextKeys(),this._onDidChangeAgents.fire(void 0)})}_updateAgentsContextKeys(){this._agentsContextKeys.clear();for(const t of this._agents.values())if(t.data.when){const i=It.deserialize(t.data.when);for(const r of i?.keys()||[])this._agentsContextKeys.add(r)}}_updateContextKeys(){let t=!1,i=!1,r=!1,n=!1;for(const s of this.getAgents())s.isDefault&&(s.isCore||(i=!0),s.modes.includes(Tr.Agent)?n=!0:s.modes.includes(Tr.Edit)?t=!0:r=!0);this._editingAgentRegistered.set(t),this._defaultAgentRegistered.set(r),this._extensionAgentRegistered.set(i),n!==this._hasToolsAgent&&(this._hasToolsAgent=n,this._onDidChangeAgents.fire(this.getDefaultAgent(ii.Panel,Tr.Agent)))}registerAgentImplementation(t,i){const r=this._agents.get(t);if(!r)throw new Error(`Unknown agent: ${JSON.stringify(t)}`);if(r.impl)throw new Error(`Agent already has implementation: ${JSON.stringify(t)}`);return r.data.isDefault&&this._hasDefaultAgent.set(!0),r.impl=i,this._onDidChangeAgents.fire(new $d(r.data,i)),ne(()=>{r.impl=void 0,this._onDidChangeAgents.fire(void 0),r.data.isDefault&&this._hasDefaultAgent.set(!1)})}registerDynamicAgent(t,i){t.isDynamic=!0;const r={data:t,impl:i};return this._agents.set(t.id,r),this._onDidChangeAgents.fire(new $d(t,i)),ne(()=>{this._agents.delete(t.id),this._onDidChangeAgents.fire(void 0)})}registerAgentCompletionProvider(t,i){return this._agentCompletionProviders.set(t,i),{dispose:()=>{this._agentCompletionProviders.delete(t)}}}async getAgentCompletionItems(t,i,r){return await this._agentCompletionProviders.get(t)?.(i,r)??[]}updateAgent(t,i){const r=this._agents.get(t);if(!r?.impl)throw new Error(`No activated agent with id ${JSON.stringify(t)} registered`);r.data.metadata={...r.data.metadata,...i},this._onDidChangeAgents.fire(new $d(r.data,r.impl))}getDefaultAgent(t,i=Tr.Ask){return this._preferExtensionAgent(this.getActivatedAgents().filter(r=>i&&!r.modes.includes(i)?!1:!!r.isDefault&&r.locations.includes(t)))}get hasToolsAgent(){return!!this._hasToolsAgent}getContributedDefaultAgent(t){return this._preferExtensionAgent(this.getAgents().filter(i=>!!i.isDefault&&i.locations.includes(t)))}_preferExtensionAgent(t){return i9(t,i=>!i.isCore)??t.at(-1)}getAgent(t,i=!1){if(!(!this._agentIsEnabled(t)&&!i))return this._agents.get(t)?.data}_agentIsEnabled(t){const i=typeof t=="string"?this._agents.get(t):t;return!i?.data.when||this.contextKeyService.contextMatchesRules(It.deserialize(i.data.when))}getAgentByFullyQualifiedId(t){const i=Jt.find(this._agents.values(),r=>SR(r.data)===t)?.data;if(!(i&&!this._agentIsEnabled(i.id)))return i}getAgents(){return Array.from(this._agents.values()).map(t=>t.data).filter(t=>this._agentIsEnabled(t.id))}getActivatedAgents(){return Array.from(this._agents.values()).filter(t=>!!t.impl).filter(t=>this._agentIsEnabled(t.data.id)).map(t=>new $d(t.data,t.impl))}getAgentsByName(t){return this._preferExtensionAgents(this.getAgents().filter(i=>i.name===t))}_preferExtensionAgents(t){const i=t.filter(r=>!r.isCore);return i.length>0?i:t}agentHasDupeName(t){const i=this.getAgent(t);return i?this.getAgentsByName(i.name).filter(r=>r.extensionId.value!==i.extensionId.value).length>0:!1}async invokeAgent(t,i,r,n,s){const o=this._agents.get(t);if(!o?.impl)throw new Error(`No activated agent with id "${t}"`);return await o.impl.invoke(i,r,n,s)}setRequestPaused(t,i,r){const n=this._agents.get(t);if(!n?.impl)throw new Error(`No activated agent with id "${t}"`);n.impl.setRequestPaused?.(i,r)}async getFollowups(t,i,r,n,s){const o=this._agents.get(t);return o?.impl?.provideFollowups?o.impl.provideFollowups(i,r,n,s):[]}async getChatTitle(t,i,r){const n=this._agents.get(t);if(!n?.impl)throw new Error(`No activated agent with id "${t}"`);if(n.impl?.provideChatTitle)return n.impl.provideChatTitle(i,r)}registerChatParticipantDetectionProvider(t,i){return this._chatParticipantDetectionProviders.set(t,i),ne(()=>{this._chatParticipantDetectionProviders.delete(t)})}hasChatParticipantDetectionProviders(){return this._chatParticipantDetectionProviders.size>0}async detectAgentOrCommand(t,i,r,n){const s=Jt.first(this._chatParticipantDetectionProviders.values());if(!s)return;const o=this.getAgents().reduce((u,d)=>{if(d.locations.includes(r.location)){u.push({participant:d.id,disambiguation:d.disambiguation??[]});for(const f of d.slashCommands)u.push({participant:d.id,command:f.name,disambiguation:f.disambiguation??[]})}return u},[]),a=await s.provideParticipantDetection(t,i,{...r,participants:o},n);if(!a)return;const l=this.getAgent(a.participant);if(!l)return;if(!a.command)return{agent:l};const c=l?.slashCommands.find(u=>u.name===a.command);if(c)return{agent:l,command:c}}};YE=__decorate([__param(0,Jg)],YE);var $d=class{constructor(e,t){this.data=e,this.impl=t}get id(){return this.data.id}get name(){return this.data.name??""}get fullName(){return this.data.fullName??""}get description(){return this.data.description??""}get extensionId(){return this.data.extensionId}get extensionPublisherId(){return this.data.extensionPublisherId}get extensionPublisherDisplayName(){return this.data.publisherDisplayName}get extensionDisplayName(){return this.data.extensionDisplayName}get isDefault(){return this.data.isDefault}get isCore(){return this.data.isCore}get metadata(){return this.data.metadata}get slashCommands(){return this.data.slashCommands}get locations(){return this.data.locations}get modes(){return this.data.modes}get disambiguation(){return this.data.disambiguation}async invoke(e,t,i,r){return this.impl.invoke(e,t,i,r)}setRequestPaused(e,t){this.impl.setRequestPaused&&this.impl.setRequestPaused(e,t)}async provideFollowups(e,t,i,r){return this.impl.provideFollowups?this.impl.provideFollowups(e,t,i,r):[]}provideSampleQuestions(e,t){if(this.impl.provideSampleQuestions)return this.impl.provideSampleQuestions(e,t)}toJSON(){return this.data}},ZW=U("chatAgentNameService"),eC=class{static{Fl=this}static{this.StorageKey="chat.participantNameRegistry"}constructor(t,i,r,n){if(this.requestService=i,this.logService=r,this.storageService=n,this.registry=Pm(this,Object.create(null)),this.disposed=!1,!t.chatParticipantRegistry)return;this.url=t.chatParticipantRegistry;const s=n.get(Fl.StorageKey,-1);try{this.registry.set(JSON.parse(s??"{}"),void 0)}catch{n.remove(Fl.StorageKey,-1)}this.refresh()}refresh(){this.disposed||this.update().catch(t=>this.logService.warn("Failed to fetch chat participant registry",t)).then(()=>sr(5*60*1e3)).then(()=>this.refresh())}async update(){const t=await this.requestService.request({type:"GET",url:this.url},Xe.None);if(t.res.statusCode!==200)throw new Error("Could not get extensions report.");const i=await aR(t);if(!i||i.version!==1)throw new Error("Unexpected chat participant registry response.");const r=i.restrictedChatParticipants;this.registry.set(r,void 0),this.storageService.store(Fl.StorageKey,JSON.stringify(r),-1,1)}getAgentNameRestriction(t){if(t.isCore)return!0;const i=this.checkAgentNameRestriction(t.name,t).get(),r=!t.fullName||this.checkAgentNameRestriction(t.fullName.replace(/\s/g,""),t).get();return i&&r}checkAgentNameRestriction(t,i){return this.registry.map(n=>n[t.toLowerCase()]).map(n=>n?n.some(s=>Pn(s,s.includes(".")?i.extensionId.value:i.extensionPublisherId)):!0)}dispose(){this.disposed=!0}};eC=Fl=__decorate([__param(0,G3),__param(1,nR),__param(2,qe),__param(3,hR)],eC);function SR(e){return`${e.extensionId.value}.${e.id}`}function tC(e){const t="name"in e?e:{...e,name:e.id};return"extensionPublisherId"in t||(t.extensionPublisherId=t.extensionPublisher??""),"extensionDisplayName"in t||(t.extensionDisplayName=""),"extensionId"in t||(t.extensionId=new Oe("")),Pt(t)}var ER=U("chatEditingService"),iC;(function(e){e[e.Modified=0]="Modified",e[e.Accepted=1]="Accepted",e[e.Rejected=2]="Rejected"})(iC||(iC={}));var rC;(function(e){e[e.Initial=0]="Initial",e[e.StreamingEdits=1]="StreamingEdits",e[e.Idle=2]="Idle",e[e.Disposed=3]="Disposed"})(rC||(rC={}));var YW=new I("chatEditingWidgetFileState",void 0,h(5578,null)),eV=new I("chatEditingAgentSupportsReadonlyReferences",void 0,h(5579,null)),tV=new I("decidedChatEditingResource",[]),iV=new I("chatEditingResource",void 0),rV=new I("inChatEditingSession",void 0),nV=new I("hasUndecidedChatEditingResource",!1),sV=new I("hasAppliedChatEdits",!1),oV=new I("applyingChatEditsFailed",!1),nC;(function(e){e[e.Created=0]="Created",e[e.Modified=1]="Modified"})(nC||(nC={}));var Vm=class W6{static{this.Kind="text"}constructor(t,i,r){this.range=t,this.editorRange=i,this.text=r,this.kind=W6.Kind}get promptText(){return this.text}},zm="#",CR="@",$l="/",sC=class V6{static{this.Kind="var"}constructor(t,i,r,n,s){this.range=t,this.editorRange=i,this.variableName=r,this.variableArg=n,this.variableId=s,this.kind=V6.Kind}get text(){const t=this.variableArg?`:${this.variableArg}`:"";return`${zm}${this.variableName}${t}`}get promptText(){return this.text}},oC=class z6{static{this.Kind="tool"}constructor(t,i,r,n,s,o){this.range=t,this.editorRange=i,this.toolName=r,this.toolId=n,this.displayName=s,this.icon=o,this.kind=z6.Kind}get text(){return`${zm}${this.toolName}`}get promptText(){return this.text}toVariableEntry(){return{kind:"tool",id:this.toolId,name:this.toolName,range:this.range,value:void 0,icon:kt.isThemeIcon(this.icon)?this.icon:void 0,fullName:this.displayName}}},aC=class q6{static{this.Kind="agent"}constructor(t,i,r){this.range=t,this.editorRange=i,this.agent=r,this.kind=q6.Kind}get text(){return`${CR}${this.agent.name}`}get promptText(){return""}},lC=class j6{static{this.Kind="subcommand"}constructor(t,i,r){this.range=t,this.editorRange=i,this.command=r,this.kind=j6.Kind}get text(){return`${$l}${this.command.name}`}get promptText(){return""}},cC=class G6{static{this.Kind="slash"}constructor(t,i,r){this.range=t,this.editorRange=i,this.slashCommand=r,this.kind=G6.Kind}get text(){return`${$l}${this.slashCommand.command}`}get promptText(){return`${$l}${this.slashCommand.command}`}},uC=class Q6{static{this.Kind="prompt"}constructor(t,i,r){this.range=t,this.editorRange=i,this.slashPromptCommand=r,this.kind=Q6.Kind}get text(){return`${$l}${this.slashPromptCommand.command}`}get promptText(){return`${$l}${this.slashPromptCommand.command}`}},dC=class J6{static{this.Kind="dynamic"}constructor(t,i,r,n,s,o,a,l,c,u){this.range=t,this.editorRange=i,this.text=r,this.id=n,this.modelDescription=s,this.data=o,this.fullName=a,this.icon=l,this.isFile=c,this.isDirectory=u,this.kind=J6.Kind}get referenceText(){return this.text.replace(zm,"")}get promptText(){return this.text}toVariableEntry(){return this.id==="vscode.problems"?jm.toEntry(this.data.filter):{kind:this.isDirectory?"directory":this.isFile?"file":"generic",id:this.id,name:this.referenceText,range:this.range,value:this.data,fullName:this.fullName,icon:this.icon}}};function DR(e){return{text:e.text,parts:e.parts.map(t=>{if(t.kind===Vm.Kind)return new Vm(new rn(t.range.start,t.range.endExclusive),t.editorRange,t.text);if(t.kind===sC.Kind)return new sC(new rn(t.range.start,t.range.endExclusive),t.editorRange,t.variableName,t.variableArg,t.variableId||"");if(t.kind===oC.Kind)return new oC(new rn(t.range.start,t.range.endExclusive),t.editorRange,t.toolName,t.toolId,t.displayName,t.icon);if(t.kind===aC.Kind){let i=t.agent;return i=tC(i),new aC(new rn(t.range.start,t.range.endExclusive),t.editorRange,i)}else{if(t.kind===lC.Kind)return new lC(new rn(t.range.start,t.range.endExclusive),t.editorRange,t.command);if(t.kind===cC.Kind)return new cC(new rn(t.range.start,t.range.endExclusive),t.editorRange,t.slashCommand);if(t.kind===uC.Kind)return new uC(new rn(t.range.start,t.range.endExclusive),t.editorRange,t.slashPromptCommand);if(t.kind===dC.Kind)return new dC(new rn(t.range.start,t.range.endExclusive),t.editorRange,t.text,t.id,t.modelDescription,Pt(t.data),t.fullName,t.icon,t.isFile,t.isDirectory);throw new Error(`Unknown chat request part: ${t.kind}`)}})}}var hC;(function(e){e[e.Info=0]="Info",e[e.Warning=1]="Warning",e[e.Error=2]="Error"})(hC||(hC={}));function IR(e){return!!e&&typeof e=="object"&&"uri"in e&&e.uri instanceof y&&"version"in e&&typeof e.version=="number"&&"ranges"in e&&Array.isArray(e.ranges)&&e.ranges.every(Fe.isIRange)}function kR(e){return!!e&&typeof e=="object"&&"documents"in e&&Array.isArray(e.documents)&&e.documents.every(IR)}var fC;(function(e){e[e.Complete=1]="Complete",e[e.Partial=2]="Partial",e[e.Omitted=3]="Omitted"})(fC||(fC={}));var Hd;(function(e){e[e.Down=0]="Down",e[e.Up=1]="Up"})(Hd||(Hd={}));var pC;(function(e){e.IncorrectCode="incorrectCode",e.DidNotFollowInstructions="didNotFollowInstructions",e.IncompleteCode="incompleteCode",e.MissingContext="missingContext",e.PoorlyWrittenOrFormatted="poorlyWrittenOrFormatted",e.RefusedAValidRequest="refusedAValidRequest",e.OffensiveOrUnsafe="offensiveOrUnsafe",e.Other="other",e.WillReportIssue="willReportIssue"})(pC||(pC={}));var gC;(function(e){e[e.Action=1]="Action",e[e.Toolbar=2]="Toolbar"})(gC||(gC={}));var PR=U("IChatService"),qm,mC;(function(e){e[e.NotOmitted=0]="NotOmitted",e[e.Partial=1]="Partial",e[e.Full=2]="Full"})(mC||(mC={}));var jm;(function(e){e.icon=re.error;function t(s){return{filterUri:s.resource,owner:s.owner,problemMessage:s.message,filterRange:{startLineNumber:s.startLineNumber,endLineNumber:s.endLineNumber,startColumn:s.startColumn,endColumn:s.endColumn}}}e.fromMarker=t;function i(s){return{id:r(s),name:n(s),icon:e.icon,value:s,kind:"diagnostic",...s}}e.toEntry=i;function r(s){return[s.filterUri,s.owner,s.filterSeverity,s.filterRange?.startLineNumber].join(":")}e.id=r;function n(s){let o;if(function(l){l[l.MaxChars=30]="MaxChars",l[l.MaxSpaceLookback=10]="MaxSpaceLookback"}(o||(o={})),s.problemMessage){if(s.problemMessage.length<30)return s.problemMessage;const l=s.problemMessage.lastIndexOf(" ",30);return l===-1||l+10<30?s.problemMessage.substring(0,30)+"\u2026":s.problemMessage.substring(0,l)+"\u2026"}let a=h(5589,null);return s.filterUri&&(a=h(5590,null,nr(s.filterUri))),a}e.label=n})(jm||(jm={}));function TR(e){return e.kind==="image"}var Ti={reason:"other"},vC=class{get session(){return this._session}get username(){return this.session.requesterUsername}get avatarIconUri(){return this.session.requesterAvatarIconUri}get attempt(){return this._attempt}get variableData(){return this._variableData}set variableData(e){this._variableData=e}get confirmation(){return this._confirmation}get locationData(){return this._locationData}get attachedContext(){return this._attachedContext}get editedFileEvents(){return this._editedFileEvents}constructor(e){this._session=e.session,this.message=e.message,this._variableData=e.variableData,this.timestamp=e.timestamp,this._attempt=e.attempt??0,this._confirmation=e.confirmation,this._locationData=e.locationData,this._attachedContext=e.attachedContext,this.isCompleteAddedRequest=e.isCompleteAddedRequest??!1,this.modelId=e.modelId,this.id=e.restoredId??"request_"+$t(),this._editedFileEvents=e.editedFileEvents}adoptTo(e){this._session=e}},_C=class{get value(){return this._responseParts}constructor(e){this._responseRepr="",this._markdownContent="",this._responseParts=e,this._updateRepr()}toString(){return this._responseRepr}getMarkdown(){return this._markdownContent}_updateRepr(){this._responseRepr=this.partsToRepr(this._responseParts),this._markdownContent=this._responseParts.map(e=>e.kind==="inlineReference"?this.inlineRefToRepr(e):e.kind==="markdownContent"||e.kind==="markdownVuln"?e.content.value:"").filter(e=>e.length>0).join("")}partsToRepr(e){const t=[];let i=[];for(const r of e){let n;switch(r.kind){case"treeData":case"progressMessage":case"codeblockUri":case"toolInvocation":case"toolInvocationSerialized":case"extensions":case"undoStop":continue;case"inlineReference":n={text:this.inlineRefToRepr(r)};break;case"command":n={text:r.command.title,isBlock:!0};break;case"textEditGroup":case"notebookEditGroup":n={text:h(5591,null),isBlock:!0};break;case"confirmation":n={text:`${r.title}
${r.message}`,isBlock:!0};break;default:n={text:r.content.value};break}n.isBlock?(i.length&&(t.push(i.join("")),i=[]),t.push(n.text)):i.push(n.text)}return i.length&&t.push(i.join("")),t.join(`

`)}inlineRefToRepr(e){return"uri"in e.inlineReference?this.uriToRepr(e.inlineReference.uri):"name"in e.inlineReference?"`"+e.inlineReference.name+"`":this.uriToRepr(e.inlineReference)}uriToRepr(e){return e.scheme===V.http||e.scheme===V.https?e.toString(!1):nr(e)}},AR=class extends _C{constructor(e,t){const i=e.value.findIndex(r=>r.kind==="undoStop"&&r.id===t);super(i===-1?e.value.slice():e.value.slice(0,i)),this.undoStop=t}},RR=class extends _C{get onDidChangeValue(){return this._onDidChangeValue.event}constructor(e){super(Fi(e).map(t=>Kr(t)?{content:t,kind:"markdownContent"}:"kind"in t?t:{kind:"treeData",treeData:t})),this._onDidChangeValue=new P,this._citations=[]}dispose(){this._onDidChangeValue.dispose()}clear(){this._responseParts=[],this._updateRepr(!0)}updateContent(e,t){if(e.kind==="markdownContent"){const i=this._responseParts.filter(r=>r.kind!=="textEditGroup").at(-1);if(!i||i.kind!=="markdownContent"||!MR(i.content,e.content))this._responseParts.push(e);else{const r=this._responseParts.indexOf(i);this._responseParts[r]={...i,content:OR(i.content,e.content)}}this._updateRepr(t)}else if(e.kind==="textEdit"||e.kind==="notebookEdit"){const r=e.uri.scheme===V.vscodeNotebookCell&&!this._responseParts.find(l=>l.kind==="notebookEditGroup")?void 0:Sd.parse(e.uri)?.notebook,n=r??e.uri;let s=!1;const o=e.kind==="textEdit"&&!r?"textEditGroup":"notebookEditGroup",a=o==="textEditGroup"?e.edits:e.edits.map(l=>TA.isTextEdit(l)?{uri:e.uri,edit:l}:l);for(let l=0;!s&&l<this._responseParts.length;l++){const c=this._responseParts[l];c.kind===o&&!c.done&&ms(c.uri,n)&&(c.edits.push(a),c.done=e.done,s=!0)}s||this._responseParts.push({kind:o,uri:n,edits:o==="textEditGroup"?[a]:a,done:e.done}),this._updateRepr(t)}else if(e.kind==="progressTask"){const i=this._responseParts.push(e)-1;this._updateRepr(t);const r=e.onDidAddProgress(()=>{this._updateRepr(!1)});e.task?.().then(n=>{r.dispose(),typeof n=="string"&&(this._responseParts[i].content=new $o(n)),this._updateRepr(!1)})}else e.kind==="toolInvocation"?(e.confirmationMessages&&e.confirmed.p.then(()=>{this._updateRepr(!1)}),e.isCompletePromise.then(()=>{this._updateRepr(!1)}),this._responseParts.push(e),this._updateRepr(t)):(this._responseParts.push(e),this._updateRepr(t))}addCitation(e){this._citations.push(e),this._updateRepr()}_updateRepr(e){super._updateRepr(),this._onDidChangeValue&&(this._responseRepr+=this._citations.length?`

`+FR(this._citations):"",e||this._onDidChangeValue.fire())}},Ud=class extends se{get session(){return this._session}get shouldBeRemovedOnSend(){return this._shouldBeRemovedOnSend}get isComplete(){return this._isComplete}set shouldBeRemovedOnSend(e){this._shouldBeRemovedOnSend=e,this._onDidChange.fire(Ti)}get isCanceled(){return this._isCanceled}get vote(){return this._vote}get voteDownReason(){return this._voteDownReason}get followups(){return this._followups}get entireResponse(){return this._finalizedResponse||this._response}get result(){return this._result}get username(){return this.session.responderUsername}get avatarIcon(){return this.session.responderAvatarIcon}get agent(){return this._agent}get slashCommand(){return this._slashCommand}get agentOrSlashCommandDetected(){return this._agentOrSlashCommandDetected??!1}get usedContext(){return this._usedContext}get contentReferences(){return Array.from(this._contentReferences)}get codeCitations(){return this._codeCitations}get progressMessages(){return this._progressMessages}get isStale(){return this._isStale}get isPaused(){return this._isPaused}get isPendingConfirmation(){return this._response.value.some(e=>e.kind==="toolInvocation"&&e.isConfirmed===void 0||e.kind==="confirmation"&&e.isUsed===!1)}get response(){const e=this._shouldBeRemovedOnSend?.afterUndoStop;return e?(this._responseView?.undoStop!==e&&(this._responseView=new AR(this._response,e)),this._responseView):this._finalizedResponse||this._response}constructor(e){super(),this._onDidChange=this._register(new P),this.onDidChange=this._onDidChange.event,this._contentReferences=[],this._codeCitations=[],this._progressMessages=[],this._isStale=!1,this._isPaused=Pm("isPaused",!1),this._session=e.session,this._agent=e.agent,this._slashCommand=e.slashCommand,this.requestId=e.requestId,this._isComplete=e.isComplete??!1,this._isCanceled=e.isCanceled??!1,this._vote=e.vote,this._voteDownReason=e.voteDownReason,this._result=e.result,this._followups=e.followups?[...e.followups]:void 0,this.isCompleteAddedRequest=e.isCompleteAddedRequest??!1,this._shouldBeRemovedOnSend=e.shouldBeRemovedOnSend,this._isStale=Array.isArray(e.responseContent)&&(e.responseContent.length!==0||Kr(e.responseContent)&&e.responseContent.value.length!==0),this._response=this._register(new RR(e.responseContent)),this._register(this._response.onDidChangeValue(()=>this._onDidChange.fire(Ti))),this.id=e.restoredId??"response_"+$t()}updateContent(e,t){this.bufferWhenPaused(()=>this._response.updateContent(e,t))}addUndoStop(e){this.bufferWhenPaused(()=>{this._onDidChange.fire({reason:"undoStop",id:e.id}),this._response.updateContent(e,!0)})}applyReference(e){e.kind==="usedContext"?this._usedContext=e:e.kind==="reference"&&(this._contentReferences.push(e),this._onDidChange.fire(Ti))}applyCodeCitation(e){this._codeCitations.push(e),this._response.addCitation(e),this._onDidChange.fire(Ti)}setAgent(e,t){this._agent=e,this._slashCommand=t,this._agentOrSlashCommandDetected=!e.isDefault||!!t,this._onDidChange.fire(Ti)}setResult(e){this._result=e,this._onDidChange.fire(Ti)}complete(){this._result?.errorDetails?.responseIsRedacted&&this._response.clear(),this._isComplete=!0,this._onDidChange.fire(Ti)}cancel(){this._isComplete=!0,this._isCanceled=!0,this._onDidChange.fire(Ti)}setFollowups(e){this._followups=e,this._onDidChange.fire(Ti)}setVote(e){this._vote=e,this._onDidChange.fire(Ti)}setVoteDownReason(e){this._voteDownReason=e,this._onDidChange.fire(Ti)}setEditApplied(e,t){return!this.response.value.includes(e)||!e.state?!1:(e.state.applied=t,this._onDidChange.fire(Ti),!0)}adoptTo(e){this._session=e,this._onDidChange.fire(Ti)}setPaused(e,t){this._isPaused.set(e,t),this._onDidChange.fire(Ti),this.bufferedPauseContent?.forEach(i=>i()),this.bufferedPauseContent=void 0}finalizeUndoState(){this._finalizedResponse=this.response,this._responseView=void 0,this._shouldBeRemovedOnSend=void 0}bufferWhenPaused(e){this._isPaused.get()?(this.bufferedPauseContent??=[],this.bufferedPauseContent.push(e)):e()}},wC;(function(e){e[e.NotPausable=0]="NotPausable",e[e.Paused=1]="Paused",e[e.Unpaused=2]="Unpaused"})(wC||(wC={}));function LR(e){const t=e;return typeof t=="object"&&typeof t.requesterUsername=="string"}function NR(e){const t=e;return LR(e)&&typeof t.creationDate=="number"&&typeof t.sessionId=="string"&&e.requests.every(i=>!i.usedContext||kR(i.usedContext))}var yC;(function(e){e[e.Removal=0]="Removal",e[e.Resend=1]="Resend",e[e.Adoption=2]="Adoption"})(yC||(yC={}));var Ji;(function(e){e[e.Created=0]="Created",e[e.Initializing=1]="Initializing",e[e.Initialized=2]="Initialized"})(Ji||(Ji={}));var bC=qm=class extends se{static getDefaultTitle(t){const i=t.at(0)?.message??"";return(typeof i=="string"?i:i.text).split(`
`)[0].substring(0,50)}get sampleQuestions(){return this._sampleQuestions}get sessionId(){return this._sessionId}get requestInProgress(){const t=this.lastRequest;return!t?.response||t.response.isPendingConfirmation?!1:!t.response.isComplete}get requestPausibility(){const t=this.lastRequest;return!t?.response?.agent||t.response.isComplete||t.response.isPendingConfirmation?0:t.response.isPaused.get()?1:2}get hasRequests(){return this._requests.length>0}get lastRequest(){return this._requests.at(-1)}get creationDate(){return this._creationDate}get lastMessageDate(){return this._lastMessageDate}get _defaultAgent(){return this.chatAgentService.getDefaultAgent(ii.Panel,Tr.Ask)}get requesterUsername(){return this._defaultAgent?.metadata.requester?.name??this.initialData?.requesterUsername??""}get responderUsername(){return this._defaultAgent?.fullName??this.initialData?.responderUsername??""}get requesterAvatarIconUri(){return this._defaultAgent?.metadata.requester?.icon??this._initialRequesterAvatarIconUri}get responderAvatarIcon(){return this._defaultAgent?.metadata.themeIcon??this._initialResponderAvatarIconUri}get initState(){return this._initState}get isImported(){return this._isImported}get customTitle(){return this._customTitle}get title(){return this._customTitle||qm.getDefaultTitle(this._requests)}get initialLocation(){return this._initialLocation}get editingSessionObs(){return this._editingSession}get editingSession(){return this._editingSession?.promiseResult.get()?.data}constructor(t,i,r,n,s){super(),this.initialData=t,this._initialLocation=i,this.logService=r,this.chatAgentService=n,this.chatEditingService=s,this._onDidDispose=this._register(new P),this.onDidDispose=this._onDidDispose.event,this._onDidChange=this._register(new P),this.onDidChange=this._onDidChange.event,this._initState=Ji.Created,this._isInitializedDeferred=new Dr,this._isImported=!1,this.currentEditedFileEvents=new Ft,this._checkpoint=void 0;const o=NR(t);t&&!o&&this.logService.warn(`ChatModel#constructor: Loaded malformed session data: ${JSON.stringify(t)}`),this._isImported=!!t&&!o||(t?.isImported??!1),this._sessionId=o&&t.sessionId||$t(),this._requests=t?this._deserialize(t):[],this._creationDate=o&&t.creationDate||Date.now(),this._lastMessageDate=o&&t.lastMessageDate||this._creationDate,this._customTitle=o?t.customTitle:void 0,this._initialRequesterAvatarIconUri=t?.requesterAvatarIconUri&&y.revive(t.requesterAvatarIconUri),this._initialResponderAvatarIconUri=Wu(t?.responderAvatarIconUri)?y.revive(t.responderAvatarIconUri):t?.responderAvatarIconUri}startEditingSession(t){const i=t?this.chatEditingService.startOrContinueGlobalEditingSession(this):this.chatEditingService.createEditingSession(this);this._editingSession=new i3(i),this._editingSession.promise.then(r=>{this._store.isDisposed?r.dispose():this._register(r)})}notifyEditingAction(t){const i=t.outcome==="accepted"?Qo.Keep:t.outcome==="rejected"?Qo.Undo:t.outcome==="userModified"?Qo.UserModification:null;i!==null&&(!this.currentEditedFileEvents.has(t.uri)||this.currentEditedFileEvents.get(t.uri)?.eventKind===Qo.Keep)&&this.currentEditedFileEvents.set(t.uri,{eventKind:i,uri:t.uri})}_deserialize(t){const i=t.requests;if(!Array.isArray(i))return this.logService.error(`Ignoring malformed session data: ${JSON.stringify(t)}`),[];try{return i.map(r=>{const n=typeof r.message=="string"?this.getParsedRequestFromString(r.message):DR(r.message),s=this.reviveVariableData(r.variableData),o=new vC({session:this,message:n,variableData:s,timestamp:r.timestamp??-1,restoredId:r.requestId,confirmation:r.confirmation,editedFileEvents:r.editedFileEvents});if(o.shouldBeRemovedOnSend=r.isHidden?{requestId:r.requestId}:r.shouldBeRemovedOnSend,r.response||r.result||r.responseErrorDetails){const a=r.agent&&"metadata"in r.agent?tC(r.agent):void 0,l="responseErrorDetails"in r?{errorDetails:r.responseErrorDetails}:r.result;o.response=new Ud({responseContent:r.response??[new $o(r.response)],session:this,agent:a,slashCommand:r.slashCommand,requestId:o.id,isComplete:!0,isCanceled:r.isCanceled,vote:r.vote,voteDownReason:r.voteDownReason,result:l,followups:r.followups,restoredId:r.responseId}),o.response.shouldBeRemovedOnSend=r.isHidden?{requestId:r.requestId}:r.shouldBeRemovedOnSend,r.usedContext&&o.response.applyReference(Pt(r.usedContext)),r.contentReferences?.forEach(c=>o.response.applyReference(Pt(c))),r.codeCitations?.forEach(c=>o.response.applyCodeCitation(Pt(c)))}return o})}catch(r){return this.logService.error("Failed to parse chat data",r),[]}}reviveVariableData(t){const i=t&&Array.isArray(t.variables)?t:{variables:[]};return i.variables=i.variables.map(r=>r&&"values"in r&&Array.isArray(r.values)?{kind:"generic",id:r.id??"",name:r.name,value:r.values[0]?.value,range:r.range,modelDescription:r.modelDescription,references:r.references}:r),i}getParsedRequestFromString(t){const i=[new Vm(new rn(0,t.length),{startColumn:1,startLineNumber:1,endColumn:1,endLineNumber:1},t)];return{text:t,parts:i}}toggleLastRequestPaused(t){if(this.requestPausibility!==0&&this.lastRequest?.response?.agent){const i=t??!this.lastRequest.response.isPaused.get();this.lastRequest.response.setPaused(i),this.chatAgentService.setRequestPaused(this.lastRequest.response.agent.id,this.lastRequest.id,i),this._onDidChange.fire({kind:"changedRequest",request:this.lastRequest})}}startInitialize(){if(this.initState!==Ji.Created)throw new Error(`ChatModel is in the wrong state for startInitialize: ${Ji[this.initState]}`);this._initState=Ji.Initializing}deinitialize(){this._initState=Ji.Created,this._isInitializedDeferred=new Dr}initialize(t){if(this.initState!==Ji.Initializing)throw new Error(`ChatModel is in the wrong state for initialize: ${Ji[this.initState]}`);this._initState=Ji.Initialized,this._sampleQuestions=t,this._isInitializedDeferred.complete(),this._onDidChange.fire({kind:"initialize"})}setInitializationError(t){if(this.initState!==Ji.Initializing)throw new Error(`ChatModel is in the wrong state for setInitializationError: ${Ji[this.initState]}`);this._isInitializedDeferred.isSettled||this._isInitializedDeferred.error(t)}waitForInitialization(){return this._isInitializedDeferred.p}getRequests(){return this._requests}get checkpoint(){return this._checkpoint}setDisabledRequests(t){this._requests.forEach(i=>{const r=t.find(n=>n.requestId===i.id);i.shouldBeRemovedOnSend=r,i.response&&(i.response.shouldBeRemovedOnSend=r)}),this._onDidChange.fire({kind:"setHidden",hiddenRequestIds:t})}addRequest(t,i,r,n,s,o,a,l,c,u){const d=[...this.currentEditedFileEvents.values()];this.currentEditedFileEvents.clear();const f=new vC({session:this,message:t,variableData:i,timestamp:Date.now(),attempt:r,confirmation:o,locationData:a,attachedContext:l,isCompleteAddedRequest:c,modelId:u,editedFileEvents:d.length?d:void 0});return f.response=new Ud({responseContent:[],session:this,agent:n,slashCommand:s,requestId:f.id,isCompleteAddedRequest:c}),this._requests.push(f),this._lastMessageDate=Date.now(),this._onDidChange.fire({kind:"addRequest",request:f}),f}setCustomTitle(t){this._customTitle=t}updateRequest(t,i){t.variableData=i,this._onDidChange.fire({kind:"changedRequest",request:t})}adoptRequest(t){const i=t.session,r=i._requests.findIndex(n=>n.id===t.id);r!==-1&&(i._requests.splice(r,1),t.adoptTo(this),t.response?.adoptTo(this),this._requests.push(t),i._onDidChange.fire({kind:"removeRequest",requestId:t.id,responseId:t.response?.id,reason:2}),this._onDidChange.fire({kind:"addRequest",request:t}))}acceptResponseProgress(t,i,r){if(t.response||(t.response=new Ud({responseContent:[],session:this,requestId:t.id})),t.response.isComplete)throw new Error("acceptResponseProgress: Adding progress to a completed response");i.kind==="markdownContent"||i.kind==="treeData"||i.kind==="inlineReference"||i.kind==="codeblockUri"||i.kind==="markdownVuln"||i.kind==="progressMessage"||i.kind==="command"||i.kind==="textEdit"||i.kind==="notebookEdit"||i.kind==="warning"||i.kind==="progressTask"||i.kind==="confirmation"||i.kind==="extensions"||i.kind==="toolInvocation"?t.response.updateContent(i,r):i.kind==="usedContext"||i.kind==="reference"?t.response.applyReference(i):i.kind==="codeCitation"?t.response.applyCodeCitation(i):i.kind==="move"?this._onDidChange.fire({kind:"move",target:i.uri,range:i.range}):i.kind==="undoStop"?t.response.addUndoStop(i):this.logService.error(`Couldn't handle progress: ${JSON.stringify(i)}`)}removeRequest(t,i=0){const r=this._requests.findIndex(s=>s.id===t),n=this._requests[r];r!==-1&&(this._onDidChange.fire({kind:"removeRequest",requestId:n.id,responseId:n.response?.id,reason:i}),this._requests.splice(r,1),n.response?.dispose())}cancelRequest(t){t.response&&t.response.cancel()}setResponse(t,i){t.response||(t.response=new Ud({responseContent:[],session:this,requestId:t.id})),t.response.setResult(i)}completeResponse(t){if(!t.response)throw new Error("Call setResponse before completeResponse");t.response.complete(),this._onDidChange.fire({kind:"completedRequest",request:t})}setFollowups(t,i){t.response&&t.response.setFollowups(i)}setResponseModel(t,i){t.response=i,this._onDidChange.fire({kind:"addResponse",response:i})}toExport(){return{requesterUsername:this.requesterUsername,requesterAvatarIconUri:this.requesterAvatarIconUri,responderUsername:this.responderUsername,responderAvatarIconUri:this.responderAvatarIcon,initialLocation:this.initialLocation,requests:this._requests.map(t=>{const i={...t.message,parts:t.message.parts.map(s=>s&&"toJSON"in s?s.toJSON():s)},r=t.response?.agent,n=r&&"toJSON"in r?r.toJSON():r?{...r}:void 0;return{requestId:t.id,message:i,variableData:t.variableData,response:t.response?t.response.entireResponse.value.map(s=>s.kind==="treeData"?s.treeData:s.kind==="markdownContent"?s.content:s):void 0,responseId:t.response?.id,shouldBeRemovedOnSend:t.shouldBeRemovedOnSend,result:t.response?.result,followups:t.response?.followups,isCanceled:t.response?.isCanceled,vote:t.response?.vote,voteDownReason:t.response?.voteDownReason,agent:n,slashCommand:t.response?.slashCommand,usedContext:t.response?.usedContext,contentReferences:t.response?.contentReferences,codeCitations:t.response?.codeCitations,timestamp:t.timestamp,confirmation:t.confirmation,editedFileEvents:t.editedFileEvents}})}}toJSON(){return{version:3,...this.toExport(),sessionId:this.sessionId,creationDate:this._creationDate,isImported:this._isImported,lastMessageDate:this._lastMessageDate,customTitle:this._customTitle}}dispose(){this._requests.forEach(t=>t.response?.dispose()),this._onDidDispose.fire(),super.dispose()}};bC=qm=__decorate([__param(2,qe),__param(3,xR),__param(4,ER)],bC);function MR(e,t){if(e.baseUri&&t.baseUri){if(!(e.baseUri.scheme===t.baseUri.scheme&&e.baseUri.authority===t.baseUri.authority&&e.baseUri.path===t.baseUri.path&&e.baseUri.query===t.baseUri.query&&e.baseUri.fragment===t.baseUri.fragment))return!1}else if(e.baseUri||t.baseUri)return!1;return fi(e.isTrusted,t.isTrusted)&&e.supportHtml===t.supportHtml&&e.supportThemeIcons===t.supportThemeIcons}function OR(e,t){const i=typeof t=="string"?t:t.value;return{value:e.value+i,isTrusted:e.isTrusted,supportThemeIcons:e.supportThemeIcons,supportHtml:e.supportHtml,baseUri:e.baseUri}}function FR(e){if(e.length===0)return"";const t=e.reduce((r,n)=>r.add(n.license),new Set);return t.size===1?h(5592,null,t.size):h(5593,null,t.size)}var Qo;(function(e){e[e.Keep=1]="Keep",e[e.Undo=2]="Undo",e[e.UserModification=3]="UserModification"})(Qo||(Qo={}));var xC;(function(e){e.Delimiter="\0"})(xC||(xC={}));var SC;(function(e){e[e.IsSame=0]="IsSame",e[e.Disconnected=1]="Disconnected",e[e.IsChild=2]="IsChild",e[e.IsParent=3]="IsParent"})(SC||(SC={}));var Re=class Yi{static fromExtHostTestItem(t,i,r=t.parent){if(t._isRoot)return new Yi([i]);const n=[t.id];for(let s=r;s&&s.id!==i;s=s.parent)n.push(s.id);return n.push(i),new Yi(n.reverse())}static isRoot(t){return!t.includes("\0")}static root(t){const i=t.indexOf("\0");return i===-1?t:t.slice(0,i)}static fromString(t){return new Yi(t.split("\0"))}static join(t,i){return new Yi([...t.path,i])}static split(t){return t.split("\0")}static joinToString(t,i){return t.toString()+"\0"+i}static parentId(t){const i=t.lastIndexOf("\0");return i===-1?void 0:t.slice(0,i)}static localId(t){const i=t.lastIndexOf("\0");return i===-1?t:t.slice(i+1)}static isChild(t,i){return i[t.length]==="\0"&&i.startsWith(t)}static compare(t,i){return t===i?0:Yi.isChild(t,i)?2:Yi.isChild(i,t)?3:1}static getLengthOfCommonPrefix(t,i){if(t===0)return 0;let r=0;for(;r<t-1;){for(let n=1;n<t;n++){const s=i(n-1),o=i(n);if(s.path[r]!==o.path[r])return r}r++}return r}constructor(t,i=t.length){if(this.path=t,this.viewEnd=i,t.length===0||i<1)throw new Error("cannot create test with empty path")}get rootId(){return new Yi(this.path,1)}get parentId(){return this.viewEnd>1?new Yi(this.path,this.viewEnd-1):void 0}get localId(){return this.path[this.viewEnd-1]}get controllerId(){return this.path[0]}get isRoot(){return this.viewEnd===1}*idsFromRoot(){for(let t=1;t<=this.viewEnd;t++)yield new Yi(this.path,t)}*idsToRoot(){for(let t=this.viewEnd;t>0;t--)yield new Yi(this.path,t)}compare(t){if(typeof t=="string")return Yi.compare(this.toString(),t);for(let i=0;i<t.viewEnd&&i<this.viewEnd;i++)if(t.path[i]!==this.path[i])return 1;return t.viewEnd>this.viewEnd?2:t.viewEnd<this.viewEnd?3:0}toJSON(){return this.toString()}toString(){if(!this.stringifed){this.stringifed=this.path[0];for(let t=1;t<this.viewEnd;t++)this.stringifed+="\0",this.stringifed+=this.path[t]}return this.stringifed}},EC;(function(e){e[e.Unset=0]="Unset",e[e.Queued=1]="Queued",e[e.Running=2]="Running",e[e.Passed=3]="Passed",e[e.Failed=4]="Failed",e[e.Skipped=5]="Skipped",e[e.Errored=6]="Errored"})(EC||(EC={}));var CC;(function(e){e[e.Run=1]="Run",e[e.Debug=2]="Debug",e[e.Coverage=3]="Coverage"})(CC||(CC={}));var DC;(function(e){e[e.Refresh=2]="Refresh",e[e.CodeRelatedToTest=4]="CodeRelatedToTest",e[e.TestRelatedToCode=8]="TestRelatedToCode"})(DC||(DC={}));var IC;(function(e){e[e.Run=2]="Run",e[e.Debug=4]="Debug",e[e.Coverage=8]="Coverage",e[e.HasNonDefaultProfile=16]="HasNonDefaultProfile",e[e.HasConfigurable=32]="HasConfigurable",e[e.SupportsContinuousRun=64]="SupportsContinuousRun"})(IC||(IC={}));var lV={2:h(12568,null),4:h(12569,null),8:h(12570,null)},$R=e=>"runId"in e,Jo;(function(e){e.serialize=t=>({range:t.range.toJSON(),uri:t.uri.toJSON()}),e.deserialize=(t,i)=>({range:Fe.lift(i.range),uri:t.asCanonicalUri(y.revive(i.uri))})})(Jo||(Jo={}));var kC;(function(e){e[e.Error=0]="Error",e[e.Output=1]="Output"})(kC||(kC={}));var Bd;(function(e){e.serialize=t=>({label:t.label,uri:t.uri?.toJSON(),position:t.position?.toJSON()}),e.deserialize=(t,i)=>({label:i.label,uri:i.uri?t.asCanonicalUri(y.revive(i.uri)):void 0,position:i.position?Bi.lift(i.position):void 0})})(Bd||(Bd={}));var Wd;(function(e){e.serialize=t=>({message:t.message,type:0,expected:t.expected,actual:t.actual,contextValue:t.contextValue,location:t.location&&Jo.serialize(t.location),stackTrace:t.stackTrace?.map(Bd.serialize)}),e.deserialize=(t,i)=>({message:i.message,type:0,expected:i.expected,actual:i.actual,contextValue:i.contextValue,location:i.location&&Jo.deserialize(t,i.location),stackTrace:i.stackTrace&&i.stackTrace.map(r=>Bd.deserialize(t,r))})})(Wd||(Wd={}));var Vd;(function(e){e.serialize=t=>({message:t.message,type:1,offset:t.offset,length:t.length,location:t.location&&Jo.serialize(t.location)}),e.deserialize=(t,i)=>({message:i.message,type:1,offset:i.offset,length:i.length,location:i.location&&Jo.deserialize(t,i.location)})})(Vd||(Vd={}));var zd;(function(e){e.serialize=t=>t.type===0?Wd.serialize(t):Vd.serialize(t),e.deserialize=(t,i)=>i.type===0?Wd.deserialize(t,i):Vd.deserialize(t,i),e.isDiffable=t=>t.type===0&&t.actual!==void 0&&t.expected!==void 0})(zd||(zd={}));var Hl;(function(e){e.serializeWithoutMessages=t=>({state:t.state,duration:t.duration,messages:[]}),e.serialize=t=>({state:t.state,duration:t.duration,messages:t.messages.map(zd.serialize)}),e.deserialize=(t,i)=>({state:i.state,duration:i.duration,messages:i.messages.map(r=>zd.deserialize(t,r))})})(Hl||(Hl={}));var PC="\0",qd=(e,t)=>e+PC+t,TC=e=>{const t=e.indexOf(PC);return{ctrlId:e.slice(0,t),tagId:e.slice(t+1)}},jd;(function(e){e.serialize=t=>({extId:t.extId,label:t.label,tags:t.tags,busy:t.busy,children:void 0,uri:t.uri?.toJSON(),range:t.range?.toJSON()||null,description:t.description,error:t.error,sortText:t.sortText}),e.deserialize=(t,i)=>({extId:i.extId,label:i.label,tags:i.tags,busy:i.busy,children:void 0,uri:i.uri?t.asCanonicalUri(y.revive(i.uri)):void 0,range:i.range?Fe.lift(i.range):null,description:i.description,error:i.error,sortText:i.sortText})})(jd||(jd={}));var AC;(function(e){e[e.NotExpandable=0]="NotExpandable",e[e.Expandable=1]="Expandable",e[e.BusyExpanding=2]="BusyExpanding",e[e.Expanded=3]="Expanded"})(AC||(AC={}));var Fn;(function(e){e.serialize=t=>({expand:t.expand,item:jd.serialize(t.item)}),e.deserialize=(t,i)=>({controllerId:Re.root(i.item.extId),expand:i.expand,item:jd.deserialize(t,i.item)})})(Fn||(Fn={}));var Ul;(function(e){e.serialize=t=>{let i;return t.item&&(i={},t.item.label!==void 0&&(i.label=t.item.label),t.item.tags!==void 0&&(i.tags=t.item.tags),t.item.busy!==void 0&&(i.busy=t.item.busy),t.item.uri!==void 0&&(i.uri=t.item.uri?.toJSON()),t.item.range!==void 0&&(i.range=t.item.range?.toJSON()),t.item.description!==void 0&&(i.description=t.item.description),t.item.error!==void 0&&(i.error=t.item.error),t.item.sortText!==void 0&&(i.sortText=t.item.sortText)),{extId:t.extId,expand:t.expand,item:i}},e.deserialize=t=>{let i;return t.item&&(i={},t.item.label!==void 0&&(i.label=t.item.label),t.item.tags!==void 0&&(i.tags=t.item.tags),t.item.busy!==void 0&&(i.busy=t.item.busy),t.item.range!==void 0&&(i.range=t.item.range?Fe.lift(t.item.range):null),t.item.description!==void 0&&(i.description=t.item.description),t.item.error!==void 0&&(i.error=t.item.error),t.item.sortText!==void 0&&(i.sortText=t.item.sortText)),{extId:t.extId,expand:t.expand,item:i}}})(Ul||(Ul={}));var Gm=(e,t)=>{t.expand!==void 0&&(e.expand=t.expand),t.item!==void 0&&(e.item=e.item?Object.assign(e.item,t.item):t.item)},RC;(function(e){e.serializeWithoutMessages=t=>({...Fn.serialize(t),ownComputedState:t.ownComputedState,computedState:t.computedState,tasks:t.tasks.map(Hl.serializeWithoutMessages)}),e.serialize=t=>({...Fn.serialize(t),ownComputedState:t.ownComputedState,computedState:t.computedState,tasks:t.tasks.map(Hl.serialize)}),e.deserialize=(t,i)=>({...Fn.deserialize(t,i),ownComputedState:i.ownComputedState,computedState:i.computedState,tasks:i.tasks.map(r=>Hl.deserialize(t,r)),retired:!0})})(RC||(RC={}));var Qm;(function(e){e.empty=()=>({covered:0,total:0}),e.sum=(t,i)=>{t.covered+=i.covered,t.total+=i.total}})(Qm||(Qm={}));var LC;(function(e){e.serialize=t=>({id:t.id,statement:t.statement,branch:t.branch,declaration:t.declaration,testIds:t.testIds,uri:t.uri.toJSON()}),e.deserialize=(t,i)=>({id:i.id,statement:i.statement,branch:i.branch,declaration:i.declaration,testIds:i.testIds,uri:t.asCanonicalUri(y.revive(i.uri))}),e.empty=(t,i)=>({id:t,uri:i,statement:Qm.empty()})})(LC||(LC={}));function Jm(e){return{...e,location:e.location?.toJSON()}}function Xm(e){return e.location=e.location?Bi.isIPosition(e.location)?Bi.lift(e.location):Fe.lift(e.location):void 0,e}var NC;(function(e){e[e.Declaration=0]="Declaration",e[e.Statement=1]="Statement",e[e.Branch=2]="Branch"})(NC||(NC={}));var MC;(function(e){e.serialize=t=>t.type===0?Qd.serialize(t):Jd.serialize(t),e.deserialize=t=>t.type===0?Qd.deserialize(t):Jd.deserialize(t)})(MC||(MC={}));var Gd;(function(e){e.serialize=Jm,e.deserialize=Xm})(Gd||(Gd={}));var Qd;(function(e){e.serialize=Jm,e.deserialize=Xm})(Qd||(Qd={}));var Jd;(function(e){e.serialize=t=>({...Jm(t),branches:t.branches?.map(Gd.serialize)}),e.deserialize=t=>({...Xm(t),branches:t.branches?.map(Gd.deserialize)})})(Jd||(Jd={}));var OC;(function(e){e[e.Add=0]="Add",e[e.Update=1]="Update",e[e.DocumentSynced=2]="DocumentSynced",e[e.Remove=3]="Remove",e[e.IncrementPendingExtHosts=4]="IncrementPendingExtHosts",e[e.Retire=5]="Retire",e[e.AddTag=6]="AddTag",e[e.RemoveTag=7]="RemoveTag"})(OC||(OC={}));var Xd;(function(e){e.deserialize=(t,i)=>i.op===0?{op:i.op,item:Fn.deserialize(t,i.item)}:i.op===1?{op:i.op,item:Ul.deserialize(i.item)}:i.op===2?{op:i.op,uri:t.asCanonicalUri(y.revive(i.uri)),docv:i.docv}:i,e.serialize=t=>t.op===0?{op:t.op,item:Fn.serialize(t.item)}:t.op===1?{op:t.op,item:Ul.serialize(t.item)}:t})(Xd||(Xd={}));var HR=class{constructor(e){this.uriIdentity=e,this._tags=new Map,this.items=new Map,this.roots=new Set,this.busyControllerCount=0,this.pendingRootCount=0,this.tags=this._tags}apply(e){const t=this.createChangeCollector();for(const i of e)switch(i.op){case 0:this.add(Fn.deserialize(this.uriIdentity,i.item),t);break;case 1:this.update(Ul.deserialize(i.item),t);break;case 3:this.remove(i.itemId,t);break;case 5:this.retireTest(i.itemId);break;case 4:this.updatePendingRoots(i.amount);break;case 6:this._tags.set(i.tag.id,i.tag);break;case 7:this._tags.delete(i.id);break}t.complete?.()}add(e,t){const i=Re.parentId(e.item.extId)?.toString();let r;if(!i)r=this.createItem(e),this.roots.add(r),this.items.set(e.item.extId,r);else if(this.items.has(i)){const n=this.items.get(i);n.children.add(e.item.extId),r=this.createItem(e,n),this.items.set(e.item.extId,r)}else{console.error(`Test with unknown parent ID: ${JSON.stringify(e)}`);return}return t.add?.(r),e.expand===2&&this.busyControllerCount++,r}update(e,t){const i=this.items.get(e.extId);if(i)return e.expand!==void 0&&(i.expand===2&&this.busyControllerCount--,e.expand===2&&this.busyControllerCount++),Gm(i,e),t.update?.(i),i}remove(e,t){const i=this.items.get(e);if(!i)return;const r=Re.parentId(i.item.extId)?.toString();r?this.items.get(r).children.delete(i.item.extId):this.roots.delete(i);const n=[[e]];for(;n.length;)for(const s of n.pop()){const o=this.items.get(s);o&&(n.push(o.children),this.items.delete(s),t.remove?.(o,o!==i),o.expand===2&&this.busyControllerCount--)}}retireTest(e){}updatePendingRoots(e){this.pendingRootCount+=e}createChangeCollector(){return{}}},UR=U("editorGroupsService"),FC;(function(e){e[e.UP=0]="UP",e[e.DOWN=1]="DOWN",e[e.LEFT=2]="LEFT",e[e.RIGHT=3]="RIGHT"})(FC||(FC={}));var $C;(function(e){e[e.HORIZONTAL=0]="HORIZONTAL",e[e.VERTICAL=1]="VERTICAL"})($C||($C={}));var HC;(function(e){e[e.FIRST=0]="FIRST",e[e.LAST=1]="LAST",e[e.NEXT=2]="NEXT",e[e.PREVIOUS=3]="PREVIOUS"})(HC||(HC={}));var UC;(function(e){e[e.MAXIMIZE=0]="MAXIMIZE",e[e.EXPAND=1]="EXPAND",e[e.EVEN=2]="EVEN"})(UC||(UC={}));var BC;(function(e){e[e.COPY_EDITORS=0]="COPY_EDITORS",e[e.MOVE_EDITORS=1]="MOVE_EDITORS"})(BC||(BC={}));var WC;(function(e){e[e.CREATION_TIME=0]="CREATION_TIME",e[e.MOST_RECENTLY_ACTIVE=1]="MOST_RECENTLY_ACTIVE",e[e.GRID_APPEARANCE=2]="GRID_APPEARANCE"})(WC||(WC={}));var VC;(function(e){e[e.NEW_EDITOR=1]="NEW_EDITOR",e[e.MOVE_EDITOR=2]="MOVE_EDITOR",e[e.COPY_EDITOR=3]="COPY_EDITOR"})(VC||(VC={}));var cV=U("editorService"),BR=-1,WR=-2,Zm="^([a-z0-9A-Z][a-z0-9-A-Z]*)\\.([a-z0-9A-Z][a-z0-9-A-Z]*)$",uV=new RegExp(Zm),zC;(function(e){e.COMMAND="command",e.SETTINGS_SYNC="settingsSync"})(zC||(zC={}));var qC;(function(e){e.NoneOrRelevance="NoneOrRelevance",e.LastUpdatedDate="LastUpdatedDate",e.Title="Title",e.PublisherName="PublisherName",e.InstallCount="InstallCount",e.PublishedDate="PublishedDate",e.AverageRating="AverageRating",e.WeightedRating="WeightedRating"})(qC||(qC={}));var jC;(function(e){e[e.Default=0]="Default",e[e.Ascending=1]="Ascending",e[e.Descending=2]="Descending"})(jC||(jC={}));var GC;(function(e){e.Category="Category",e.ExtensionId="ExtensionId",e.ExtensionName="ExtensionName",e.ExcludeWithFlags="ExcludeWithFlags",e.Featured="Featured",e.SearchText="SearchText",e.Tag="Tag",e.Target="Target"})(GC||(GC={}));var QC;(function(e){e.Install="install",e.Uninstall="uninstall"})(QC||(QC={}));var JC;(function(e){e[e.None=1]="None",e[e.Install=2]="Install",e[e.Update=3]="Update",e[e.Migrate=4]="Migrate"})(JC||(JC={}));var dV=U("extensionGalleryService"),XC;(function(e){e.Timeout="Timeout",e.Cancelled="Cancelled",e.Failed="Failed",e.DownloadFailedWriting="DownloadFailedWriting",e.Offline="Offline"})(XC||(XC={}));var ZC;(function(e){e.NotFound="NotFound",e.Unsupported="Unsupported",e.Deprecated="Deprecated",e.Malicious="Malicious",e.Incompatible="Incompatible",e.IncompatibleApi="IncompatibleApi",e.IncompatibleTargetPlatform="IncompatibleTargetPlatform",e.ReleaseVersionNotFound="ReleaseVersionNotFound",e.Invalid="Invalid",e.Download="Download",e.DownloadSignature="DownloadSignature",e.DownloadFailedWriting="DownloadFailedWriting",e.UpdateMetadata="UpdateMetadata",e.Extract="Extract",e.Scanning="Scanning",e.ScanningExtension="ScanningExtension",e.ReadRemoved="ReadRemoved",e.UnsetRemoved="UnsetRemoved",e.Delete="Delete",e.Rename="Rename",e.IntializeDefaultProfile="IntializeDefaultProfile",e.AddToProfile="AddToProfile",e.InstalledExtensionNotFound="InstalledExtensionNotFound",e.PostInstall="PostInstall",e.CorruptZip="CorruptZip",e.IncompleteZip="IncompleteZip",e.PackageNotSigned="PackageNotSigned",e.SignatureVerificationInternal="SignatureVerificationInternal",e.SignatureVerificationFailed="SignatureVerificationFailed",e.NotAllowed="NotAllowed",e.Gallery="Gallery",e.Cancelled="Cancelled",e.Unknown="Unknown",e.Internal="Internal"})(ZC||(ZC={}));var KC;(function(e){e.NotSigned="NotSigned",e.Success="Success",e.RequiredArgumentMissing="RequiredArgumentMissing",e.InvalidArgument="InvalidArgument",e.PackageIsUnreadable="PackageIsUnreadable",e.UnhandledException="UnhandledException",e.SignatureManifestIsMissing="SignatureManifestIsMissing",e.SignatureManifestIsUnreadable="SignatureManifestIsUnreadable",e.SignatureIsMissing="SignatureIsMissing",e.SignatureIsUnreadable="SignatureIsUnreadable",e.CertificateIsUnreadable="CertificateIsUnreadable",e.SignatureArchiveIsUnreadable="SignatureArchiveIsUnreadable",e.FileAlreadyExists="FileAlreadyExists",e.SignatureArchiveIsInvalidZip="SignatureArchiveIsInvalidZip",e.SignatureArchiveHasSameSignatureFile="SignatureArchiveHasSameSignatureFile",e.PackageIntegrityCheckFailed="PackageIntegrityCheckFailed",e.SignatureIsInvalid="SignatureIsInvalid",e.SignatureManifestIsInvalid="SignatureManifestIsInvalid",e.SignatureIntegrityCheckFailed="SignatureIntegrityCheckFailed",e.EntryIsMissing="EntryIsMissing",e.EntryIsTampered="EntryIsTampered",e.Untrusted="Untrusted",e.CertificateRevoked="CertificateRevoked",e.SignatureIsNotValid="SignatureIsNotValid",e.UnknownError="UnknownError",e.PackageIsInvalidZip="PackageIsInvalidZip",e.SignatureArchiveHasTooManyEntries="SignatureArchiveHasTooManyEntries"})(KC||(KC={}));var hV=U("extensionManagementService"),fV=U("IGlobalExtensionEnablementService"),pV=U("IExtensionTipsService"),gV=U("IAllowedExtensionsService"),mV=Fu(1953,"Extensions"),vV=Fu(1954,"Preferences"),VR="extensions.allowed",zR="extensions.gallery.url";Ht.as(Ps.Configuration).registerConfiguration({id:"extensions",order:30,title:h(1935,null),type:"object",properties:{[zR]:{type:"string",markdownDescription:h(1936,null),scope:1,default:null},[VR]:{type:"object",markdownDescription:h(1937,null),default:"*",defaultSnippets:[{body:{},description:h(1938,null)},{body:{"*":!0},description:h(1939,null)}],scope:1,policy:{name:"AllowedExtensions",minimumVersion:"1.96",description:h(1940,null)},additionalProperties:!1,patternProperties:{"([a-z0-9A-Z][a-z0-9-A-Z]*)\\.([a-z0-9A-Z][a-z0-9-A-Z]*)$":{anyOf:[{type:["boolean","string"],enum:[!0,!1,"stable"],description:h(1941,null),enumDescriptions:[h(1942,null),h(1943,null),h(1944,null)]},{type:"array",items:{type:"string"},description:h(1945,null)}]},"([a-z0-9A-Z][a-z0-9-A-Z]*)$":{type:["boolean","string"],enum:[!0,!1,"stable"],description:h(1946,null),enumDescriptions:[h(1947,null),h(1948,null),h(1949,null)]},"\\*":{type:"boolean",enum:[!0,!1],description:h(1950,null),enumDescriptions:[h(1951,null),h(1952,null)]}}}}});var _V=U("telemetryService"),wV=U("customEndpointTelemetryService"),YC;(function(e){e[e.NONE=0]="NONE",e[e.CRASH=1]="CRASH",e[e.ERROR=2]="ERROR",e[e.USAGE=3]="USAGE"})(YC||(YC={}));var e4;(function(e){e.OFF="off",e.CRASH="crash",e.ERROR="error",e.ON="all"})(e4||(e4={}));var Km=class{constructor(e){this.value=e,this.isTrustedTelemetryValue=!0}},qR=class{constructor(){this.telemetryLevel=0,this.sessionId="someValue.sessionId",this.machineId="someValue.machineId",this.sqmId="someValue.sqmId",this.devDeviceId="someValue.devDeviceId",this.firstSessionDate="someValue.firstSessionDate",this.sendErrorTelemetry=!1}publicLog(){}publicLog2(){}publicLogError(){}publicLogError2(){}setExperimentProperty(){}},yV=new qR,jR="telemetry",GR={id:jR,name:h(2269,null)},QR=new Set(["ssh-remote","dev-container","attached-container","wsl","tunnel","codespaces","amlext"]);function JR(e){if(!e)return"none";const t=Fg(e);return QR.has(t)?t:"other"}function XR(e,t){if(!e||!e.includes("/")&&!e.includes("\\"))return e;let i=e;const r=[];for(const a of t)for(;;){const l=a.exec(e);if(!l)break;r.push([l.index,a.lastIndex])}const n=/^[\\\/]?(node_modules|node_modules\.asar)[\\\/]/,s=/(file:\/\/)?([a-zA-Z]:(\\\\|\\|\/)|(\\\\|\\|\/))?([\w-\._]+(\\\\|\\|\/))+[\w-\._]*/g;let o=0;for(i="";;){const a=s.exec(e);if(!a)break;const l=r.some(([c,u])=>a.index<u&&c<s.lastIndex);!n.test(a[0])&&!l&&(i+=e.substring(o,a.index)+"<REDACTED: user-file-path>",o=s.lastIndex)}return o<e.length&&(i+=e.substr(o)),i}function ZR(e){if(!e)return e;const t=[{label:"Google API Key",regex:/AIza[A-Za-z0-9_\\\-]{35}/},{label:"Slack Token",regex:/xox[pbar]\-[A-Za-z0-9]/},{label:"GitHub Token",regex:/(gh[psuro]_[a-zA-Z0-9]{36}|github_pat_[a-zA-Z0-9]{22}_[a-zA-Z0-9]{59})/},{label:"Generic Secret",regex:/(key|token|sig|secret|signature|password|passwd|pwd|android:value)[^a-zA-Z0-9]/i},{label:"CLI Credentials",regex:/((login|psexec|(certutil|psexec)\.exe).{1,50}(\s-u(ser(name)?)?\s+.{3,100})?\s-(admin|user|vm|root)?p(ass(word)?)?\s+["']?[^$\-\/\s]|(^|[\s\r\n\\])net(\.exe)?.{1,5}(user\s+|share\s+\/user:| user -? secrets ? set) \s + [^ $\s \/])/},{label:"Microsoft Entra ID",regex:/eyJ(?:0eXAiOiJKV1Qi|hbGci|[a-zA-Z0-9\-_]+\.[a-zA-Z0-9\-_]+\.)/},{label:"Email",regex:/[a-zA-Z0-9._%+-]+@[a-zA-Z0-9.-]+\.[a-zA-Z]{2,}/}];for(const i of t)if(i.regex.test(e))return`<REDACTED: ${i.label}>`;return e}function t4(e,t){return Mo(e,i=>{if(i instanceof Km||Object.hasOwnProperty.call(i,"isTrustedTelemetryValue"))return i.value;if(typeof i=="string"){let r=i.replaceAll("%20"," ");r=XR(r,t);for(const n of t)r=r.replace(n,"");return r=ZR(r),r}})}function KR(e,t){return e.uuid&&t.uuid?e.uuid===t.uuid:e.id===t.id?!0:kg(e.id,t.id)===0}var bV=new Oe("pprice.better-merge"),YR=class{constructor(){this._generators=new Map,this._cache=new WeakMap}register(e,t){this._generators.set(e,t)}readActivationEvents(e){return this._cache.has(e)||this._cache.set(e,this._readActivationEvents(e)),this._cache.get(e)}createActivationEventsMap(e){const t=Object.create(null);for(const i of e){const r=this.readActivationEvents(i);r.length>0&&(t[Oe.toKey(i.identifier)]=r)}return t}_readActivationEvents(e){if(typeof e.main>"u"&&typeof e.browser>"u")return[];const t=Array.isArray(e.activationEvents)?e.activationEvents.slice(0):[];for(let i=0;i<t.length;i++)t[i]==="onUri"&&(t[i]=`onUri:${Oe.toKey(e.identifier)}`);if(!e.contributes)return t;for(const i in e.contributes){const r=this._generators.get(i);if(!r)continue;const n=e.contributes[i],s=Array.isArray(n)?n:[n];try{r(s,t)}catch(o){Qt(o)}}return t}},e2=new YR,t2=Object.freeze({identifier:new Oe("nullExtensionDescription"),name:"Null Extension Description",version:"0.0.0",publisher:"vscode",engines:{vscode:""},extensionLocation:y.parse("void:location"),isBuiltin:!1,targetPlatform:"undefined",isUserBuiltin:!1,isUnderDevelopment:!1,preRelease:!1}),xV=U("extensionService"),i4=class{constructor(e){this.dependency=e}},r4;(function(e){e[e.EagerAutoStart=1]="EagerAutoStart",e[e.EagerManualStart=2]="EagerManualStart",e[e.Lazy=3]="Lazy"})(r4||(r4={}));function Ke(e,t){return e.enabledApiProposals?e.enabledApiProposals.includes(t):!1}function N(e,t){if(!(e.identifier.value==="CodeBuddy.codebuddy-remote-ssh"||e.identifier.value==="CodeBuddy.codebuddy-open-wsl")&&!Ke(e,t))throw new Error(`Extension '${e.identifier.value}' CANNOT use API proposal: ${t}.
Its package.json#enabledApiProposals-property declares: ${e.enabledApiProposals?.join(", ")??"[]"} but NOT ${t}.
 The missing proposal MUST be added and you must start in extension development mode or use the following command line switch: --enable-proposed-api ${e.identifier.value}`)}var n4;(function(e){e[e.Normal=0]="Normal",e[e.Immediate=1]="Immediate"})(n4||(n4={}));var s4;(function(e){e[e.Upsert=0]="Upsert",e[e.SetTags=1]="SetTags",e[e.UpdateCanResolveChildren=2]="UpdateCanResolveChildren",e[e.RemoveChild=3]="RemoveChild",e[e.SetProp=4]="SetProp",e[e.Bulk=5]="Bulk",e[e.DocumentSynced=6]="DocumentSynced"})(s4||(s4={}));var Bl=(e,t)=>e===t,i2={range:(e,t)=>e===t?!0:!e||!t?!1:e.equalsRange(t),busy:Bl,label:Bl,description:Bl,error:Bl,sortText:Bl,tags:(e,t)=>!(e.length!==t.length||e.some(i=>!t.includes(i)))},r2=Object.entries(i2),n2=(e,t)=>{let i;for(const[r,n]of r2)n(e[r],t[r])||(i?i[r]=t[r]:i={[r]:t[r]});return i},s2=class extends se{get root(){return this.options.root}constructor(e){super(),this.options=e,this.debounceSendDiff=this._register(new Ao(()=>this.flushDiff(),200)),this.diffOpEmitter=this._register(new P),this.tree=new Map,this.tags=new Map,this.diff=[],this.onDidGenerateDiff=this.diffOpEmitter.event,this.root.canResolveChildren=!0,this.upsertItem(this.root,void 0)}set resolveHandler(e){this._resolveHandler=e;for(const t of this.tree.values())this.updateExpandability(t)}get resolveHandler(){return this._resolveHandler}collectDiff(){const e=this.diff;return this.diff=[],e}pushDiff(e){switch(e.op){case 2:{for(const t of this.diff)if(t.op===2&&t.uri===e.uri){t.docv=e.docv;return}break}case 1:{const t=this.diff[this.diff.length-1];if(t){if(t.op===1&&t.item.extId===e.item.extId){Gm(t.item,e.item);return}if(t.op===0&&t.item.item.extId===e.item.extId){Gm(t.item,e.item);return}}break}}this.diff.push(e),this.debounceSendDiff.isScheduled()||this.debounceSendDiff.schedule()}expand(e,t){const i=this.tree.get(e);if(i){if((i.expandLevels===void 0||t>i.expandLevels)&&(i.expandLevels=t),i.expand===1){const r=this.resolveChildren(i);return r.isOpen()?this.expandChildren(i,t-1):r.wait().then(()=>this.expandChildren(i,t-1))}else if(i.expand===3)return i.resolveBarrier?.isOpen()===!1?i.resolveBarrier.wait().then(()=>this.expandChildren(i,t-1)):this.expandChildren(i,t-1)}}dispose(){for(const e of this.tree.values())this.options.getApiFor(e.actual).listener=void 0;this.tree.clear(),this.diff=[],super.dispose()}onTestItemEvent(e,t){switch(t.op){case 3:this.removeItem(Re.joinToString(e.fullId,t.id));break;case 0:this.upsertItem(t.item,e);break;case 5:for(const i of t.ops)this.onTestItemEvent(e,i);break;case 1:this.diffTagRefs(t.new,t.old,e.fullId.toString());break;case 2:this.updateExpandability(e);break;case 4:this.pushDiff({op:1,item:{extId:e.fullId.toString(),item:t.update}});break;case 6:this.documentSynced(e.actual.uri);break;default:og(t)}}documentSynced(e){e&&this.pushDiff({op:2,uri:e,docv:this.options.getDocumentVersion(e)})}upsertItem(e,t){const i=Re.fromExtHostTestItem(e,this.root.id,t?.actual),r=this.options.getApiFor(e);r.parent&&r.parent!==t?.actual&&this.options.getChildren(r.parent).delete(e.id);let n=this.tree.get(i.toString());if(!n){n={fullId:i,actual:e,expandLevels:t?.expandLevels?t.expandLevels-1:void 0,expand:0},e.tags.forEach(this.incrementTagRefs,this),this.tree.set(n.fullId.toString(),n),this.setItemParent(e,t),this.pushDiff({op:0,item:{controllerId:this.options.controllerId,expand:n.expand,item:this.options.toITestItem(e)}}),this.connectItemAndChildren(e,n,t);return}if(n.actual===e){this.connectItem(e,n,t);return}if(n.actual.uri?.toString()!==e.uri?.toString())return this.removeItem(i.toString()),this.upsertItem(e,t);const s=this.options.getChildren(n.actual),o=n.actual,a=n2(this.options.toITestItem(o),this.options.toITestItem(e));this.options.getApiFor(o).listener=void 0,n.actual=e,n.resolveBarrier=void 0,n.expand=0,a&&(a.hasOwnProperty("tags")&&(this.diffTagRefs(e.tags,o.tags,i.toString()),delete a.tags),this.onTestItemEvent(n,{op:4,update:a})),this.connectItemAndChildren(e,n,t);for(const[c,u]of s)this.options.getChildren(e).get(u.id)||this.removeItem(Re.joinToString(i,u.id));const l=n.expandLevels;l!==void 0&&queueMicrotask(()=>{n.expand===1&&(n.expandLevels=void 0,this.expand(i.toString(),l))}),this.documentSynced(n.actual.uri)}diffTagRefs(e,t,i){const r=new Set(t.map(n=>n.id));for(const n of e)r.delete(n.id)||this.incrementTagRefs(n);this.pushDiff({op:1,item:{extId:i,item:{tags:e.map(n=>qd(this.options.controllerId,n.id))}}}),r.forEach(this.decrementTagRefs,this)}incrementTagRefs(e){const t=this.tags.get(e.id);t?t.refCount++:(this.tags.set(e.id,{refCount:1}),this.pushDiff({op:6,tag:{id:qd(this.options.controllerId,e.id)}}))}decrementTagRefs(e){const t=this.tags.get(e);t&&!--t.refCount&&(this.tags.delete(e),this.pushDiff({op:7,id:qd(this.options.controllerId,e)}))}setItemParent(e,t){this.options.getApiFor(e).parent=t&&t.actual!==this.root?t.actual:void 0}connectItem(e,t,i){this.setItemParent(e,i);const r=this.options.getApiFor(e);r.parent=i?.actual,r.listener=n=>this.onTestItemEvent(t,n),this.updateExpandability(t)}connectItemAndChildren(e,t,i){this.connectItem(e,t,i);for(const[r,n]of this.options.getChildren(e))this.upsertItem(n,t)}updateExpandability(e){let t;this._resolveHandler?e.resolveBarrier?t=e.resolveBarrier.isOpen()?3:2:t=e.actual.canResolveChildren?1:0:t=0,t!==e.expand&&(e.expand=t,this.pushDiff({op:1,item:{extId:e.fullId.toString(),expand:t}}),t===1&&e.expandLevels!==void 0&&this.resolveChildren(e))}expandChildren(e,t){if(t<0)return;const i=[];for(const[r,n]of this.options.getChildren(e.actual)){const s=this.expand(Re.joinToString(e.fullId,n.id),t);An(s)&&i.push(s)}if(i.length)return Promise.all(i).then(()=>{})}resolveChildren(e){if(e.resolveBarrier)return e.resolveBarrier;if(!this._resolveHandler){const n=new Cr;return n.open(),n}e.expand=2,this.pushExpandStateUpdate(e);const t=e.resolveBarrier=new Cr,i=n=>{console.error(`Unhandled error in resolveHandler of test controller "${this.options.controllerId}"`,n)};let r;try{r=this._resolveHandler(e.actual===this.root?void 0:e.actual)}catch(n){i(n)}return An(r)?r.catch(i).then(()=>{t.open(),this.updateExpandability(e)}):(t.open(),this.updateExpandability(e)),e.resolveBarrier}pushExpandStateUpdate(e){this.pushDiff({op:1,item:{extId:e.fullId.toString(),expand:e.expand}})}removeItem(e){const t=this.tree.get(e);if(!t)throw new Error("attempting to remove non-existent child");this.pushDiff({op:3,itemId:e});const i=[t];for(;i.length;){const r=i.pop();if(r){this.options.getApiFor(r.actual).listener=void 0;for(const n of r.actual.tags)this.decrementTagRefs(n.id);this.tree.delete(r.fullId.toString());for(const[n,s]of this.options.getChildren(r.actual))i.push(this.tree.get(Re.joinToString(r.fullId,s.id)))}}}flushDiff(){const e=this.collectDiff();e.length&&this.diffOpEmitter.fire(e)}},o2=class extends Error{constructor(e){super(`Attempted to insert a duplicate test item ID ${e}`)}},Zd=class extends Error{constructor(e){super(`TestItem with ID "${e}" is invalid. Make sure to create it from the createTestItem method.`)}},a2=class extends Error{constructor(e,t,i){super(`TestItem with ID "${e}" is from controller "${t}" and cannot be added as a child of an item from controller "${i}".`)}},l2=(e,t,i)=>{let r=new Map;return{get size(){return r.size},forEach(n,s){for(const o of r.values())n.call(s,o,this)},[Symbol.iterator](){return r.entries()},replace(n){const s=new Map,o=new Set(r.keys()),a={op:5,ops:[]};for(const l of n){if(!(l instanceof i))throw new Zd(l.id);const c=t(l).controllerId;if(c!==e.controllerId)throw new a2(l.id,c,e.controllerId);if(s.has(l.id))throw new o2(l.id);s.set(l.id,l),o.delete(l.id),a.ops.push({op:0,item:l})}for(const l of o.keys())a.ops.push({op:3,id:l});e.listener?.(a),r=s},add(n){if(!(n instanceof i))throw new Zd(n.id);r.set(n.id,n),e.listener?.({op:0,item:n})},delete(n){r.delete(n)&&e.listener?.({op:3,id:n})},get(n){return r.get(n)},toJSON(){return Array.from(r.values())}}},o4=new WeakMap,c2=(e,t)=>{const i={controllerId:t};return o4.set(e,i),i},Kd=e=>{const t=o4.get(e);if(!t)throw new Zd(e?.id||"<unknown>");return t},SV=U("remoteAuthorityResolverService"),a4;(function(e){e[e.WebSocket=0]="WebSocket",e[e.Managed=1]="Managed"})(a4||(a4={}));var u2=class{constructor(e){this.id=e,this.type=1}toString(){return`Managed(${this.id})`}},d2=class{constructor(e,t){this.host=e,this.port=t,this.type=0}toString(){return`WebSocket(${this.host}:${this.port})`}},nn;(function(e){e.Unknown="Unknown",e.NotAvailable="NotAvailable",e.TemporarilyNotAvailable="TemporarilyNotAvailable",e.NoResolverFound="NoResolverFound",e.InvalidAuthority="InvalidAuthority"})(nn||(nn={}));function l4(e){const t=e.indexOf("+");return t===-1?e:e.substring(0,t)}var Ym,As,sn,ev,Rs,$n,Ls,tv,iv,Yd,Wl,rv,Ar,Rr,nv,gi,sv;function ie(e){return Object.assign(e,{apply:function(...i){if(i.length===0)return Reflect.construct(e,[]);{const r=i.length===1?[]:i[1];return Reflect.construct(e,r,i[0].constructor)}},call:function(...i){if(i.length===0)return Reflect.construct(e,[]);{const[r,...n]=i;return Reflect.construct(e,n,r.constructor)}}})}var ov;(function(e){e[e.Top=0]="Top",e[e.Bottom=1]="Bottom"})(ov||(ov={}));var c4;(function(e){e[e.TerminalCommand=0]="TerminalCommand",e[e.Opener=1]="Opener",e[e.Command=3]="Command"})(c4||(c4={}));var Ce=Ym=class{static from(...t){let i=t;return new Ym(function(){if(i){for(const r of i)r&&typeof r.dispose=="function"&&r.dispose();i=void 0}})}#e;constructor(t){this.#e=t}dispose(){typeof this.#e=="function"&&(this.#e(),this.#e=void 0)}};Ce=Ym=__decorate([ie],Ce);var Ie=As=class{static Min(...t){if(t.length===0)throw new TypeError;let i=t[0];for(let r=1;r<t.length;r++){const n=t[r];n.isBefore(i)&&(i=n)}return i}static Max(...t){if(t.length===0)throw new TypeError;let i=t[0];for(let r=1;r<t.length;r++){const n=t[r];n.isAfter(i)&&(i=n)}return i}static isPosition(t){if(!t)return!1;if(t instanceof As)return!0;const{line:i,character:r}=t;return typeof i=="number"&&typeof r=="number"}static of(t){if(t instanceof As)return t;if(this.isPosition(t))return new As(t.line,t.character);throw new Error("Invalid argument, is NOT a position-like object")}get line(){return this._line}get character(){return this._character}constructor(t,i){if(t<0)throw Se("line must be non-negative");if(i<0)throw Se("character must be non-negative");this._line=t,this._character=i}isBefore(t){return this._line<t._line?!0:t._line<this._line?!1:this._character<t._character}isBeforeOrEqual(t){return this._line<t._line?!0:t._line<this._line?!1:this._character<=t._character}isAfter(t){return!this.isBeforeOrEqual(t)}isAfterOrEqual(t){return!this.isBefore(t)}isEqual(t){return this._line===t._line&&this._character===t._character}compareTo(t){return this._line<t._line?-1:this._line>t.line?1:this._character<t._character?-1:this._character>t._character?1:0}translate(t,i=0){if(t===null||i===null)throw Se();let r;return typeof t>"u"?r=0:typeof t=="number"?r=t:(r=typeof t.lineDelta=="number"?t.lineDelta:0,i=typeof t.characterDelta=="number"?t.characterDelta:0),r===0&&i===0?this:new As(this.line+r,this.character+i)}with(t,i=this.character){if(t===null||i===null)throw Se();let r;return typeof t>"u"?r=this.line:typeof t=="number"?r=t:(r=typeof t.line=="number"?t.line:this.line,i=typeof t.character=="number"?t.character:this.character),r===this.line&&i===this.character?this:new As(r,i)}toJSON(){return{line:this.line,character:this.character}}[Symbol.for("debug.description")](){return`(${this.line}:${this.character})`}};Ie=As=__decorate([ie],Ie);var ye=sn=class{static isRange(t){return t instanceof sn?!0:t?Ie.isPosition(t.start)&&Ie.isPosition(t.end):!1}static of(t){if(t instanceof sn)return t;if(this.isRange(t))return new sn(t.start,t.end);throw new Error("Invalid argument, is NOT a range-like object")}get start(){return this._start}get end(){return this._end}constructor(t,i,r,n){let s,o;if(typeof t=="number"&&typeof i=="number"&&typeof r=="number"&&typeof n=="number"?(s=new Ie(t,i),o=new Ie(r,n)):Ie.isPosition(t)&&Ie.isPosition(i)&&(s=Ie.of(t),o=Ie.of(i)),!s||!o)throw new Error("Invalid arguments");s.isBefore(o)?(this._start=s,this._end=o):(this._start=o,this._end=s)}contains(t){return sn.isRange(t)?this.contains(t.start)&&this.contains(t.end):Ie.isPosition(t)?!(Ie.of(t).isBefore(this._start)||this._end.isBefore(t)):!1}isEqual(t){return this._start.isEqual(t._start)&&this._end.isEqual(t._end)}intersection(t){const i=Ie.Max(t.start,this._start),r=Ie.Min(t.end,this._end);if(!i.isAfter(r))return new sn(i,r)}union(t){if(this.contains(t))return this;if(t.contains(this))return t;const i=Ie.Min(t.start,this._start),r=Ie.Max(t.end,this.end);return new sn(i,r)}get isEmpty(){return this._start.isEqual(this._end)}get isSingleLine(){return this._start.line===this._end.line}with(t,i=this.end){if(t===null||i===null)throw Se();let r;return t?Ie.isPosition(t)?r=t:(r=t.start||this.start,i=t.end||this.end):r=this.start,r.isEqual(this._start)&&i.isEqual(this.end)?this:new sn(r,i)}toJSON(){return[this.start,this.end]}[Symbol.for("debug.description")](){return u4(this)}};ye=sn=__decorate([ie],ye);var on=ev=class extends ye{static isSelection(t){return t instanceof ev?!0:t?ye.isRange(t)&&Ie.isPosition(t.anchor)&&Ie.isPosition(t.active)&&typeof t.isReversed=="boolean":!1}get anchor(){return this._anchor}get active(){return this._active}constructor(t,i,r,n){let s,o;if(typeof t=="number"&&typeof i=="number"&&typeof r=="number"&&typeof n=="number"?(s=new Ie(t,i),o=new Ie(r,n)):Ie.isPosition(t)&&Ie.isPosition(i)&&(s=Ie.of(t),o=Ie.of(i)),!s||!o)throw new Error("Invalid arguments");super(s,o),this._anchor=s,this._active=o}get isReversed(){return this._anchor===this._end}toJSON(){return{start:this.start,end:this.end,active:this.active,anchor:this.anchor}}[Symbol.for("debug.description")](){return h2(this)}};on=ev=__decorate([ie],on);function u4(e){return e.isEmpty?`[${e.start.line}:${e.start.character})`:`[${e.start.line}:${e.start.character} -> ${e.end.line}:${e.end.character})`}function h2(e){let t=u4(e);return e.isEmpty||(e.active.isEqual(e.start)?t=`|${t}`:t=`${t}|`),t}var d4=e=>{if(typeof e!="string"||e.length===0||!/^[0-9A-Za-z_\-]+$/.test(e))throw Se("connectionToken")},f2=class{static isResolvedAuthority(e){return e&&typeof e=="object"&&typeof e.host=="string"&&typeof e.port=="number"&&(e.connectionToken===void 0||typeof e.connectionToken=="string")}constructor(e,t,i){if(typeof e!="string"||e.length===0)throw Se("host");if(typeof t!="number"||t===0||Math.round(t)!==t)throw Se("port");typeof i<"u"&&d4(i),this.host=e,this.port=Math.round(t),this.connectionToken=i}},eh=class{static isManagedResolvedAuthority(e){return e&&typeof e=="object"&&typeof e.makeConnection=="function"&&(e.connectionToken===void 0||typeof e.connectionToken=="string")}constructor(e,t){this.makeConnection=e,this.connectionToken=t,typeof t<"u"&&d4(t)}},Xo=class Hp extends Error{static NotAvailable(t,i){return new Hp(t,nn.NotAvailable,i)}static TemporarilyNotAvailable(t){return new Hp(t,nn.TemporarilyNotAvailable)}constructor(t,i=nn.Unknown,r){super(t),this._message=t,this._code=i,this._detail=r,Object.setPrototypeOf(this,Hp.prototype)}},ur;(function(e){e[e.LF=1]="LF",e[e.CRLF=2]="CRLF"})(ur||(ur={}));var Zo;(function(e){e[e.Replace=1]="Replace",e[e.Append=2]="Append",e[e.Prepend=3]="Prepend"})(Zo||(Zo={}));var Hn=Rs=class{static isTextEdit(t){return t instanceof Rs?!0:t?ye.isRange(t)&&typeof t.newText=="string":!1}static replace(t,i){return new Rs(t,i)}static insert(t,i){return Rs.replace(new ye(t,t),i)}static delete(t){return Rs.replace(t,"")}static setEndOfLine(t){const i=new Rs(new ye(new Ie(0,0),new Ie(0,0)),"");return i.newEol=t,i}get range(){return this._range}set range(t){if(t&&!ye.isRange(t))throw Se("range");this._range=t}get newText(){return this._newText||""}set newText(t){if(t&&typeof t!="string")throw Se("newText");this._newText=t}get newEol(){return this._newEol}set newEol(t){if(t&&typeof t!="number")throw Se("newEol");this._newEol=t}constructor(t,i){this._range=t,this._newText=i}toJSON(){return{range:this.range,newText:this.newText,newEol:this._newEol}}};Hn=Rs=__decorate([ie],Hn);var th=$n=class{static isNotebookCellEdit(t){return t instanceof $n?!0:t?ln.isNotebookRange(t)&&Array.isArray(t.newCells):!1}static replaceCells(t,i){return new $n(t,i)}static insertCells(t,i){return new $n(new ln(t,t),i)}static deleteCells(t){return new $n(t,[])}static updateCellMetadata(t,i){const r=new $n(new ln(t,t),[]);return r.newCellMetadata=i,r}static updateNotebookMetadata(t){const i=new $n(new ln(0,0),[]);return i.newNotebookMetadata=t,i}constructor(t,i){this.range=t,this.newCells=i}};th=$n=__decorate([ie],th);var av=class Up{static isSnippetTextEdit(t){return t instanceof Up?!0:t?ye.isRange(t.range)&&Ms.isSnippetString(t.snippet):!1}static replace(t,i){return new Up(t,i)}static insert(t,i){return Up.replace(new ye(t,t),i)}constructor(t,i){this.range=t,this.snippet=i}},h4;(function(e){e[e.File=1]="File",e[e.Text=2]="Text",e[e.Cell=3]="Cell",e[e.CellReplace=5]="CellReplace",e[e.Snippet=6]="Snippet"})(h4||(h4={}));var Ns=class{constructor(){this._edits=[]}_allEntries(){return this._edits}renameFile(t,i,r,n){this._edits.push({_type:1,from:t,to:i,options:r,metadata:n})}createFile(t,i,r){this._edits.push({_type:1,from:void 0,to:t,options:i,metadata:r})}deleteFile(t,i,r){this._edits.push({_type:1,from:t,to:void 0,options:i,metadata:r})}replaceNotebookMetadata(t,i,r){this._edits.push({_type:3,metadata:r,uri:t,edit:{editType:5,metadata:i}})}replaceNotebookCells(t,i,r,n){const s=i.start,o=i.end;(s!==o||r.length>0)&&this._edits.push({_type:5,uri:t,index:s,count:o-s,cells:r,metadata:n})}replaceNotebookCellMetadata(t,i,r,n){this._edits.push({_type:3,metadata:n,uri:t,edit:{editType:3,index:i,metadata:r}})}replace(t,i,r,n){this._edits.push({_type:2,uri:t,edit:new Hn(i,r),metadata:n})}insert(t,i,r,n){this.replace(t,new ye(i,i),r,n)}delete(t,i,r){this.replace(t,i,"",r)}has(t){return this._edits.some(i=>i._type===2&&i.uri.toString()===t.toString())}set(t,i){if(i)for(const r of i){if(!r)continue;let n,s;Array.isArray(r)?(n=r[0],s=r[1]):n=r,th.isNotebookCellEdit(n)?n.newCellMetadata?this.replaceNotebookCellMetadata(t,n.range.start,n.newCellMetadata,s):n.newNotebookMetadata?this.replaceNotebookMetadata(t,n.newNotebookMetadata,s):this.replaceNotebookCells(t,n.range,n.newCells,s):av.isSnippetTextEdit(n)?this._edits.push({_type:6,uri:t,range:n.range,edit:n.snippet,metadata:s,keepWhitespace:n.keepWhitespace}):this._edits.push({_type:2,uri:t,edit:n,metadata:s})}else{for(let r=0;r<this._edits.length;r++){const n=this._edits[r];switch(n._type){case 2:case 6:case 3:case 5:n.uri.toString()===t.toString()&&(this._edits[r]=void 0);break}}a9(this._edits)}}get(t){const i=[];for(const r of this._edits)r._type===2&&r.uri.toString()===t.toString()&&i.push(r.edit);return i}entries(){const t=new Ft;for(const i of this._edits)if(i._type===2){let r=t.get(i.uri);r||(r=[i.uri,[]],t.set(i.uri,r)),r[1].push(i.edit)}return[...t.values()]}get size(){return this.entries().length}toJSON(){return this.entries()}};Ns=__decorate([ie],Ns);var Ms=Ls=class{static isSnippetString(t){return t instanceof Ls?!0:t?typeof t.value=="string":!1}static _escape(t){return t.replace(/\$|}|\\/g,"\\$&")}constructor(t){this._tabstop=1,this.value=t||""}appendText(t){return this.value+=Ls._escape(t),this}appendTabstop(t=this._tabstop++){return this.value+="$",this.value+=t,this}appendPlaceholder(t,i=this._tabstop++){if(typeof t=="function"){const r=new Ls;r._tabstop=this._tabstop,t(r),this._tabstop=r._tabstop,t=r.value}else t=Ls._escape(t);return this.value+="${",this.value+=i,this.value+=":",this.value+=t,this.value+="}",this}appendChoice(t,i=this._tabstop++){const r=t.map(n=>n.replaceAll(/[|\\,]/g,"\\$&")).join(",");return this.value+="${",this.value+=i,this.value+="|",this.value+=r,this.value+="|}",this}appendVariable(t,i){if(typeof i=="function"){const r=new Ls;r._tabstop=this._tabstop,i(r),this._tabstop=r._tabstop,i=r.value}else typeof i=="string"&&(i=i.replace(/\$|}/g,"\\$&"));return this.value+="${",this.value+=t,i&&(this.value+=":",this.value+=i),this.value+="}",this}};Ms=Ls=__decorate([ie],Ms);var Os;(function(e){e[e.Unnecessary=1]="Unnecessary",e[e.Deprecated=2]="Deprecated"})(Os||(Os={}));var ei;(function(e){e[e.Hint=3]="Hint",e[e.Information=2]="Information",e[e.Warning=1]="Warning",e[e.Error=0]="Error"})(ei||(ei={}));var Wi=tv=class{static isLocation(t){return t instanceof tv?!0:t?ye.isRange(t.range)&&y.isUri(t.uri):!1}constructor(t,i){if(this.uri=t,i)if(ye.isRange(i))this.range=ye.of(i);else if(Ie.isPosition(i))this.range=new ye(i,i);else throw new Error("Illegal argument")}toJSON(){return{uri:this.uri,range:this.range}}};Wi=tv=__decorate([ie],Wi);var Vl=class{static is(t){return t?typeof t.message=="string"&&t.location&&ye.isRange(t.location.range)&&y.isUri(t.location.uri):!1}constructor(t,i){this.location=t,this.message=i}static isEqual(t,i){return t===i?!0:!t||!i?!1:t.message===i.message&&t.location.range.isEqual(i.location.range)&&t.location.uri.toString()===i.location.uri.toString()}};Vl=__decorate([ie],Vl);var ih=class{constructor(t,i,r=ei.Error){if(!ye.isRange(t))throw new TypeError("range must be set");if(!i)throw new TypeError("message must be set");this.range=t,this.message=i,this.severity=r}toJSON(){return{severity:ei[this.severity],message:this.message,range:this.range,source:this.source,code:this.code}}static isEqual(t,i){return t===i?!0:!t||!i?!1:t.message===i.message&&t.severity===i.severity&&t.code===i.code&&t.severity===i.severity&&t.source===i.source&&t.range.isEqual(i.range)&&Sr(t.tags,i.tags)&&Sr(t.relatedInformation,i.relatedInformation,Vl.isEqual)}};ih=__decorate([ie],ih);var rh=class{constructor(t,i){if(!t)throw new Error("Illegal argument, contents must be defined");Array.isArray(t)?this.contents=t:this.contents=[t],this.range=i}};rh=__decorate([ie],rh);var nh=class extends rh{constructor(t,i,r,n){super(t,i),this.canIncreaseVerbosity=r,this.canDecreaseVerbosity=n}};nh=__decorate([ie],nh);var lv;(function(e){e[e.Increase=0]="Increase",e[e.Decrease=1]="Decrease"})(lv||(lv={}));var zl;(function(e){e[e.Text=0]="Text",e[e.Read=1]="Read",e[e.Write=2]="Write"})(zl||(zl={}));var sh=class{constructor(t,i=zl.Text){this.range=t,this.kind=i}toJSON(){return{range:this.range,kind:zl[this.kind]}}};sh=__decorate([ie],sh);var oh=class{constructor(t,i){this.uri=t,this.highlights=i}toJSON(){return{uri:this.uri,highlights:this.highlights.map(t=>t.toJSON())}}};oh=__decorate([ie],oh);var et;(function(e){e[e.File=0]="File",e[e.Module=1]="Module",e[e.Namespace=2]="Namespace",e[e.Package=3]="Package",e[e.Class=4]="Class",e[e.Method=5]="Method",e[e.Property=6]="Property",e[e.Field=7]="Field",e[e.Constructor=8]="Constructor",e[e.Enum=9]="Enum",e[e.Interface=10]="Interface",e[e.Function=11]="Function",e[e.Variable=12]="Variable",e[e.Constant=13]="Constant",e[e.String=14]="String",e[e.Number=15]="Number",e[e.Boolean=16]="Boolean",e[e.Array=17]="Array",e[e.Object=18]="Object",e[e.Key=19]="Key",e[e.Null=20]="Null",e[e.EnumMember=21]="EnumMember",e[e.Struct=22]="Struct",e[e.Event=23]="Event",e[e.Operator=24]="Operator",e[e.TypeParameter=25]="TypeParameter"})(et||(et={}));var ql;(function(e){e[e.Deprecated=1]="Deprecated"})(ql||(ql={}));var jl=iv=class{static validate(t){if(!t.name)throw new Error("name must not be falsy")}constructor(t,i,r,n,s){this.name=t,this.kind=i,this.containerName=s,typeof r=="string"&&(this.containerName=r),n instanceof Wi?this.location=n:r instanceof ye&&(this.location=new Wi(n,r)),iv.validate(this)}toJSON(){return{name:this.name,kind:et[this.kind],location:this.location,containerName:this.containerName}}};jl=iv=__decorate([ie],jl);var Gl=Yd=class{static validate(t){if(!t.name)throw new Error("name must not be falsy");if(!t.range.contains(t.selectionRange))throw new Error("selectionRange must be contained in fullRange");t.children?.forEach(Yd.validate)}constructor(t,i,r,n,s){this.name=t,this.detail=i,this.kind=r,this.range=n,this.selectionRange=s,this.children=[],Yd.validate(this)}};Gl=Yd=__decorate([ie],Gl);var Ql;(function(e){e[e.Invoke=1]="Invoke",e[e.Automatic=2]="Automatic"})(Ql||(Ql={}));var Jl=class{constructor(t,i){this.title=t,this.kind=i}};Jl=__decorate([ie],Jl);var dt=class{static{Wl=this}static{this.sep="."}constructor(t){this.value=t}append(t){return new Wl(this.value?this.value+Wl.sep+t:t)}intersects(t){return this.contains(t)||t.contains(this)}contains(t){return this.value===t.value||t.value.startsWith(this.value+Wl.sep)}};dt=Wl=__decorate([ie],dt),dt.Empty=new dt(""),dt.QuickFix=dt.Empty.append("quickfix"),dt.Refactor=dt.Empty.append("refactor"),dt.RefactorExtract=dt.Refactor.append("extract"),dt.RefactorInline=dt.Refactor.append("inline"),dt.RefactorMove=dt.Refactor.append("move"),dt.RefactorRewrite=dt.Refactor.append("rewrite"),dt.Source=dt.Empty.append("source"),dt.SourceOrganizeImports=dt.Source.append("organizeImports"),dt.SourceFixAll=dt.Source.append("fixAll"),dt.Notebook=dt.Empty.append("notebook");var Xl=class{constructor(t,i){if(this.range=t,this.parent=i,i&&!i.range.contains(this.range))throw new Error("Invalid argument: parent must contain this range")}};Xl=__decorate([ie],Xl);var cv=class{constructor(e,t,i,r,n,s){this.kind=e,this.name=t,this.detail=i,this.uri=r,this.range=n,this.selectionRange=s}},f4=class{constructor(e,t){this.fromRanges=t,this.from=e}},p4=class{constructor(e,t){this.fromRanges=t,this.to=e}},Ko;(function(e){e[e.Information=0]="Information",e[e.Warning=1]="Warning",e[e.Error=2]="Error"})(Ko||(Ko={}));var ah=class{constructor(t,i){this.range=t,this.command=i}get isResolved(){return!!this.command}};ah=__decorate([ie],ah);var mi=rv=class{#e;static isMarkdownString(t){return t instanceof rv?!0:t&&t.appendCodeblock&&t.appendMarkdown&&t.appendText&&t.value!==void 0}constructor(t,i=!1){this.#e=new $o(t,{supportThemeIcons:i})}get value(){return this.#e.value}set value(t){this.#e.value=t}get isTrusted(){return this.#e.isTrusted}set isTrusted(t){this.#e.isTrusted=t}get supportThemeIcons(){return this.#e.supportThemeIcons}set supportThemeIcons(t){this.#e.supportThemeIcons=t}get supportHtml(){return this.#e.supportHtml}set supportHtml(t){this.#e.supportHtml=t}get baseUri(){return this.#e.baseUri}set baseUri(t){this.#e.baseUri=t}appendText(t){return this.#e.appendText(t),this}appendMarkdown(t){return this.#e.appendMarkdown(t),this}appendCodeblock(t,i){return this.#e.appendCodeblock(i??"",t),this}};mi=rv=__decorate([ie],mi);var uv=class{constructor(t,i){this.label=t,this.documentation=i}};uv=__decorate([ie],uv);var dv=class{constructor(t,i){this.label=t,this.documentation=i,this.parameters=[]}};dv=__decorate([ie],dv);var hv=class{constructor(){this.activeSignature=0,this.activeParameter=0,this.signatures=[]}};hv=__decorate([ie],hv);var fv;(function(e){e[e.Invoke=1]="Invoke",e[e.TriggerCharacter=2]="TriggerCharacter",e[e.ContentChange=3]="ContentChange"})(fv||(fv={}));var pv;(function(e){e[e.Type=1]="Type",e[e.Parameter=2]="Parameter"})(pv||(pv={}));var lh=class{constructor(t){this.value=t}};lh=__decorate([ie],lh);var ch=class{constructor(t,i,r){this.position=t,this.label=i,this.kind=r}};ch=__decorate([ie],ch);var Yo;(function(e){e[e.Invoke=0]="Invoke",e[e.TriggerCharacter=1]="TriggerCharacter",e[e.TriggerForIncompleteCompletions=2]="TriggerForIncompleteCompletions"})(Yo||(Yo={}));var le;(function(e){e[e.Text=0]="Text",e[e.Method=1]="Method",e[e.Function=2]="Function",e[e.Constructor=3]="Constructor",e[e.Field=4]="Field",e[e.Variable=5]="Variable",e[e.Class=6]="Class",e[e.Interface=7]="Interface",e[e.Module=8]="Module",e[e.Property=9]="Property",e[e.Unit=10]="Unit",e[e.Value=11]="Value",e[e.Enum=12]="Enum",e[e.Keyword=13]="Keyword",e[e.Snippet=14]="Snippet",e[e.Color=15]="Color",e[e.File=16]="File",e[e.Reference=17]="Reference",e[e.Folder=18]="Folder",e[e.EnumMember=19]="EnumMember",e[e.Constant=20]="Constant",e[e.Struct=21]="Struct",e[e.Event=22]="Event",e[e.Operator=23]="Operator",e[e.TypeParameter=24]="TypeParameter",e[e.User=25]="User",e[e.Issue=26]="Issue"})(le||(le={}));var Zl;(function(e){e[e.Deprecated=1]="Deprecated"})(Zl||(Zl={}));var uh=class{constructor(t,i){this.label=t,this.kind=i}toJSON(){return{label:this.label,kind:this.kind&&le[this.kind],detail:this.detail,documentation:this.documentation,sortText:this.sortText,filterText:this.filterText,preselect:this.preselect,insertText:this.insertText,textEdit:this.textEdit}}};uh=__decorate([ie],uh);var ea=class{constructor(t=[],i=!1){this.items=t,this.isIncomplete=i}};ea=__decorate([ie],ea);var gv=class{constructor(t,i,r){this.insertText=t,this.range=i,this.command=r}};gv=__decorate([ie],gv);var mv=class{constructor(t){this.commands=void 0,this.suppressSuggestions=void 0,this.items=t}};mv=__decorate([ie],mv);var Fs;(function(e){e[e.Unknown=0]="Unknown",e[e.Word=1]="Word",e[e.Line=2]="Line",e[e.Suggest=3]="Suggest"})(Fs||(Fs={}));var ta;(function(e){e[e.Accepted=0]="Accepted",e[e.Rejected=1]="Rejected",e[e.Ignored=2]="Ignored"})(ta||(ta={}));var Kl;(function(e){e[e.Active=-1]="Active",e[e.Beside=-2]="Beside",e[e.One=1]="One",e[e.Two=2]="Two",e[e.Three=3]="Three",e[e.Four=4]="Four",e[e.Five=5]="Five",e[e.Six=6]="Six",e[e.Seven=7]="Seven",e[e.Eight=8]="Eight",e[e.Nine=9]="Nine"})(Kl||(Kl={}));var Un;(function(e){e[e.Left=1]="Left",e[e.Right=2]="Right"})(Un||(Un={}));function p2(e,t){return`${Oe.toKey(e)}.${t}`}var dr;(function(e){e[e.Off=0]="Off",e[e.On=1]="On",e[e.Relative=2]="Relative",e[e.Interval=3]="Interval"})(dr||(dr={}));var ia;(function(e){e[e.Manual=1]="Manual",e[e.AfterDelay=2]="AfterDelay",e[e.FocusOut=3]="FocusOut"})(ia||(ia={}));var dh;(function(e){e[e.Default=0]="Default",e[e.InCenter=1]="InCenter",e[e.InCenterIfOutsideViewport=2]="InCenterIfOutsideViewport",e[e.AtTop=3]="AtTop"})(dh||(dh={}));var ra;(function(e){e[e.Keyboard=1]="Keyboard",e[e.Mouse=2]="Mouse",e[e.Command=3]="Command"})(ra||(ra={}));var na;(function(e){e[e.Addition=1]="Addition",e[e.Deletion=2]="Deletion",e[e.Modification=3]="Modification"})(na||(na={}));var Yl;(function(e){e[e.Undo=1]="Undo",e[e.Redo=2]="Redo"})(Yl||(Yl={}));var $s;(function(e){e[e.OpenOpen=0]="OpenOpen",e[e.ClosedClosed=1]="ClosedClosed",e[e.OpenClosed=2]="OpenClosed",e[e.ClosedOpen=3]="ClosedOpen"})($s||($s={})),function(e){function t(i){switch(i){case"keyboard":return e.Keyboard;case"mouse":return e.Mouse;case"api":case"code.jump":case"code.navigation":return e.Command}}e.fromValue=t}(ra||(ra={}));var sa;(function(e){e[e.Other=0]="Other",e[e.Comment=1]="Comment",e[e.String=2]="String",e[e.RegEx=3]="RegEx"})(sa||(sa={})),function(e){function t(i){switch(i){case e.Other:return"other";case e.Comment:return"comment";case e.String:return"string";case e.RegEx:return"regex"}return"other"}e.toString=t}(sa||(sa={}));var hh=class{constructor(t,i){if(i&&!y.isUri(i))throw Se("target");if(!ye.isRange(t)||t.isEmpty)throw Se("range");this.range=t,this.target=i}};hh=__decorate([ie],hh);var oa=class{constructor(t,i,r,n){this.red=t,this.green=i,this.blue=r,this.alpha=n}};oa=__decorate([ie],oa);var fh=class{constructor(t,i){if(i&&!(i instanceof oa))throw Se("color");if(!ye.isRange(t)||t.isEmpty)throw Se("range");this.range=t,this.color=i}};fh=__decorate([ie],fh);var ph=class{constructor(t){if(!t||typeof t!="string")throw Se("label");this.label=t}};ph=__decorate([ie],ph);var g4;(function(e){e[e.RGB=0]="RGB",e[e.HEX=1]="HEX",e[e.HSL=2]="HSL"})(g4||(g4={}));var vv;(function(e){e[e.Error=0]="Error",e[e.Warning=1]="Warning",e[e.Information=2]="Information"})(vv||(vv={}));var _v;(function(e){e[e.Unknown=0]="Unknown",e[e.Shutdown=1]="Shutdown",e[e.Process=2]="Process",e[e.User=3]="User",e[e.Extension=4]="Extension"})(_v||(_v={}));var ec;(function(e){e[e.Low=0]="Low",e[e.Medium=1]="Medium",e[e.High=2]="High"})(ec||(ec={}));var wv;(function(e){e[e.Sh=1]="Sh",e[e.Bash=2]="Bash",e[e.Fish=3]="Fish",e[e.Csh=4]="Csh",e[e.Ksh=5]="Ksh",e[e.Zsh=6]="Zsh",e[e.CommandPrompt=7]="CommandPrompt",e[e.GitBash=8]="GitBash",e[e.PowerShell=9]="PowerShell",e[e.Python=10]="Python",e[e.Julia=11]="Julia",e[e.NuShell=12]="NuShell",e[e.Node=13]="Node"})(wv||(wv={}));var g2=class{constructor(e,t,i){if(this.startIndex=e,this.length=t,this.tooltip=i,typeof e!="number"||e<0)throw Se("startIndex");if(typeof t!="number"||t<1)throw Se("length");if(i!==void 0&&typeof i!="string")throw Se("tooltip")}},m2=class{constructor(e){this.uri=e}},v2=class{constructor(e){this.terminalCommand=e}},yv;(function(e){e[e.Panel=1]="Panel",e[e.Editor=2]="Editor"})(yv||(yv={}));var _2=class{constructor(e){if(this.options=e,typeof e!="object")throw Se("options")}},bv;(function(e){e[e.File=0]="File",e[e.Folder=1]="Folder",e[e.Method=2]="Method",e[e.Alias=3]="Alias",e[e.Argument=4]="Argument",e[e.Option=5]="Option",e[e.OptionValue=6]="OptionValue",e[e.Flag=7]="Flag"})(bv||(bv={}));var w2=class{constructor(e,t,i,r,n,s,o,a,l){this.label=e,this.icon=t,this.detail=i,this.documentation=r,this.isFile=n,this.isDirectory=s,this.isKeyword=o,this.replacementIndex=a??0,this.replacementLength=l??0}},y2=class{constructor(e,t){this.items=e??[],this.resourceRequestConfig=t}},xv;(function(e){e[e.Always=1]="Always",e[e.Silent=2]="Silent",e[e.Never=3]="Never"})(xv||(xv={}));var Sv;(function(e){e.Changed="changed",e.ProcessStarted="processStarted",e.ProcessEnded="processEnded",e.Terminated="terminated",e.Start="start",e.AcquiredInput="acquiredInput",e.DependsOnStarted="dependsOnStarted",e.Active="active",e.Inactive="inactive",e.End="end",e.ProblemMatcherStarted="problemMatcherStarted",e.ProblemMatcherEnded="problemMatcherEnded",e.ProblemMatcherFoundErrors="problemMatcherFoundErrors"})(Sv||(Sv={}));var Ev;(function(e){e[e.Shared=1]="Shared",e[e.Dedicated=2]="Dedicated",e[e.New=3]="New"})(Ev||(Ev={}));var tc=class{static{Ar=this}static{this.Clean=new Ar("clean","Clean")}static{this.Build=new Ar("build","Build")}static{this.Rebuild=new Ar("rebuild","Rebuild")}static{this.Test=new Ar("test","Test")}static from(t){switch(t){case"clean":return Ar.Clean;case"build":return Ar.Build;case"rebuild":return Ar.Rebuild;case"test":return Ar.Test;default:return}}constructor(t,i){if(this.label=i,typeof t!="string"||typeof i!="string")throw Se("name");this._id=t}get id(){return this._id}};tc=Ar=__decorate([ie],tc);function m4(e){let t="";for(let i=0;i<e.length;i++)t+=e[i].replace(/,/g,",,")+",";return t}var aa=class{constructor(t,i,r){if(typeof t!="string")throw Se("process");this._args=[],this._process=t,i!==void 0&&(Array.isArray(i)?(this._args=i,this._options=r):this._options=i)}get process(){return this._process}set process(t){if(typeof t!="string")throw Se("process");this._process=t}get args(){return this._args}set args(t){Array.isArray(t)||(t=[]),this._args=t}get options(){return this._options}set options(t){this._options=t}computeId(){const t=[];if(t.push("process"),this._process!==void 0&&t.push(this._process),this._args&&this._args.length>0)for(const i of this._args)t.push(i);return m4(t)}};aa=__decorate([ie],aa);var Hs=class{constructor(t,i,r){if(this._args=[],Array.isArray(i)){if(!t)throw Se("command can't be undefined or null");if(typeof t!="string"&&typeof t.value!="string")throw Se("command");this._command=t,i&&(this._args=i),this._options=r}else{if(typeof t!="string")throw Se("commandLine");this._commandLine=t,this._options=i}}get commandLine(){return this._commandLine}set commandLine(t){if(typeof t!="string")throw Se("commandLine");this._commandLine=t}get command(){return this._command?this._command:""}set command(t){if(typeof t!="string"&&typeof t.value!="string")throw Se("command");this._command=t}get args(){return this._args}set args(t){this._args=t||[]}get options(){return this._options}set options(t){this._options=t}computeId(){const t=[];if(t.push("shell"),this._commandLine!==void 0&&t.push(this._commandLine),this._command!==void 0&&t.push(typeof this._command=="string"?this._command:this._command.value),this._args&&this._args.length>0)for(const i of this._args)t.push(typeof i=="string"?i:i.value);return m4(t)}};Hs=__decorate([ie],Hs);var Cv;(function(e){e[e.Escape=1]="Escape",e[e.Strong=2]="Strong",e[e.Weak=3]="Weak"})(Cv||(Cv={}));var Bn;(function(e){e[e.Global=1]="Global",e[e.Workspace=2]="Workspace"})(Bn||(Bn={}));var Dv=class{constructor(e){this._callback=e}computeId(){return"customExecution"+$t()}set callback(e){this._callback=e}get callback(){return this._callback}},gh=class{static{Rr=this}static{this.ExtensionCallbackType="customExecution"}static{this.ProcessType="process"}static{this.ShellType="shell"}static{this.EmptyType="$empty"}constructor(t,i,r,n,s,o){this.__deprecated=!1,this._definition=this.definition=t;let a;typeof i=="string"?(this._name=this.name=i,this._source=this.source=r,this.execution=n,a=s,this.__deprecated=!0):i===Bn.Global||i===Bn.Workspace?(this.target=i,this._name=this.name=r,this._source=this.source=n,this.execution=s,a=o):(this.target=i,this._name=this.name=r,this._source=this.source=n,this.execution=s,a=o),typeof a=="string"?(this._problemMatchers=[a],this._hasDefinedMatchers=!0):Array.isArray(a)?(this._problemMatchers=a,this._hasDefinedMatchers=!0):(this._problemMatchers=[],this._hasDefinedMatchers=!1),this._isBackground=!1,this._presentationOptions=Object.create(null),this._runOptions=Object.create(null)}get _id(){return this.__id}set _id(t){this.__id=t}get _deprecated(){return this.__deprecated}clear(){this.__id!==void 0&&(this.__id=void 0,this._scope=void 0,this.computeDefinitionBasedOnExecution())}computeDefinitionBasedOnExecution(){this._execution instanceof aa?this._definition={type:Rr.ProcessType,id:this._execution.computeId()}:this._execution instanceof Hs?this._definition={type:Rr.ShellType,id:this._execution.computeId()}:this._execution instanceof Dv?this._definition={type:Rr.ExtensionCallbackType,id:this._execution.computeId()}:this._definition={type:Rr.EmptyType,id:$t()}}get definition(){return this._definition}set definition(t){if(t==null)throw Se("Kind can't be undefined or null");this.clear(),this._definition=t}get scope(){return this._scope}set target(t){this.clear(),this._scope=t}get name(){return this._name}set name(t){if(typeof t!="string")throw Se("name");this.clear(),this._name=t}get execution(){return this._execution}set execution(t){t===null&&(t=void 0),this.clear(),this._execution=t;const i=this._definition.type;(Rr.EmptyType===i||Rr.ProcessType===i||Rr.ShellType===i||Rr.ExtensionCallbackType===i)&&this.computeDefinitionBasedOnExecution()}get problemMatchers(){return this._problemMatchers}set problemMatchers(t){if(Array.isArray(t))this.clear(),this._problemMatchers=t,this._hasDefinedMatchers=!0;else{this.clear(),this._problemMatchers=[],this._hasDefinedMatchers=!1;return}}get hasDefinedMatchers(){return this._hasDefinedMatchers}get isBackground(){return this._isBackground}set isBackground(t){t!==!0&&t!==!1&&(t=!1),this.clear(),this._isBackground=t}get source(){return this._source}set source(t){if(typeof t!="string"||t.length===0)throw Se("source must be a string of length > 0");this.clear(),this._source=t}get group(){return this._group}set group(t){t===null&&(t=void 0),this.clear(),this._group=t}get detail(){return this._detail}set detail(t){t===null&&(t=void 0),this._detail=t}get presentationOptions(){return this._presentationOptions}set presentationOptions(t){t==null&&(t=Object.create(null)),this.clear(),this._presentationOptions=t}get runOptions(){return this._runOptions}set runOptions(t){t==null&&(t=Object.create(null)),this.clear(),this._runOptions=t}};gh=Rr=__decorate([ie],gh);var Us;(function(e){e[e.SourceControl=1]="SourceControl",e[e.Window=10]="Window",e[e.Notification=15]="Notification"})(Us||(Us={}));var Iv;(function(e){function t(i){const r=i;return ls(r.value)?r.tooltip&&!Me(r.tooltip)?(console.log("INVALID view badge, invalid tooltip",r.tooltip),!1):!0:(console.log("INVALID view badge, invalid value",r.value),!1)}e.isViewBadge=t})(Iv||(Iv={}));var mh=nv=class{static isTreeItem(t,i){const r=t;if(r.checkboxState!==void 0){const n=ls(r.checkboxState)?r.checkboxState:St(r.checkboxState)&&ls(r.checkboxState.state)?r.checkboxState.state:void 0,s=!ls(r.checkboxState)&&St(r.checkboxState)?r.checkboxState.tooltip:void 0;if(n===void 0||n!==Lr.Checked&&n!==Lr.Unchecked||s!==void 0&&!Me(s))return console.log("INVALID tree item, invalid checkboxState",r.checkboxState),!1}if(t instanceof nv)return!0;if(r.label!==void 0&&!Me(r.label)&&!r.label?.label)return console.log("INVALID tree item, invalid label",r.label),!1;if(r.id!==void 0&&!Me(r.id))return console.log("INVALID tree item, invalid id",r.id),!1;if(r.iconPath!==void 0&&!Me(r.iconPath)&&!y.isUri(r.iconPath)&&(!r.iconPath||!Me(r.iconPath.id))){const n=r.iconPath;if(!n||!Me(n.light)&&!y.isUri(n.light)&&!Me(n.dark)&&!y.isUri(n.dark))return console.log("INVALID tree item, invalid iconPath",r.iconPath),!1}return r.description!==void 0&&!Me(r.description)&&typeof r.description!="boolean"?(console.log("INVALID tree item, invalid description",r.description),!1):r.resourceUri!==void 0&&!y.isUri(r.resourceUri)?(console.log("INVALID tree item, invalid resourceUri",r.resourceUri),!1):r.tooltip!==void 0&&!Me(r.tooltip)&&!(r.tooltip instanceof mi)?(console.log("INVALID tree item, invalid tooltip",r.tooltip),!1):r.command!==void 0&&!r.command.command?(console.log("INVALID tree item, invalid command",r.command),!1):r.collapsibleState!==void 0&&r.collapsibleState<Bs.None&&r.collapsibleState>Bs.Expanded?(console.log("INVALID tree item, invalid collapsibleState",r.collapsibleState),!1):r.contextValue!==void 0&&!Me(r.contextValue)?(console.log("INVALID tree item, invalid contextValue",r.contextValue),!1):r.accessibilityInformation!==void 0&&!r.accessibilityInformation?.label?(console.log("INVALID tree item, invalid accessibilityInformation",r.accessibilityInformation),!1):!0}constructor(t,i=Bs.None){this.collapsibleState=i,y.isUri(t)?this.resourceUri=t:this.label=t}};mh=nv=__decorate([ie],mh);var Bs;(function(e){e[e.None=0]="None",e[e.Collapsed=1]="Collapsed",e[e.Expanded=2]="Expanded"})(Bs||(Bs={}));var Lr;(function(e){e[e.Unchecked=0]="Unchecked",e[e.Checked=1]="Checked"})(Lr||(Lr={}));var vh=class{async asString(){return typeof this.value=="string"?this.value:JSON.stringify(this.value)}asFile(){}constructor(t){this.value=t}};vh=__decorate([ie],vh);var _h=class extends vh{},b2=class extends _h{#e;constructor(e){super(""),this.#e=e}asFile(){return this.#e}},x2=class{constructor(e,t,i,r){this.name=e,this.uri=t,this._itemId=i,this._getData=r}data(){return this._getData()}},la=class{#e=new Map;constructor(t){for(const[i,r]of t??[]){const n=this.#e.get(this.#t(i));n?n.push(r):this.#e.set(this.#t(i),[r])}}get(t){return this.#e.get(this.#t(t))?.[0]}set(t,i){this.#e.set(this.#t(t),[i])}forEach(t,i){for(const[r,n]of this.#e)for(const s of n)t.call(i,s,r,this)}*[Symbol.iterator](){for(const[t,i]of this.#e)for(const r of i)yield[t,r]}#t(t){return t.toLowerCase()}};la=__decorate([ie],la);var kv=class{constructor(t,i,r){this.insertText=t,this.title=i,this.kind=r}};kv=__decorate([ie],kv);var Pv;(function(e){e[e.Automatic=0]="Automatic",e[e.PasteAs=1]="PasteAs"})(Pv||(Pv={}));var Wn=class Bp{static{this.sep="."}constructor(t){this.value=t}append(...t){return new Bp((this.value?[this.value,...t]:t).join(Bp.sep))}intersects(t){return this.contains(t)||t.contains(this)}contains(t){return this.value===t.value||t.value.startsWith(this.value+Bp.sep)}};Wn.Empty=new Wn(""),Wn.Text=new Wn("text"),Wn.TextUpdateImports=Wn.Text.append("updateImports");var S2=class{constructor(e,t,i){this.title=t,this.insertText=e,this.kind=i}},ci=class{constructor(t,i){this.id=t,this.color=i}static isThemeIcon(t){return typeof t.id!="string"?(console.log("INVALID ThemeIcon, invalid id",t.id),!1):!0}};ci=__decorate([ie],ci),ci.File=new ci("file"),ci.Folder=new ci("folder");var ic=class{constructor(t){this.id=t}};ic=__decorate([ie],ic);var ca;(function(e){e[e.Global=1]="Global",e[e.Workspace=2]="Workspace",e[e.WorkspaceFolder=3]="WorkspaceFolder"})(ca||(ca={}));var ua=class{get base(){return this._base}set base(t){this._base=t,this._baseUri=y.file(t)}get baseUri(){return this._baseUri}set baseUri(t){this._baseUri=t,this._base=t.fsPath}constructor(t,i){if(typeof t!="string"&&(!t||!y.isUri(t)&&!y.isUri(t.uri)))throw Se("base");if(typeof i!="string")throw Se("pattern");typeof t=="string"?this.baseUri=y.file(t):y.isUri(t)?this.baseUri=t:this.baseUri=t.uri,this.pattern=i}toJSON(){return{pattern:this.pattern,base:this.base,baseUri:this.baseUri.toJSON()}}};ua=__decorate([ie],ua);var v4=new WeakMap;function E2(e,t){v4.set(e,t)}var da=class{constructor(t,i,r,n,s){this.enabled=typeof t=="boolean"?t:!0,typeof i=="string"&&(this.condition=i),typeof r=="string"&&(this.hitCondition=r),typeof n=="string"&&(this.logMessage=n),typeof s=="string"&&(this.mode=s)}get id(){return this._id||(this._id=v4.get(this)??$t()),this._id}};da=__decorate([ie],da);var Ws=class extends da{constructor(t,i,r,n,s,o){if(super(i,r,n,s,o),t===null)throw Se("location");this.location=t}};Ws=__decorate([ie],Ws);var Vs=class extends da{constructor(t,i,r,n,s,o){super(i,r,n,s,o),this.functionName=t}};Vs=__decorate([ie],Vs);var wh=class extends da{constructor(t,i,r,n,s,o,a,l){if(super(n,s,o,a,l),!i)throw Se("dataId");this.label=t,this.dataId=i,this.canPersist=r}};wh=__decorate([ie],wh);var yh=class{constructor(t,i,r){this.command=t,this.args=i||[],this.options=r}};yh=__decorate([ie],yh);var rc=class{constructor(t,i){this.port=t,this.host=i}};rc=__decorate([ie],rc);var bh=class{constructor(t){this.path=t}};bh=__decorate([ie],bh);var nc=class{constructor(t){this.implementation=t}};nc=__decorate([ie],nc);var _4=class{constructor(e,t,i){this.session=e,this.threadId=t,this.frameId=i}},w4=class{constructor(e,t){this.session=e,this.threadId=t}},xh=class{constructor(t,i){this.range=t,this.expression=i}};xh=__decorate([ie],xh);var sc;(function(e){e[e.Invoke=0]="Invoke",e[e.Automatic=1]="Automatic"})(sc||(sc={}));var Sh=class{constructor(t,i){this.range=t,this.text=i}};Sh=__decorate([ie],Sh);var Eh=class{constructor(t,i,r=!0){this.range=t,this.variableName=i,this.caseSensitiveLookup=r}};Eh=__decorate([ie],Eh);var Ch=class{constructor(t,i){this.range=t,this.expression=i}};Ch=__decorate([ie],Ch);var Tv=class{constructor(t,i){this.frameId=t,this.stoppedLocation=i}};Tv=__decorate([ie],Tv);var Av;(function(e){e[e.AIGenerated=1]="AIGenerated"})(Av||(Av={}));var oc;(function(e){e[e.Invoke=0]="Invoke",e[e.Automatic=1]="Automatic"})(oc||(oc={}));var C2=class{constructor(e,t){this.newSymbolName=e,this.tags=t}},ha;(function(e){e[e.Changed=1]="Changed",e[e.Created=2]="Created",e[e.Deleted=3]="Deleted"})(ha||(ha={}));var At=gi=class extends Error{static FileExists(t){return new gi(t,_e.FileExists,gi.FileExists)}static FileNotFound(t){return new gi(t,_e.FileNotFound,gi.FileNotFound)}static FileNotADirectory(t){return new gi(t,_e.FileNotADirectory,gi.FileNotADirectory)}static FileIsADirectory(t){return new gi(t,_e.FileIsADirectory,gi.FileIsADirectory)}static NoPermissions(t){return new gi(t,_e.NoPermissions,gi.NoPermissions)}static Unavailable(t){return new gi(t,_e.Unavailable,gi.Unavailable)}constructor(t,i=_e.Unknown,r){super(y.isUri(t)?t.toString(!0):t),this.code=r?.name??"Unknown",RS(this,i),Object.setPrototypeOf(this,gi.prototype),typeof Error.captureStackTrace=="function"&&typeof r=="function"&&Error.captureStackTrace(this,r)}};At=gi=__decorate([ie],At);var Rv=class{constructor(t,i,r){this.start=t,this.end=i,this.kind=r}};Rv=__decorate([ie],Rv);var an;(function(e){e[e.Comment=1]="Comment",e[e.Imports=2]="Imports",e[e.Region=3]="Region"})(an||(an={}));var ac;(function(e){e[e.Collapsed=0]="Collapsed",e[e.Expanded=1]="Expanded"})(ac||(ac={}));var Lv;(function(e){e[e.Editing=0]="Editing",e[e.Preview=1]="Preview"})(Lv||(Lv={}));var Nv;(function(e){e[e.Published=0]="Published",e[e.Draft=1]="Draft"})(Nv||(Nv={}));var lc;(function(e){e[e.Unresolved=0]="Unresolved",e[e.Resolved=1]="Resolved"})(lc||(lc={}));var cc;(function(e){e[e.Current=0]="Current",e[e.Outdated=1]="Outdated"})(cc||(cc={}));var uc;(function(e){e[e.Reply=1]="Reply",e[e.Comment=2]="Comment"})(uc||(uc={}));var Mv=class{constructor(e,t=[]){this.tokenTypes=e,this.tokenModifiers=t}};function D2(e){return typeof e>"u"||m9(e)}var I2=class X6{constructor(t){if(this._prevLine=0,this._prevChar=0,this._dataIsSortedAndDeltaEncoded=!0,this._data=[],this._dataLen=0,this._tokenTypeStrToInt=new Map,this._tokenModifierStrToInt=new Map,this._hasLegend=!1,t){this._hasLegend=!0;for(let i=0,r=t.tokenTypes.length;i<r;i++)this._tokenTypeStrToInt.set(t.tokenTypes[i],i);for(let i=0,r=t.tokenModifiers.length;i<r;i++)this._tokenModifierStrToInt.set(t.tokenModifiers[i],i)}}push(t,i,r,n,s){if(typeof t=="number"&&typeof i=="number"&&typeof r=="number"&&typeof n=="number"&&(typeof s=="number"||typeof s>"u"))return typeof s>"u"&&(s=0),this._pushEncoded(t,i,r,n,s);if(ye.isRange(t)&&typeof i=="string"&&D2(r))return this._push(t,i,r);throw Se()}_push(t,i,r){if(!this._hasLegend)throw new Error("Legend must be provided in constructor");if(t.start.line!==t.end.line)throw new Error("`range` cannot span multiple lines");if(!this._tokenTypeStrToInt.has(i))throw new Error("`tokenType` is not in the provided legend");const n=t.start.line,s=t.start.character,o=t.end.character-t.start.character,a=this._tokenTypeStrToInt.get(i);let l=0;if(r)for(const c of r){if(!this._tokenModifierStrToInt.has(c))throw new Error("`tokenModifier` is not in the provided legend");const u=this._tokenModifierStrToInt.get(c);l|=1<<u>>>0}this._pushEncoded(n,s,o,a,l)}_pushEncoded(t,i,r,n,s){if(this._dataIsSortedAndDeltaEncoded&&(t<this._prevLine||t===this._prevLine&&i<this._prevChar)){this._dataIsSortedAndDeltaEncoded=!1;const l=this._data.length/5|0;let c=0,u=0;for(let d=0;d<l;d++){let f=this._data[5*d],p=this._data[5*d+1];f===0?(f=c,p+=u):f+=c,this._data[5*d]=f,this._data[5*d+1]=p,c=f,u=p}}let o=t,a=i;this._dataIsSortedAndDeltaEncoded&&this._dataLen>0&&(o-=this._prevLine,o===0&&(a-=this._prevChar)),this._data[this._dataLen++]=o,this._data[this._dataLen++]=a,this._data[this._dataLen++]=r,this._data[this._dataLen++]=n,this._data[this._dataLen++]=s,this._prevLine=t,this._prevChar=i}static _sortAndDeltaEncode(t){const i=[],r=t.length/5|0;for(let a=0;a<r;a++)i[a]=a;i.sort((a,l)=>{const c=t[5*a],u=t[5*l];if(c===u){const d=t[5*a+1],f=t[5*l+1];return d-f}return c-u});const n=new Uint32Array(t.length);let s=0,o=0;for(let a=0;a<r;a++){const l=5*i[a],c=t[l+0],u=t[l+1],d=t[l+2],f=t[l+3],p=t[l+4],m=c-s,_=m===0?u-o:u,b=5*a;n[b+0]=m,n[b+1]=_,n[b+2]=d,n[b+3]=f,n[b+4]=p,s=c,o=u}return n}build(t){return this._dataIsSortedAndDeltaEncoded?new fa(new Uint32Array(this._data),t):new fa(X6._sortAndDeltaEncode(this._data),t)}},fa=class{constructor(e,t){this.resultId=t,this.data=e}},y4=class{constructor(e,t,i){this.start=e,this.deleteCount=t,this.data=i}},Dh=class{constructor(e,t){this.resultId=t,this.edits=e}},Ih;(function(e){e[e.Separate=0]="Separate",e[e.MergeWithParent=1]="MergeWithParent"})(Ih||(Ih={}));var k2=class{constructor(e){this.name=e}},Ov;(function(e){e[e.Title=1]="Title",e[e.Inline=2]="Inline"})(Ov||(Ov={}));var dc=class{static{this.Back={iconPath:new ci("arrow-left")}}constructor(){}};dc=__decorate([ie],dc);var hc;(function(e){e[e.Separator=-1]="Separator",e[e.Default=0]="Default"})(hc||(hc={}));var pa;(function(e){e[e.Info=1]="Info",e[e.Warning=2]="Warning",e[e.Error=3]="Error"})(pa||(pa={}));var zs;(function(e){e[e.UI=1]="UI",e[e.Workspace=2]="Workspace"})(zs||(zs={}));var Fv=class{static validate(e){if(typeof e.badge=="string"){let t=db(e.badge,0);if(t<e.badge.length&&(t+=db(e.badge,t)),e.badge.length>t)throw new Error("The 'badge'-property must be undefined or a short character")}else if(e.badge&&!ci.isThemeIcon(e.badge))throw new Error("The 'badge'-property is not a valid ThemeIcon");if(!e.color&&!e.badge&&!e.tooltip)throw new Error("The decoration is empty");return!0}constructor(e,t,i){this.badge=e,this.tooltip=t,this.color=i}},kh=class{constructor(t){this.kind=t}};kh=__decorate([ie],kh);var Vn;(function(e){e[e.Light=1]="Light",e[e.Dark=2]="Dark",e[e.HighContrast=3]="HighContrast",e[e.HighContrastLight=4]="HighContrastLight"})(Vn||(Vn={}));var ln=class Aw{static isNotebookRange(t){return t instanceof Aw?!0:t?typeof t.start=="number"&&typeof t.end=="number":!1}get start(){return this._start}get end(){return this._end}get isEmpty(){return this._start===this._end}constructor(t,i){if(t<0)throw Se("start must be positive");if(i<0)throw Se("end must be positive");t<=i?(this._start=t,this._end=i):(this._start=i,this._end=t)}with(t){let i=this._start,r=this._end;return t.start!==void 0&&(i=t.start),t.end!==void 0&&(r=t.end),i===this._start&&r===this._end?this:new Aw(i,r)}},Ph=class Rw{static validate(t){if(typeof t.kind!="number")throw new Error("NotebookCellData MUST have 'kind' property");if(typeof t.value!="string")throw new Error("NotebookCellData MUST have 'value' property");if(typeof t.languageId!="string")throw new Error("NotebookCellData MUST have 'languageId' property")}static isNotebookCellDataArray(t){return Array.isArray(t)&&t.every(i=>Rw.isNotebookCellData(i))}static isNotebookCellData(t){return!0}constructor(t,i,r,n,s,o,a){this.kind=t,this.value=i,this.languageId=r,this.mime=n,this.outputs=s??[],this.metadata=o,this.executionSummary=a,Rw.validate(this)}},b4=class{constructor(e){this.cells=e}},x4=class xn{static isNotebookCellOutputItem(t){return t instanceof xn?!0:t?typeof t.mime=="string"&&t.data instanceof Uint8Array:!1}static error(t){const i={name:t.name,message:t.message,stack:t.stack};return xn.json(i,"application/vnd.code.notebook.error")}static stdout(t){return xn.text(t,"application/vnd.code.notebook.stdout")}static stderr(t){return xn.text(t,"application/vnd.code.notebook.stderr")}static bytes(t,i="application/octet-stream"){return new xn(t,i)}static#e=new TextEncoder;static text(t,i=Yr.text){const r=xn.#e.encode(String(t));return new xn(r,i)}static json(t,i="text/x-json"){const r=JSON.stringify(t,void 0,"	");return xn.text(r,i)}constructor(t,i){this.data=t,this.mime=i;const r=nS(i,!0);if(!r)throw new Error(`INVALID mime type: ${i}. Must be in the format "type/subtype[;optionalparameter]"`);this.mime=r}},Th=class Lw{static isNotebookCellOutput(t){return t instanceof Lw?!0:!t||typeof t!="object"?!1:typeof t.id=="string"&&Array.isArray(t.items)}static ensureUniqueMimeTypes(t,i=!1){const r=new Set,n=new Set;for(let s=0;s<t.length;s++){const o=t[s],a=nS(o.mime);if(!r.has(a)||LE(a)){r.add(a);continue}n.add(s),i&&console.warn(`DUPLICATED mime type '${o.mime}' will be dropped`)}return n.size===0?t:t.filter((s,o)=>!n.has(o))}constructor(t,i,r){this.items=Lw.ensureUniqueMimeTypes(t,!0),typeof i=="string"?(this.id=i,this.metadata=r):(this.id=$t(),this.metadata=i??r)}},P2=class{constructor(e,t,i){this.label=e,this.uri=t,this.position=i}},qs;(function(e){e[e.Markup=1]="Markup",e[e.Code=2]="Code"})(qs||(qs={}));var ga;(function(e){e[e.Idle=1]="Idle",e[e.Pending=2]="Pending",e[e.Executing=3]="Executing"})(ga||(ga={}));var Ah;(function(e){e[e.Left=1]="Left",e[e.Right=2]="Right"})(Ah||(Ah={}));var Rh;(function(e){e[e.Default=0]="Default",e[e.InCenter=1]="InCenter",e[e.InCenterIfOutsideViewport=2]="InCenterIfOutsideViewport",e[e.AtTop=3]="AtTop"})(Rh||(Rh={}));var T2=class{constructor(e,t){this.text=e,this.alignment=t}},$v;(function(e){e[e.Default=1]="Default",e[e.Preferred=2]="Preferred"})($v||($v={}));var Lh;(function(e){e[e.Default=1]="Default",e[e.Preferred=2]="Preferred",e[e.Hidden=-1]="Hidden"})(Lh||(Lh={}));var S4=class{constructor(e,t=[]){this.uri=e,this.provides=Fi(t)}},A2=class{constructor(e){this.label=e}},fc;(function(e){e[e.Named=1]="Named",e[e.Indexed=2]="Indexed"})(fc||(fc={}));var Hv=class{constructor(t,i){this.label=t,this.timestamp=i}};Hv=__decorate([ie],Hv);var ma;(function(e){e[e.Production=1]="Production",e[e.Development=2]="Development",e[e.Test=3]="Test"})(ma||(ma={}));var Nh;(function(e){e[e.Node=1]="Node",e[e.Webworker=2]="Webworker"})(Nh||(Nh={}));var zn;(function(e){e[e.Other=0]="Other",e[e.Comment=1]="Comment",e[e.String=2]="String",e[e.RegEx=3]="RegEx"})(zn||(zn={}));var R2=class{constructor(e,t){this.ranges=e,this.wordPattern=t}},L2=class{constructor(e){this._autoForwardAction=e}get autoForwardAction(){return this._autoForwardAction}},Uv;(function(e){e[e.Queued=1]="Queued",e[e.Running=2]="Running",e[e.Passed=3]="Passed",e[e.Failed=4]="Failed",e[e.Skipped=5]="Skipped",e[e.Errored=6]="Errored"})(Uv||(Uv={}));var va;(function(e){e[e.Run=1]="Run",e[e.Debug=2]="Debug",e[e.Coverage=3]="Coverage"})(va||(va={}));var E4=class{constructor(e,t,i){this.controllerId=e,this.profileId=t,this.kind=i}},Mh=class{constructor(t=void 0,i=void 0,r=void 0,n=!1,s=!0){this.include=t,this.exclude=i,this.profile=r,this.continuous=n,this.preserveFocus=s}};Mh=__decorate([ie],Mh);var Oh=sv=class{static diff(t,i,r){const n=new sv(t);return n.expectedOutput=i,n.actualOutput=r,n}constructor(t){this.message=t}};Oh=sv=__decorate([ie],Oh);var pc=class{constructor(t){this.id=t}};pc=__decorate([ie],pc);var N2=class{constructor(e,t,i){this.label=e,this.uri=t,this.position=i}},Fh=class{constructor(e,t){this.covered=e,this.total=t,$h(this)}};function $h(e){if(e){if(e.covered>e.total)throw new Error(`The total number of covered items (${e.covered}) cannot be greater than the total (${e.total})`);if(e.total<0)throw new Error(`The number of covered items (${e.total}) cannot be negative`)}}var Hh=class Z6{static fromDetails(t,i){const r=new Fh(0,0),n=new Fh(0,0),s=new Fh(0,0);for(const a of i)if("branches"in a){r.total+=1,r.covered+=a.executed?1:0;for(const l of a.branches)n.total+=1,n.covered+=l.executed?1:0}else s.total+=1,s.covered+=a.executed?1:0;const o=new Z6(t,r,n.total>0?n:void 0,s.total>0?s:void 0);return o.detailedCoverage=i,o}constructor(t,i,r,n,s=[]){this.uri=t,this.statementCoverage=i,this.branchCoverage=r,this.declarationCoverage=n,this.includesTests=s}},C4=class{get executionCount(){return+this.executed}set executionCount(e){this.executed=e}constructor(e,t,i=[]){this.executed=e,this.location=t,this.branches=i}},D4=class{get executionCount(){return+this.executed}set executionCount(e){this.executed=e}constructor(e,t,i){this.executed=e,this.location=t,this.label=i}},I4=class{get executionCount(){return+this.executed}set executionCount(e){this.executed=e}constructor(e,t,i){this.name=e,this.executed=t,this.location=i}},Bv;(function(e){e[e.None=0]="None",e[e.Option=1]="Option",e[e.Default=2]="Default",e[e.Preferred=3]="Preferred"})(Bv||(Bv={}));var Wv;(function(e){e[e.Untrusted=0]="Untrusted",e[e.Trusted=1]="Trusted",e[e.Unspecified=2]="Unspecified"})(Wv||(Wv={}));var Vv;(function(e){e[e.Notify=1]="Notify",e[e.OpenBrowser=2]="OpenBrowser",e[e.OpenPreview=3]="OpenPreview",e[e.Silent=4]="Silent",e[e.Ignore=5]="Ignore",e[e.OpenBrowserOnce=6]="OpenBrowserOnce"})(Vv||(Vv={}));var zv=class{constructor(e,t,i,r,n,s){this.kind=e,this.name=t,this.detail=i,this.uri=r,this.range=n,this.selectionRange=s}},qv=class{constructor(e){this.uri=e}},Uh=class{constructor(e,t){this.original=e,this.modified=t}},k4=class{constructor(e,t,i,r){this.base=e,this.input1=t,this.input2=i,this.result=r}},jv=class{constructor(e,t){this.uri=e,this.viewType=t}},P4=class{constructor(e){this.viewType=e}},Gv=class{constructor(e,t){this.uri=e,this.notebookType=t}},Qv=class{constructor(e,t,i){this.original=e,this.modified=t,this.notebookType=i}},T4=class{constructor(){}},A4=class{constructor(e,t){this.uri=e,this.inputBoxUri=t}},R4=class{constructor(){}},L4=class{constructor(e){this.textDiffs=e}},Jv;(function(e){e[e.Down=0]="Down",e[e.Up=1]="Up"})(Jv||(Jv={}));var Xv;(function(e){e[e.Action=1]="Action",e[e.Toolbar=2]="Toolbar"})(Xv||(Xv={}));var Zv;(function(e){e[e.Short=1]="Short",e[e.Medium=2]="Medium",e[e.Full=3]="Full"})(Zv||(Zv={}));var M2=class{constructor(e,t,i){this.id=e,this.label=t,this.values=i}},js;(function(e){e[e.Accepted=1]="Accepted",e[e.Rejected=2]="Rejected",e[e.Saved=3]="Saved"})(js||(js={}));var Kv;(function(e){e[e.Keep=1]="Keep",e[e.Undo=2]="Undo",e[e.UserModification=3]="UserModification"})(Kv||(Kv={}));var Yv;(function(e){e[e.Unhelpful=0]="Unhelpful",e[e.Helpful=1]="Helpful",e[e.Undone=2]="Undone",e[e.Accepted=3]="Accepted",e[e.Bug=4]="Bug"})(Yv||(Yv={}));var gc;(function(e){e[e.Unhelpful=0]="Unhelpful",e[e.Helpful=1]="Helpful"})(gc||(gc={}));var Bh=class{constructor(e){if(typeof e!="string"&&e.isTrusted===!0)throw new Error("The boolean form of MarkdownString.isTrusted is NOT supported for chat participants.");this.value=typeof e=="string"?new mi(e):e}},mc=class{constructor(e,t){if(typeof e!="string"&&e.isTrusted===!0)throw new Error("The boolean form of MarkdownString.isTrusted is NOT supported for chat participants.");this.value=typeof e=="string"?new mi(e):e,this.vulnerabilities=t}},Wh=class{constructor(e,t,i,r){this.title=e,this.message=t,this.data=i,this.buttons=r}},Vh=class{constructor(e,t){this.value=e,this.baseUri=t}},vc=class{constructor(e,t){this.value=e,this.value2=e,this.title=t}},e1=class{constructor(e){this.value=e}},zh=class{constructor(e,t){this.value=e,this.task=t}},_c=class{constructor(e){if(typeof e!="string"&&e.isTrusted===!0)throw new Error("The boolean form of MarkdownString.isTrusted is NOT supported for chat participants.");this.value=typeof e=="string"?new mi(e):e}},qh=class{constructor(e){this.value=e}},Gs=class{constructor(e,t,i){this.value=e,this.iconPath=t,this.options=i}},jh=class{constructor(e,t){this.value=e,this.isEdit=t}},Gh=class{constructor(e,t,i){this.value=e,this.license=t,this.snippet=i}},Qh=class{constructor(e,t){this.uri=e,this.range=t}},t1=class{constructor(e){this.extensions=e}},wc=class{constructor(e,t){this.uri=e,t===!0?(this.isDone=!0,this.edits=[]):this.edits=Array.isArray(t)?t:[t]}},Jh=class{constructor(e,t){this.uri=e,t===!0?(this.isDone=!0,this.edits=[]):this.edits=Array.isArray(t)?t:[t]}},i1=class{constructor(e,t,i,r,n,s){this.prompt=e,this.command=t,this.references=i,this.participant=r,this.toolReferences=n,this.editedFileEvents=s}},N4=class{constructor(e,t,i,r){this.response=e,this.result=t,this.participant=i,this.command=r}},hr;(function(e){e[e.Panel=1]="Panel",e[e.Terminal=2]="Terminal",e[e.Notebook=3]="Notebook",e[e.Editor=4]="Editor"})(hr||(hr={}));var r1;(function(e){e[e.Complete=1]="Complete",e[e.Partial=2]="Partial",e[e.Omitted=3]="Omitted"})(r1||(r1={}));var M4=class{constructor(e,t,i){this.document=e,this.selection=t,this.wholeRange=i}},O4=class{constructor(e){this.cell=e}},F4=class{constructor(e,t,i){this.mimeType=e,this.data=t,this.reference=i}},$4=class{constructor(e){this.diagnostics=e}},Ai;(function(e){e[e.User=1]="User",e[e.Assistant=2]="Assistant",e[e.System=3]="System"})(Ai||(Ai={}));var Xh=class{constructor(e,t,i){this.callId=e,this.content=t,this.isError=i??!1}},n1=class{constructor(e,t,i){this.callId=e,this.content=t,this.isError=i??!1}},O2=class{constructor(e,t,i){this.command=e,this.language=t,this.confirmationMessages=i}},s1;(function(e){e[e.Info=0]="Info",e[e.Warning=1]="Warning",e[e.Error=2]="Error"})(s1||(s1={}));var H4=class Nw{static User(t,i){return new Nw(Ai.User,t,i)}static Assistant(t,i){return new Nw(Ai.Assistant,t,i)}set content(t){typeof t=="string"?this._content=[new mt(t)]:this._content=t}get content(){return this._content}constructor(t,i,r){this._content=[],this.role=t,this.content=i,this.name=r}},U4=class Mw{static User(t,i){return new Mw(Ai.User,t,i)}static Assistant(t,i){return new Mw(Ai.Assistant,t,i)}set content(t){typeof t=="string"?this._content=[new mt(t)]:this._content=t}get content(){return this._content}set content2(t){t&&(this.content=t.map(i=>typeof i=="string"?new mt(i):i))}get content2(){return this.content.map(t=>t instanceof mt?t.value:t)}constructor(t,i,r){this._content=[],this.role=t,this.content=i,this.name=r}},Qs=class{constructor(e,t,i){this.callId=e,this.name=t,this.input=i}},mt=class{constructor(e){this.value=e}toJSON(){return{$mid:21,value:this.value}}},qn=class Wp{constructor(t,i){this.mimeType=i,this.data=t}static image(t,i){return new Wp(t,i)}static json(t){const i=JSON.stringify(t,void 0,"	");return new Wp(ae.fromString(i).buffer,"json")}static text(t){return new Wp(ae.fromString(t).buffer,"text/plain")}toJSON(){return{$mid:23,mimeType:this.mimeType,data:this.data}}},Zh;(function(e){e.PNG="image/png",e.JPEG="image/jpeg",e.GIF="image/gif",e.WEBP="image/webp",e.BMP="image/bmp"})(Zh||(Zh={}));var o1=class{constructor(e,t){this.kind=e,this.data=t}toJSON(){return{$mid:24,kind:this.kind,data:this.data}}},Nr=class{constructor(e){this.value=e}toJSON(){return{$mid:22,value:this.value}}},cn=class Ur extends Error{static#e="LanguageModelError";static NotFound(t){return new Ur(t,Ur.NotFound.name)}static NoPermissions(t){return new Ur(t,Ur.NoPermissions.name)}static Blocked(t){return new Ur(t,Ur.Blocked.name)}static tryDeserialize(t){if(t.name===Ur.#e)return new Ur(t.message,t.code,t.cause)}constructor(t,i,r){super(t,{cause:r}),this.name=Ur.#e,this.code=i??""}},Kh=class{constructor(e){this.content=e}toJSON(){return{$mid:20,content:this.content}}},B4=class{constructor(e){this.content=e}toJSON(){return{$mid:20,content:this.content}}},F2=class extends Kh{},a1;(function(e){e[e.Auto=1]="Auto",e[e.Required=2]="Required"})(a1||(a1={}));var l1;(function(e){e[e.SymbolInformation=1]="SymbolInformation",e[e.CommandInformation=2]="CommandInformation",e[e.SearchInformation=3]="SearchInformation",e[e.SettingInformation=4]="SettingInformation"})(l1||(l1={}));var c1;(function(e){e[e.EMBEDDED=1]="EMBEDDED",e[e.LLM_RANKED=2]="LLM_RANKED",e[e.CANCELED=3]="CANCELED"})(c1||(c1={}));var u1;(function(e){e[e.Started=1]="Started",e[e.Recognizing=2]="Recognizing",e[e.Recognized=3]="Recognized",e[e.Stopped=4]="Stopped",e[e.Error=5]="Error"})(u1||(u1={}));var d1;(function(e){e[e.Started=1]="Started",e[e.Stopped=2]="Stopped",e[e.Error=3]="Error"})(d1||(d1={}));var h1;(function(e){e[e.Recognized=1]="Recognized",e[e.Stopped=2]="Stopped"})(h1||(h1={}));var $2=class{constructor(e,t){this.text=e,this.range=t}},yc;(function(e){e[e.Invoke=0]="Invoke",e[e.Automatic=1]="Automatic"})(yc||(yc={}));var H2=class{constructor(e,t,i,r={},n){this.label=e,this.command=t,this.args=i,this.env=r,this.version=n}},U2=class{constructor(e,t,i={},r){this.label=e,this.uri=t,this.headers=i,this.version=r}},Fz=U("IAiSettingsSearchService"),jn;(function(e){e[e.EMBEDDED=1]="EMBEDDED",e[e.LLM_RANKED=2]="LLM_RANKED",e[e.CANCELED=3]="CANCELED"})(jn||(jn={}));function B2(e,t){return Oe.toKey(e)+"/"+t}var W4;(function(e){e[e.WorkspaceFolder=0]="WorkspaceFolder",e[e.Workspace=100]="Workspace",e[e.User=200]="User",e[e.Extension=300]="Extension",e[e.Filesystem=400]="Filesystem",e[e.RemoteBoost=-50]="RemoteBoost"})(W4||(W4={}));var V4;(function(e){function t(i,r){return i.id===r.id&&i.remoteAuthority===r.remoteAuthority&&i.label===r.label&&i.isTrustedByDefault===r.isTrustedByDefault}e.equals=t})(V4||(V4={}));var z4;(function(e){function t(n){return n}e.toSerialized=t;function i(n){return{id:n.id,label:n.label,cacheNonce:n.cacheNonce,launch:bc.fromSerialized(n.launch),variableReplacement:n.variableReplacement?f1.fromSerialized(n.variableReplacement):void 0}}e.fromSerialized=i;function r(n,s){return n.id===s.id&&n.label===s.label&&Sr(n.roots,s.roots,(o,a)=>o.toString()===a.toString())&&fi(n.launch,s.launch)&&fi(n.presentation,s.presentation)&&fi(n.variableReplacement,s.variableReplacement)}e.equals=r})(z4||(z4={}));var f1;(function(e){function t(r){return r}e.toSerialized=t;function i(r){return{section:r.section,folder:r.folder?{...r.folder,uri:y.revive(r.folder.uri)}:void 0,target:r.target}}e.fromSerialized=i})(f1||(f1={}));var q4;(function(e){e[e.HasUnknown=0]="HasUnknown",e[e.LoadingUnknown=1]="LoadingUnknown",e[e.AllKnown=2]="AllKnown"})(q4||(q4={}));var $z=U("IMcpService"),j4;(function(e){e[e.Unknown=0]="Unknown",e[e.Cached=1]="Cached",e[e.Outdated=2]="Outdated",e[e.RefreshingFromUnknown=3]="RefreshingFromUnknown",e[e.RefreshingFromCached=4]="RefreshingFromCached",e[e.Live=5]="Live"})(j4||(j4={}));var G4;(function(e){e[e.Stdio=1]="Stdio",e[e.HTTP=2]="HTTP"})(G4||(G4={}));var bc;(function(e){function t(r){return r}e.toSerialized=t;function i(r){switch(r.type){case 2:return{type:r.type,uri:y.revive(r.uri),headers:r.headers};case 1:return{type:r.type,cwd:r.cwd?y.revive(r.cwd):void 0,command:r.command,args:r.args,env:r.env,envFile:r.envFile}}}e.fromSerialized=i})(bc||(bc={}));var Q4;(function(e){let t;(function(i){i[i.Stopped=0]="Stopped",i[i.Starting=1]="Starting",i[i.Running=2]="Running",i[i.Error=3]="Error"})(t=e.Kind||(e.Kind={})),e.toString=i=>{switch(i.state){case 0:return h(8965,null);case 1:return h(8966,null);case 2:return h(8967,null);case 3:return h(8968,null,i.message);default:og(i)}},e.toKindString=i=>{switch(i){case 0:return"stopped";case 1:return"starting";case 2:return"running";case 3:return"error";default:og(i)}},e.canBeStarted=i=>i===3||i===0,e.isRunning=i=>!e.canBeStarted(i.state)})(Q4||(Q4={}));var fr;(function(e){function t(r){const{selectionStartLineNumber:n,selectionStartColumn:s,positionLineNumber:o,positionColumn:a}=r,l=new Ie(n-1,s-1),c=new Ie(o-1,a-1);return new on(l,c)}e.to=t;function i(r){const{anchor:n,active:s}=r;return{selectionStartLineNumber:n.line+1,selectionStartColumn:n.character+1,positionLineNumber:s.line+1,positionColumn:s.character+1}}e.from=i})(fr||(fr={}));var F;(function(e){function t(r){if(!r)return;const{start:n,end:s}=r;return{startLineNumber:n.line+1,startColumn:n.character+1,endLineNumber:s.line+1,endColumn:s.character+1}}e.from=t;function i(r){if(!r)return;const{startLineNumber:n,startColumn:s,endLineNumber:o,endColumn:a}=r;return new ye(n-1,s-1,o-1,a-1)}e.to=i})(F||(F={}));var Mr;(function(e){function t(r){return{uri:r.uri,range:F.from(r.range)}}e.from=t;function i(r){return new Wi(y.revive(r.uri),F.to(r.range))}e.to=i})(Mr||(Mr={}));var p1;(function(e){function t(i){switch(i){case 1:return zn.Comment;case 0:return zn.Other;case 3:return zn.RegEx;case 2:return zn.String}}e.to=t})(p1||(p1={}));var Be;(function(e){function t(r){return new Ie(r.lineNumber-1,r.column-1)}e.to=t;function i(r){return{lineNumber:r.line+1,column:r.character+1}}e.from=i})(Be||(Be={}));var _a;(function(e){function t(n,s,o){return xt(Fi(n).map(a=>i(a,s,o)))}e.from=t;function i(n,s,o){if(typeof n=="string")return{$serialized:!0,language:n,isBuiltin:o?.isBuiltin};if(n)return{$serialized:!0,language:n.language,scheme:r(n.scheme,s),pattern:Li.from(n.pattern)??void 0,exclusive:n.exclusive,notebookType:n.notebookType,isBuiltin:o?.isBuiltin}}function r(n,s){return s&&typeof n=="string"?s.transformOutgoingScheme(n):n}})(_a||(_a={}));var Yh;(function(e){function t(r){switch(r){case Os.Unnecessary:return 1;case Os.Deprecated:return 2}}e.from=t;function i(r){switch(r){case 1:return Os.Unnecessary;case 2:return Os.Deprecated;default:return}}e.to=i})(Yh||(Yh={}));var wa;(function(e){function t(r){let n;return r.code&&(Me(r.code)||ls(r.code)?n=String(r.code):n={value:String(r.code.value),target:r.code.target}),{...F.from(r.range),message:r.message,source:r.source,code:n,severity:xc.from(r.severity),relatedInformation:r.relatedInformation&&r.relatedInformation.map(ef.from),tags:Array.isArray(r.tags)?xt(r.tags.map(Yh.from)):void 0}}e.from=t;function i(r){const n=new ih(F.to(r),r.message,xc.to(r.severity));return n.source=r.source,n.code=Me(r.code)?r.code:r.code?.value,n.relatedInformation=r.relatedInformation&&r.relatedInformation.map(ef.to),n.tags=r.tags&&xt(r.tags.map(Yh.to)),n}e.to=i})(wa||(wa={}));var ef;(function(e){function t(r){return{...F.from(r.location.range),message:r.message,resource:r.location.uri}}e.from=t;function i(r){return new Vl(new Wi(r.resource,F.to(r)),r.message)}e.to=i})(ef||(ef={}));var xc;(function(e){function t(r){switch(r){case ei.Error:return pi.Error;case ei.Warning:return pi.Warning;case ei.Information:return pi.Info;case ei.Hint:return pi.Hint}return pi.Error}e.from=t;function i(r){switch(r){case pi.Info:return ei.Information;case pi.Warning:return ei.Warning;case pi.Error:return ei.Error;case pi.Hint:return ei.Hint;default:return ei.Error}}e.to=i})(xc||(xc={}));var Rt;(function(e){function t(r){return typeof r=="number"&&r>=Kl.One?r-1:r===Kl.Beside?WR:BR}e.from=t;function i(r){if(typeof r=="number"&&r>=0)return r+1;throw new Error("invalid 'EditorGroupColumn'")}e.to=i})(Rt||(Rt={}));function W2(e){return typeof e.range<"u"}function J4(e){return e.length===0?!0:!!W2(e[0])}var pe;(function(e){function t(a){return a.map(e.from)}e.fromMany=t;function i(a){return a&&typeof a=="object"&&typeof a.language=="string"&&typeof a.value=="string"}function r(a){let l;if(i(a)){const{language:d,value:f}=a;l={value:"```"+d+`
`+f+"\n```\n"}}else mi.isMarkdownString(a)?l={value:a.value,isTrusted:a.isTrusted,supportThemeIcons:a.supportThemeIcons,supportHtml:a.supportHtml,baseUri:a.baseUri}:typeof a=="string"?l={value:a}:l={value:""};const c=Object.create(null);l.uris=c;const u=({href:d})=>{try{let f=y.parse(d,!0);f=f.with({query:n(f.query,c)}),c[d]=f}catch{}return""};return st.walkTokens(st.lexer(l.value),d=>{d.type==="link"?u({href:d.href}):d.type==="image"&&typeof d.href=="string"&&u(V8(d.href))}),l}e.from=r;function n(a,l){if(!a)return a;let c;try{c=rS(a)}catch{}if(!c)return a;let u=!1;return c=Mo(c,d=>{if(y.isUri(d)){const f=`__uri_${Math.random().toString(16).slice(2,8)}`;return l[f]=d,u=!0,f}else return}),u?JSON.stringify(c):a}function s(a){const l=new mi(a.value,a.supportThemeIcons);return l.isTrusted=a.isTrusted,l.supportHtml=a.supportHtml,l.baseUri=a.baseUri?y.from(a.baseUri):void 0,l}e.to=s;function o(a){if(a)return typeof a=="string"?a:e.from(a)}e.fromStrict=o})(pe||(pe={}));function V2(e){return J4(e)?e.map(t=>({range:F.from(t.range),hoverMessage:Array.isArray(t.hoverMessage)?pe.fromMany(t.hoverMessage):t.hoverMessage?pe.from(t.hoverMessage):void 0,renderOptions:t.renderOptions})):e.map(t=>({range:F.from(t)}))}function tf(e){return typeof e>"u"?e:typeof e=="string"?y.file(e):e}var ya;(function(e){function t(i){return typeof i>"u"?i:{contentText:i.contentText,contentIconPath:i.contentIconPath?tf(i.contentIconPath):void 0,border:i.border,borderColor:i.borderColor,fontStyle:i.fontStyle,fontWeight:i.fontWeight,textDecoration:i.textDecoration,color:i.color,backgroundColor:i.backgroundColor,margin:i.margin,width:i.width,height:i.height}}e.from=t})(ya||(ya={}));var rf;(function(e){function t(i){return typeof i>"u"?i:{backgroundColor:i.backgroundColor,outline:i.outline,outlineColor:i.outlineColor,outlineStyle:i.outlineStyle,outlineWidth:i.outlineWidth,border:i.border,borderColor:i.borderColor,borderRadius:i.borderRadius,borderSpacing:i.borderSpacing,borderStyle:i.borderStyle,borderWidth:i.borderWidth,fontStyle:i.fontStyle,fontWeight:i.fontWeight,textDecoration:i.textDecoration,cursor:i.cursor,color:i.color,opacity:i.opacity,letterSpacing:i.letterSpacing,gutterIconPath:i.gutterIconPath?tf(i.gutterIconPath):void 0,gutterIconSize:i.gutterIconSize,overviewRulerColor:i.overviewRulerColor,before:i.before?ya.from(i.before):void 0,after:i.after?ya.from(i.after):void 0}}e.from=t})(rf||(rf={}));var g1;(function(e){function t(i){if(typeof i>"u")return i;switch(i){case $s.OpenOpen:return 0;case $s.ClosedClosed:return 1;case $s.OpenClosed:return 2;case $s.ClosedOpen:return 3}}e.from=t})(g1||(g1={}));var m1;(function(e){function t(i){return{isWholeLine:i.isWholeLine,rangeBehavior:i.rangeBehavior?g1.from(i.rangeBehavior):void 0,overviewRulerLane:i.overviewRulerLane,light:i.light?rf.from(i.light):void 0,dark:i.dark?rf.from(i.dark):void 0,backgroundColor:i.backgroundColor,outline:i.outline,outlineColor:i.outlineColor,outlineStyle:i.outlineStyle,outlineWidth:i.outlineWidth,border:i.border,borderColor:i.borderColor,borderRadius:i.borderRadius,borderSpacing:i.borderSpacing,borderStyle:i.borderStyle,borderWidth:i.borderWidth,fontStyle:i.fontStyle,fontWeight:i.fontWeight,textDecoration:i.textDecoration,cursor:i.cursor,color:i.color,opacity:i.opacity,letterSpacing:i.letterSpacing,gutterIconPath:i.gutterIconPath?tf(i.gutterIconPath):void 0,gutterIconSize:i.gutterIconSize,overviewRulerColor:i.overviewRulerColor,before:i.before?ya.from(i.before):void 0,after:i.after?ya.from(i.after):void 0}}e.from=t})(m1||(m1={}));var Lt;(function(e){function t(r){return{text:r.newText,eol:r.newEol&&Ea.from(r.newEol),range:F.from(r.range)}}e.from=t;function i(r){const n=new Hn(F.to(r.range),r.text);return n.newEol=typeof r.eol>"u"?void 0:Ea.to(r.eol),n}e.to=i})(Lt||(Lt={}));var Ri;(function(e){function t(r,n){const s={edits:[]};if(r instanceof Ns){const o=new ny;for(const a of r._allEntries())a._type===1&&y.isUri(a.to)&&a.from===void 0&&o.add(a.to);for(const a of r._allEntries())if(a._type===1){let l;a.options?.contents&&(ArrayBuffer.isView(a.options.contents)?l={type:"base64",value:hg(ae.wrap(a.options.contents))}:l={type:"dataTransferItem",id:a.options.contents._itemId}),s.edits.push({oldResource:a.from,newResource:a.to,options:{...a.options,contents:l},metadata:a.metadata})}else a._type===2?s.edits.push({resource:a.uri,textEdit:Lt.from(a.edit),versionId:o.has(a.uri)?void 0:n?.getTextDocumentVersion(a.uri),metadata:a.metadata}):a._type===6?s.edits.push({resource:a.uri,textEdit:{range:F.from(a.range),text:a.edit.value,insertAsSnippet:!0,keepWhitespace:a.keepWhitespace},versionId:o.has(a.uri)?void 0:n?.getTextDocumentVersion(a.uri),metadata:a.metadata}):a._type===3?s.edits.push({metadata:a.metadata,resource:a.uri,cellEdit:a.edit,notebookVersionId:n?.getNotebookDocumentVersion(a.uri)}):a._type===5&&s.edits.push({metadata:a.metadata,resource:a.uri,notebookVersionId:n?.getNotebookDocumentVersion(a.uri),cellEdit:{editType:1,index:a.index,count:a.count,cells:a.cells.map(Da.from)}})}return s}e.from=t;function i(r){const n=new Ns,s=new Ft;for(const o of r.edits)if(o.textEdit){const a=o,l=y.revive(a.resource),c=F.to(a.textEdit.range),u=a.textEdit.text,d=a.textEdit.insertAsSnippet;let f;d?f=av.replace(c,new Ms(u)):f=Hn.replace(c,u);const p=s.get(l);p?p.push(f):s.set(l,[f])}else n.renameFile(y.revive(o.oldResource),y.revive(o.newResource),o.options);for(const[o,a]of s)n.set(o,a);return n}e.to=i})(Ri||(Ri={}));var Xi;(function(e){const t=Object.create(null);t[et.File]=0,t[et.Module]=1,t[et.Namespace]=2,t[et.Package]=3,t[et.Class]=4,t[et.Method]=5,t[et.Property]=6,t[et.Field]=7,t[et.Constructor]=8,t[et.Enum]=9,t[et.Interface]=10,t[et.Function]=11,t[et.Variable]=12,t[et.Constant]=13,t[et.String]=14,t[et.Number]=15,t[et.Boolean]=16,t[et.Array]=17,t[et.Object]=18,t[et.Key]=19,t[et.Null]=20,t[et.EnumMember]=21,t[et.Struct]=22,t[et.Event]=23,t[et.Operator]=24,t[et.TypeParameter]=25;function i(n){return typeof t[n]=="number"?t[n]:6}e.from=i;function r(n){for(const s in t)if(t[s]===n)return Number(s);return et.Property}e.to=r})(Xi||(Xi={}));var un;(function(e){function t(r){switch(r){case ql.Deprecated:return 1}}e.from=t;function i(r){switch(r){case 1:return ql.Deprecated}}e.to=i})(un||(un={}));var Js;(function(e){function t(r){return{name:r.name,kind:Xi.from(r.kind),tags:r.tags&&r.tags.map(un.from),containerName:r.containerName,location:vi.from(r.location)}}e.from=t;function i(r){const n=new jl(r.name,Xi.to(r.kind),r.containerName,vi.to(r.location));return n.tags=r.tags&&r.tags.map(un.to),n}e.to=i})(Js||(Js={}));var v1;(function(e){function t(r){const n={name:r.name||"!!MISSING: name!!",detail:r.detail,range:F.from(r.range),selectionRange:F.from(r.selectionRange),kind:Xi.from(r.kind),tags:r.tags?.map(un.from)??[]};return r.children&&(n.children=r.children.map(t)),n}e.from=t;function i(r){const n=new Gl(r.name,r.detail,Xi.to(r.kind),F.to(r.range),F.to(r.selectionRange));return yo(r.tags)&&(n.tags=r.tags.map(un.to)),r.children&&(n.children=r.children.map(i)),n}e.to=i})(v1||(v1={}));var Xs;(function(e){function t(r){const n=new cv(Xi.to(r.kind),r.name,r.detail||"",y.revive(r.uri),F.to(r.range),F.to(r.selectionRange));return n._sessionId=r._sessionId,n._itemId=r._itemId,n}e.to=t;function i(r,n,s){if(n=n??r._sessionId,s=s??r._itemId,n===void 0||s===void 0)throw new Error("invalid item");return{_sessionId:n,_itemId:s,name:r.name,detail:r.detail,kind:Xi.from(r.kind),uri:r.uri,range:F.from(r.range),selectionRange:F.from(r.selectionRange),tags:r.tags?.map(un.from)}}e.from=i})(Xs||(Xs={}));var _1;(function(e){function t(i){return new f4(Xs.to(i.from),i.fromRanges.map(r=>F.to(r)))}e.to=t})(_1||(_1={}));var w1;(function(e){function t(i){return new p4(Xs.to(i.to),i.fromRanges.map(r=>F.to(r)))}e.to=t})(w1||(w1={}));var vi;(function(e){function t(r){return{range:r.range&&F.from(r.range),uri:r.uri}}e.from=t;function i(r){return new Wi(y.revive(r.uri),F.to(r.range))}e.to=i})(vi||(vi={}));var Sc;(function(e){function t(r){const n=r,s=r;return{originSelectionRange:n.originSelectionRange?F.from(n.originSelectionRange):void 0,uri:n.targetUri?n.targetUri:s.uri,range:F.from(n.targetRange?n.targetRange:s.range),targetSelectionRange:n.targetSelectionRange?F.from(n.targetSelectionRange):void 0}}e.from=t;function i(r){return{targetUri:y.revive(r.uri),targetRange:F.to(r.range),targetSelectionRange:r.targetSelectionRange?F.to(r.targetSelectionRange):void 0,originSelectionRange:r.originSelectionRange?F.to(r.originSelectionRange):void 0}}e.to=i})(Sc||(Sc={}));var Ec;(function(e){function t(r){return{range:F.from(r.range),contents:pe.fromMany(r.contents),canIncreaseVerbosity:r.canIncreaseVerbosity,canDecreaseVerbosity:r.canDecreaseVerbosity}}e.from=t;function i(r){const n=r.contents.map(pe.to),s=F.to(r.range),o=r.canIncreaseVerbosity,a=r.canDecreaseVerbosity;return new nh(n,s,o,a)}e.to=i})(Ec||(Ec={}));var y1;(function(e){function t(r){return{range:F.from(r.range),expression:r.expression}}e.from=t;function i(r){return new xh(F.to(r.range),r.expression)}e.to=i})(y1||(y1={}));var nf;(function(e){function t(r){if(r instanceof Sh)return{type:"text",range:F.from(r.range),text:r.text};if(r instanceof Eh)return{type:"variable",range:F.from(r.range),variableName:r.variableName,caseSensitiveLookup:r.caseSensitiveLookup};if(r instanceof Ch)return{type:"expression",range:F.from(r.range),expression:r.expression};throw new Error("Unknown 'InlineValue' type")}e.from=t;function i(r){switch(r.type){case"text":return{range:F.to(r.range),text:r.text};case"variable":return{range:F.to(r.range),variableName:r.variableName,caseSensitiveLookup:r.caseSensitiveLookup};case"expression":return{range:F.to(r.range),expression:r.expression}}}e.to=i})(nf||(nf={}));var sf;(function(e){function t(r){return{frameId:r.frameId,stoppedLocation:F.from(r.stoppedLocation)}}e.from=t;function i(r){return new Tv(r.frameId,F.to(r.stoppedLocation))}e.to=i})(sf||(sf={}));var ba;(function(e){function t(r){return{range:F.from(r.range),kind:r.kind}}e.from=t;function i(r){return new sh(F.to(r.range),r.kind)}e.to=i})(ba||(ba={}));var b1;(function(e){function t(r){return{uri:r.uri,highlights:r.highlights.map(ba.from)}}e.from=t;function i(r){return new oh(y.revive(r.uri),r.highlights.map(ba.to))}e.to=i})(b1||(b1={}));var x1;(function(e){function t(i){switch(i){case 1:return Yo.TriggerCharacter;case 2:return Yo.TriggerForIncompleteCompletions;case 0:default:return Yo.Invoke}}e.to=t})(x1||(x1={}));var S1;(function(e){function t(i){return{triggerKind:x1.to(i.triggerKind),triggerCharacter:i.triggerCharacter}}e.to=t})(S1||(S1={}));var of;(function(e){function t(r){switch(r){case Zl.Deprecated:return 1}}e.from=t;function i(r){switch(r){case 1:return Zl.Deprecated}}e.to=i})(of||(of={}));var af;(function(e){const t=new Map([[le.Method,0],[le.Function,1],[le.Constructor,2],[le.Field,3],[le.Variable,4],[le.Class,5],[le.Interface,7],[le.Struct,6],[le.Module,8],[le.Property,9],[le.Unit,12],[le.Value,13],[le.Constant,14],[le.Enum,15],[le.EnumMember,16],[le.Keyword,17],[le.Snippet,27],[le.Text,18],[le.Color,19],[le.File,20],[le.Reference,21],[le.Folder,23],[le.Event,10],[le.Operator,11],[le.TypeParameter,24],[le.Issue,26],[le.User,25]]);function i(s){return t.get(s)??9}e.from=i;const r=new Map([[0,le.Method],[1,le.Function],[2,le.Constructor],[3,le.Field],[4,le.Variable],[5,le.Class],[7,le.Interface],[6,le.Struct],[8,le.Module],[9,le.Property],[12,le.Unit],[13,le.Value],[14,le.Constant],[15,le.Enum],[16,le.EnumMember],[17,le.Keyword],[27,le.Snippet],[18,le.Text],[19,le.Color],[20,le.File],[21,le.Reference],[23,le.Folder],[10,le.Event],[11,le.Operator],[24,le.TypeParameter],[25,le.User],[26,le.Issue]]);function n(s){return r.get(s)??le.Property}e.to=n})(af||(af={}));var E1;(function(e){function t(i,r){const n=new uh(i.label);return n.insertText=i.insertText,n.kind=af.to(i.kind),n.tags=i.tags?.map(of.to),n.detail=i.detail,n.documentation=Kr(i.documentation)?pe.to(i.documentation):i.documentation,n.sortText=i.sortText,n.filterText=i.filterText,n.preselect=i.preselect,n.commitCharacters=i.commitCharacters,Fe.isIRange(i.range)?n.range=F.to(i.range):typeof i.range=="object"&&(n.range={inserting:F.to(i.range.insert),replacing:F.to(i.range.replace)}),n.keepWhitespace=typeof i.insertTextRules>"u"?!1:!!(i.insertTextRules&1),typeof i.insertTextRules<"u"&&i.insertTextRules&4?n.insertText=new Ms(i.insertText):(n.insertText=i.insertText,n.textEdit=n.range instanceof ye?new Hn(n.range,n.insertText):void 0),i.additionalTextEdits&&i.additionalTextEdits.length>0&&(n.additionalTextEdits=i.additionalTextEdits.map(s=>Lt.to(s))),n.command=r&&i.command?r.fromInternal(i.command):void 0,n}e.to=t})(E1||(E1={}));var lf;(function(e){function t(r){if(typeof r.label!="string"&&!Array.isArray(r.label))throw new TypeError("Invalid label");return{label:r.label,documentation:pe.fromStrict(r.documentation)}}e.from=t;function i(r){return{label:r.label,documentation:Kr(r.documentation)?pe.to(r.documentation):r.documentation}}e.to=i})(lf||(lf={}));var cf;(function(e){function t(r){return{label:r.label,documentation:pe.fromStrict(r.documentation),parameters:Array.isArray(r.parameters)?r.parameters.map(lf.from):[],activeParameter:r.activeParameter}}e.from=t;function i(r){return{label:r.label,documentation:Kr(r.documentation)?pe.to(r.documentation):r.documentation,parameters:Array.isArray(r.parameters)?r.parameters.map(lf.to):[],activeParameter:r.activeParameter}}e.to=i})(cf||(cf={}));var Cc;(function(e){function t(r){return{activeSignature:r.activeSignature,activeParameter:r.activeParameter,signatures:Array.isArray(r.signatures)?r.signatures.map(cf.from):[]}}e.from=t;function i(r){return{activeSignature:r.activeSignature,activeParameter:r.activeParameter,signatures:Array.isArray(r.signatures)?r.signatures.map(cf.to):[]}}e.to=i})(Cc||(Cc={}));var C1;(function(e){function t(i,r){const n=new ch(Be.to(r.position),typeof r.label=="string"?r.label:r.label.map(D1.to.bind(void 0,i)),r.kind&&uf.to(r.kind));return n.textEdits=r.textEdits&&r.textEdits.map(Lt.to),n.tooltip=Kr(r.tooltip)?pe.to(r.tooltip):r.tooltip,n.paddingLeft=r.paddingLeft,n.paddingRight=r.paddingRight,n}e.to=t})(C1||(C1={}));var D1;(function(e){function t(i,r){const n=new lh(r.label);return n.tooltip=Kr(r.tooltip)?pe.to(r.tooltip):r.tooltip,_m.is(r.command)&&(n.command=i.fromInternal(r.command)),r.location&&(n.location=vi.to(r.location)),n}e.to=t})(D1||(D1={}));var uf;(function(e){function t(r){return r}e.from=t;function i(r){return r}e.to=i})(uf||(uf={}));var Zs;(function(e){function t(r){return{range:F.from(r.range),url:r.target,tooltip:r.tooltip}}e.from=t;function i(r){let n;if(r.url)try{n=typeof r.url=="string"?y.parse(r.url,!0):y.revive(r.url)}catch{}const s=new hh(F.to(r.range),n);return s.tooltip=r.tooltip,s}e.to=i})(Zs||(Zs={}));var df;(function(e){function t(r){const n=new ph(r.label);return r.textEdit&&(n.textEdit=Lt.to(r.textEdit)),r.additionalTextEdits&&(n.additionalTextEdits=r.additionalTextEdits.map(s=>Lt.to(s))),n}e.to=t;function i(r){return{label:r.label,textEdit:r.textEdit?Lt.from(r.textEdit):void 0,additionalTextEdits:r.additionalTextEdits?r.additionalTextEdits.map(n=>Lt.from(n)):void 0}}e.from=i})(df||(df={}));var xa;(function(e){function t(r){return new oa(r[0],r[1],r[2],r[3])}e.to=t;function i(r){return[r.red,r.green,r.blue,r.alpha]}e.from=i})(xa||(xa={}));var I1;(function(e){function t(r){return{range:F.from(r.range)}}e.from=t;function i(r){return new Xl(F.to(r.range))}e.to=i})(I1||(I1={}));var hf;(function(e){function t(i){switch(i){case 2:return ia.AfterDelay;case 1:return ia.Manual;case 3:case 4:return ia.FocusOut}}e.to=t})(hf||(hf={}));var Sa;(function(e){function t(r){switch(r){case dr.Off:return 0;case dr.Relative:return 2;case dr.Interval:return 3;case dr.On:default:return 1}}e.from=t;function i(r){switch(r){case 0:return dr.Off;case 2:return dr.Relative;case 3:return dr.Interval;case 1:default:return dr.On}}e.to=i})(Sa||(Sa={}));var Ea;(function(e){function t(r){if(r===ur.CRLF)return 1;if(r===ur.LF)return 0}e.from=t;function i(r){if(r===1)return ur.CRLF;if(r===0)return ur.LF}e.to=i})(Ea||(Ea={}));var k1;(function(e){function t(i){if(typeof i=="object")return i.viewId;switch(i){case Us.SourceControl:return 3;case Us.Window:return 10;case Us.Notification:return 15}throw new Error("Unknown 'ProgressLocation'")}e.from=t})(k1||(k1={}));var ff;(function(e){function t(r){const n={start:r.start+1,end:r.end+1};return r.kind&&(n.kind=pf.from(r.kind)),n}e.from=t;function i(r){const n={start:r.start-1,end:r.end-1};return r.kind&&(n.kind=pf.to(r.kind)),n}e.to=i})(ff||(ff={}));var pf;(function(e){function t(r){if(r)switch(r){case an.Comment:return Ho.Comment;case an.Imports:return Ho.Imports;case an.Region:return Ho.Region}}e.from=t;function i(r){if(r)switch(r.value){case Ho.Comment.value:return an.Comment;case Ho.Imports.value:return an.Imports;case Ho.Region.value:return an.Region}}e.to=i})(pf||(pf={}));var Dc;(function(e){function t(i){if(i)return{pinned:typeof i.preview=="boolean"?!i.preview:void 0,inactive:i.background,preserveFocus:i.preserveFocus,selection:typeof i.selection=="object"?F.from(i.selection):void 0,override:typeof i.override=="boolean"?OA.id:void 0}}e.from=t})(Dc||(Dc={}));var Li;(function(e){function t(s){return s instanceof ua?s.toJSON():typeof s=="string"?s:i(s)||r(s)?new ua(s.baseUri??s.base,s.pattern).toJSON():s}e.from=t;function i(s){const o=s;return o?y.isUri(o.baseUri)&&typeof o.pattern=="string":!1}function r(s){const o=s;return o?typeof o.base=="string"&&typeof o.pattern=="string":!1}function n(s){return typeof s=="string"?s:new ua(y.revive(s.baseUri),s.pattern)}e.to=n})(Li||(Li={}));var P1;(function(e){function t(i){if(i){if(Array.isArray(i))return i.map(t);if(typeof i=="string")return i;{const r=i;return{language:r.language,scheme:r.scheme,pattern:Li.from(r.pattern)??void 0,exclusive:r.exclusive,notebookType:r.notebookType}}}else return}e.from=t})(P1||(P1={}));var Or;(function(e){function t(r){return{start:r.start,end:r.end}}e.from=t;function i(r){return new ln(r.start,r.end)}e.to=i})(Or||(Or={}));var Ca;(function(e){function t(r){return{timing:typeof r.runStartTime=="number"&&typeof r.runEndTime=="number"?{startTime:r.runStartTime,endTime:r.runEndTime}:void 0,executionOrder:r.executionOrder,success:r.lastRunSuccess}}e.to=t;function i(r){return{lastRunSuccess:r.success,runStartTime:r.timing?.startTime,runEndTime:r.timing?.endTime,executionOrder:r.executionOrder}}e.from=i})(Ca||(Ca={}));var T1;(function(e){function t(i){if(i===Ll.Unconfirmed)return ga.Pending;if(i===Ll.Pending)return;if(i===Ll.Executing)return ga.Executing;throw new Error(`Unknown state: ${i}`)}e.to=t})(T1||(T1={}));var Ic;(function(e){function t(r){switch(r){case qs.Markup:return qo.Markup;case qs.Code:default:return qo.Code}}e.from=t;function i(r){switch(r){case qo.Markup:return qs.Markup;case qo.Code:default:return qs.Code}}e.to=i})(Ic||(Ic={}));var Gn;(function(e){function t(r){const n={metadata:r.metadata??Object.create(null),cells:[]};for(const s of r.cells)Ph.validate(s),n.cells.push(Da.from(s));return n}e.from=t;function i(r){const n=new b4(r.cells.map(Da.to));return cy(r.metadata)||(n.metadata=r.metadata),n}e.to=i})(Gn||(Gn={}));var Da;(function(e){function t(r){return{cellKind:Ic.from(r.kind),language:r.languageId,mime:r.mime,source:r.value,metadata:r.metadata,internalMetadata:Ca.from(r.executionSummary??{}),outputs:r.outputs?r.outputs.map(Qn.from):[]}}e.from=t;function i(r){return new Ph(Ic.to(r.cellKind),r.source,r.language,r.mime,r.outputs?r.outputs.map(Qn.to):void 0,r.metadata,r.internalMetadata?Ca.to(r.internalMetadata):void 0)}e.to=i})(Da||(Da={}));var Ia;(function(e){function t(r){return{mime:r.mime,valueBytes:ae.wrap(r.data)}}e.from=t;function i(r){return new x4(r.valueBytes.buffer,r.mime)}e.to=i})(Ia||(Ia={}));var Qn;(function(e){function t(r){return{outputId:r.id,items:r.items.map(Ia.from),metadata:r.metadata}}e.from=t;function i(r){const n=r.items.map(Ia.to);return new Th(n,r.outputId,r.metadata)}e.to=i})(Qn||(Qn={}));var gf;(function(e){function t(n){return r(n)?{include:Li.from(n.include)??void 0,exclude:Li.from(n.exclude)??void 0}:Li.from(n)??void 0}e.from=t;function i(n){return r(n)?{include:Li.to(n.include),exclude:Li.to(n.exclude)}:Li.to(n)}e.to=i;function r(n){const s=n;return s?!Et(s.include)&&!Et(s.exclude):!1}})(gf||(gf={}));var A1;(function(e){function t(i,r,n){const s=typeof i.command=="string"?{title:"",command:i.command}:i.command;return{alignment:i.alignment===Ah.Left?1:2,command:r.toInternal(s,n),text:i.text,tooltip:i.tooltip,accessibilityInformation:i.accessibilityInformation,priority:i.priority}}e.from=t})(A1||(A1={}));var R1;(function(e){function t(i,r,n){const s=typeof i.command=="string"?{title:"",command:i.command}:i.command;return{command:r.toInternal(s,n),label:i.label,description:i.description,detail:i.detail,documentation:i.documentation}}e.from=t})(R1||(R1={}));var L1;(function(e){function t(i){return{transientOutputs:i?.transientOutputs??!1,transientCellMetadata:i?.transientCellMetadata??{},transientDocumentMetadata:i?.transientDocumentMetadata??{},cellContentMetadata:i?.cellContentMetadata??{}}}e.from=t})(L1||(L1={}));var mf;(function(e){function t(r){return{uri:r.uri,provides:r.provides}}e.from=t;function i(r){return new S4(y.revive(r.uri),r.provides)}e.to=i})(mf||(mf={}));var ka;(function(e){function t(r){return{message:pe.fromStrict(r.message)||"",type:0,expected:r.expectedOutput,actual:r.actualOutput,contextValue:r.contextValue,location:r.location&&{range:F.from(r.location.range),uri:r.location.uri},stackTrace:r.stackTrace?.map(n=>({label:n.label,position:n.position&&Be.from(n.position),uri:n.uri&&y.revive(n.uri).toJSON()}))}}e.from=t;function i(r){const n=new Oh(typeof r.message=="string"?r.message:pe.to(r.message));return n.actualOutput=r.actual,n.expectedOutput=r.expected,n.contextValue=r.contextValue,n.location=r.location?vi.to(r.location):void 0,n}e.to=i})(ka||(ka={}));var pr;(function(e){e.namespace=qd,e.denamespace=TC})(pr||(pr={}));var N1;(function(e){function t(i){return{controllerId:i.controllerId,profileId:i.profileId,group:Pa.from(i.kind)}}e.from=t})(N1||(N1={}));var Pa;(function(e){const t={[va.Coverage]:8,[va.Debug]:4,[va.Run]:2};function i(r){return t.hasOwnProperty(r)?t[r]:2}e.from=i})(Pa||(Pa={}));var Jn;(function(e){function t(r){const n=Kd(r).controllerId;return{extId:Re.fromExtHostTestItem(r,n).toString(),label:r.label,uri:y.revive(r.uri),busy:r.busy,tags:r.tags.map(s=>pr.namespace(n,s.id)),range:Fe.lift(F.from(r.range)),description:r.description||null,sortText:r.sortText||null,error:r.error&&pe.fromStrict(r.error)||null}}e.from=t;function i(r){return{parent:void 0,error:void 0,id:Re.fromString(r.extId).localId,label:r.label,uri:y.revive(r.uri),tags:(r.tags||[]).map(n=>{const{tagId:s}=pr.denamespace(n);return new pc(s)}),children:{add:()=>{},delete:()=>{},forEach:()=>{},*[Symbol.iterator](){},get:()=>{},replace:()=>{},size:0},range:F.to(r.range||void 0),canResolveChildren:!1,busy:r.busy,description:r.description||void 0,sortText:r.sortText||void 0}}e.toPlain=i})(Jn||(Jn={})),function(e){function t(r){return{id:r.id}}e.from=t;function i(r){return new pc(r.id)}e.to=i}(pr||(pr={}));var M1;(function(e){const t=(r,n)=>{const s=r.value;if(!s)return;const o={...Jn.toPlain(s.item),parent:n,taskStates:s.tasks.map(a=>({state:a.state,duration:a.duration,messages:a.messages.filter(l=>l.type===0).map(ka.to)})),children:[]};if(r.children)for(const a of r.children.values()){const l=t(a,o);l&&o.children.push(l)}return o};function i(r){const n=new DA;for(const a of r.items)n.insert(Re.fromString(a.item.extId).path,a);const s=[n.nodes],o=[];for(;s.length;)for(const a of s.pop())a.value?o.push(a):a.children&&s.push(a.children.values());return{completedAt:r.completedAt,results:o.map(a=>t(a)).filter(ji)}}e.to=i})(M1||(M1={}));var kc;(function(e){function t(a){return{covered:a.covered,total:a.total}}function i(a){return"line"in a?Be.from(a):F.from(a)}function r(a){if(a)return"endLineNumber"in a?F.to(a):Be.to(a)}function n(a){if(a.type===1){const l=[];if(a.branches)for(const c of a.branches)l.push({executed:c.count,location:r(c.location),label:c.label});return new C4(a.count,r(a.location),a.branches?.map(c=>new D4(c.count,r(c.location),c.label)))}else return new I4(a.name,a.count,r(a.location))}e.to=n;function s(a){if(typeof a.executed=="number"&&a.executed<0)throw new Error(`Invalid coverage count ${a.executed}`);return"branches"in a?{count:a.executed,location:i(a.location),type:1,branches:a.branches.length?a.branches.map(l=>({count:l.executed,location:l.location&&i(l.location),label:l.label})):void 0}:{type:0,name:a.name,count:a.executed,location:i(a.location)}}e.fromDetails=s;function o(a,l,c){return $h(c.statementCoverage),$h(c.branchCoverage),$h(c.declarationCoverage),{id:l,uri:c.uri,statement:t(c.statementCoverage),branch:c.branchCoverage&&t(c.branchCoverage),declaration:c.declarationCoverage&&t(c.declarationCoverage),testIds:c instanceof Hh&&c.includesTests.length?c.includesTests.map(u=>Re.fromExtHostTestItem(u,a).toString()):void 0}}e.fromFile=o})(kc||(kc={}));var O1;(function(e){function t(i){switch(i){case 1:return Ql.Invoke;case 2:return Ql.Automatic}}e.to=t})(O1||(O1={}));var Ks;(function(e){function t(r){const n=new zv(Xi.to(r.kind),r.name,r.detail||"",y.revive(r.uri),F.to(r.range),F.to(r.selectionRange));return n._sessionId=r._sessionId,n._itemId=r._itemId,n}e.to=t;function i(r,n,s){if(n=n??r._sessionId,s=s??r._itemId,n===void 0||s===void 0)throw new Error("invalid item");return{_sessionId:n,_itemId:s,kind:Xi.from(r.kind),name:r.name,detail:r.detail??"",uri:r.uri,range:F.from(r.range),selectionRange:F.from(r.selectionRange),tags:r.tags?.map(un.from)}}e.from=i})(Ks||(Ks={}));var vf;(function(e){function t(i){if(i)return{value:i.value,tooltip:i.tooltip}}e.from=t})(vf||(vf={}));var Ys;(function(e){function t(s,o,a){const l=o.fileData;return l?new b2(new x2(l.name,y.revive(l.uri),l.id,sg(()=>a(l.id)))):s===Yr.uriList&&o.uriListData?new _h(n(o.uriListData)):new _h(o.asString)}e.to=t;async function i(s,o,a=$t()){const l=await o.asString();if(s===Yr.uriList)return{id:a,asString:l,fileData:void 0,uriListData:r(l)};const c=o.asFile();return{id:a,asString:l,fileData:c?{name:c.name,uri:c.uri,id:c._itemId??c.id}:void 0}}e.from=i;function r(s){return tm.split(s).map(o=>{if(o.startsWith("#"))return o;try{return y.parse(o)}catch{}return o})}function n(s){return tm.create(s.map(o=>typeof o=="string"?o:y.revive(o)))}})(Ys||(Ys={}));var Ta;(function(e){function t(n,s){const o=n.items.map(([a,l])=>[a,Ys.to(a,l,s)]);return new la(o)}e.toDataTransfer=t;async function i(n){return{items:await Promise.all(Array.from(n,async([o,a])=>[o,await Ys.from(o,a)]))}}e.from=i;async function r(n){return{items:await Promise.all(Array.from(n,async([o,a])=>[o,await Ys.from(o,a,a.id)]))}}e.fromList=r})(Ta||(Ta={}));var Pc;(function(e){function t(r,n){return{kind:"reply",agentId:r.participant??n?.agentId??"",subCommand:r.command??n?.command,message:r.prompt,title:r.label}}e.from=t;function i(r){return{prompt:r.message,label:r.title,participant:r.agentId,command:r.subCommand}}e.to=i})(Pc||(Pc={}));var Aa;(function(e){function t(r){switch(r){case 0:return Ai.System;case 1:return Ai.User;case 2:return Ai.Assistant}}e.to=t;function i(r){switch(r){case Ai.System:return 0;case Ai.User:return 1;case Ai.Assistant:return 2}return 1}e.from=i})(Aa||(Aa={}));var X4;(function(e){function t(r){const n=r.content.map(a=>{if(a.type==="text")return new mt(a.value);if(a.type==="tool_result"){const l=a.value.map(c=>c.type==="text"?new mt(c.value):new Nr(c.value));return new Xh(a.toolCallId,l,a.isError)}else return a.type==="image_url"||a.type==="extra_data"?void 0:new Qs(a.toolCallId,a.name,a.parameters)}).filter(a=>a!==void 0),s=Aa.to(r.role);return new H4(s,n,r.name)}e.to=t;function i(r){const n=Aa.from(r.role),s=r.name;let o=r.content;typeof o=="string"&&(o=[new mt(o)]);const a=o.map(l=>{if(l instanceof Xh)return{type:"tool_result",toolCallId:l.callId,value:xt(l.content.map(c=>c instanceof mt?{type:"text",value:c.value}:c instanceof Nr?{type:"prompt_tsx",value:c.value}:void 0)),isError:l.isError};if(l instanceof Qs)return{type:"tool_use",toolCallId:l.callId,name:l.name,parameters:l.input};if(l instanceof mt)return{type:"text",value:l.value};if(typeof l!="string")throw new Error("Unexpected chat message content type");return{type:"text",value:l}});return{role:n,name:s,content:a}}e.from=i})(X4||(X4={}));var Tc;(function(e){function t(r){const n=r.content.map(a=>{if(a.type==="text")return new mt(a.value);if(a.type==="tool_result"){const l=a.value.map(c=>c.type==="text"?new mt(c.value):c.type==="data"?new qn(c.value.data.buffer,c.value.mimeType):new Nr(c.value));return new n1(a.toolCallId,l,a.isError)}else return a.type==="image_url"?new qn(a.value.data.buffer,a.value.mimeType):a.type==="extra_data"?new o1(a.kind,a.data):new Qs(a.toolCallId,a.name,a.parameters)}),s=Aa.to(r.role);return new U4(s,n,r.name)}e.to=t;function i(r){const n=Aa.from(r.role),s=r.name;let o=r.content;typeof o=="string"&&(o=[new mt(o)]);const a=o.map(l=>{if(l instanceof n1||l instanceof Xh)return{type:"tool_result",toolCallId:l.callId,value:xt(l.content.map(c=>c instanceof mt?{type:"text",value:c.value}:c instanceof Nr?{type:"prompt_tsx",value:c.value}:c instanceof qn?{type:"data",value:{mimeType:c.mimeType,data:ae.wrap(c.data)}}:void 0)),isError:l.isError};if(l instanceof qn)return{type:"image_url",value:{mimeType:l.mimeType,data:ae.wrap(l.data)}};if(l instanceof Qs)return{type:"tool_use",toolCallId:l.callId,name:l.name,parameters:l.input};if(l instanceof mt)return{type:"text",value:l.value};if(l instanceof o1)return{type:"extra_data",kind:l.kind,data:l.data};if(typeof l!="string")throw new Error("Unexpected chat message content type llm 2");return{type:"text",value:l}});return{role:n,name:s,content:a}}e.from=i})(Tc||(Tc={}));var Ac;(function(e){function t(r){return{kind:"markdownContent",content:pe.from(r.value)}}e.from=t;function i(r){return new Bh(pe.to(r.content))}e.to=i})(Ac||(Ac={}));var _f;(function(e){function t(r){return{kind:"codeblockUri",uri:r.value,isEdit:r.isEdit}}e.from=t;function i(r){return new jh(y.revive(r.uri),r.isEdit)}e.to=i})(_f||(_f={}));var wf;(function(e){function t(r){return{kind:"markdownVuln",content:pe.from(r.value),vulnerabilities:r.vulnerabilities}}e.from=t;function i(r){return new mc(pe.to(r.content),r.vulnerabilities)}e.to=i})(wf||(wf={}));var yf;(function(e){function t(i){return{kind:"confirmation",title:i.title,message:i.message,data:i.data,buttons:i.buttons}}e.from=t})(yf||(yf={}));var Rc;(function(e){function t(r){const{value:n,baseUri:s}=r;function o(a,l){return a.map(c=>{const u=y.joinPath(l,c.name);return{label:c.name,uri:u,children:c.children&&o(c.children,u)}})}return{kind:"treeData",treeData:{label:nr(s),uri:s,children:o(n,s)}}}e.from=t;function i(r){const n=Pt(r.treeData);function s(l){return l.map(c=>({name:c.label,children:c.children&&s(c.children)}))}const o=n.uri,a=n.children?s(n.children):[];return new Vh(a,o)}e.to=i})(Rc||(Rc={}));var Ra;(function(e){function t(r){const n=o=>y.isUri(o),s=o=>"name"in o;return{kind:"inlineReference",name:r.title,inlineReference:n(r.value)?r.value:s(r.value)?Js.from(r.value):Mr.from(r.value)}}e.from=t;function i(r){const n=Pt(r);return new vc(y.isUri(n.inlineReference)?n.inlineReference:"location"in n.inlineReference?Js.to(n.inlineReference):Mr.to(n.inlineReference),r.name)}e.to=i})(Ra||(Ra={}));var Lc;(function(e){function t(r){return{kind:"progressMessage",content:pe.from(r.value)}}e.from=t;function i(r){return new e1(r.content.value)}e.to=i})(Lc||(Lc={}));var Nc;(function(e){function t(r){return{kind:"warning",content:pe.from(r.value)}}e.from=t;function i(r){return new _c(r.content.value)}e.to=i})(Nc||(Nc={}));var F1;(function(e){function t(i){return{kind:"extensions",extensions:i.extensions}}e.from=t})(F1||(F1={}));var $1;(function(e){function t(r){return{kind:"move",uri:r.uri,range:F.from(r.range)}}e.from=t;function i(r){return new Qh(y.revive(r.uri),F.to(r.range))}e.to=i})($1||($1={}));var bf;(function(e){function t(i){return{kind:"progressTask",content:pe.from(i.value)}}e.from=t})(bf||(bf={}));var H1;(function(e){function t(i){return{kind:"progressTaskResult",content:typeof i=="string"?pe.from(i):void 0}}e.from=t})(H1||(H1={}));var Mc;(function(e){function t(r,n,s){return{kind:"command",command:n.toInternal(r.value,s)??{command:r.value.command,title:r.value.title}}}e.from=t;function i(r,n){return new qh(n.fromInternal(r.command)??{command:r.command.id,title:r.command.title})}e.to=i})(Mc||(Mc={}));var xf;(function(e){function t(r){return{kind:"textEdit",uri:r.uri,edits:r.edits.map(n=>Lt.from(n)),done:r.isDone}}e.from=t;function i(r){const n=new wc(y.revive(r.uri),r.edits.map(s=>Lt.to(s)));return n.isDone=r.done,n}e.to=i})(xf||(xf={}));var Sf;(function(e){function t(i){return i.newCellMetadata?{editType:3,index:i.range.start,metadata:i.newCellMetadata}:i.newNotebookMetadata?{editType:5,metadata:i.newNotebookMetadata}:{editType:1,index:i.range.start,count:i.range.end-i.range.start,cells:i.newCells.map(Da.from)}}e.from=t})(Sf||(Sf={}));var Ef;(function(e){function t(i){return{kind:"notebookEdit",uri:i.uri,edits:i.edits.map(Sf.from),done:i.isDone}}e.from=t})(Ef||(Ef={}));var eo;(function(e){function t(r){const n=kt.isThemeIcon(r.iconPath)?r.iconPath:y.isUri(r.iconPath)?{light:y.revive(r.iconPath)}:r.iconPath&&"light"in r.iconPath&&"dark"in r.iconPath&&y.isUri(r.iconPath.light)&&y.isUri(r.iconPath.dark)?{light:y.revive(r.iconPath.light),dark:y.revive(r.iconPath.dark)}:void 0;return typeof r.value=="object"&&"variableName"in r.value?{kind:"reference",reference:{variableName:r.value.variableName,value:y.isUri(r.value.value)||!r.value.value?r.value.value:Mr.from(r.value.value)},iconPath:n,options:r.options}:{kind:"reference",reference:y.isUri(r.value)||typeof r.value=="string"?r.value:Mr.from(r.value),iconPath:n,options:r.options}}e.from=t;function i(r){const n=Pt(r),s=o=>y.isUri(o)?o:Mr.to(o);return new Gs(typeof n.reference=="string"?n.reference:"variableName"in n.reference?{variableName:n.reference.variableName,value:n.reference.value&&s(n.reference.value)}:s(n.reference))}e.to=i})(eo||(eo={}));var Cf;(function(e){function t(i){return{kind:"codeCitation",value:i.value,license:i.license,snippet:i.snippet}}e.from=t})(Cf||(Cf={}));var Df;(function(e){function t(n,s,o){return n instanceof Bh?Ac.from(n):n instanceof vc?Ra.from(n):n instanceof Gs?eo.from(n):n instanceof e1?Lc.from(n):n instanceof Vh?Rc.from(n):n instanceof qh?Mc.from(n,s,o):n instanceof wc?xf.from(n):n instanceof Jh?Ef.from(n):n instanceof mc?wf.from(n):n instanceof jh?_f.from(n):n instanceof _c?Nc.from(n):n instanceof Wh?yf.from(n):n instanceof Gh?Cf.from(n):n instanceof Qh?$1.from(n):n instanceof t1?F1.from(n):{kind:"markdownContent",content:pe.from("")}}e.from=t;function i(n,s){switch(n.kind){case"reference":return eo.to(n);case"markdownContent":case"inlineReference":case"progressMessage":case"treeData":case"command":return r(n,s)}}e.to=i;function r(n,s){switch(n.kind){case"markdownContent":return Ac.to(n);case"inlineReference":return Ra.to(n);case"progressMessage":return;case"treeData":return Rc.to(n);case"command":return Mc.to(n,s)}}e.toContent=r})(Df||(Df={}));var If;(function(e){function t(i,r,n,s,o,a,l){const c=i.variables.variables.filter(f=>f.kind==="tool"),u=i.variables.variables.filter(f=>f.kind!=="tool"),d={id:i.requestId,prompt:i.message,command:i.command,attempt:i.attempt??0,enableCommandDetection:i.enableCommandDetection??!0,isParticipantDetected:i.isParticipantDetected??!1,references:u.map(f=>kf.to(f,s)),toolReferences:c.map(Pf.to),location:Oc.to(i.location),acceptedConfirmationData:i.acceptedConfirmationData,rejectedConfirmationData:i.rejectedConfirmationData,location2:r,toolInvocationToken:Object.freeze({sessionId:i.sessionId}),toolSelection:o,tools:a,model:n,editedFileEvents:i.editedFileEvents};return Ke(l,"chatParticipantPrivate")||(delete d.id,delete d.attempt,delete d.enableCommandDetection,delete d.isParticipantDetected,delete d.location,delete d.location2,delete d.editedFileEvents),Ke(l,"chatParticipantAdditions")||(delete d.acceptedConfirmationData,delete d.rejectedConfirmationData,delete d.tools),d}e.to=t})(If||(If={}));var U1;(function(e){function t(i){return{prompt:i.prompt,files:i.files.map(r=>y.revive(r))}}e.to=t})(U1||(U1={}));var Oc;(function(e){function t(r){switch(r){case ii.Notebook:return hr.Notebook;case ii.Terminal:return hr.Terminal;case ii.Panel:return hr.Panel;case ii.Editor:return hr.Editor}}e.to=t;function i(r){switch(r){case hr.Notebook:return ii.Notebook;case hr.Terminal:return ii.Terminal;case hr.Panel:return ii.Panel;case hr.Editor:return ii.Editor}}e.from=i})(Oc||(Oc={}));var kf;(function(e){function t(i,r){let n=i.value;if(!n)throw new Error("Invalid value reference");if(Wu(n))n=y.revive(n);else if(n&&typeof n=="object"&&"uri"in n&&"range"in n&&Wu(n.uri))n=Mr.to(Pt(n));else if(TR(i)){const s=i.references?.[0]?.reference;n=new F4(i.mimeType??"image/png",()=>Promise.resolve(new Uint8Array(Object.values(i.value))),s&&y.isUri(s)?s:void 0)}else if(i.kind==="diagnostic"){const s=i.filterSeverity&&xc.to(i.filterSeverity),o=i.filterUri&&y.revive(i.filterUri).toString();n=new $4(r.map(([a,l])=>i.filterUri&&a.toString()!==o?[a,[]]:[a,l.filter(c=>!(s&&c.severity>s||i.filterRange&&!Fe.areIntersectingOrTouching(i.filterRange,F.from(c.range))))]).filter(([,a])=>a.length>0))}return{id:i.id,name:i.name,range:i.range&&[i.range.start,i.range.endExclusive],value:n,modelDescription:i.modelDescription}}e.to=t})(kf||(kf={}));var Pf;(function(e){function t(i){if(i.value)throw new Error("Invalid tool reference");return{name:i.id,range:i.range&&[i.range.start,i.range.endExclusive]}}e.to=t})(Pf||(Pf={}));var B1;(function(e){function t(i,r,n){return{id:i.id,label:i.label,fullName:i.fullName,icon:i.icon?.id,value:i.values[0].value,insertText:i.insertText,detail:i.detail,documentation:i.documentation,command:r.toInternal(i.command,n)}}e.from=t})(B1||(B1={}));var La;(function(e){function t(n){return{errorDetails:n.errorDetails,metadata:r(n.metadata),nextQuestion:n.nextQuestion}}e.to=t;function i(n){return{errorDetails:n.errorDetails,metadata:n.metadata,nextQuestion:n.nextQuestion}}e.from=i;function r(n){return Mo(n,s=>{if(s.$mid===20)return new Kh(Mo(s.content,r));if(s.$mid===21)return new mt(s.value);if(s.$mid===22)return new Nr(s.value)})}})(La||(La={}));var W1;(function(e){function t(i,r,n){if(r.action.kind==="vote")return;const s=La.to(i);if(r.action.kind==="command"){const o=r.action.commandButton.command;return{action:{kind:"command",commandButton:{command:n.fromInternal(o)??{command:o.id,title:o.title}}},result:s}}else return r.action.kind==="followUp"?{action:{kind:"followUp",followup:Pc.to(r.action.followup)},result:s}:r.action.kind==="inlineChat"?{action:{kind:"editor",accepted:r.action.action==="accepted"},result:s}:r.action.kind==="chatEditingSessionAction"?{action:{kind:"chatEditingSessionAction",outcome:new Map([["accepted",js.Accepted],["rejected",js.Rejected],["saved",js.Saved]]).get(r.action.outcome)??js.Rejected,uri:y.revive(r.action.uri),hasRemainingEdits:r.action.hasRemainingEdits},result:s}:{action:r.action,result:s}}e.to=t})(W1||(W1={}));var Tf;(function(e){function t(i,r,n){return"terminalCommand"in i?{terminalCommand:i.terminalCommand,shouldExecute:i.shouldExecute}:"uri"in i?{uri:i.uri}:r.toInternal(i,n)}e.from=t})(Tf||(Tf={}));var Af;(function(e){function t(i){return{...i,documentation:pe.fromStrict(i.documentation)}}e.from=t})(Af||(Af={}));var V1;(function(e){function t(i){return Array.isArray(i)?{items:i.map(r=>Af.from(r))}:{items:i.items.map(r=>Af.from(r)),resourceRequestConfig:i.resourceRequestConfig?z1.from(i.resourceRequestConfig):void 0}}e.from=t})(V1||(V1={}));var z1;(function(e){function t(i){return{...i,pathSeparator:oi?"\\":"/",cwd:i.cwd?y.revive(i.cwd):void 0}}e.from=t})(z1||(z1={}));var q1;(function(e){function t(i){return{kind:j1.to(i.kind),acceptedLength:i.acceptedLength}}e.to=t})(q1||(q1={}));var j1;(function(e){function t(i){switch(i){case 0:return Fs.Word;case 1:return Fs.Line;case 2:return Fs.Suggest;default:return Fs.Unknown}}e.to=t})(j1||(j1={}));var G1;(function(e){function t(i,r){if(i.kind===fd.Ignored){const n=i.supersededBy?r(i.supersededBy):void 0;return{kind:ta.Ignored,supersededBy:n,userTypingDisagreed:i.userTypingDisagreed}}else if(i.kind===fd.Accepted)return{kind:ta.Accepted};return{kind:ta.Rejected}}e.to=t})(G1||(G1={}));var Q1;(function(e){function t(i,r){return{id:r,label:i.label,description:i.description,canEdit:i.canEdit,collapsibleState:i.collapsibleState||0,contextValue:i.contextValue}}e.from=t})(Q1||(Q1={}));var Z4;(function(e){function t(i){return{name:i.id,description:i.modelDescription,inputSchema:i.inputSchema,tags:i.tags??[]}}e.to=t})(Z4||(Z4={}));var K4;(function(e){function t(r){return new Kh(r.content.map(n=>n.kind==="text"?new mt(n.value):new Nr(n.value)))}e.to=t;function i(r,n){return r.toolResultMessage&&N(n,"chatParticipantPrivate"),{content:r.content.map(s=>{if(s instanceof mt)return{kind:"text",value:s.value};if(s instanceof Nr)return{kind:"promptTsx",value:s.value};throw new Error("Unknown LanguageModelToolResult part type")}),toolResultMessage:pe.fromStrict(r.toolResultMessage),toolResultDetails:r.toolResultDetails?.map(s=>y.isUri(s)?s:Mr.from(s))}}e.from=i})(K4||(K4={}));var Rf;(function(e){function t(r){return new B4(r.content.map(n=>{if(n.kind==="text")return new mt(n.value);if(n.kind==="data"){const s=Object.values(Zh).includes(n.value.mimeType)?n.value.mimeType:void 0;if(!s)throw new Error("Invalid MIME type");return new qn(n.value.data.buffer,s)}else return new Nr(n.value)}))}e.to=t;function i(r,n){r.toolResultMessage&&N(n,"chatParticipantPrivate");let s=!1;const o={content:r.content.map(a=>{if(a instanceof mt)return{kind:"text",value:a.value};if(a instanceof Nr)return{kind:"promptTsx",value:a.value};if(a instanceof qn)return s=!0,{kind:"data",value:{mimeType:a.mimeType,data:ae.wrap(a.data)}};throw new Error("Unknown LanguageModelToolResult part type")}),toolResultMessage:pe.fromStrict(r.toolResultMessage),toolResultDetails:r.toolResultDetails?.map(a=>y.isUri(a)?a:Mr.from(a))};return s?new ai(o):o}e.from=i})(Rf||(Rf={}));var J1;(function(e){function t(i){return i}e.fromThemeIcon=t})(J1||(J1={}));var X1;(function(e){function t(r){return{query:r.query,kind:i(r.kind),settings:r.settings}}e.fromSettingsSearchResult=t;function i(r){switch(r){case jn.EMBEDDED:return jn.EMBEDDED;case jn.LLM_RANKED:return jn.LLM_RANKED;case jn.CANCELED:return jn.CANCELED;default:throw new Error("Unknown AiSettingsSearchResultKind")}}})(X1||(X1={}));var Fc;(function(e){function t(r){return!!r.uri}function i(r){return bc.toSerialized(t(r)?{type:2,uri:r.uri,headers:Object.entries(r.headers)}:{type:1,cwd:r.cwd,args:r.args,command:r.command,env:r.env,envFile:void 0})}e.from=i})(Fc||(Fc={}));var Xn=class{constructor(e,t,i){this.uri=e,this.ranges=t,this.previewText=i}},Z1=class{constructor(e,t,i){this.uri=e,this.text=t,this.lineNumber=i}},K1=class{constructor(e){this.keyword=e}},dn;(function(e){e[e.None=1]="None",e[e.FilesExclude=2]="FilesExclude",e[e.SearchAndFilesExclude=3]="SearchAndFilesExclude"})(dn||(dn={}));var Lf;(function(e){e[e.Information=1]="Information",e[e.Warning=2]="Warning"})(Lf||(Lf={}));var Y4=2e4,eD="\u27EA ",tD=" characters skipped \u27EB",z2=(eD.length+tD.length+5)*2,Hz=U("searchService"),iD;(function(e){e[e.file=0]="file",e[e.text=1]="text",e[e.aiText=2]="aiText"})(iD||(iD={}));var rD;(function(e){e[e.File=1]="File",e[e.Text=2]="Text",e[e.aiText=3]="aiText"})(rD||(rD={}));function nD(e){return!!e.rangeLocations&&!!e.previewText}var sD;(function(e){e[e.Normal=0]="Normal",e[e.NewSearchStarted=1]="NewSearchStarted"})(sD||(sD={}));var q2=class{constructor(e,t,i,r){this.rangeLocations=[],this.webviewIndex=r;const n=Array.isArray(t)?t:[t];if(i&&i.matchLines===1&&j2(n)){e=YP(e,i.matchLines);let s="",o=0,a=0;const l=Math.floor(i.charsPerLine/5);for(const c of n){const u=Math.max(c.startColumn-l,0),d=c.startColumn+i.charsPerLine;if(u>a+l+z2){const f=eD+(u-a)+tD;s+=f+e.slice(u,d),o+=u-(a+f.length)}else s+=e.slice(a,d);a=d,this.rangeLocations.push({source:c,preview:new G2(0,c.startColumn-o,c.endColumn-o)})}this.previewText=s}else{const s=Array.isArray(t)?t[0].startLineNumber:t.startLineNumber,o=ig(t,a=>({preview:new oD(a.startLineNumber-s,a.startColumn,a.endLineNumber-s,a.endColumn),source:a}));this.rangeLocations=Array.isArray(o)?o:[o],this.previewText=e}}};function j2(e){const t=e[0].startLineNumber;for(const i of e)if(i.startLineNumber!==t||i.endLineNumber!==t)return!1;return!0}var oD=class{constructor(e,t,i,r){this.startLineNumber=e,this.startColumn=t,this.endLineNumber=i,this.endColumn=r}},G2=class extends oD{constructor(e,t,i){super(e,t,e,i)}},aD;(function(e){e.List="list",e.Tree="tree"})(aD||(aD={}));var lD;(function(e){e.Default="default",e.FileNames="fileNames",e.Type="type",e.Modified="modified",e.CountDescending="countDescending",e.CountAscending="countAscending"})(lD||(lD={}));function Q2(e,t=!0){const i=e&&e.files&&e.files.exclude,r=t&&e&&e.search&&e.search.exclude;if(!i&&!r)return;if(!i||!r)return i||r||void 0;let n=Object.create(null);return n=ys(n,nt(i)),n=ys(n,nt(r),!0),n}function cD(e,t){return e.excludePattern&&Rl(e.excludePattern,t)?!1:e.includePattern||e.usingSearchPaths?e.includePattern&&Rl(e.includePattern,t)?!0:e.usingSearchPaths?!!e.folderQueries&&e.folderQueries.some(i=>{const r=i.folder.fsPath;if(Xu(t,r)){const n=ul(r,t);return!i.includePattern||!!Rl(i.includePattern,n)}else return!1}):!1:!0}var uD;(function(e){e[e.unknownEncoding=1]="unknownEncoding",e[e.regexParseError=2]="regexParseError",e[e.globParseError=3]="globParseError",e[e.invalidLiteral=4]="invalidLiteral",e[e.rgProcessError=5]="rgProcessError",e[e.other=6]="other",e[e.canceled=7]="canceled"})(uD||(uD={}));function Na(e,t){const i={...e||{},...t||{}};return Object.keys(i).filter(r=>{const n=i[r];return typeof n=="boolean"&&n})}var dD=class{constructor(e,t){this._parsedIncludeExpression=null,this._excludeExpression=t.excludePattern?.map(r=>({...e.excludePattern||{},...r.pattern||{}}))??[],this._excludeExpression.length===0&&(this._excludeExpression=[e.excludePattern||{}]),this._parsedExcludeExpression=this._excludeExpression.map(r=>zo(r));let i=e.includePattern;t.includePattern&&(i?i={...i,...t.includePattern}:i=t.includePattern),i&&(this._parsedIncludeExpression=zo(i))}_evalParsedExcludeExpression(e,t,i){let r=null;for(const n of this._parsedExcludeExpression){const s=n(e,t,i);if(typeof s=="string"){r=s;break}}return r}matchesExcludesSync(e,t,i){return!!(this._parsedExcludeExpression&&this._evalParsedExcludeExpression(e,t,i))}includedInQuerySync(e,t,i){return!(this._parsedExcludeExpression&&this._evalParsedExcludeExpression(e,t,i)||this._parsedIncludeExpression&&!this._parsedIncludeExpression(e,t,i))}includedInQuery(e,t,i){const r=()=>this._parsedIncludeExpression?!!this._parsedIncludeExpression(e,t,i):!0;return Promise.all(this._parsedExcludeExpression.map(n=>{const s=n(e,t,i);return An(s)?s.then(o=>o?!1:r()):r()})).then(n=>n.some(s=>!!s))}hasSiblingExcludeClauses(){return this._excludeExpression.reduce((e,t)=>J2(t)||e,!1)}};function J2(e){for(const t in e)if(typeof e[t]!="boolean")return!0;return!1}function X2(e){if(!e)return;let t;return i=>(t||(t=(e()||Promise.resolve([])).then(r=>r?hD(r):{})),t.then(r=>!!r[i]))}function Z2(e){if(!e)return;let t;return i=>{if(!t){const r=e();t=r?hD(r):{}}return!!t[i]}}function hD(e){const t={};for(const i of e)t[i]=!0;return t}function fD(e){return e.flatMap(t=>t.patterns.map(i=>t.baseUri?{baseUri:t.baseUri,pattern:i}:i))}var Y1={matchLines:100,charsPerLine:1e4},K2=!1,Y2=class{constructor(e,t,i){this.id=e,this.dependencies=t,this.callback=i}},to;(function(e){e[e.Uninitialized=1]="Uninitialized",e[e.InitializedInternal=2]="InitializedInternal",e[e.InitializedExternal=3]="InitializedExternal"})(to||(to={}));var eL=class K6{static{this.INSTANCE=new K6}constructor(){this._isWebWorker=typeof self=="object"&&self.constructor&&self.constructor.name==="DedicatedWorkerGlobalScope",this._isRenderer=typeof document=="object",this._defineCalls=[],this._state=to.Uninitialized}_initialize(){if(this._state===to.Uninitialized){if(globalThis.define){this._state=to.InitializedExternal;return}}else return;this._state=to.InitializedInternal,globalThis.define=(t,i,r)=>{typeof t!="string"&&(r=i,i=t,t=null),(typeof i!="object"||!Array.isArray(i))&&(r=i,i=null),this._defineCalls.push(new Y2(t,i,r))},globalThis.define.amd=!0,this._isRenderer?this._amdPolicy=globalThis._VSCODE_WEB_PACKAGE_TTP??window.trustedTypes?.createPolicy("amdLoader",{createScriptURL(t){if(t.startsWith(window.location.origin)||t.startsWith(`${V.vscodeFileResource}://${xb}`))return t;throw new Error(`[trusted_script_src] Invalid script url: ${t}`)}}):this._isWebWorker&&(this._amdPolicy=globalThis._VSCODE_WEB_PACKAGE_TTP??globalThis.trustedTypes?.createPolicy("amdLoader",{createScriptURL(t){return t}}))}async load(t){if(this._initialize(),this._state===to.InitializedExternal)return new Promise(o=>{const a=$t();globalThis.define(a,[t],function(l){o(l)})});const i=await(this._isWebWorker?this._workerLoadScript(t):this._isRenderer?this._rendererLoadScript(t):this._nodeJSLoadScript(t));if(!i){console.warn(`Did not receive a define call from script ${t}`);return}const r={},n=[],s=[];if(Array.isArray(i.dependencies))for(const o of i.dependencies)o==="exports"?n.push(r):s.push(o);if(s.length>0)throw new Error(`Cannot resolve dependencies for script ${t}. The dependencies are: ${s.join(", ")}`);return typeof i.callback=="function"?i.callback(...n)??r:i.callback}_rendererLoadScript(t){return new Promise((i,r)=>{const n=document.createElement("script");n.setAttribute("async","async"),n.setAttribute("type","text/javascript");const s=()=>{n.removeEventListener("load",o),n.removeEventListener("error",a)},o=l=>{s(),i(this._defineCalls.pop())},a=l=>{s(),r(l)};n.addEventListener("load",o),n.addEventListener("error",a),this._amdPolicy&&(t=this._amdPolicy.createScriptURL(t)),n.setAttribute("src",t),window.document.getElementsByTagName("head")[0].appendChild(n)})}async _workerLoadScript(t){return this._amdPolicy&&(t=this._amdPolicy.createScriptURL(t)),await import(t),this._defineCalls.pop()}async _nodeJSLoadScript(t){try{const i=(await import("fs")).default,r=(await import("vm")).default,n=(await import("module")).default,s=y.parse(t).fsPath,o=i.readFileSync(s).toString(),a=n.wrap(o.replace(/^#!.*/,""));return new r.Script(a).runInThisContext().apply(),this._defineCalls.pop()}catch(i){throw i}}},e_=new Map;async function t_(e,t,i){i===void 0&&(i=!!(globalThis._VSCODE_PRODUCT_JSON??globalThis.vscode?.context?.configuration()?.product)?.commit);const r=t?`${e}/${t}`:e;if(e_.has(r))return e_.get(r);let n;if(/^\w[\w\d+.-]*:\/\//.test(r))n=r;else{const l=`${K2&&i&&!Co?fT:hT}/${r}`;n=Sb.asBrowserUri(l).toString(!0)}const s=eL.INSTANCE.load(n);return e_.set(r,s),s}var Nf="utf8",i_="utf8bom",Mf="utf16be",Of="utf16le",Ff=[254,255],r_=[255,254],$c=[239,187,191],tL=512,iL=512,rL=512*8,nL=512*128,pD;(function(e){e[e.STREAM_IS_BINARY=1]="STREAM_IS_BINARY"})(pD||(pD={}));var sL=class extends Error{constructor(e,t){super(e),this.decodeStreamErrorKind=t}},oL=class Y6{static async create(t){let i;if(t!==Nf)i=(await t_("@vscode/iconv-lite-umd","lib/iconv-lite-umd.js")).getDecoder(gD(t));else{const r=new TextDecoder;i={write(n){return r.decode(n,{stream:!0})},end(){return r.decode()}}}return new Y6(i)}constructor(t){this.iconvLiteDecoder=t}write(t){return this.iconvLiteDecoder.write(t)}end(){return this.iconvLiteDecoder.end()}};function aL(e,t){const i=t.minBytesRequiredForDetection??t.guessEncoding?rL:iL;return new Promise((r,n)=>{const s=fy(d=>d.join("")),o=[];let a=0,l;const c=new ft,u=async()=>{try{const d=await mL({buffer:ae.concat(o),bytesRead:a},t.guessEncoding,t.candidateGuessEncodings);if(d.seemsBinary&&t.acceptTextOnly)throw new sL("Stream is binary but only text is accepted for decoding",1);d.encoding=await t.overwriteEncoding(d.encoding),l=await oL.create(d.encoding);const f=l.write(ae.concat(o).buffer);s.write(f),o.length=0,a=0,r({stream:s,detected:d})}catch(d){c.cancel(),s.destroy(),n(d)}};gy(e,{onData:async d=>{l?s.write(l.write(d.buffer)):(o.push(d),a+=d.byteLength,a>=i&&(e.pause(),await u(),setTimeout(()=>e.resume())))},onError:d=>s.error(d),onEnd:async()=>{l||await u(),s.end(l?.end())}},c.token)})}async function lL(e,t,i){const n=(await t_("@vscode/iconv-lite-umd","lib/iconv-lite-umd.js")).getEncoder(gD(t),i);let s=!1,o=!1;return{read(){if(o)return null;const a=e.read();if(typeof a!="string"){if(o=!0,!s&&i?.addBOM)switch(t){case Nf:case i_:return ae.wrap(Uint8Array.from($c));case Mf:return ae.wrap(Uint8Array.from(Ff));case Of:return ae.wrap(Uint8Array.from(r_))}const l=n.end();return l&&l.length>0?(s=!0,ae.wrap(l)):null}return s=!0,ae.wrap(n.write(a))}}}function gD(e){return e===i_||e===null?Nf:e}function cL(e,t){if(!e||t<Ff.length)return null;const i=e.readUInt8(0),r=e.readUInt8(1);if(i===Ff[0]&&r===Ff[1])return Mf;if(i===r_[0]&&r===r_[1])return Of;if(t<$c.length)return null;const n=e.readUInt8(2);return i===$c[0]&&r===$c[1]&&n===$c[2]?i_:null}var uL=["ascii","utf-16","utf-32"];async function dL(e,t){const i=await t_("jschardet","dist/jschardet.min.js"),r=e.slice(0,nL),n=gL(r.buffer);t&&(t=xt(t.map(a=>pL(a))),t.length===0&&(t=void 0));let s;try{s=i.detect(n,t?{detectEncodings:t}:void 0)}catch{return null}if(!s||!s.encoding)return null;const o=s.encoding.toLowerCase();return 0<=uL.indexOf(o)?null:fL(s.encoding)}var hL={ibm866:"cp866",big5:"cp950"};function mD(e){return e.replace(/[^a-zA-Z0-9]/g,"").toLowerCase()}function fL(e){const t=mD(e);return hL[t]||t}function pL(e){const t=mD(e),i=vL[t];return i?i.guessableName:void 0}function gL(e){let t="";for(let i=0;i<e.length;i++)t+=String.fromCharCode(e[i]);return t}function mL({buffer:e,bytesRead:t},i,r){let n=cL(e,t),s=!1;if(n!==Mf&&n!==Of&&e){let o=!0,a=!0,l=!1;for(let c=0;c<t&&c<tL;c++){const u=c%2===1,d=e.readUInt8(c)===0;if(d&&(l=!0),o&&(u&&!d||!u&&d)&&(o=!1),a&&(u&&d||!u&&!d)&&(a=!1),d&&!o&&!a)break}l&&(o?n=Of:a?n=Mf:s=!0)}return i&&!s&&!n&&e?dL(e.slice(0,t),r).then(o=>({seemsBinary:!1,encoding:o})):{seemsBinary:s,encoding:n}}var n_={utf8:{labelLong:"UTF-8",labelShort:"UTF-8",order:1,alias:"utf8bom",guessableName:"UTF-8"},utf8bom:{labelLong:"UTF-8 with BOM",labelShort:"UTF-8 with BOM",encodeOnly:!0,order:2,alias:"utf8"},utf16le:{labelLong:"UTF-16 LE",labelShort:"UTF-16 LE",order:3,guessableName:"UTF-16LE"},utf16be:{labelLong:"UTF-16 BE",labelShort:"UTF-16 BE",order:4,guessableName:"UTF-16BE"},windows1252:{labelLong:"Western (Windows 1252)",labelShort:"Windows 1252",order:5,guessableName:"windows-1252"},iso88591:{labelLong:"Western (ISO 8859-1)",labelShort:"ISO 8859-1",order:6},iso88593:{labelLong:"Western (ISO 8859-3)",labelShort:"ISO 8859-3",order:7},iso885915:{labelLong:"Western (ISO 8859-15)",labelShort:"ISO 8859-15",order:8},macroman:{labelLong:"Western (Mac Roman)",labelShort:"Mac Roman",order:9},cp437:{labelLong:"DOS (CP 437)",labelShort:"CP437",order:10},windows1256:{labelLong:"Arabic (Windows 1256)",labelShort:"Windows 1256",order:11},iso88596:{labelLong:"Arabic (ISO 8859-6)",labelShort:"ISO 8859-6",order:12},windows1257:{labelLong:"Baltic (Windows 1257)",labelShort:"Windows 1257",order:13},iso88594:{labelLong:"Baltic (ISO 8859-4)",labelShort:"ISO 8859-4",order:14},iso885914:{labelLong:"Celtic (ISO 8859-14)",labelShort:"ISO 8859-14",order:15},windows1250:{labelLong:"Central European (Windows 1250)",labelShort:"Windows 1250",order:16,guessableName:"windows-1250"},iso88592:{labelLong:"Central European (ISO 8859-2)",labelShort:"ISO 8859-2",order:17,guessableName:"ISO-8859-2"},cp852:{labelLong:"Central European (CP 852)",labelShort:"CP 852",order:18},windows1251:{labelLong:"Cyrillic (Windows 1251)",labelShort:"Windows 1251",order:19,guessableName:"windows-1251"},cp866:{labelLong:"Cyrillic (CP 866)",labelShort:"CP 866",order:20,guessableName:"IBM866"},cp1125:{labelLong:"Cyrillic (CP 1125)",labelShort:"CP 1125",order:21,guessableName:"IBM1125"},iso88595:{labelLong:"Cyrillic (ISO 8859-5)",labelShort:"ISO 8859-5",order:22,guessableName:"ISO-8859-5"},koi8r:{labelLong:"Cyrillic (KOI8-R)",labelShort:"KOI8-R",order:23,guessableName:"KOI8-R"},koi8u:{labelLong:"Cyrillic (KOI8-U)",labelShort:"KOI8-U",order:24},iso885913:{labelLong:"Estonian (ISO 8859-13)",labelShort:"ISO 8859-13",order:25},windows1253:{labelLong:"Greek (Windows 1253)",labelShort:"Windows 1253",order:26,guessableName:"windows-1253"},iso88597:{labelLong:"Greek (ISO 8859-7)",labelShort:"ISO 8859-7",order:27,guessableName:"ISO-8859-7"},windows1255:{labelLong:"Hebrew (Windows 1255)",labelShort:"Windows 1255",order:28,guessableName:"windows-1255"},iso88598:{labelLong:"Hebrew (ISO 8859-8)",labelShort:"ISO 8859-8",order:29,guessableName:"ISO-8859-8"},iso885910:{labelLong:"Nordic (ISO 8859-10)",labelShort:"ISO 8859-10",order:30},iso885916:{labelLong:"Romanian (ISO 8859-16)",labelShort:"ISO 8859-16",order:31},windows1254:{labelLong:"Turkish (Windows 1254)",labelShort:"Windows 1254",order:32},iso88599:{labelLong:"Turkish (ISO 8859-9)",labelShort:"ISO 8859-9",order:33},windows1258:{labelLong:"Vietnamese (Windows 1258)",labelShort:"Windows 1258",order:34},gbk:{labelLong:"Simplified Chinese (GBK)",labelShort:"GBK",order:35},gb18030:{labelLong:"Simplified Chinese (GB18030)",labelShort:"GB18030",order:36},cp950:{labelLong:"Traditional Chinese (Big5)",labelShort:"Big5",order:37,guessableName:"Big5"},big5hkscs:{labelLong:"Traditional Chinese (Big5-HKSCS)",labelShort:"Big5-HKSCS",order:38},shiftjis:{labelLong:"Japanese (Shift JIS)",labelShort:"Shift JIS",order:39,guessableName:"SHIFT_JIS"},eucjp:{labelLong:"Japanese (EUC-JP)",labelShort:"EUC-JP",order:40,guessableName:"EUC-JP"},euckr:{labelLong:"Korean (EUC-KR)",labelShort:"EUC-KR",order:41,guessableName:"EUC-KR"},windows874:{labelLong:"Thai (Windows 874)",labelShort:"Windows 874",order:42},iso885911:{labelLong:"Latin/Thai (ISO 8859-11)",labelShort:"ISO 8859-11",order:43},koi8ru:{labelLong:"Cyrillic (KOI8-RU)",labelShort:"KOI8-RU",order:44},koi8t:{labelLong:"Tajik (KOI8-T)",labelShort:"KOI8-T",order:45},gb2312:{labelLong:"Simplified Chinese (GB 2312)",labelShort:"GB 2312",order:46,guessableName:"GB2312"},cp865:{labelLong:"Nordic DOS (CP 865)",labelShort:"CP 865",order:47},cp850:{labelLong:"Western European DOS (CP 850)",labelShort:"CP 850",order:48}},vL=(()=>{const e={};for(const t in n_)n_[t].guessableName&&(e[t]=n_[t]);return e})(),Uz=U("textFileService"),vD;(function(e){e[e.FILE_IS_BINARY=0]="FILE_IS_BINARY"})(vD||(vD={}));var _D;(function(e){e[e.SAVED=0]="SAVED",e[e.DIRTY=1]="DIRTY",e[e.PENDING_SAVE=2]="PENDING_SAVE",e[e.CONFLICT=3]="CONFLICT",e[e.ORPHAN=4]="ORPHAN",e[e.ERROR=5]="ERROR"})(_D||(_D={}));var wD;(function(e){e[e.EDITOR=1]="EDITOR",e[e.REFERENCE=2]="REFERENCE",e[e.OTHER=3]="OTHER"})(wD||(wD={}));var yD;(function(e){e[e.Encode=0]="Encode",e[e.Decode=1]="Decode"})(yD||(yD={}));function _L(e){let t=!1;return{read(){return t?null:(t=!0,e)}}}function Hc(e,t,i){return new hl(r=>s_(r,i)).isEqual(e,t)}function wL(e,t,i){return Hc(e.uri,t.uri,i)?0:gs(e.uri.toString(),t.uri.toString())}function yL(e,t,i){return e.index!==t.index?e.index<t.index?-1:1:Hc(e.uri,t.uri,i)?gs(e.name,t.name):gs(e.uri.toString(),t.uri.toString())}function bD(e,t,i,r){const n=e.slice(0).sort((o,a)=>i(o,a,r)),s=t.slice(0).sort((o,a)=>i(o,a,r));return o9(n,s,(o,a)=>i(o,a,r))}function s_(e,t){const i=t.getCapabilities(e.scheme);return!(i&&i&1024)}var o_=class Ow extends D8{static toExtHostWorkspace(t,i,r,n){if(!t)return{workspace:null,added:[],removed:[]};const{id:s,name:o,folders:a,configuration:l,transient:c,isUntitled:u}=t,d=[],f=i;i?a.forEach((b,E)=>{const C=y.revive(b.uri),T=Ow._findFolder(r||i,C,n);T?(T.name=b.name,T.index=b.index,d.push(T)):d.push({uri:C,name:b.name,index:E})}):d.push(...a.map(({uri:b,name:E,index:C})=>({uri:y.revive(b),name:E,index:C}))),d.sort((b,E)=>b.index<E.index?-1:1);const p=new Ow(s,o,d,!!c,l?y.revive(l):null,!!u,b=>s_(b,n)),{added:m,removed:_}=bD(f?f.workspaceFolders:[],p.workspaceFolders,wL,n);return{workspace:p,added:m,removed:_}}static _findFolder(t,i,r){for(let n=0;n<t.folders.length;n++){const s=t.workspaceFolders[n];if(Hc(s.uri,i,r))return s}}constructor(t,i,r,n,s,o,a){super(t,r.map(l=>new Dx(l)),n,s,a),this._name=i,this._isUntitled=o,this._workspaceFolders=[],this._structure=Rn.forUris(a,()=>!0),r.forEach(l=>{this._workspaceFolders.push(l),this._structure.set(l.uri,l)})}get name(){return this._name}get isUntitled(){return this._isUntitled}get workspaceFolders(){return this._workspaceFolders.slice(0)}getWorkspaceFolder(t,i){return i&&this._structure.get(t)&&(t=Zu(t)),this._structure.findSubstr(t)}resolveWorkspaceFolder(t){return this._structure.get(t)}},a_=class{constructor(t,i,r,n,s){this._onDidChangeWorkspace=new P,this.onDidChangeWorkspace=this._onDidChangeWorkspace.event,this._onDidGrantWorkspaceTrust=new P,this.onDidGrantWorkspaceTrust=this._onDidGrantWorkspaceTrust.event,this._activeSearchCallbacks=[],this._trusted=!1,this._editSessionIdentityProviders=new Map,this._providerHandlePool=0,this._onWillCreateEditSessionIdentityEvent=new nl,this._canonicalUriProviders=new Map,this._logService=n,this._extHostFileSystemInfo=r,this._uriTransformerService=s,this._requestIdProvider=new x8,this._barrier=new Cr,this._proxy=t.getProxy(W.MainThreadWorkspace),this._messageService=t.getProxy(W.MainThreadMessageService);const o=i.workspace;this._confirmedWorkspace=o?new o_(o.id,o.name,[],!!o.transient,o.configuration?y.revive(o.configuration):null,!!o.isUntitled,a=>s_(a,r)):void 0}$initializeWorkspace(t,i){this._trusted=i,this.$acceptWorkspaceData(t),this._barrier.open()}waitForInitializeCall(){return this._barrier.wait()}get workspace(){return this._actualWorkspace}get name(){return this._actualWorkspace?this._actualWorkspace.name:void 0}get workspaceFile(){if(this._actualWorkspace&&this._actualWorkspace.configuration)return this._actualWorkspace.isUntitled?y.from({scheme:V.untitled,path:nr(Zu(this._actualWorkspace.configuration))}):this._actualWorkspace.configuration}get _actualWorkspace(){return this._unconfirmedWorkspace||this._confirmedWorkspace}getWorkspaceFolders(){if(this._actualWorkspace)return this._actualWorkspace.workspaceFolders.slice(0)}async getWorkspaceFolders2(){if(await this._barrier.wait(),!!this._actualWorkspace)return this._actualWorkspace.workspaceFolders.slice(0)}updateWorkspaceFolders(t,i,r,...n){const s=[];if(Array.isArray(n)&&n.forEach(u=>{y.isUri(u.uri)&&!s.some(d=>Hc(d.uri,u.uri,this._extHostFileSystemInfo))&&s.push({uri:u.uri,name:u.name||Lg(u.uri)})}),this._unconfirmedWorkspace||[i,r].some(u=>typeof u!="number"||u<0)||r===0&&s.length===0)return!1;const o=this._actualWorkspace?this._actualWorkspace.workspaceFolders:[];if(i+r>o.length)return!1;const a=o.slice(0);a.splice(i,r,...s.map(u=>({uri:u.uri,name:u.name||Lg(u.uri),index:void 0})));for(let u=0;u<a.length;u++){const d=a[u];if(a.some((f,p)=>p!==u&&Hc(d.uri,f.uri,this._extHostFileSystemInfo)))return!1}a.forEach((u,d)=>u.index=d);const{added:l,removed:c}=bD(o,a,yL,this._extHostFileSystemInfo);if(l.length===0&&c.length===0)return!1;if(this._proxy){const u=t.displayName||t.name;this._proxy.$updateWorkspaceFolders(u,i,r,s).then(void 0,d=>{this._unconfirmedWorkspace=void 0;const f={source:{identifier:t.identifier,label:t.displayName||t.name}};this._messageService.$showMessage(S8.Error,h(2942,null,u,d.toString()),f,[])})}return this.trySetWorkspaceFolders(a),!0}getWorkspaceFolder(t,i){if(this._actualWorkspace)return this._actualWorkspace.getWorkspaceFolder(t,i)}async getWorkspaceFolder2(t,i){if(await this._barrier.wait(),!!this._actualWorkspace)return this._actualWorkspace.getWorkspaceFolder(t,i)}async resolveWorkspaceFolder(t){if(await this._barrier.wait(),!!this._actualWorkspace)return this._actualWorkspace.resolveWorkspaceFolder(t)}getPath(){if(!this._actualWorkspace)return;const{folders:t}=this._actualWorkspace;if(t.length!==0)return t[0].uri.fsPath}getRelativePath(t,i){let r,n="";if(typeof t=="string"?(r=y.file(t),n=t):typeof t<"u"&&(r=t,n=t.fsPath),!r)return n;const s=this.getWorkspaceFolder(r,!0);if(!s)return n;typeof i>"u"&&this._actualWorkspace&&(i=this._actualWorkspace.folders.length>1);let o=Cb(s.uri,r);return i&&s.name&&(o=`${s.name}/${o}`),o}trySetWorkspaceFolders(t){this._actualWorkspace&&(this._unconfirmedWorkspace=o_.toExtHostWorkspace({id:this._actualWorkspace.id,name:this._actualWorkspace.name,configuration:this._actualWorkspace.configuration,folders:t,isUntitled:this._actualWorkspace.isUntitled},this._actualWorkspace,void 0,this._extHostFileSystemInfo).workspace||void 0)}$acceptWorkspaceData(t){const{workspace:i,added:r,removed:n}=o_.toExtHostWorkspace(t,this._confirmedWorkspace,this._unconfirmedWorkspace,this._extHostFileSystemInfo);this._confirmedWorkspace=i||void 0,this._unconfirmedWorkspace=void 0,this._onDidChangeWorkspace.fire(Object.freeze({added:r,removed:n}))}findFiles(t,i,r,n,s=Xe.None){this._logService.trace(`extHostWorkspace#findFiles: fileSearch, extension: ${n.value}, entryPoint: findFiles`);let o="",a=!0;return i===null?a=!1:i!==void 0&&(typeof i=="string"?o=i:o=i.pattern),this._findFilesImpl({type:"include",value:t},{exclude:[o],maxResults:r,useExcludeSettings:a?dn.FilesExclude:dn.None,useIgnoreFiles:{local:!1}},s)}findFiles2(t,i={},r,n=Xe.None){return this._logService.trace(`extHostWorkspace#findFiles2New: fileSearch, extension: ${r.value}, entryPoint: findFiles2New`),this._findFilesImpl({type:"filePatterns",value:t},i,n)}async _findFilesImpl(t,i,r){if(r.isCancellationRequested)return Promise.resolve([]);const n=t.type==="include"?[t.value]:t.value??[];if(!Array.isArray(n))throw console.error("Invalid file pattern provided",n),new Error(`Invalid file pattern provided ${JSON.stringify(n)}`);const s=n.map(o=>{const a=xD(i.exclude),l={ignoreSymlinks:typeof i.followSymlinks=="boolean"?!i.followSymlinks:void 0,disregardIgnoreFiles:typeof i.useIgnoreFiles?.local=="boolean"?!i.useIgnoreFiles.local:void 0,disregardGlobalIgnoreFiles:typeof i.useIgnoreFiles?.global=="boolean"?!i.useIgnoreFiles.global:void 0,disregardParentIgnoreFiles:typeof i.useIgnoreFiles?.parent=="boolean"?!i.useIgnoreFiles.parent:void 0,disregardExcludeSettings:i.useExcludeSettings!==void 0&&i.useExcludeSettings===dn.None,disregardSearchExcludeSettings:i.useExcludeSettings!==void 0&&i.useExcludeSettings!==dn.SearchAndFilesExclude,maxResults:i.maxResults,excludePattern:a.length>0?a:void 0,_reason:"startFileSearch",shouldGlobSearch:t.type==="include"?void 0:!0},c=$f(Li.from(o)),u=c?.folder;return t.type==="include"?l.includePattern=c?.pattern:l.filePattern=c?.pattern,{folder:u,options:l}});return this._findFilesBase(s,r)}async _findFilesBase(t,i){return(await Promise.all(t?.map(n=>this._proxy.$startFileSearch(n.folder??null,n.options,i).then(s=>Array.isArray(s)?s.map(o=>y.revive(o)):[]))??[])).flat()}findTextInFiles2(t,i,r,n=Xe.None){this._logService.trace(`extHostWorkspace#findTextInFiles2: textSearch, extension: ${r.value}, entryPoint: findTextInFiles2`);const s=f=>{if(!i)return{folder:void 0,options:{}};const p=f?$f(Li.from(f)):void 0,m=i.exclude?xD(i.exclude):void 0;return{options:{ignoreSymlinks:typeof i.followSymlinks=="boolean"?!i.followSymlinks:void 0,disregardIgnoreFiles:typeof i.useIgnoreFiles=="boolean"?!i.useIgnoreFiles:void 0,disregardGlobalIgnoreFiles:typeof i.useIgnoreFiles?.global=="boolean"?!i.useIgnoreFiles?.global:void 0,disregardParentIgnoreFiles:typeof i.useIgnoreFiles?.parent=="boolean"?!i.useIgnoreFiles?.parent:void 0,disregardExcludeSettings:i.useExcludeSettings!==void 0&&i.useExcludeSettings===dn.None,disregardSearchExcludeSettings:i.useExcludeSettings!==void 0&&i.useExcludeSettings!==dn.SearchAndFilesExclude,fileEncoding:i.encoding,maxResults:i.maxResults,previewOptions:i.previewOptions?{matchLines:i.previewOptions?.numMatchLines??100,charsPerLine:i.previewOptions?.charsPerLine??1e4}:void 0,surroundingContext:i.surroundingContext,includePattern:p?.pattern,excludePattern:m},folder:p?.folder}},a=(i?.include?.map(f=>s(f))??[s(void 0)]).filter(f=>!!f),l=new he,c=l.add(new P),u=this.findTextInFilesBase(t,a,(f,p)=>c.fire({result:f,uri:p}),n);return{results:new fl(async f=>{l.add(c.event(p=>{const m=p.result,_=p.uri;nD(m)?f.emitOne(new Xn(_,m.rangeLocations.map(b=>({previewRange:new ye(b.preview.startLineNumber,b.preview.startColumn,b.preview.endLineNumber,b.preview.endColumn),sourceRange:new ye(b.source.startLineNumber,b.source.startColumn,b.source.endLineNumber,b.source.endColumn)})),m.previewText)):f.emitOne(new Z1(_,m.text,m.lineNumber))})),await u}),complete:u.then(f=>(l.dispose(),{limitHit:f?.limitHit??!1}))}}async findTextInFilesBase(t,i,r,n=Xe.None){const s=this._requestIdProvider.getNext();let o=!1;if(n.onCancellationRequested(a=>{o=!0}),this._activeSearchCallbacks[s]=a=>{if(o)return;const l=y.revive(a.resource);a.results.forEach(c=>{const u=Pt(c);r(u,l)})},n.isCancellationRequested)return{};try{const a=await Promise.all(i?.map(l=>this._proxy.$startTextSearch(t,l.folder??null,l.options,s,n)||{})??[]);return delete this._activeSearchCallbacks[s],a.reduce((l,c)=>({limitHit:l?.limitHit||(c?.limitHit??!1),message:[l?.message??[],c?.message??[]].flat()}),{})??{limitHit:!1}}catch(a){throw delete this._activeSearchCallbacks[s],a}}async findTextInFiles(t,i,r,n,s=Xe.None){this._logService.trace(`extHostWorkspace#findTextInFiles: textSearch, extension: ${n.value}, entryPoint: findTextInFiles`);const o=typeof i.previewOptions>"u"?{matchLines:100,charsPerLine:1e4}:i.previewOptions,a=$f(Li.from(i.include)),l=typeof i.exclude=="string"?i.exclude:i.exclude?i.exclude.pattern:void 0,c={ignoreSymlinks:typeof i.followSymlinks=="boolean"?!i.followSymlinks:void 0,disregardIgnoreFiles:typeof i.useIgnoreFiles=="boolean"?!i.useIgnoreFiles:void 0,disregardGlobalIgnoreFiles:typeof i.useGlobalIgnoreFiles=="boolean"?!i.useGlobalIgnoreFiles:void 0,disregardParentIgnoreFiles:typeof i.useParentIgnoreFiles=="boolean"?!i.useParentIgnoreFiles:void 0,disregardExcludeSettings:typeof i.useDefaultExcludes=="boolean"?!i.useDefaultExcludes:!0,disregardSearchExcludeSettings:typeof i.useSearchExclude=="boolean"?!i.useSearchExclude:!0,fileEncoding:i.encoding,maxResults:i.maxResults,previewOptions:o,surroundingContext:i.afterContext,includePattern:a?.pattern,excludePattern:l?[{pattern:l}]:void 0},u=(d,f)=>{nD(d)?r({uri:f,preview:{text:d.previewText,matches:ig(d.rangeLocations,p=>new ye(p.preview.startLineNumber,p.preview.startColumn,p.preview.endLineNumber,p.preview.endColumn))},ranges:ig(d.rangeLocations,p=>new ye(p.source.startLineNumber,p.source.startColumn,p.source.endLineNumber,p.source.endColumn))}):r({uri:f,text:d.text,lineNumber:d.lineNumber})};return this.findTextInFilesBase(t,[{options:c,folder:a?.folder}],u,s)}$handleTextSearchResult(t,i){this._activeSearchCallbacks[i]?.(t)}async save(t){const i=await this._proxy.$save(t,{saveAs:!1});return y.revive(i)}async saveAs(t){const i=await this._proxy.$save(t,{saveAs:!0});return y.revive(i)}saveAll(t){return this._proxy.$saveAll(t)}resolveProxy(t){return this._proxy.$resolveProxy(t)}lookupAuthorization(t){return this._proxy.$lookupAuthorization(t)}lookupKerberosAuthorization(t){return this._proxy.$lookupKerberosAuthorization(t)}loadCertificates(){return this._proxy.$loadCertificates()}get trusted(){return this._trusted}requestWorkspaceTrust(t){return this._proxy.$requestWorkspaceTrust(t)}$onDidGrantWorkspaceTrust(){this._trusted||(this._trusted=!0,this._onDidGrantWorkspaceTrust.fire())}registerEditSessionIdentityProvider(t,i){if(this._editSessionIdentityProviders.has(t))throw new Error(`A provider has already been registered for scheme ${t}`);this._editSessionIdentityProviders.set(t,i);const r=this._uriTransformerService.transformOutgoingScheme(t),n=this._providerHandlePool++;return this._proxy.$registerEditSessionIdentityProvider(n,r),ne(()=>{this._editSessionIdentityProviders.delete(t),this._proxy.$unregisterEditSessionIdentityProvider(n)})}async $getEditSessionIdentifier(t,i){this._logService.info("Getting edit session identifier for workspaceFolder",t);const r=await this.resolveWorkspaceFolder(y.revive(t));if(!r){this._logService.warn("Unable to resolve workspace folder");return}this._logService.info("Invoking #provideEditSessionIdentity for workspaceFolder",r);const n=this._editSessionIdentityProviders.get(r.uri.scheme);if(this._logService.info(`Provider for scheme ${r.uri.scheme} is defined: `,!!n),!n)return;const s=await n.provideEditSessionIdentity(r,i);if(this._logService.info("Provider returned edit session identifier: ",s),!!s)return s}async $provideEditSessionIdentityMatch(t,i,r,n){this._logService.info("Getting edit session identifier for workspaceFolder",t);const s=await this.resolveWorkspaceFolder(y.revive(t));if(!s){this._logService.warn("Unable to resolve workspace folder");return}this._logService.info("Invoking #provideEditSessionIdentity for workspaceFolder",s);const o=this._editSessionIdentityProviders.get(s.uri.scheme);if(this._logService.info(`Provider for scheme ${s.uri.scheme} is defined: `,!!o),!o)return;const a=await o.provideEditSessionIdentityMatch?.(i,r,n);if(this._logService.info("Provider returned edit session identifier match result: ",a),!!a)return a}getOnWillCreateEditSessionIdentityEvent(t){return(i,r,n)=>{const s=function(a){i.call(r,a)};return s.extension=t,this._onWillCreateEditSessionIdentityEvent.event(s,void 0,n)}}async $onWillCreateEditSessionIdentity(t,i,r){const n=await this.resolveWorkspaceFolder(y.revive(t));if(n===void 0)throw new Error("Unable to resolve workspace folder");await this._onWillCreateEditSessionIdentityEvent.fireAsync({workspaceFolder:n},i,async(s,o)=>{const a=Date.now();await Promise.resolve(s),Date.now()-a>r&&this._logService.warn("SLOW edit session create-participant",o.extension.identifier)}),i.isCancellationRequested}registerCanonicalUriProvider(t,i){if(this._canonicalUriProviders.has(t))throw new Error(`A provider has already been registered for scheme ${t}`);this._canonicalUriProviders.set(t,i);const r=this._uriTransformerService.transformOutgoingScheme(t),n=this._providerHandlePool++;return this._proxy.$registerCanonicalUriProvider(n,r),ne(()=>{this._canonicalUriProviders.delete(t),this._proxy.$unregisterCanonicalUriProvider(n)})}async provideCanonicalUri(t,i,r){const n=this._canonicalUriProviders.get(t.scheme);if(!n)return;const s=await n.provideCanonicalUri?.(y.revive(t),i,r);if(s)return s}async $provideCanonicalUri(t,i,r){return this.provideCanonicalUri(y.revive(t),{targetScheme:i},r)}async decode(t,i){const[r,n]=this.toEncodeDecodeParameters(i),s=await this._proxy.$resolveDecoding(r,n),o=(await aL(F9(ae.wrap(t)),{...s,acceptTextOnly:!0,overwriteEncoding:a=>a===null||a===s.preferredEncoding?Promise.resolve(s.preferredEncoding):this._proxy.$validateDetectedEncoding(r,a,n)})).stream;return py(o,a=>a.join(""))}async encode(t,i){const[r,n]=this.toEncodeDecodeParameters(i),{encoding:s,addBOM:o}=await this._proxy.$resolveEncoding(r,n);if(s===Nf&&!o)return ae.fromString(t).buffer;const a=await lL(_L(t),s,{addBOM:o});return M9(a).buffer}toEncodeDecodeParameters(t){const i=Wu(t?.uri)?t.uri:void 0,r=typeof t?.encoding=="string"?t.encoding:void 0;return[i,r?{encoding:r}:void 0]}};a_=__decorate([__param(0,Ue),__param(1,Yt),__param(2,Oo),__param(3,qe),__param(4,id)],a_);var hn=U("IExtHostWorkspace");function $f(e){let t,i;if(e)return typeof e=="string"?t=e:(t=e.pattern,i=y.revive(e.baseUri)),{pattern:t,folder:i}}function xD(e){return(e?.map(t=>{if(typeof t=="string")return t===""?void 0:{pattern:t,uri:void 0};{const i=$f(t);return i?{pattern:i.pattern,uri:i.folder}:void 0}})??[]).filter(t=>!!t)}var SD;(function(e){e[e.None=0]="None",e[e.UnexpectedEndOfComment=1]="UnexpectedEndOfComment",e[e.UnexpectedEndOfString=2]="UnexpectedEndOfString",e[e.UnexpectedEndOfNumber=3]="UnexpectedEndOfNumber",e[e.InvalidUnicode=4]="InvalidUnicode",e[e.InvalidEscapeCharacter=5]="InvalidEscapeCharacter",e[e.InvalidCharacter=6]="InvalidCharacter"})(SD||(SD={}));var ED;(function(e){e[e.OpenBraceToken=1]="OpenBraceToken",e[e.CloseBraceToken=2]="CloseBraceToken",e[e.OpenBracketToken=3]="OpenBracketToken",e[e.CloseBracketToken=4]="CloseBracketToken",e[e.CommaToken=5]="CommaToken",e[e.ColonToken=6]="ColonToken",e[e.NullKeyword=7]="NullKeyword",e[e.TrueKeyword=8]="TrueKeyword",e[e.FalseKeyword=9]="FalseKeyword",e[e.StringLiteral=10]="StringLiteral",e[e.NumericLiteral=11]="NumericLiteral",e[e.LineCommentTrivia=12]="LineCommentTrivia",e[e.BlockCommentTrivia=13]="BlockCommentTrivia",e[e.LineBreakTrivia=14]="LineBreakTrivia",e[e.Trivia=15]="Trivia",e[e.Unknown=16]="Unknown",e[e.EOF=17]="EOF"})(ED||(ED={}));var CD;(function(e){e[e.InvalidSymbol=1]="InvalidSymbol",e[e.InvalidNumberFormat=2]="InvalidNumberFormat",e[e.PropertyNameExpected=3]="PropertyNameExpected",e[e.ValueExpected=4]="ValueExpected",e[e.ColonExpected=5]="ColonExpected",e[e.CommaExpected=6]="CommaExpected",e[e.CloseBraceExpected=7]="CloseBraceExpected",e[e.CloseBracketExpected=8]="CloseBracketExpected",e[e.EndOfFileExpected=9]="EndOfFileExpected",e[e.InvalidCommentToken=10]="InvalidCommentToken",e[e.UnexpectedEndOfComment=11]="UnexpectedEndOfComment",e[e.UnexpectedEndOfString=12]="UnexpectedEndOfString",e[e.UnexpectedEndOfNumber=13]="UnexpectedEndOfNumber",e[e.InvalidUnicode=14]="InvalidUnicode",e[e.InvalidEscapeCharacter=15]="InvalidEscapeCharacter",e[e.InvalidCharacter=16]="InvalidCharacter"})(CD||(CD={}));var l_;(function(e){e.DEFAULT={allowTrailingComma:!0}})(l_||(l_={}));function bL(e,t=!1){let i=0;const r=e.length;let n="",s=0,o=16,a=0;function l(_){let b=0,E=0;for(;b<_;){const C=e.charCodeAt(i);if(C>=48&&C<=57)E=E*16+C-48;else if(C>=65&&C<=70)E=E*16+C-65+10;else if(C>=97&&C<=102)E=E*16+C-97+10;else break;i++,b++}return b<_&&(E=-1),E}function c(_){i=_,n="",s=0,o=16,a=0}function u(){const _=i;if(e.charCodeAt(i)===48)i++;else for(i++;i<e.length&&Ma(e.charCodeAt(i));)i++;if(i<e.length&&e.charCodeAt(i)===46)if(i++,i<e.length&&Ma(e.charCodeAt(i)))for(i++;i<e.length&&Ma(e.charCodeAt(i));)i++;else return a=3,e.substring(_,i);let b=i;if(i<e.length&&(e.charCodeAt(i)===69||e.charCodeAt(i)===101))if(i++,(i<e.length&&e.charCodeAt(i)===43||e.charCodeAt(i)===45)&&i++,i<e.length&&Ma(e.charCodeAt(i))){for(i++;i<e.length&&Ma(e.charCodeAt(i));)i++;b=i}else a=3;return e.substring(_,b)}function d(){let _="",b=i;for(;;){if(i>=r){_+=e.substring(b,i),a=2;break}const E=e.charCodeAt(i);if(E===34){_+=e.substring(b,i),i++;break}if(E===92){if(_+=e.substring(b,i),i++,i>=r){a=2;break}switch(e.charCodeAt(i++)){case 34:_+='"';break;case 92:_+="\\";break;case 47:_+="/";break;case 98:_+="\b";break;case 102:_+="\f";break;case 110:_+=`
`;break;case 114:_+="\r";break;case 116:_+="	";break;case 117:{const T=l(4);T>=0?_+=String.fromCharCode(T):a=4;break}default:a=5}b=i;continue}if(E>=0&&E<=31)if(Hf(E)){_+=e.substring(b,i),a=2;break}else a=6;i++}return _}function f(){if(n="",a=0,s=i,i>=r)return s=r,o=17;let _=e.charCodeAt(i);if(c_(_)){do i++,n+=String.fromCharCode(_),_=e.charCodeAt(i);while(c_(_));return o=15}if(Hf(_))return i++,n+=String.fromCharCode(_),_===13&&e.charCodeAt(i)===10&&(i++,n+=`
`),o=14;switch(_){case 123:return i++,o=1;case 125:return i++,o=2;case 91:return i++,o=3;case 93:return i++,o=4;case 58:return i++,o=6;case 44:return i++,o=5;case 34:return i++,n=d(),o=10;case 47:{const b=i-1;if(e.charCodeAt(i+1)===47){for(i+=2;i<r&&!Hf(e.charCodeAt(i));)i++;return n=e.substring(b,i),o=12}if(e.charCodeAt(i+1)===42){i+=2;const E=r-1;let C=!1;for(;i<E;){if(e.charCodeAt(i)===42&&e.charCodeAt(i+1)===47){i+=2,C=!0;break}i++}return C||(i++,a=1),n=e.substring(b,i),o=13}return n+=String.fromCharCode(_),i++,o=16}case 45:if(n+=String.fromCharCode(_),i++,i===r||!Ma(e.charCodeAt(i)))return o=16;case 48:case 49:case 50:case 51:case 52:case 53:case 54:case 55:case 56:case 57:return n+=u(),o=11;default:for(;i<r&&p(_);)i++,_=e.charCodeAt(i);if(s!==i){switch(n=e.substring(s,i),n){case"true":return o=8;case"false":return o=9;case"null":return o=7}return o=16}return n+=String.fromCharCode(_),i++,o=16}}function p(_){if(c_(_)||Hf(_))return!1;switch(_){case 125:case 93:case 123:case 91:case 34:case 58:case 44:case 47:return!1}return!0}function m(){let _;do _=f();while(_>=12&&_<=15);return _}return{setPosition:c,getPosition:()=>i,scan:t?m:f,getToken:()=>o,getTokenValue:()=>n,getTokenOffset:()=>s,getTokenLength:()=>i-s,getTokenError:()=>a}}function c_(e){return e===32||e===9||e===11||e===12||e===160||e===5760||e>=8192&&e<=8203||e===8239||e===8287||e===12288||e===65279}function Hf(e){return e===10||e===13||e===8232||e===8233}function Ma(e){return e>=48&&e<=57}var DD;(function(e){e[e.nullCharacter=0]="nullCharacter",e[e.maxAsciiCharacter=127]="maxAsciiCharacter",e[e.lineFeed=10]="lineFeed",e[e.carriageReturn=13]="carriageReturn",e[e.lineSeparator=8232]="lineSeparator",e[e.paragraphSeparator=8233]="paragraphSeparator",e[e.nextLine=133]="nextLine",e[e.space=32]="space",e[e.nonBreakingSpace=160]="nonBreakingSpace",e[e.enQuad=8192]="enQuad",e[e.emQuad=8193]="emQuad",e[e.enSpace=8194]="enSpace",e[e.emSpace=8195]="emSpace",e[e.threePerEmSpace=8196]="threePerEmSpace",e[e.fourPerEmSpace=8197]="fourPerEmSpace",e[e.sixPerEmSpace=8198]="sixPerEmSpace",e[e.figureSpace=8199]="figureSpace",e[e.punctuationSpace=8200]="punctuationSpace",e[e.thinSpace=8201]="thinSpace",e[e.hairSpace=8202]="hairSpace",e[e.zeroWidthSpace=8203]="zeroWidthSpace",e[e.narrowNoBreakSpace=8239]="narrowNoBreakSpace",e[e.ideographicSpace=12288]="ideographicSpace",e[e.mathematicalSpace=8287]="mathematicalSpace",e[e.ogham=5760]="ogham",e[e._=95]="_",e[e.$=36]="$",e[e._0=48]="_0",e[e._1=49]="_1",e[e._2=50]="_2",e[e._3=51]="_3",e[e._4=52]="_4",e[e._5=53]="_5",e[e._6=54]="_6",e[e._7=55]="_7",e[e._8=56]="_8",e[e._9=57]="_9",e[e.a=97]="a",e[e.b=98]="b",e[e.c=99]="c",e[e.d=100]="d",e[e.e=101]="e",e[e.f=102]="f",e[e.g=103]="g",e[e.h=104]="h",e[e.i=105]="i",e[e.j=106]="j",e[e.k=107]="k",e[e.l=108]="l",e[e.m=109]="m",e[e.n=110]="n",e[e.o=111]="o",e[e.p=112]="p",e[e.q=113]="q",e[e.r=114]="r",e[e.s=115]="s",e[e.t=116]="t",e[e.u=117]="u",e[e.v=118]="v",e[e.w=119]="w",e[e.x=120]="x",e[e.y=121]="y",e[e.z=122]="z",e[e.A=65]="A",e[e.B=66]="B",e[e.C=67]="C",e[e.D=68]="D",e[e.E=69]="E",e[e.F=70]="F",e[e.G=71]="G",e[e.H=72]="H",e[e.I=73]="I",e[e.J=74]="J",e[e.K=75]="K",e[e.L=76]="L",e[e.M=77]="M",e[e.N=78]="N",e[e.O=79]="O",e[e.P=80]="P",e[e.Q=81]="Q",e[e.R=82]="R",e[e.S=83]="S",e[e.T=84]="T",e[e.U=85]="U",e[e.V=86]="V",e[e.W=87]="W",e[e.X=88]="X",e[e.Y=89]="Y",e[e.Z=90]="Z",e[e.ampersand=38]="ampersand",e[e.asterisk=42]="asterisk",e[e.at=64]="at",e[e.backslash=92]="backslash",e[e.bar=124]="bar",e[e.caret=94]="caret",e[e.closeBrace=125]="closeBrace",e[e.closeBracket=93]="closeBracket",e[e.closeParen=41]="closeParen",e[e.colon=58]="colon",e[e.comma=44]="comma",e[e.dot=46]="dot",e[e.doubleQuote=34]="doubleQuote",e[e.equals=61]="equals",e[e.exclamation=33]="exclamation",e[e.greaterThan=62]="greaterThan",e[e.lessThan=60]="lessThan",e[e.minus=45]="minus",e[e.openBrace=123]="openBrace",e[e.openBracket=91]="openBracket",e[e.openParen=40]="openParen",e[e.percent=37]="percent",e[e.plus=43]="plus",e[e.question=63]="question",e[e.semicolon=59]="semicolon",e[e.singleQuote=39]="singleQuote",e[e.slash=47]="slash",e[e.tilde=126]="tilde",e[e.backspace=8]="backspace",e[e.formFeed=12]="formFeed",e[e.byteOrderMark=65279]="byteOrderMark",e[e.tab=9]="tab",e[e.verticalTab=11]="verticalTab"})(DD||(DD={}));function xL(e,t,i=l_.DEFAULT){const r=bL(e,!1);function n(X){return X?()=>X(r.getTokenOffset(),r.getTokenLength()):()=>!0}function s(X){return X?ce=>X(ce,r.getTokenOffset(),r.getTokenLength()):()=>!0}const o=n(t.onObjectBegin),a=s(t.onObjectProperty),l=n(t.onObjectEnd),c=n(t.onArrayBegin),u=n(t.onArrayEnd),d=s(t.onLiteralValue),f=s(t.onSeparator),p=n(t.onComment),m=s(t.onError),_=i&&i.disallowComments,b=i&&i.allowTrailingComma;function E(){for(;;){const X=r.scan();switch(r.getTokenError()){case 4:C(14);break;case 5:C(15);break;case 3:C(13);break;case 1:_||C(11);break;case 2:C(12);break;case 6:C(16);break}switch(X){case 12:case 13:_?C(10):p();break;case 16:C(1);break;case 15:case 14:break;default:return X}}}function C(X,ce=[],We=[]){if(m(X),ce.length+We.length>0){let De=r.getToken();for(;De!==17;){if(ce.indexOf(De)!==-1){E();break}else if(We.indexOf(De)!==-1)break;De=E()}}}function T(X){const ce=r.getTokenValue();return X?d(ce):a(ce),E(),!0}function j(){switch(r.getToken()){case 11:{let X=0;try{X=JSON.parse(r.getTokenValue()),typeof X!="number"&&(C(2),X=0)}catch{C(2)}d(X);break}case 7:d(null);break;case 8:d(!0);break;case 9:d(!1);break;default:return!1}return E(),!0}function M(){return r.getToken()!==10?(C(3,[],[2,5]),!1):(T(!1),r.getToken()===6?(f(":"),E(),Y()||C(4,[],[2,5])):C(5,[],[2,5]),!0)}function B(){o(),E();let X=!1;for(;r.getToken()!==2&&r.getToken()!==17;){if(r.getToken()===5){if(X||C(4,[],[]),f(","),E(),r.getToken()===2&&b)break}else X&&C(6,[],[]);M()||C(4,[],[2,5]),X=!0}return l(),r.getToken()!==2?C(7,[2],[]):E(),!0}function K(){c(),E();let X=!1;for(;r.getToken()!==4&&r.getToken()!==17;){if(r.getToken()===5){if(X||C(4,[],[]),f(","),E(),r.getToken()===4&&b)break}else X&&C(6,[],[]);Y()||C(4,[],[4,5]),X=!0}return u(),r.getToken()!==4?C(8,[4],[]):E(),!0}function Y(){switch(r.getToken()){case 3:return K();case 1:return B();case 10:return T(!0);default:return j()}}return E(),r.getToken()===17?i.allowEmptyContent?!0:(C(4,[],[]),!1):Y()?(r.getToken()!==17&&C(9,[],[]),!0):(C(4,[],[]),!1)}function Uc(e){return Object.isFrozen(e)?e:wx(e)}var Oa=class po{static createEmptyModel(t){return new po({},[],[],void 0,t)}constructor(t,i,r,n,s){this._contents=t,this._keys=i,this._overrides=r,this.raw=n,this.logService=s,this.overrideConfigurations=new Map}get rawConfiguration(){if(!this._rawConfiguration)if(this.raw){const t=(Array.isArray(this.raw)?this.raw:[this.raw]).map(i=>{if(i instanceof po)return i;const r=new SL("",this.logService);return r.parseRaw(i),r.configurationModel});this._rawConfiguration=t.reduce((i,r)=>r===i?r:i.merge(r),t[0])}else this._rawConfiguration=this;return this._rawConfiguration}get contents(){return this._contents}get overrides(){return this._overrides}get keys(){return this._keys}isEmpty(){return this._keys.length===0&&Object.keys(this._contents).length===0&&this._overrides.length===0}getValue(t){return t?Dd(this.contents,t):this.contents}inspect(t,i){const r=this;return{get value(){return Uc(r.rawConfiguration.getValue(t))},get override(){return i?Uc(r.rawConfiguration.getOverrideValue(t,i)):void 0},get merged(){return Uc(i?r.rawConfiguration.override(i).getValue(t):r.rawConfiguration.getValue(t))},get overrides(){const n=[];for(const{contents:s,identifiers:o,keys:a}of r.rawConfiguration.overrides){const l=new po(s,a,[],void 0,r.logService).getValue(t);l!==void 0&&n.push({identifiers:o,value:l})}return n.length?Uc(n):void 0}}}getOverrideValue(t,i){const r=this.getContentsForOverrideIdentifer(i);return r?t?Dd(r,t):r:void 0}getKeysForOverrideIdentifier(t){const i=[];for(const r of this.overrides)r.identifiers.includes(t)&&i.push(...r.keys);return bo(i)}getAllOverrideIdentifiers(){const t=[];for(const i of this.overrides)t.push(...i.identifiers);return bo(t)}override(t){let i=this.overrideConfigurations.get(t);return i||(i=this.createOverrideConfigurationModel(t),this.overrideConfigurations.set(t,i)),i}merge(...t){const i=nt(this.contents),r=nt(this.overrides),n=[...this.keys],s=this.raw?Array.isArray(this.raw)?[...this.raw]:[this.raw]:[this];for(const o of t)if(s.push(...o.raw?Array.isArray(o.raw)?o.raw:[o.raw]:[o]),!o.isEmpty()){this.mergeContents(i,o.contents);for(const a of o.overrides){const[l]=r.filter(c=>Sr(c.identifiers,a.identifiers));l?(this.mergeContents(l.contents,a.contents),l.keys.push(...a.keys),l.keys=bo(l.keys)):r.push(nt(a))}for(const a of o.keys)n.indexOf(a)===-1&&n.push(a)}return new po(i,n,r,!s.length||s.every(o=>o instanceof po)?void 0:s,this.logService)}createOverrideConfigurationModel(t){const i=this.getContentsForOverrideIdentifer(t);if(!i||typeof i!="object"||!Object.keys(i).length)return this;const r={};for(const n of bo([...Object.keys(this.contents),...Object.keys(i)])){let s=this.contents[n];const o=i[n];o&&(typeof s=="object"&&typeof o=="object"?(s=nt(s),this.mergeContents(s,o)):s=o),r[n]=s}return new po(r,this.keys,this.overrides,void 0,this.logService)}mergeContents(t,i){for(const r of Object.keys(i)){if(r in t&&St(t[r])&&St(i[r])){this.mergeContents(t[r],i[r]);continue}t[r]=nt(i[r])}}getContentsForOverrideIdentifer(t){let i=null,r=null;const n=s=>{s&&(r?this.mergeContents(r,s):r=nt(s))};for(const s of this.overrides)s.identifiers.length===1&&s.identifiers[0]===t?i=s.contents:s.identifiers.includes(t)&&n(s.contents);return n(i),r}toJSON(){return{contents:this.contents,overrides:this.overrides,keys:this.keys}}addValue(t,i){this.updateValue(t,i,!0)}setValue(t,i){this.updateValue(t,i,!1)}removeValue(t){const i=this.keys.indexOf(t);i!==-1&&(this.keys.splice(i,1),J3(this.contents,t),Pr.test(t)&&this.overrides.splice(this.overrides.findIndex(r=>Sr(r.identifiers,Ml(t))),1))}updateValue(t,i,r){if(ME(this.contents,t,i,n=>this.logService.error(n)),r=r||this.keys.indexOf(t)===-1,r&&this.keys.push(t),Pr.test(t)){const n=Ml(t),s={identifiers:n,keys:Object.keys(this.contents[t]),contents:Um(this.contents[t],a=>this.logService.error(a))},o=this.overrides.findIndex(a=>Sr(a.identifiers,n));o!==-1?this.overrides[o]=s:this.overrides.push(s)}}},SL=class{constructor(e,t){this._name=e,this.logService=t,this._raw=null,this._configurationModel=null,this._restrictedConfigurations=[],this._parseErrors=[]}get configurationModel(){return this._configurationModel||Oa.createEmptyModel(this.logService)}get restrictedConfigurations(){return this._restrictedConfigurations}get errors(){return this._parseErrors}parse(e,t){if(!Et(e)){const i=this.doParseContent(e);this.parseRaw(i,t)}}reparse(e){this._raw&&this.parseRaw(this._raw,e)}parseRaw(e,t){this._raw=e;const{contents:i,keys:r,overrides:n,restricted:s,hasExcludedProperties:o}=this.doParseRaw(e,t);this._configurationModel=new Oa(i,r,n,o?[e]:void 0,this.logService),this._restrictedConfigurations=s||[]}doParseContent(e){let t={},i=null,r=[];const n=[],s=[];function o(l){Array.isArray(r)?r.push(l):i!==null&&(r[i]=l)}const a={onObjectBegin:()=>{const l={};o(l),n.push(r),r=l,i=null},onObjectProperty:l=>{i=l},onObjectEnd:()=>{r=n.pop()},onArrayBegin:()=>{const l=[];o(l),n.push(r),r=l,i=null},onArrayEnd:()=>{r=n.pop()},onLiteralValue:o,onError:(l,c,u)=>{s.push({error:l,offset:c,length:u})}};if(e)try{xL(e,a),t=r[0]||{}}catch(l){this.logService.error(`Error while parsing settings file ${this._name}: ${l}`),this._parseErrors=[l]}return t}doParseRaw(e,t){const i=Ht.as(Ps.Configuration).getConfigurationProperties(),r=this.filter(e,i,!0,t);e=r.raw;const n=Um(e,a=>this.logService.error(`Conflict in settings file ${this._name}: ${a}`)),s=Object.keys(e),o=this.toOverrides(e,a=>this.logService.error(`Conflict in settings file ${this._name}: ${a}`));return{contents:n,keys:s,overrides:o,restricted:r.restricted,hasExcludedProperties:r.hasExcludedProperties}}filter(e,t,i,r){let n=!1;if(!r?.scopes&&!r?.skipRestricted&&!r?.exclude?.length)return{raw:e,restricted:[],hasExcludedProperties:n};const s={},o=[];for(const a in e)if(Pr.test(a)&&i){const l=this.filter(e[a],t,!1,r);s[a]=l.raw,n=n||l.hasExcludedProperties,o.push(...l.restricted)}else{const l=t[a];l?.restricted&&o.push(a),this.shouldInclude(a,l,r)?s[a]=e[a]:n=!0}return{raw:s,restricted:o,hasExcludedProperties:n}}shouldInclude(e,t,i){if(i.exclude?.includes(e))return!1;if(i.include?.includes(e))return!0;if(i.skipRestricted&&t?.restricted||i.skipUnregistered&&!t)return!1;const r=t?typeof t.scope<"u"?t.scope:4:void 0;return r===void 0||i.scopes===void 0?!0:i.scopes.includes(r)}toOverrides(e,t){const i=[];for(const r of Object.keys(e))if(Pr.test(r)){const n={};for(const s in e[r])n[s]=e[r][s];i.push({identifiers:Ml(r),keys:Object.keys(n),contents:Um(n,t)})}return i}},EL=class{constructor(e,t,i,r,n,s,o,a,l,c,u,d,f){this.key=e,this.overrides=t,this._value=i,this.overrideIdentifiers=r,this.defaultConfiguration=n,this.policyConfiguration=s,this.applicationConfiguration=o,this.userConfiguration=a,this.localUserConfiguration=l,this.remoteUserConfiguration=c,this.workspaceConfiguration=u,this.folderConfigurationModel=d,this.memoryConfigurationModel=f}get value(){return Uc(this._value)}toInspectValue(e){return e?.value!==void 0||e?.override!==void 0||e?.overrides!==void 0?e:void 0}get defaultInspectValue(){return this._defaultInspectValue||(this._defaultInspectValue=this.defaultConfiguration.inspect(this.key,this.overrides.overrideIdentifier)),this._defaultInspectValue}get defaultValue(){return this.defaultInspectValue.merged}get default(){return this.toInspectValue(this.defaultInspectValue)}get policyInspectValue(){return this._policyInspectValue===void 0&&(this._policyInspectValue=this.policyConfiguration?this.policyConfiguration.inspect(this.key):null),this._policyInspectValue}get policyValue(){return this.policyInspectValue?.merged}get policy(){return this.policyInspectValue?.value!==void 0?{value:this.policyInspectValue.value}:void 0}get applicationInspectValue(){return this._applicationInspectValue===void 0&&(this._applicationInspectValue=this.applicationConfiguration?this.applicationConfiguration.inspect(this.key):null),this._applicationInspectValue}get applicationValue(){return this.applicationInspectValue?.merged}get application(){return this.toInspectValue(this.applicationInspectValue)}get userInspectValue(){return this._userInspectValue||(this._userInspectValue=this.userConfiguration.inspect(this.key,this.overrides.overrideIdentifier)),this._userInspectValue}get userValue(){return this.userInspectValue.merged}get user(){return this.toInspectValue(this.userInspectValue)}get userLocalInspectValue(){return this._userLocalInspectValue||(this._userLocalInspectValue=this.localUserConfiguration.inspect(this.key,this.overrides.overrideIdentifier)),this._userLocalInspectValue}get userLocalValue(){return this.userLocalInspectValue.merged}get userLocal(){return this.toInspectValue(this.userLocalInspectValue)}get userRemoteInspectValue(){return this._userRemoteInspectValue||(this._userRemoteInspectValue=this.remoteUserConfiguration.inspect(this.key,this.overrides.overrideIdentifier)),this._userRemoteInspectValue}get userRemoteValue(){return this.userRemoteInspectValue.merged}get userRemote(){return this.toInspectValue(this.userRemoteInspectValue)}get workspaceInspectValue(){return this._workspaceInspectValue===void 0&&(this._workspaceInspectValue=this.workspaceConfiguration?this.workspaceConfiguration.inspect(this.key,this.overrides.overrideIdentifier):null),this._workspaceInspectValue}get workspaceValue(){return this.workspaceInspectValue?.merged}get workspace(){return this.toInspectValue(this.workspaceInspectValue)}get workspaceFolderInspectValue(){return this._workspaceFolderInspectValue===void 0&&(this._workspaceFolderInspectValue=this.folderConfigurationModel?this.folderConfigurationModel.inspect(this.key,this.overrides.overrideIdentifier):null),this._workspaceFolderInspectValue}get workspaceFolderValue(){return this.workspaceFolderInspectValue?.merged}get workspaceFolder(){return this.toInspectValue(this.workspaceFolderInspectValue)}get memoryInspectValue(){return this._memoryInspectValue===void 0&&(this._memoryInspectValue=this.memoryConfigurationModel.inspect(this.key,this.overrides.overrideIdentifier)),this._memoryInspectValue}get memoryValue(){return this.memoryInspectValue.merged}get memory(){return this.toInspectValue(this.memoryInspectValue)}},u_=class e7{constructor(t,i,r,n,s,o,a,l,c,u){this._defaultConfiguration=t,this._policyConfiguration=i,this._applicationConfiguration=r,this._localUserConfiguration=n,this._remoteUserConfiguration=s,this._workspaceConfiguration=o,this._folderConfigurations=a,this._memoryConfiguration=l,this._memoryConfigurationByResource=c,this.logService=u,this._workspaceConsolidatedConfiguration=null,this._foldersConsolidatedConfigurations=new Ft,this._userConfiguration=null}getValue(t,i,r){return this.getConsolidatedConfigurationModel(t,i,r).getValue(t)}updateValue(t,i,r={}){let n;r.resource?(n=this._memoryConfigurationByResource.get(r.resource),n||(n=Oa.createEmptyModel(this.logService),this._memoryConfigurationByResource.set(r.resource,n))):n=this._memoryConfiguration,i===void 0?n.removeValue(t):n.setValue(t,i),r.resource||(this._workspaceConsolidatedConfiguration=null)}inspect(t,i,r){const n=this.getConsolidatedConfigurationModel(t,i,r),s=this.getFolderConfigurationModelForResource(i.resource,r),o=i.resource?this._memoryConfigurationByResource.get(i.resource)||this._memoryConfiguration:this._memoryConfiguration,a=new Set;for(const l of n.overrides)for(const c of l.identifiers)n.getOverrideValue(t,c)!==void 0&&a.add(c);return new EL(t,i,n.getValue(t),a.size?[...a]:void 0,this._defaultConfiguration,this._policyConfiguration.isEmpty()?void 0:this._policyConfiguration,this.applicationConfiguration.isEmpty()?void 0:this.applicationConfiguration,this.userConfiguration,this.localUserConfiguration,this.remoteUserConfiguration,r?this._workspaceConfiguration:void 0,s||void 0,o)}keys(t){const i=this.getFolderConfigurationModelForResource(void 0,t);return{default:this._defaultConfiguration.keys.slice(0),user:this.userConfiguration.keys.slice(0),workspace:this._workspaceConfiguration.keys.slice(0),workspaceFolder:i?i.keys.slice(0):[]}}updateDefaultConfiguration(t){this._defaultConfiguration=t,this._workspaceConsolidatedConfiguration=null,this._foldersConsolidatedConfigurations.clear()}updatePolicyConfiguration(t){this._policyConfiguration=t}updateApplicationConfiguration(t){this._applicationConfiguration=t,this._workspaceConsolidatedConfiguration=null,this._foldersConsolidatedConfigurations.clear()}updateLocalUserConfiguration(t){this._localUserConfiguration=t,this._userConfiguration=null,this._workspaceConsolidatedConfiguration=null,this._foldersConsolidatedConfigurations.clear()}updateRemoteUserConfiguration(t){this._remoteUserConfiguration=t,this._userConfiguration=null,this._workspaceConsolidatedConfiguration=null,this._foldersConsolidatedConfigurations.clear()}updateWorkspaceConfiguration(t){this._workspaceConfiguration=t,this._workspaceConsolidatedConfiguration=null,this._foldersConsolidatedConfigurations.clear()}updateFolderConfiguration(t,i){this._folderConfigurations.set(t,i),this._foldersConsolidatedConfigurations.delete(t)}deleteFolderConfiguration(t){this.folderConfigurations.delete(t),this._foldersConsolidatedConfigurations.delete(t)}compareAndUpdateDefaultConfiguration(t,i){const r=[];if(!i){const{added:n,updated:s,removed:o}=Zn(this._defaultConfiguration,t);i=[...n,...s,...o]}for(const n of i)for(const s of Ml(n)){const o=this._defaultConfiguration.getKeysForOverrideIdentifier(s),a=t.getKeysForOverrideIdentifier(s),l=[...a.filter(c=>o.indexOf(c)===-1),...o.filter(c=>a.indexOf(c)===-1),...o.filter(c=>!fi(this._defaultConfiguration.override(s).getValue(c),t.override(s).getValue(c)))];r.push([s,l])}return this.updateDefaultConfiguration(t),{keys:i,overrides:r}}compareAndUpdatePolicyConfiguration(t){const{added:i,updated:r,removed:n}=Zn(this._policyConfiguration,t),s=[...i,...r,...n];return s.length&&this.updatePolicyConfiguration(t),{keys:s,overrides:[]}}compareAndUpdateApplicationConfiguration(t){const{added:i,updated:r,removed:n,overrides:s}=Zn(this.applicationConfiguration,t),o=[...i,...r,...n];return o.length&&this.updateApplicationConfiguration(t),{keys:o,overrides:s}}compareAndUpdateLocalUserConfiguration(t){const{added:i,updated:r,removed:n,overrides:s}=Zn(this.localUserConfiguration,t),o=[...i,...r,...n];return o.length&&this.updateLocalUserConfiguration(t),{keys:o,overrides:s}}compareAndUpdateRemoteUserConfiguration(t){const{added:i,updated:r,removed:n,overrides:s}=Zn(this.remoteUserConfiguration,t),o=[...i,...r,...n];return o.length&&this.updateRemoteUserConfiguration(t),{keys:o,overrides:s}}compareAndUpdateWorkspaceConfiguration(t){const{added:i,updated:r,removed:n,overrides:s}=Zn(this.workspaceConfiguration,t),o=[...i,...r,...n];return o.length&&this.updateWorkspaceConfiguration(t),{keys:o,overrides:s}}compareAndUpdateFolderConfiguration(t,i){const r=this.folderConfigurations.get(t),{added:n,updated:s,removed:o,overrides:a}=Zn(r,i),l=[...n,...s,...o];return(l.length||!r)&&this.updateFolderConfiguration(t,i),{keys:l,overrides:a}}compareAndDeleteFolderConfiguration(t){const i=this.folderConfigurations.get(t);if(!i)throw new Error("Unknown folder");this.deleteFolderConfiguration(t);const{added:r,updated:n,removed:s,overrides:o}=Zn(i,void 0);return{keys:[...r,...n,...s],overrides:o}}get defaults(){return this._defaultConfiguration}get applicationConfiguration(){return this._applicationConfiguration}get userConfiguration(){if(!this._userConfiguration)if(this._remoteUserConfiguration.isEmpty())this._userConfiguration=this._localUserConfiguration;else{const t=this._localUserConfiguration.merge(this._remoteUserConfiguration);this._userConfiguration=new Oa(t.contents,t.keys,t.overrides,void 0,this.logService)}return this._userConfiguration}get localUserConfiguration(){return this._localUserConfiguration}get remoteUserConfiguration(){return this._remoteUserConfiguration}get workspaceConfiguration(){return this._workspaceConfiguration}get folderConfigurations(){return this._folderConfigurations}getConsolidatedConfigurationModel(t,i,r){let n=this.getConsolidatedConfigurationModelForResource(i,r);if(i.overrideIdentifier&&(n=n.override(i.overrideIdentifier)),!this._policyConfiguration.isEmpty()&&this._policyConfiguration.getValue(t)!==void 0){n=n.merge();for(const s of this._policyConfiguration.keys)n.setValue(s,this._policyConfiguration.getValue(s))}return n}getConsolidatedConfigurationModelForResource({resource:t},i){let r=this.getWorkspaceConsolidatedConfiguration();if(i&&t){const n=i.getFolder(t);n&&(r=this.getFolderConsolidatedConfiguration(n.uri)||r);const s=this._memoryConfigurationByResource.get(t);s&&(r=r.merge(s))}return r}getWorkspaceConsolidatedConfiguration(){return this._workspaceConsolidatedConfiguration||(this._workspaceConsolidatedConfiguration=this._defaultConfiguration.merge(this.applicationConfiguration,this.userConfiguration,this._workspaceConfiguration,this._memoryConfiguration)),this._workspaceConsolidatedConfiguration}getFolderConsolidatedConfiguration(t){let i=this._foldersConsolidatedConfigurations.get(t);if(!i){const r=this.getWorkspaceConsolidatedConfiguration(),n=this._folderConfigurations.get(t);n?(i=r.merge(n),this._foldersConsolidatedConfigurations.set(t,i)):i=r}return i}getFolderConfigurationModelForResource(t,i){if(i&&t){const r=i.getFolder(t);if(r)return this._folderConfigurations.get(r.uri)}}toData(){return{defaults:{contents:this._defaultConfiguration.contents,overrides:this._defaultConfiguration.overrides,keys:this._defaultConfiguration.keys},policy:{contents:this._policyConfiguration.contents,overrides:this._policyConfiguration.overrides,keys:this._policyConfiguration.keys},application:{contents:this.applicationConfiguration.contents,overrides:this.applicationConfiguration.overrides,keys:this.applicationConfiguration.keys,raw:Array.isArray(this.applicationConfiguration.raw)?void 0:this.applicationConfiguration.raw},userLocal:{contents:this.localUserConfiguration.contents,overrides:this.localUserConfiguration.overrides,keys:this.localUserConfiguration.keys,raw:Array.isArray(this.localUserConfiguration.raw)?void 0:this.localUserConfiguration.raw},userRemote:{contents:this.remoteUserConfiguration.contents,overrides:this.remoteUserConfiguration.overrides,keys:this.remoteUserConfiguration.keys,raw:Array.isArray(this.remoteUserConfiguration.raw)?void 0:this.remoteUserConfiguration.raw},workspace:{contents:this._workspaceConfiguration.contents,overrides:this._workspaceConfiguration.overrides,keys:this._workspaceConfiguration.keys},folders:[...this._folderConfigurations.keys()].reduce((t,i)=>{const{contents:r,overrides:n,keys:s}=this._folderConfigurations.get(i);return t.push([i,{contents:r,overrides:n,keys:s}]),t},[])}}allKeys(){const t=new Set;return this._defaultConfiguration.keys.forEach(i=>t.add(i)),this.userConfiguration.keys.forEach(i=>t.add(i)),this._workspaceConfiguration.keys.forEach(i=>t.add(i)),this._folderConfigurations.forEach(i=>i.keys.forEach(r=>t.add(r))),[...t.values()]}allOverrideIdentifiers(){const t=new Set;return this._defaultConfiguration.getAllOverrideIdentifiers().forEach(i=>t.add(i)),this.userConfiguration.getAllOverrideIdentifiers().forEach(i=>t.add(i)),this._workspaceConfiguration.getAllOverrideIdentifiers().forEach(i=>t.add(i)),this._folderConfigurations.forEach(i=>i.getAllOverrideIdentifiers().forEach(r=>t.add(r))),[...t.values()]}getAllKeysForOverrideIdentifier(t){const i=new Set;return this._defaultConfiguration.getKeysForOverrideIdentifier(t).forEach(r=>i.add(r)),this.userConfiguration.getKeysForOverrideIdentifier(t).forEach(r=>i.add(r)),this._workspaceConfiguration.getKeysForOverrideIdentifier(t).forEach(r=>i.add(r)),this._folderConfigurations.forEach(r=>r.getKeysForOverrideIdentifier(t).forEach(n=>i.add(n))),[...i.values()]}static parse(t,i){const r=this.parseConfigurationModel(t.defaults,i),n=this.parseConfigurationModel(t.policy,i),s=this.parseConfigurationModel(t.application,i),o=this.parseConfigurationModel(t.userLocal,i),a=this.parseConfigurationModel(t.userRemote,i),l=this.parseConfigurationModel(t.workspace,i),c=t.folders.reduce((u,d)=>(u.set(y.revive(d[0]),this.parseConfigurationModel(d[1],i)),u),new Ft);return new e7(r,n,s,o,a,l,c,Oa.createEmptyModel(i),new Ft,i)}static parseConfigurationModel(t,i){return new Oa(t.contents,t.keys,t.overrides,t.raw,i)}},CL=class{constructor(e,t,i,r,n){this.change=e,this.previous=t,this.currentConfiguraiton=i,this.currentWorkspace=r,this.logService=n,this._marker=`
`,this._markerCode1=this._marker.charCodeAt(0),this._markerCode2=46,this.affectedKeys=new Set,this._previousConfiguration=void 0;for(const s of e.keys)this.affectedKeys.add(s);for(const[,s]of e.overrides)for(const o of s)this.affectedKeys.add(o);this._affectsConfigStr=this._marker;for(const s of this.affectedKeys)this._affectsConfigStr+=s+this._marker}get previousConfiguration(){return!this._previousConfiguration&&this.previous&&(this._previousConfiguration=u_.parse(this.previous.data,this.logService)),this._previousConfiguration}affectsConfiguration(e,t){const i=this._marker+e,r=this._affectsConfigStr.indexOf(i);if(r<0)return!1;const n=r+i.length;if(n>=this._affectsConfigStr.length)return!1;const s=this._affectsConfigStr.charCodeAt(n);if(s!==this._markerCode1&&s!==this._markerCode2)return!1;if(t){const o=this.previousConfiguration?this.previousConfiguration.getValue(e,t,this.previous?.workspace):void 0,a=this.currentConfiguraiton.getValue(e,t,this.currentWorkspace);return!fi(o,a)}return!0}};function Zn(e,t){const{added:i,removed:r,updated:n}=ID(t?.rawConfiguration,e?.rawConfiguration),s=[],o=e?.getAllOverrideIdentifiers()||[],a=t?.getAllOverrideIdentifiers()||[];if(t){const l=a.filter(c=>!o.includes(c));for(const c of l)s.push([c,t.getKeysForOverrideIdentifier(c)])}if(e){const l=o.filter(c=>!a.includes(c));for(const c of l)s.push([c,e.getKeysForOverrideIdentifier(c)])}if(t&&e){for(const l of o)if(a.includes(l)){const c=ID({contents:e.getOverrideValue(void 0,l)||{},keys:e.getKeysForOverrideIdentifier(l)},{contents:t.getOverrideValue(void 0,l)||{},keys:t.getKeysForOverrideIdentifier(l)});s.push([l,[...c.added,...c.removed,...c.updated]])}}return{added:i,removed:r,updated:n,overrides:s}}function ID(e,t){const i=e?t?e.keys.filter(s=>t.keys.indexOf(s)===-1):[...e.keys]:[],r=t?e?t.keys.filter(s=>e.keys.indexOf(s)===-1):[...t.keys]:[],n=[];if(e&&t){for(const s of t.keys)if(e.keys.indexOf(s)!==-1){const o=Dd(t.contents,s),a=Dd(e.contents,s);fi(o,a)||n.push(s)}}return{added:i,removed:r,updated:n}}function Uf(e,t){if(t){const i=t.split(".");let r=e;for(let n=0;r&&n<i.length;n++)r=r[i[n]];return r}}function DL(e){return e instanceof y}function IL(e){return e&&e.uri instanceof y&&e.languageId&&typeof e.languageId=="string"}function kL(e){return e&&!e.uri&&e.languageId&&typeof e.languageId=="string"}function PL(e){return e&&e.uri instanceof y&&(!e.name||typeof e.name=="string")&&(!e.index||typeof e.index=="number")}function kD(e){if(DL(e))return{resource:e};if(IL(e))return{resource:e.uri,overrideIdentifier:e.languageId};if(kL(e))return{overrideIdentifier:e.languageId};if(PL(e))return{resource:e.uri};if(e===null)return{resource:null}}var d_=class{constructor(t,i,r){this._proxy=t.getProxy(W.MainThreadConfiguration),this._extHostWorkspace=i,this._logService=r,this._barrier=new Cr,this._actual=null}getConfigProvider(){return this._barrier.wait().then(t=>this._actual)}$initializeConfiguration(t){this._actual=new TL(this._proxy,this._extHostWorkspace,t,this._logService),this._barrier.open()}$acceptConfigurationChanged(t,i){this.getConfigProvider().then(r=>r.$acceptConfigurationChanged(t,i))}};d_=__decorate([__param(0,Ue),__param(1,hn),__param(2,qe)],d_);var TL=class{constructor(e,t,i,r){this._onDidChangeConfiguration=new P,this._proxy=e,this._logService=r,this._extHostWorkspace=t,this._configuration=u_.parse(i,r),this._configurationScopes=this._toMap(i.configurationScopes)}get onDidChangeConfiguration(){return this._onDidChangeConfiguration&&this._onDidChangeConfiguration.event}$acceptConfigurationChanged(e,t){const i={data:this._configuration.toData(),workspace:this._extHostWorkspace.workspace};this._configuration=u_.parse(e,this._logService),this._configurationScopes=this._toMap(e.configurationScopes),this._onDidChangeConfiguration.fire(this._toConfigurationChangeEvent(t,i))}getConfiguration(e,t,i){const r=kD(t)||{},n=this._toReadonlyValue(this._configuration.getValue(e,r,this._extHostWorkspace.workspace));e&&this._validateConfigurationAccess(e,r,i?.identifier);function s(a){if(a==null)return null;if(typeof a=="boolean")return a?2:5;switch(a){case ca.Global:return 2;case ca.Workspace:return 5;case ca.WorkspaceFolder:return 6}}const o={has(a){return typeof Uf(n,a)<"u"},get:(a,l)=>{this._validateConfigurationAccess(e?`${e}.${a}`:a,r,i?.identifier);let c=Uf(n,a);if(typeof c>"u")c=l;else{let u;const d=(f,p)=>{if(St(f)){let m;const _=()=>{u=u||nt(n),m=m||Uf(u,p)};return new Proxy(f,{get:(b,E)=>{if(typeof E=="string"&&E.toLowerCase()==="tojson")return _(),()=>m;if(u)return m=m||Uf(u,p),m[E];const C=b[E];return typeof E=="string"?d(C,`${p}.${E}`):C},set:(b,E,C)=>(_(),m&&(m[E]=C),!0),deleteProperty:(b,E)=>(_(),m&&delete m[E],!0),defineProperty:(b,E,C)=>(_(),m&&Object.defineProperty(m,E,C),!0)})}return Array.isArray(f)?nt(f):f};c=d(c,a)}return c},update:(a,l,c,u)=>{a=e?`${e}.${a}`:a;const d=s(c);return l!==void 0?this._proxy.$updateConfigurationOption(d,a,l,r,u):this._proxy.$removeConfigurationOption(d,a,r,u)},inspect:a=>{a=e?`${e}.${a}`:a;const l=this._configuration.inspect(a,r,this._extHostWorkspace.workspace);if(l)return{key:a,defaultValue:nt(l.policy?.value??l.default?.value),globalLocalValue:nt(l.userLocal?.value),globalRemoteValue:nt(l.userRemote?.value),globalValue:nt(l.user?.value??l.application?.value),workspaceValue:nt(l.workspace?.value),workspaceFolderValue:nt(l.workspaceFolder?.value),defaultLanguageValue:nt(l.default?.override),globalLocalLanguageValue:nt(l.userLocal?.override),globalRemoteLanguageValue:nt(l.userRemote?.override),globalLanguageValue:nt(l.user?.override??l.application?.override),workspaceLanguageValue:nt(l.workspace?.override),workspaceFolderLanguageValue:nt(l.workspaceFolder?.override),languageIds:nt(l.overrideIdentifiers)}}};return typeof n=="object"&&ys(o,n,!1),Object.freeze(o)}_toReadonlyValue(e){const t=i=>St(i)?new Proxy(i,{get:(r,n)=>t(r[n]),set:(r,n,s)=>{throw new Error(`TypeError: Cannot assign to read only property '${String(n)}' of object`)},deleteProperty:(r,n)=>{throw new Error(`TypeError: Cannot delete read only property '${String(n)}' of object`)},defineProperty:(r,n)=>{throw new Error(`TypeError: Cannot define property '${String(n)}' for a readonly object`)},setPrototypeOf:r=>{throw new Error("TypeError: Cannot set prototype for a readonly object")},isExtensible:()=>!1,preventExtensions:()=>!0}):i;return t(e)}_validateConfigurationAccess(e,t,i){const r=Pr.test(e)?5:this._configurationScopes.get(e),n=i?`[${i.value}] `:"";if(r===5){typeof t?.resource>"u"&&this._logService.warn(`${n}Accessing a resource scoped configuration without providing a resource is not expected. To get the effective value for '${e}', provide the URI of a resource or 'null' for any resource.`);return}if(r===4){t?.resource&&this._logService.warn(`${n}Accessing a window scoped configuration for a resource is not expected. To associate '${e}' to a resource, define its scope to 'resource' in configuration contributions in 'package.json'.`);return}}_toConfigurationChangeEvent(e,t){const i=new CL(e,t,this._configuration,this._extHostWorkspace.workspace,this._logService);return Object.freeze({affectsConfiguration:(r,n)=>i.affectsConfiguration(r,kD(n))})}_toMap(e){return e.reduce((t,i)=>(t.set(i[0],i[1]),t),new Map)}},fn=U("IExtHostConfiguration"),AL=class{constructor(e,t){this.versionId=e,this.removedDueToLooping=t}},Bc=class t7 extends se{static isHostExtension(t,i,r){if(i.getExtensionDescription(t))return!1;const n=r.getExtensionDescription(t);return n?!!((n.main||n.browser)&&n.api==="none"):!1}constructor(t,i){super(),this._activationEventsReader=t,this._onDidChange=this._register(new P),this.onDidChange=this._onDidChange.event,this._versionId=0,this._extensionDescriptions=i,this._initialize()}_initialize(){this._extensionDescriptions.sort(LL),this._extensionsMap=new Xr,this._extensionsArr=[],this._activationMap=new Map;for(const t of this._extensionDescriptions){if(this._extensionsMap.has(t.identifier)){console.error("Extension `"+t.identifier.value+"` is already registered");continue}this._extensionsMap.set(t.identifier,t),this._extensionsArr.push(t);const i=this._activationEventsReader.readActivationEvents(t);for(const r of i)this._activationMap.has(r)||this._activationMap.set(r,[]),this._activationMap.get(r).push(t)}}set(t){return this._extensionDescriptions=t,this._initialize(),this._versionId++,this._onDidChange.fire(void 0),{versionId:this._versionId}}deltaExtensions(t,i){this._extensionDescriptions=TD(this._extensionDescriptions,i),this._extensionDescriptions=this._extensionDescriptions.concat(t);const r=t7._findLoopingExtensions(this._extensionDescriptions);return this._extensionDescriptions=TD(this._extensionDescriptions,r.map(n=>n.identifier)),this._initialize(),this._versionId++,this._onDidChange.fire(void 0),new AL(this._versionId,r)}static _findLoopingExtensions(t){const i=new class{constructor(){this._arcs=new Map,this._nodesSet=new Set,this._nodesArr=[]}addNode(a){this._nodesSet.has(a)||(this._nodesSet.add(a),this._nodesArr.push(a))}addArc(a,l){this.addNode(a),this.addNode(l),this._arcs.has(a)?this._arcs.get(a).push(l):this._arcs.set(a,[l])}getArcs(a){return this._arcs.has(a)?this._arcs.get(a):[]}hasOnlyGoodArcs(a,l){const c=i.getArcs(a);for(let u=0;u<c.length;u++)if(!l.has(c[u]))return!1;return!0}getNodes(){return this._nodesArr}},r=new Xr;for(const a of t)if(r.set(a.identifier,a),a.extensionDependencies)for(const l of a.extensionDependencies)i.addArc(Oe.toKey(a.identifier),Oe.toKey(l));const n=new Set;i.getNodes().filter(a=>i.getArcs(a).length===0).forEach(a=>n.add(a));const s=i.getNodes().filter(a=>!n.has(a));let o;do{o=!1;for(let a=0;a<s.length;a++){const l=s[a];i.hasOnlyGoodArcs(l,n)&&(s.splice(a,1),a--,n.add(l),o=!0)}}while(o);return s.map(a=>r.get(a))}containsActivationEvent(t){return this._activationMap.has(t)}containsExtension(t){return this._extensionsMap.has(t)}getExtensionDescriptionsForActivationEvent(t){const i=this._activationMap.get(t);return i?i.slice(0):[]}getAllExtensionDescriptions(){return this._extensionsArr.slice(0)}getSnapshot(){return new RL(this._versionId,this.getAllExtensionDescriptions())}getExtensionDescription(t){const i=this._extensionsMap.get(t);return i||void 0}getExtensionDescriptionByUUID(t){for(const i of this._extensionsArr)if(i.uuid===t)return i}getExtensionDescriptionByIdOrUUID(t,i){return this.getExtensionDescription(t)??(i?this.getExtensionDescriptionByUUID(i):void 0)}},RL=class{constructor(e,t){this.versionId=e,this.extensions=t}},PD;(function(e){e[e.Builtin=0]="Builtin",e[e.User=1]="User",e[e.Dev=2]="Dev"})(PD||(PD={}));function LL(e,t){const i=e.isBuiltin?0:e.isUnderDevelopment?2:1,r=t.isBuiltin?0:t.isUnderDevelopment?2:1;if(i!==r)return i-r;const n=Ne.basename(e.extensionLocation.path),s=Ne.basename(t.extensionLocation.path);return n<s?-1:n>s?1:0}function TD(e,t){const i=new vs(t);return e.filter(r=>!i.has(r.identifier))}var Bf=class i7{static{this.NONE=new i7(!1,-1,-1,-1)}constructor(t,i,r,n){this.startup=t,this.codeLoadingTime=i,this.activateCallTime=r,this.activateResolvedTime=n}},h_=class{constructor(e){this._startup=e,this._codeLoadingStart=-1,this._codeLoadingStop=-1,this._activateCallStart=-1,this._activateCallStop=-1,this._activateResolveStart=-1,this._activateResolveStop=-1}_delta(e,t){return e===-1||t===-1?-1:t-e}build(){return new Bf(this._startup,this._delta(this._codeLoadingStart,this._codeLoadingStop),this._delta(this._activateCallStart,this._activateCallStop),this._delta(this._activateResolveStart,this._activateResolveStop))}codeLoadingStart(){this._codeLoadingStart=Date.now()}codeLoadingStop(){this._codeLoadingStop=Date.now()}activateCallStart(){this._activateCallStart=Date.now()}activateCallStop(){this._activateCallStop=Date.now()}activateResolveStart(){this._activateResolveStart=Date.now()}activateResolveStop(){this._activateResolveStop=Date.now()}},Wf=class{constructor(e,t,i,r,n,s){this.activationFailed=e,this.activationFailedError=t,this.activationTimes=i,this.module=r,this.exports=n,this.disposable=s}},NL=class extends Wf{constructor(e){super(!1,null,e,{activate:void 0,deactivate:void 0},void 0,se.None)}},ML=class extends Wf{constructor(){super(!1,null,Bf.NONE,{activate:void 0,deactivate:void 0},void 0,se.None)}},Vf=class extends Wf{constructor(e){super(!0,e,Bf.NONE,{activate:void 0,deactivate:void 0},void 0,se.None)}},f_=class{constructor(t,i,r,n){this._logService=n,this._registry=t,this._globalRegistry=i,this._host=r,this._operations=new Xr,this._alreadyActivatedEvents=Object.create(null)}dispose(){for(const[t,i]of this._operations)i.dispose()}async waitForActivatingExtensions(){const t=[];for(const[i,r]of this._operations)t.push(r.wait());await Promise.all(t)}isActivated(t){const i=this._operations.get(t);return!!(i&&i.value)}getActivatedExtension(t){const i=this._operations.get(t);if(!i||!i.value)throw new Error(`Extension '${t.value}' is not known or not activated`);return i.value}async activateByEvent(t,i){if(this._alreadyActivatedEvents[t])return;const r=this._registry.getExtensionDescriptionsForActivationEvent(t);await this._activateExtensions(r.map(n=>({id:n.identifier,reason:{startup:i,extensionId:n.identifier,activationEvent:t}}))),this._alreadyActivatedEvents[t]=!0}activateById(t,i){const r=this._registry.getExtensionDescription(t);if(!r)throw new Error(`Extension '${t.value}' is not known`);return this._activateExtensions([{id:r.identifier,reason:i}])}async _activateExtensions(t){const i=t.filter(r=>!this.isActivated(r.id)).map(r=>this._handleActivationRequest(r));await Promise.all(i.map(r=>r.wait()))}_handleActivationRequest(t){if(this._operations.has(t.id))return this._operations.get(t.id);if(this._isHostExtension(t.id))return this._createAndSaveOperation(t,null,[],null);const i=this._registry.getExtensionDescription(t.id);if(!i){const s=new Error(`Cannot activate unknown extension '${t.id.value}'`),o=this._createAndSaveOperation(t,null,[],new Vf(s));return this._host.onExtensionActivationError(t.id,s,new i4(t.id.value)),o}const r=[],n=typeof i.extensionDependencies>"u"?[]:i.extensionDependencies;for(const s of n){if(this._isResolvedExtension(s))continue;const o=this._operations.get(s);if(o){r.push(o);continue}if(this._isHostExtension(s)){r.push(this._handleActivationRequest({id:this._globalRegistry.getExtensionDescription(s).identifier,reason:t.reason}));continue}const a=this._registry.getExtensionDescription(s);if(a){if(!a.main&&!a.browser)continue;r.push(this._handleActivationRequest({id:a.identifier,reason:t.reason}));continue}const l=i.displayName||i.identifier.value,c=new Error(`Cannot activate the '${l}' extension because it depends on unknown extension '${s}'`),u=this._createAndSaveOperation(t,i.displayName,[],new Vf(c));return this._host.onExtensionActivationError(i.identifier,c,new i4(s)),u}return this._createAndSaveOperation(t,i.displayName,r,null)}_createAndSaveOperation(t,i,r,n){const s=new p_(t.id,i,t.reason,r,n,this._host,this._logService);return this._operations.set(t.id,s),s}_isHostExtension(t){return Bc.isHostExtension(t,this._registry,this._globalRegistry)}_isResolvedExtension(t){const i=this._globalRegistry.getExtensionDescription(t);return i?!i.main&&!i.browser:!1}};f_=__decorate([__param(3,qe)],f_);var p_=class{get value(){return this._value}get friendlyName(){return this._displayName||this._id.value}constructor(t,i,r,n,s,o,a){this._id=t,this._displayName=i,this._reason=r,this._deps=n,this._value=s,this._host=o,this._logService=a,this._barrier=new Cr,this._isDisposed=!1,this._initialize()}dispose(){this._isDisposed=!0}wait(){return this._barrier.wait()}async _initialize(){await this._waitForDepsThenActivate(),this._barrier.open()}async _waitForDepsThenActivate(){if(!this._value){for(;this._deps.length>0;){for(let t=0;t<this._deps.length;t++){const i=this._deps[t];if(i.value&&!i.value.activationFailed){this._deps.splice(t,1),t--;continue}if(i.value&&i.value.activationFailed){const r=new Error(`Cannot activate the '${this.friendlyName}' extension because its dependency '${i.friendlyName}' failed to activate`);r.detail=i.value.activationFailedError,this._value=new Vf(r),this._host.onExtensionActivationError(this._id,r,null);return}}this._deps.length>0&&await Promise.race(this._deps.map(t=>t.wait()))}await this._activate()}}async _activate(){try{this._value=await this._host.actualActivateExtension(this._id,this._reason)}catch(t){const i=new Error;if(t&&t.name&&(i.name=t.name),t&&t.message?i.message=`Activating extension '${this._id.value}' failed: ${t.message}.`:i.message=`Activating extension '${this._id.value}' failed: ${t}.`,t&&t.stack&&(i.stack=t.stack),this._value=new Vf(i),this._isDisposed&&br(t))return;this._host.onExtensionActivationError(this._id,i,null),this._logService.error(`Activating extension ${this._id.value} failed due to an error:`),this._logService.error(t)}}};p_=__decorate([__param(6,qe)],p_);var AD=class{constructor(e,t){this._logService=t,this._onDidChangeStorage=new P,this.onDidChangeStorage=this._onDidChangeStorage.event,this._proxy=e.getProxy(W.MainThreadStorage)}registerExtensionStorageKeysToSync(e,t){this._proxy.$registerExtensionStorageKeysToSync(e,t)}async initializeExtensionStorage(e,t,i){const r=await this._proxy.$initializeExtensionStorage(e,t);let n;return r&&(n=this.safeParseValue(e,t,r)),n||i}setValue(e,t,i){return this._proxy.$setValue(e,t,i)}$acceptValue(e,t,i){const r=this.safeParseValue(e,t,i);r&&this._onDidChangeStorage.fire({shared:e,key:t,value:r})}safeParseValue(e,t,i){try{return JSON.parse(i)}catch(r){this._logService.error(`[extHostStorage] unexpected error parsing storage contents (extensionId: ${t}, global: ${e}): ${r}`)}}},g_=U("IExtHostStorage"),RD=class{constructor(e,t,i){this._deferredPromises=new Map,this._id=e,this._shared=t,this._storage=i,this._init=this._storage.initializeExtensionStorage(this._shared,this._id,Object.create(null)).then(r=>(this._value=r,this)),this._storageListener=this._storage.onDidChangeStorage(r=>{r.shared===this._shared&&r.key===this._id&&(this._value=r.value)}),this._scheduler=new Ao(()=>{const r=this._deferredPromises;this._deferredPromises=new Map,(async()=>{try{await this._storage.setValue(this._shared,this._id,this._value);for(const n of r.values())n.complete()}catch(n){for(const s of r.values())s.error(n)}})()},0)}keys(){return Object.entries(this._value??{}).filter(([,e])=>e!==void 0).map(([e])=>e)}get whenReady(){return this._init}get(e,t){let i=this._value[e];return typeof i>"u"&&(i=t),i}update(e,t){t!==null&&typeof t=="object"?this._value[e]=JSON.parse(JSON.stringify(t)):this._value[e]=t;const i=this._deferredPromises.get(e);if(i!==void 0)return i.p;const r=new Dr;return this._deferredPromises.set(e,r),this._scheduler.isScheduled()||this._scheduler.schedule(),r.p}dispose(){this._storageListener.dispose()}},OL=class extends RD{setKeysForSync(e){this._storage.registerExtensionStorageKeysToSync({id:this._id,version:this._extension.version},e)}constructor(e,t){super(e.identifier.value,!0,t),this._extension=e}},Fr,m_=Fr=class{constructor(t,i){this._fileSystemProvider=new Map,this._writeQueue=new AT,this._proxy=t.getProxy(W.MainThreadFileSystem);const r=this;this.value=Object.freeze({async stat(n){try{let s;const o=r._fileSystemProvider.get(n.scheme);return o?(await r._proxy.$ensureActivation(n.scheme),s=await o.impl.stat(n)):s=await r._proxy.$stat(n),{type:s.type,ctime:s.ctime,mtime:s.mtime,size:s.size,permissions:s.permissions===Bo.Readonly?1:void 0}}catch(s){Fr._handleError(s)}},async readDirectory(n){try{const s=r._fileSystemProvider.get(n.scheme);return s?(await r._proxy.$ensureActivation(n.scheme),(await s.impl.readDirectory(n)).slice()):await r._proxy.$readdir(n)}catch(s){return Fr._handleError(s)}},async createDirectory(n){try{const s=r._fileSystemProvider.get(n.scheme);return s&&!s.isReadonly?(await r._proxy.$ensureActivation(n.scheme),await r.mkdirp(s.impl,s.extUri,n)):await r._proxy.$mkdir(n)}catch(s){return Fr._handleError(s)}},async readFile(n){try{const s=r._fileSystemProvider.get(n.scheme);return s?(await r._proxy.$ensureActivation(n.scheme),(await s.impl.readFile(n)).slice()):(await r._proxy.$readFile(n)).buffer}catch(s){return Fr._handleError(s)}},async writeFile(n,s){try{const o=r._fileSystemProvider.get(n.scheme);return o&&!o.isReadonly?(await r._proxy.$ensureActivation(n.scheme),await r.mkdirp(o.impl,o.extUri,o.extUri.dirname(n)),await r._writeQueue.queueFor(n,()=>Promise.resolve(o.impl.writeFile(n,s,{create:!0,overwrite:!0})))):await r._proxy.$writeFile(n,ae.wrap(s))}catch(o){return Fr._handleError(o)}},async delete(n,s){try{const o=r._fileSystemProvider.get(n.scheme);return o&&!o.isReadonly&&!s?.useTrash?(await r._proxy.$ensureActivation(n.scheme),await o.impl.delete(n,{recursive:!1,...s})):await r._proxy.$delete(n,{recursive:!1,useTrash:!1,atomic:!1,...s})}catch(o){return Fr._handleError(o)}},async rename(n,s,o){try{return await r._proxy.$rename(n,s,{overwrite:!1,...o})}catch(a){return Fr._handleError(a)}},async copy(n,s,o){try{return await r._proxy.$copy(n,s,{overwrite:!1,...o})}catch(a){return Fr._handleError(a)}},isWritableFileSystem(n){const s=i.getCapabilities(n);if(typeof s=="number")return!(s&2048)}})}async mkdirp(t,i,r){const n=[];for(;!i.isEqual(r,i.dirname(r));)try{if(((await t.stat(r)).type&Cs.Directory)===0)throw At.FileExists(`Unable to create folder '${r.scheme===V.file?r.fsPath:r.toString(!0)}' that already exists but is not a directory`);break}catch(s){if(md(s)!==_e.FileNotFound)throw s;n.push(i.basename(r)),r=i.dirname(r)}for(let s=n.length-1;s>=0;s--){r=i.joinPath(r,n[s]);try{await t.createDirectory(r)}catch(o){if(md(o)!==_e.FileExists)throw o}}}static _handleError(t){if(t instanceof At)throw t;if(t instanceof AS)switch(t.code){case _e.FileExists:throw At.FileExists(t.message);case _e.FileNotFound:throw At.FileNotFound(t.message);case _e.FileNotADirectory:throw At.FileNotADirectory(t.message);case _e.FileIsADirectory:throw At.FileIsADirectory(t.message);case _e.NoPermissions:throw At.NoPermissions(t.message);case _e.Unavailable:throw At.Unavailable(t.message);default:throw new At(t.message,t.name)}if(!(t instanceof Error))throw new At(String(t));if(t.name==="ENOPRO"||t.message.includes("ENOPRO"))throw At.Unavailable(t.message);switch(t.name){case _e.FileExists:throw At.FileExists(t.message);case _e.FileNotFound:throw At.FileNotFound(t.message);case _e.FileNotADirectory:throw At.FileNotADirectory(t.message);case _e.FileIsADirectory:throw At.FileIsADirectory(t.message);case _e.NoPermissions:throw At.NoPermissions(t.message);case _e.Unavailable:throw At.Unavailable(t.message);default:throw new At(t.message,t.name)}}addFileSystemProvider(t,i,r){return this._fileSystemProvider.set(t,{impl:i,extUri:r?.isCaseSensitive?He:mT,isReadonly:!!r?.isReadonly}),ne(()=>this._fileSystemProvider.delete(t))}getFileSystemProviderExtUri(t){return this._fileSystemProvider.get(t)?.extUri??He}};m_=Fr=__decorate([__param(0,Ue),__param(1,Oo)],m_);var zf=U("IExtHostConsumerFileSystem"),v_=U("IExtensionStoragePaths"),__=class{constructor(t,i,r){this._logService=i,this._extHostFileSystem=r,this._workspace=t.workspace??void 0,this._environment=t.environment,this.whenReady=this._getOrCreateWorkspaceStoragePath().then(n=>this._value=n)}async _getWorkspaceStorageURI(t){return y.joinPath(this._environment.workspaceStorageHome,t)}async _getOrCreateWorkspaceStoragePath(){if(!this._workspace)return Promise.resolve(void 0);const t=this._workspace.id,i=await this._getWorkspaceStorageURI(t);try{return await this._extHostFileSystem.value.stat(i),this._logService.trace("[ExtHostStorage] storage dir already exists",i),i}catch{}try{return this._logService.trace("[ExtHostStorage] creating dir and metadata-file",i),await this._extHostFileSystem.value.createDirectory(i),await this._extHostFileSystem.value.writeFile(y.joinPath(i,"meta.json"),new TextEncoder().encode(JSON.stringify({id:this._workspace.id,configuration:y.revive(this._workspace.configuration)?.toString(),name:this._workspace.name},void 0,2))),i}catch(r){this._logService.error("[ExtHostStorage]",r);return}}workspaceValue(t){if(this._value)return y.joinPath(this._value,t.identifier.value)}globalValue(t){return y.joinPath(this._environment.globalStorageHome,t.identifier.value.toLowerCase())}onWillDeactivateAll(){}};__=__decorate([__param(0,Yt),__param(1,qe),__param(2,zf)],__);var Gz=U("tunnelService"),Qz=U("sharedTunnelsService"),LD;(function(e){e.Http="http",e.Https="https"})(LD||(LD={}));var io;(function(e){e.ConstantPrivate="constantPrivate",e.Private="private",e.Public="public"})(io||(io={}));var ND;(function(e){e[e.Notify=1]="Notify",e[e.OpenBrowser=2]="OpenBrowser",e[e.OpenPreview=3]="OpenPreview",e[e.Silent=4]="Silent",e[e.Ignore=5]="Ignore",e[e.OpenBrowserOnce=6]="OpenBrowserOnce"})(ND||(ND={}));function FL(e){if(e.scheme!=="http"&&e.scheme!=="https")return;const t=/^(localhost|127\.0\.0\.1|0\.0\.0\.0):(\d+)$/.exec(e.authority);if(t)return{address:t[1],port:+t[2]}}var w_=["localhost","127.0.0.1","0:0:0:0:0:0:0:1","::1"];function MD(e){return w_.indexOf(e)>=0}var y_=["0.0.0.0","0:0:0:0:0:0:0:0","::"];function OD(e){return y_.indexOf(e)>=0}var $L=class{constructor(e,t,i){this.remoteAddress=e,this.localAddress=t,this._dispose=i,this._onDispose=new P,this.onDidDispose=this._onDispose.event}dispose(){return this._onDispose.fire(),this._dispose()}},FD=class extends se{constructor(t,i){super(),this.logService=t,this.configurationService=i,this._onTunnelOpened=new P,this.onTunnelOpened=this._onTunnelOpened.event,this._onTunnelClosed=new P,this.onTunnelClosed=this._onTunnelClosed.event,this._onAddedTunnelProvider=new P,this.onAddedTunnelProvider=this._onAddedTunnelProvider.event,this._tunnels=new Map,this._canElevate=!1,this._canChangeProtocol=!0,this._privacyOptions=[],this._factoryInProgress=new Set}get hasTunnelProvider(){return!!this._tunnelProvider}get defaultTunnelHost(){const t=this.configurationService.getValue("remote.localPortHost");return!t||t==="localhost"?"127.0.0.1":"0.0.0.0"}setTunnelProvider(t){return this._tunnelProvider=t,t?(this._onAddedTunnelProvider.fire(),{dispose:()=>{this._tunnelProvider=void 0,this._canElevate=!1,this._privacyOptions=[]}}):(this._canElevate=!1,this._privacyOptions=[],this._onAddedTunnelProvider.fire(),{dispose:()=>{}})}setTunnelFeatures(t){this._canElevate=t.elevation,this._privacyOptions=t.privacyOptions,this._canChangeProtocol=t.protocol}get canChangeProtocol(){return this._canChangeProtocol}get canElevate(){return this._canElevate}get canChangePrivacy(){return this._privacyOptions.length>0}get privacyOptions(){return this._privacyOptions}get tunnels(){return this.getTunnels()}async getTunnels(){const t=[],i=Array.from(this._tunnels.values());for(const r of i){const n=Array.from(r.values());for(const s of n){const o=await s.value;o&&typeof o!="string"&&t.push(o)}}return t}async dispose(){super.dispose();for(const t of this._tunnels.values()){for(const{value:i}of t.values())await i.then(r=>typeof r!="string"?r?.dispose():void 0);t.clear()}this._tunnels.clear()}setEnvironmentTunnel(t,i,r,n,s){this.addTunnelToMap(t,i,Promise.resolve({tunnelRemoteHost:t,tunnelRemotePort:i,localAddress:r,privacy:n,protocol:s,dispose:()=>Promise.resolve()}))}async getExistingTunnel(t,i){(OD(t)||MD(t))&&(t=w_[0]);const r=this.getTunnelFromMap(t,i);if(r)return++r.refcount,r.value}openTunnel(t,i,r,n,s,o=!1,a,l){this.logService.trace(`ForwardedPorts: (TunnelService) openTunnel request for ${i}:${r} on local port ${s}.`);const c=this._tunnelProvider??t;if(!c)return;if(i||(i="localhost"),n||(n=this.defaultTunnelHost),this._tunnelProvider&&this._factoryInProgress.has(r)){this.logService.debug("ForwardedPorts: (TunnelService) Another call to create a tunnel with the same address has occurred before the last one completed. This call will be ignored.");return}const u=this.retainOrCreateTunnel(c,i,r,n,s,o,a,l);return u?u.then(d=>{if(d){if(typeof d=="string")return this.logService.trace("ForwardedPorts: (TunnelService) The tunnel provider returned an error when creating the tunnel."),this.removeEmptyOrErrorTunnelFromMap(i,r),d}else{this.logService.trace("ForwardedPorts: (TunnelService) New tunnel is undefined."),this.removeEmptyOrErrorTunnelFromMap(i,r);return}this.logService.trace("ForwardedPorts: (TunnelService) New tunnel established.");const f=this.makeTunnel(d);return(d.tunnelRemoteHost!==i||d.tunnelRemotePort!==r)&&this.logService.warn("ForwardedPorts: (TunnelService) Created tunnel does not match requirements of requested tunnel. Host or port mismatch."),a&&d.privacy!==a&&this.logService.warn("ForwardedPorts: (TunnelService) Created tunnel does not match requirements of requested tunnel. Privacy mismatch."),this._onTunnelOpened.fire(f),f}):(this.logService.trace("ForwardedPorts: (TunnelService) Tunnel was not created."),u)}makeTunnel(t){return{tunnelRemotePort:t.tunnelRemotePort,tunnelRemoteHost:t.tunnelRemoteHost,tunnelLocalPort:t.tunnelLocalPort,localAddress:t.localAddress,privacy:t.privacy,protocol:t.protocol,dispose:async()=>{this.logService.trace(`ForwardedPorts: (TunnelService) dispose request for ${t.tunnelRemoteHost}:${t.tunnelRemotePort} `);const i=this._tunnels.get(t.tunnelRemoteHost);if(i){const r=i.get(t.tunnelRemotePort);r&&(r.refcount--,await this.tryDisposeTunnel(t.tunnelRemoteHost,t.tunnelRemotePort,r))}}}}async tryDisposeTunnel(t,i,r){if(r.refcount<=0){this.logService.trace(`ForwardedPorts: (TunnelService) Tunnel is being disposed ${t}:${i}.`);const n=r.value.then(async s=>{s&&typeof s!="string"&&(await s.dispose(!0),this._onTunnelClosed.fire({host:s.tunnelRemoteHost,port:s.tunnelRemotePort}))});return this._tunnels.has(t)&&this._tunnels.get(t).delete(i),n}}async closeTunnel(t,i){this.logService.trace(`ForwardedPorts: (TunnelService) close request for ${t}:${i} `);const r=this._tunnels.get(t);if(r&&r.has(i)){const n=r.get(i);n.refcount=0,await this.tryDisposeTunnel(t,i,n)}}addTunnelToMap(t,i,r){this._tunnels.has(t)||this._tunnels.set(t,new Map),this._tunnels.get(t).set(i,{refcount:1,value:r})}async removeEmptyOrErrorTunnelFromMap(t,i){const r=this._tunnels.get(t);if(r){const n=r.get(i),s=n?await n.value:void 0;(!s||typeof s=="string")&&r.delete(i),r.size===0&&this._tunnels.delete(t)}}getTunnelFromMap(t,i){const r=[t];MD(t)?(r.push(...w_),r.push(...y_)):OD(t)&&r.push(...y_);const n=r.map(s=>this._tunnels.get(s));for(const s of n){const o=s?.get(i);if(o)return o}}canTunnel(t){return!!FL(t)}createWithProvider(t,i,r,n,s,o,a){this.logService.trace(`ForwardedPorts: (TunnelService) Creating tunnel with provider ${i}:${r} on local port ${n}.`);const l=r;this._factoryInProgress.add(l);const c=n===void 0?r:n,u={elevationRequired:s?this.isPortPrivileged(c):!1},d={remoteAddress:{host:i,port:r},localAddressPort:n,privacy:o,public:o?o!==io.Private:void 0,protocol:a},f=t.forwardPort(d,u);return f?(this.addTunnelToMap(i,r,f),f.finally(()=>{this.logService.trace("ForwardedPorts: (TunnelService) Tunnel created by provider."),this._factoryInProgress.delete(l)})):this._factoryInProgress.delete(l),f}};FD=__decorate([__param(0,qe),__param(1,Cd)],FD);var HL=class extends $L{},b_;(function(e){function t(r){return{remoteAddress:r.remoteAddress,localAddress:r.localAddress,public:!!r.public,privacy:r.privacy??(r.public?io.Public:io.Private),protocol:r.protocol}}e.fromApiTunnel=t;function i(r){return{remoteAddress:{host:r.tunnelRemoteHost,port:r.tunnelRemotePort},localAddress:r.localAddress,public:r.privacy!==io.ConstantPrivate&&r.privacy!==io.ConstantPrivate,privacy:r.privacy,protocol:r.protocol}}e.fromServiceTunnel=i})(b_||(b_={}));var x_=U("IExtHostTunnelService"),S_=class extends se{constructor(t,i,r){super(),this.logService=r,this._showCandidatePort=()=>Promise.resolve(!0),this._extensionTunnels=new Map,this._onDidChangeTunnels=new P,this.onDidChangeTunnels=this._onDidChangeTunnels.event,this._providerHandleCounter=0,this._portAttributesProviders=new Map,this._proxy=t.getProxy(W.MainThreadTunnelService)}async openTunnel(t,i){this.logService.trace(`ForwardedPorts: (ExtHostTunnelService) ${t.identifier.value} called openTunnel API for ${i.remoteAddress.host}:${i.remoteAddress.port}.`);const r=await this._proxy.$openTunnel(i,t.displayName);if(r){const n=new HL(r.remoteAddress,r.localAddress,()=>this._proxy.$closeTunnel(r.remoteAddress));return this._register(n),n}}async getTunnels(){return this._proxy.$getTunnels()}nextPortAttributesProviderHandle(){return this._providerHandleCounter++}registerPortsAttributesProvider(t,i){t.portRange===void 0&&t.commandPattern===void 0&&this.logService.error("PortAttributesProvider must specify either a portRange or a commandPattern");const r=this.nextPortAttributesProviderHandle();return this._portAttributesProviders.set(r,{selector:t,provider:i}),this._proxy.$registerPortsAttributesProvider(t,r),new Ce(()=>{this._portAttributesProviders.delete(r),this._proxy.$unregisterPortsAttributesProvider(r)})}async $providePortAttributes(t,i,r,n,s){const o=[];for(const l of t){const c=this._portAttributesProviders.get(l);if(!c)return[];o.push(...await Promise.all(i.map(async u=>{let d;try{d=await c.provider.providePortAttributes({port:u,pid:r,commandLine:n},s)}catch{d=await c.provider.providePortAttributes(u,r,n,s)}return{providedAttributes:d,port:u}})))}const a=o.filter(l=>!!l.providedAttributes);return a.length>0?a.map(l=>({autoForwardAction:l.providedAttributes.autoForwardAction,port:l.port})):[]}async $registerCandidateFinder(t){}registerTunnelProvider(t,i){if(this._forwardPortProvider)throw new Error("A tunnel provider has already been registered. Only the first tunnel provider to be registered will be used.");this._forwardPortProvider=async(n,s)=>await t.provideTunnel(n,s,Xe.None)??void 0;const r=i.tunnelFeatures?{elevation:!!i.tunnelFeatures?.elevation,privacyOptions:i.tunnelFeatures?.privacyOptions,protocol:i.tunnelFeatures.protocol===void 0?!0:i.tunnelFeatures.protocol}:void 0;return this._proxy.$setTunnelProvider(r,!0),Promise.resolve(ne(()=>{this._forwardPortProvider=void 0,this._proxy.$setTunnelProvider(void 0,!1)}))}async setTunnelFactory(t,i){if(t){t.candidatePortSource!==void 0&&this._proxy.$setCandidatePortSource(t.candidatePortSource),t.showCandidatePort&&(this._showCandidatePort=t.showCandidatePort,this._proxy.$setCandidateFilter());const r=t.tunnelFactory??(i?this.makeManagedTunnelFactory(i):void 0);if(r){this._forwardPortProvider=r;let n=t.tunnelFeatures?.privacyOptions??[];t.tunnelFeatures?.public&&n.length===0&&(n=[{id:"private",label:h(2940,null),themeIcon:"lock"},{id:"public",label:h(2941,null),themeIcon:"eye"}]);const s=t.tunnelFeatures?{elevation:!!t.tunnelFeatures?.elevation,public:!!t.tunnelFeatures?.public,privacyOptions:n,protocol:!0}:void 0;this._proxy.$setTunnelProvider(s,!!t.tunnelFactory)}}else this._forwardPortProvider=void 0;return ne(()=>{this._forwardPortProvider=void 0})}makeManagedTunnelFactory(t){}async $closeTunnel(t,i){if(this._extensionTunnels.has(t.host)){const r=this._extensionTunnels.get(t.host);r.has(t.port)&&(i&&r.get(t.port).disposeListener.dispose(),await r.get(t.port).tunnel.dispose(),r.delete(t.port))}}async $onDidTunnelsChange(){this._onDidChangeTunnels.fire()}async $forwardPort(t,i){if(this._forwardPortProvider)try{this.logService.trace("ForwardedPorts: (ExtHostTunnelService) Getting tunnel from provider.");const r=this._forwardPortProvider(t,i);if(this.logService.trace("ForwardedPorts: (ExtHostTunnelService) Got tunnel promise from provider."),r!==void 0){const n=await r;if(this.logService.trace("ForwardedPorts: (ExtHostTunnelService) Successfully awaited tunnel from provider."),n===void 0){this.logService.error("ForwardedPorts: (ExtHostTunnelService) Resolved tunnel is undefined");return}this._extensionTunnels.has(t.remoteAddress.host)||this._extensionTunnels.set(t.remoteAddress.host,new Map);const s=this._register(n.onDidDispose(()=>(this.logService.trace("ForwardedPorts: (ExtHostTunnelService) Extension fired tunnel's onDidDispose."),this._proxy.$closeTunnel(n.remoteAddress))));return this._extensionTunnels.get(t.remoteAddress.host).set(t.remoteAddress.port,{tunnel:n,disposeListener:s}),b_.fromApiTunnel(n)}else this.logService.trace("ForwardedPorts: (ExtHostTunnelService) Tunnel is undefined")}catch(r){if(this.logService.trace("ForwardedPorts: (ExtHostTunnelService) tunnel provider error"),r instanceof Error)return r.message}}async $applyCandidateFilter(t){const i=await Promise.all(t.map(n=>this._showCandidatePort(n.host,n.port,n.detail??""))),r=t.filter((n,s)=>i[s]);return this.logService.trace(`ForwardedPorts: (ExtHostTunnelService) filtered from ${t.map(n=>n.port).join(", ")} to ${r.map(n=>n.port).join(", ")}`),r}};S_=__decorate([__param(0,Ue),__param(1,Yt),__param(2,qe)],S_);function UL(e){return[...e.entries()]}function BL(e){return e?[...e.entries()]:[]}var WL=class{constructor(e){this._callback=e,this._terminalBufferMap=new Map}dispose(){for(const e of this._terminalBufferMap.values())e.dispose()}startBuffering(e,t,i=5){const r=t(n=>{const s=typeof n=="string"?n:n.data;let o=this._terminalBufferMap.get(e);if(o){o.data.push(s);return}const a=setTimeout(()=>this.flushBuffer(e),i);o={data:[s],timeoutId:a,dispose:()=>{clearTimeout(a),this.flushBuffer(e),r.dispose()}},this._terminalBufferMap.set(e,o)});return r}stopBuffering(e){this._terminalBufferMap.get(e)?.dispose()}flushBuffer(e){const t=this._terminalBufferMap.get(e);t&&(this._terminalBufferMap.delete(e),this._callback(e,t.data.join("")))}},ro=(e,t,i,r)=>{let n=t;return{enumerable:!0,configurable:!1,get(){return n},set(s){if(!i(n,s)){const o=n;n=s,e.listener?.(r(s,o))}}}},Fa=(e,t)=>e===t,Kn={range:(e,t)=>e===t?!0:!e||!t?!1:e.isEqual(t),label:Fa,description:Fa,sortText:Fa,busy:Fa,error:Fa,canResolveChildren:Fa,tags:(e,t)=>!(e.length!==t.length||e.some(i=>!t.find(r=>i.id===r.id)))},$a=e=>t=>({op:4,update:e(t)}),VL=(e,t)=>({range:(()=>{let i;const r=$a(n=>({range:Fe.lift(F.from(n))}));return{enumerable:!0,configurable:!1,get(){return i},set(n){e.listener?.({op:6}),Kn.range(i,n)||(i=n,e.listener?.(r(n)))}}})(),label:ro(e,t,Kn.label,$a(i=>({label:i}))),description:ro(e,void 0,Kn.description,$a(i=>({description:i}))),sortText:ro(e,void 0,Kn.sortText,$a(i=>({sortText:i}))),canResolveChildren:ro(e,!1,Kn.canResolveChildren,i=>({op:2,state:i})),busy:ro(e,!1,Kn.busy,$a(i=>({busy:i}))),error:ro(e,void 0,Kn.error,$a(i=>({error:pe.fromStrict(i)||null}))),tags:ro(e,[],Kn.tags,(i,r)=>({op:1,new:i.map(pr.from),old:r.map(pr.from)}))}),zL=e=>{const t=Re.fromString(e.extId),i=new Wc(t.controllerId,t.localId,e.label,y.revive(e.uri)||void 0);return i.range=F.to(e.range||void 0),i.description=e.description||void 0,i.sortText=e.sortText||void 0,i.tags=e.tags.map(r=>pr.to({id:TC(r).tagId})),i},$D=e=>{let t;for(const i of e.tests){const r=zL(i.item);Kd(r).parent=t,t=r}return t},Wc=class r7{constructor(t,i,r,n){if(i.includes("\0"))throw new Error(`Test IDs may not include the ${JSON.stringify(i)} symbol`);const s=c2(this,t);Object.defineProperties(this,{id:{value:i,enumerable:!0,writable:!1},uri:{value:n,enumerable:!0,writable:!1},parent:{enumerable:!1,get(){return s.parent instanceof E_?void 0:s.parent}},children:{value:l2(s,Kd,r7),enumerable:!0,writable:!1},...VL(s,r)})}},E_=class extends Wc{constructor(e,t){super(e,e,t,void 0),this._isRoot=!0}},qL=class extends s2{constructor(e,t,i){super({controllerId:e,getDocumentVersion:r=>r&&i.getDocument(r)?.version,getApiFor:Kd,getChildren:r=>r.children,root:new E_(e,t),toITestItem:Jn.from})}},C_=class extends se{constructor(t,i,r){super(),this.initData=i,this._onDidChangeTelemetryEnabled=this._register(new P),this.onDidChangeTelemetryEnabled=this._onDidChangeTelemetryEnabled.event,this._onDidChangeTelemetryConfiguration=this._register(new P),this.onDidChangeTelemetryConfiguration=this._onDidChangeTelemetryConfiguration.event,this._productConfig={usage:!0,error:!0},this._level=0,this._inLoggingOnlyMode=!1,this._telemetryLoggers=new Map,this._inLoggingOnlyMode=this.initData.environment.isExtensionTelemetryLoggingOnly;const n=i.remote.isRemote?"remoteExtHostTelemetry":t?"workerExtHostTelemetry":"extHostTelemetry";this._outputLogger=this._register(r.createLogger(n,{name:h(2937,null,this._inLoggingOnlyMode?" (Not Sent)":""),hidden:!0,group:GR}))}getTelemetryConfiguration(){return this._level===3}getTelemetryDetails(){return{isCrashEnabled:this._level>=1,isErrorsEnabled:this._productConfig.error?this._level>=2:!1,isUsageEnabled:this._productConfig.usage?this._level>=3:!1}}instantiateLogger(t,i,r){const n=this.getTelemetryDetails(),s=new HD(i,r,t,this._outputLogger,this._inLoggingOnlyMode,this.getBuiltInCommonProperties(t),{isUsageEnabled:n.isUsageEnabled,isErrorsEnabled:n.isErrorsEnabled}),o=this._telemetryLoggers.get(t.identifier.value)??[];return this._telemetryLoggers.set(t.identifier.value,[...o,s]),s.apiTelemetryLogger}$initializeTelemetryLevel(t,i,r){this._level=t,this._productConfig=r??{usage:!0,error:!0}}getBuiltInCommonProperties(t){const i=Object.create(null);switch(i["common.extname"]=`${t.publisher}.${t.name}`,i["common.extversion"]=t.version,i["common.vscodemachineid"]=this.initData.telemetryInfo.machineId,i["common.vscodesessionid"]=this.initData.telemetryInfo.sessionId,i["common.vscodecommithash"]=this.initData.commit,i["common.sqmid"]=this.initData.telemetryInfo.sqmId,i["common.devDeviceId"]=this.initData.telemetryInfo.devDeviceId,i["common.vscodeversion"]=this.initData.version,i["common.isnewappinstall"]=UD(this.initData.telemetryInfo.firstSessionDate),i["common.product"]=this.initData.environment.appHost,this.initData.uiKind){case sl.Web:i["common.uikind"]="web";break;case sl.Desktop:i["common.uikind"]="desktop";break;default:i["common.uikind"]="unknown"}return i["common.remotename"]=Fg(JR(this.initData.remote.authority)),i}$onDidChangeTelemetryLevel(t){this._oldTelemetryEnablement=this.getTelemetryConfiguration(),this._level=t;const i=this.getTelemetryDetails();this._telemetryLoggers.forEach((r,n)=>{const s=r.filter(o=>!o.isDisposed);s.length===0?this._telemetryLoggers.delete(n):this._telemetryLoggers.set(n,s)}),this._telemetryLoggers.forEach(r=>{for(const n of r)n.updateTelemetryEnablements(i.isUsageEnabled,i.isErrorsEnabled)}),this._oldTelemetryEnablement!==this.getTelemetryConfiguration()&&this._onDidChangeTelemetryEnabled.fire(this.getTelemetryConfiguration()),this._onDidChangeTelemetryConfiguration.fire(this.getTelemetryDetails())}onExtensionError(t,i){const n=this._telemetryLoggers.get(t.value)?.filter(o=>!o.isDisposed);if(!n)return this._telemetryLoggers.delete(t.value),!1;let s=!1;for(const o of n)o.ignoreUnhandledExtHostErrors||(o.logError(i),s=!0);return s}};C_=__decorate([__param(1,Yt),__param(2,xl)],C_);var HD=class{static validateSender(e){if(typeof e!="object")throw new TypeError("TelemetrySender argument is invalid");if(typeof e.sendEventData!="function")throw new TypeError("TelemetrySender.sendEventData must be a function");if(typeof e.sendErrorData!="function")throw new TypeError("TelemetrySender.sendErrorData must be a function");if(typeof e.flush<"u"&&typeof e.flush!="function")throw new TypeError("TelemetrySender.flush must be a function or undefined")}constructor(e,t,i,r,n,s,o){this._extension=i,this._logger=r,this._inLoggingOnlyMode=n,this._commonProperties=s,this._onDidChangeEnableStates=new P,this.ignoreUnhandledExtHostErrors=t?.ignoreUnhandledErrors??!1,this._ignoreBuiltinCommonProperties=t?.ignoreBuiltInCommonProperties??!1,this._additionalCommonProperties=t?.additionalCommonProperties,this._sender=e,this._telemetryEnablements={isUsageEnabled:o.isUsageEnabled,isErrorsEnabled:o.isErrorsEnabled}}updateTelemetryEnablements(e,t){this._apiObject&&(this._telemetryEnablements={isUsageEnabled:e,isErrorsEnabled:t},this._onDidChangeEnableStates.fire(this._apiObject))}mixInCommonPropsAndCleanData(e){let t="properties"in e?e.properties??{}:e;return t=t4(t,[]),this._additionalCommonProperties&&(t=ys(t,this._additionalCommonProperties)),this._ignoreBuiltinCommonProperties||(t=ys(t,this._commonProperties)),"properties"in e?e.properties=t:e=t,e}logEvent(e,t){this._sender&&(this._extension.publisher==="vscode"?e=this._extension.name+"/"+e:e=this._extension.identifier.value+"/"+e,t=this.mixInCommonPropsAndCleanData(t||{}),this._inLoggingOnlyMode||this._sender?.sendEventData(e,t),this._logger.trace(e,t))}logUsage(e,t){this._telemetryEnablements.isUsageEnabled&&this.logEvent(e,t)}logError(e,t){if(!(!this._telemetryEnablements.isErrorsEnabled||!this._sender))if(typeof e=="string")this.logEvent(e,t);else{const i={name:e.name,message:e.message,stack:e.stack,cause:e.cause},r=t4(i,[]),n=new Error(r.message,{cause:r.cause});n.stack=r.stack,n.name=r.name,t=this.mixInCommonPropsAndCleanData(t||{}),this._inLoggingOnlyMode||this._sender.sendErrorData(n,t),this._logger.trace("exception",t)}}get apiTelemetryLogger(){if(!this._apiObject){const e=this,t={logUsage:e.logUsage.bind(e),get isUsageEnabled(){return e._telemetryEnablements.isUsageEnabled},get isErrorsEnabled(){return e._telemetryEnablements.isErrorsEnabled},logError:e.logError.bind(e),dispose:e.dispose.bind(e),onDidChangeEnableStates:e._onDidChangeEnableStates.event.bind(e)};this._apiObject=Object.freeze(t)}return this._apiObject}get isDisposed(){return!this._sender}dispose(){if(this._sender?.flush){let e=this._sender;this._sender=void 0,Promise.resolve(e.flush()).then(e=void 0),this._apiObject=void 0}else this._sender=void 0}};function UD(e){const t=Date.now()-new Date(e).getTime();return isNaN(t)?!1:t<1e3*60*60*24}var qf=U("IExtHostTelemetry"),D_=class{#e;#t;#i;constructor(t,i,r){this._commands=new Map,this._apiCommands=new Map,this.#e=t.getProxy(W.MainThreadCommands),this._logService=i,this.#i=r,this.#t=t.getProxy(W.MainThreadTelemetry),this.converter=new jL(this,n=>{const s=this._apiCommands.get(n);return s?.result===de.Void?s:void 0},i),this._argumentProcessors=[{processArgument(n){return Pt(n)}},{processArgument(n){return Mo(n,function(s){if(Fe.isIRange(s))return F.to(s);if(Bi.isIPosition(s))return Be.to(s);if(Fe.isIRange(s.range)&&y.isUri(s.uri))return vi.to(s);if(s instanceof ae)return s.buffer.buffer;if(!Array.isArray(s))return s})}}]}registerArgumentProcessor(t){this._argumentProcessors.push(t)}registerApiCommand(t){const i=this.registerCommand(!1,t.id,async(...r)=>{const n=t.args.map((o,a)=>{if(!o.validate(r[a]))throw new Error(`Invalid argument '${o.name}' when running '${t.id}', received: ${typeof r[a]=="object"?JSON.stringify(r[a],null,"	"):r[a]} `);return o.convert(r[a])}),s=await this.executeCommand(t.internalId,...n);return t.result.convert(s,r,this.converter)},void 0,{description:t.description,args:t.args,returns:t.result.description});return this._apiCommands.set(t.id,t),new Ce(()=>{i.dispose(),this._apiCommands.delete(t.id)})}registerCommand(t,i,r,n,s,o){if(this._logService.trace("ExtHostCommands#registerCommand",i),!i.trim().length)throw new Error("invalid id");if(this._commands.has(i))throw new Error(`command '${i}' already exists`);return this._commands.set(i,{callback:r,thisArg:n,metadata:s,extension:o}),t&&this.#e.$registerCommand(i),new Ce(()=>{this._commands.delete(i)&&t&&this.#e.$unregisterCommand(i)})}executeCommand(t,...i){return this._logService.trace("ExtHostCommands#executeCommand",t),this._doExecuteCommand(t,i,!0)}async _doExecuteCommand(t,i,r){if(this._commands.has(t))return this.#e.$fireCommandActivationEvent(t),this._executeContributedCommand(t,i,!1);{let n=!1;const s=Mo(i,function(o){if(o instanceof Ie)return Be.from(o);if(o instanceof ye)return F.from(o);if(o instanceof Wi)return vi.from(o);if(ln.isNotebookRange(o))return Or.from(o);if(o instanceof ArrayBuffer)return n=!0,ae.wrap(new Uint8Array(o));if(o instanceof Uint8Array)return n=!0,ae.wrap(o);if(o instanceof ae)return n=!0,o;if(!Array.isArray(o))return o});try{const o=await this.#e.$executeCommand(t,n?new ai(s):s,r);return Pt(o)}catch(o){if(o instanceof Error&&o.message==="$executeCommand:retry")return this._doExecuteCommand(t,i,!1);throw o}}}async _executeContributedCommand(t,i,r){const n=this._commands.get(t);if(!n)throw new Error("Unknown command");const{callback:s,thisArg:o,metadata:a}=n;if(a?.args)for(let c=0;c<a.args.length;c++)try{dy(i[c],a.args[c].constraint)}catch{throw new Error(`Running the contributed command: '${t}' failed. Illegal argument '${a.args[c].name}' - ${a.args[c].description}`)}const l=us.create();try{return await s.apply(o,i)}catch(c){if(t===this.converter.delegatingCommandId){const u=this.converter.getActualCommand(...i);u&&(t=u.command)}if(br(c)||this._logService.error(c,t,n.extension?.identifier),!r)throw c;if(n.extension?.identifier){const u=this.#i.onExtensionError(n.extension.identifier,c);this._logService.trace("forwarded error to extension?",u,n.extension?.identifier)}throw new class extends Error{constructor(){super(Lo(c)),this.id=t,this.source=n.extension?.displayName??n.extension?.name}}}finally{this._reportTelemetry(n,t,l.elapsed())}}_reportTelemetry(t,i,r){t.extension&&this.#t.$publicLog2("Extension:ActionExecuted",{extensionId:t.extension.identifier.value,id:new Km(i),duration:r})}$executeContributedCommand(t,...i){this._logService.trace("ExtHostCommands#$executeContributedCommand",t);const r=this._commands.get(t);return r?(i=i.map(n=>this._argumentProcessors.reduce((s,o)=>o.processArgument(s,r.extension),n)),this._executeContributedCommand(t,i,!0)):Promise.reject(new Error(`Contributed command '${t}' does not exist.`))}getCommands(t=!1){return this._logService.trace("ExtHostCommands#getCommands",t),this.#e.$getCommands().then(i=>(t&&(i=i.filter(r=>r[0]!=="_")),i))}$getContributedCommandMetadata(){const t=Object.create(null);for(const[i,r]of this._commands){const{metadata:n}=r;n&&(t[i]=n)}return Promise.resolve(t)}};D_=__decorate([__param(0,Ue),__param(1,qe),__param(2,qf)],D_);var no=U("IExtHostCommands"),jL=class{constructor(e,t,i){this._commands=e,this._lookupApiCommand=t,this._logService=i,this.delegatingCommandId=`__vsc${$t()}`,this._cache=new Map,this._cachIdPool=0,this._commands.registerCommand(!0,this.delegatingCommandId,this._executeConvertedCommand,this)}toInternal(e,t){if(!e)return;const i={$ident:void 0,id:e.command,title:e.title,tooltip:e.tooltip};if(!e.command)return i;const r=this._lookupApiCommand(e.command);if(r)i.id=r.internalId,i.arguments=r.args.map((n,s)=>n.convert(e.arguments&&e.arguments[s]));else if(yo(e.arguments)){const n=`${e.command} /${++this._cachIdPool}`;this._cache.set(n,e),t.add(ne(()=>{this._cache.delete(n),this._logService.trace("CommandsConverter#DISPOSE",n)})),i.$ident=n,i.id=this.delegatingCommandId,i.arguments=[n],this._logService.trace("CommandsConverter#CREATE",e.command,n)}return i}fromInternal(e){return typeof e.$ident=="string"?this._cache.get(e.$ident):{command:e.id,title:e.title,arguments:e.arguments}}getActualCommand(...e){return this._cache.get(e[0])}_executeConvertedCommand(...e){const t=this.getActualCommand(...e);return this._logService.trace("CommandsConverter#EXECUTE",e[0],t?t.command:"MISSING"),t?this._commands.executeCommand(t.command,...t.arguments||[]):Promise.reject(`Actual command not found, wanted to execute ${e[0]}`)}},$=class Mi{static{this.Uri=new Mi("uri","Uri of a text document",t=>y.isUri(t),t=>t)}static{this.Position=new Mi("position","A position in a text document",t=>Ie.isPosition(t),Be.from)}static{this.Range=new Mi("range","A range in a text document",t=>ye.isRange(t),F.from)}static{this.Selection=new Mi("selection","A selection in a text document",t=>on.isSelection(t),fr.from)}static{this.Number=new Mi("number","",t=>typeof t=="number",t=>t)}static{this.String=new Mi("string","",t=>typeof t=="string",t=>t)}static Arr(t){return new Mi(`${t.name}_array`,`Array of ${t.name}, ${t.description}`,i=>Array.isArray(i)&&i.every(r=>t.validate(r)),i=>i.map(r=>t.convert(r)))}static{this.CallHierarchyItem=new Mi("item","A call hierarchy item",t=>t instanceof cv,Xs.from)}static{this.TypeHierarchyItem=new Mi("item","A type hierarchy item",t=>t instanceof zv,Ks.from)}static{this.TestItem=new Mi("testItem","A CodeBuddy TestItem",t=>t instanceof Wc,Jn.from)}static{this.TestProfile=new Mi("testProfile","A CodeBuddy test profile",t=>t instanceof E4,N1.from)}constructor(t,i,r,n){this.name=t,this.description=i,this.validate=r,this.convert=n}optional(){return new Mi(this.name,`(optional) ${this.description}`,t=>t==null||this.validate(t),t=>t===void 0?void 0:t===null?null:this.convert(t))}with(t,i){return new Mi(t??this.name,i??this.description,this.validate,this.convert)}},de=class n7{static{this.Void=new n7("no result",t=>t)}constructor(t,i){this.description=t,this.convert=i}},fe=class{constructor(e,t,i,r,n){this.id=e,this.internalId=t,this.description=i,this.args=r,this.result=n}},Ha=U("IExtHostTerminalService"),BD=class extends se{constructor(e,t,i,r){super(),this._proxy=e,this._id=t,this._creationOptions=i,this._name=r,this._disposed=!1,this._state={isInteractedWith:!1,shell:void 0},this.isOpen=!1,this._onWillDispose=this._register(new P),this.onWillDispose=this._onWillDispose.event,this._creationOptions=Object.freeze(this._creationOptions),this._pidPromise=new Promise(s=>this._pidPromiseComplete=s);const n=this;this.value={get name(){return n._name||""},get processId(){return n._pidPromise},get creationOptions(){return n._creationOptions},get exitStatus(){return n._exitStatus},get state(){return n._state},get selection(){return n._selection},get shellIntegration(){return n.shellIntegration},sendText(s,o=!0){n._checkDisposed(),n._proxy.$sendText(n._id,s,o)},show(s){n._checkDisposed(),n._proxy.$show(n._id,s)},hide(){n._checkDisposed(),n._proxy.$hide(n._id)},dispose(){n._disposed||(n._disposed=!0,n._proxy.$dispose(n._id))},get dimensions(){if(!(n._cols===void 0||n._rows===void 0))return{columns:n._cols,rows:n._rows}}}}dispose(){this._onWillDispose.fire(),super.dispose()}async create(e,t){if(typeof this._id!="string")throw new Error("Terminal has already been created");await this._proxy.$createTerminal(this._id,{name:e.name,shellPath:e.shellPath??void 0,shellArgs:e.shellArgs??void 0,cwd:e.cwd??t?.cwd??void 0,env:e.env??void 0,icon:VD(e.iconPath)??void 0,color:Fo.isThemeColor(e.color)?e.color.id:void 0,initialText:e.message??void 0,strictEnv:e.strictEnv??void 0,hideFromUser:e.hideFromUser??void 0,forceShellIntegration:t?.forceShellIntegration??void 0,isFeatureTerminal:t?.isFeatureTerminal??void 0,isExtensionOwnedTerminal:!0,useShellEnvironment:t?.useShellEnvironment??void 0,location:t?.location||this._serializeParentTerminal(e.location,t?.resolvedExtHostIdentifier),isTransient:e.isTransient??void 0})}async createExtensionTerminal(e,t,i,r,n){if(typeof this._id!="string")throw new Error("Terminal has already been created");if(await this._proxy.$createTerminal(this._id,{name:this._name,isExtensionCustomPtyTerminal:!0,icon:r,color:Fo.isThemeColor(n)?n.id:void 0,location:t?.location||this._serializeParentTerminal(e,i),isTransient:!0}),typeof this._id=="string")throw new Error("Terminal creation failed");return this._id}_serializeParentTerminal(e,t){return typeof e=="object"?"parentTerminal"in e&&e.parentTerminal&&t?{parentTerminal:t}:"viewColumn"in e?{viewColumn:Rt.from(e.viewColumn),preserveFocus:e.preserveFocus}:void 0:e}_checkDisposed(){if(this._disposed)throw new Error("Terminal has already been disposed")}set name(e){this._name=e}setExitStatus(e,t){this._exitStatus=Object.freeze({code:e,reason:t})}setDimensions(e,t){return e===this._cols&&t===this._rows||e===0||t===0?!1:(this._cols=e,this._rows=t,!0)}setInteractedWith(){return this._state.isInteractedWith?!1:(this._state={...this._state,isInteractedWith:!0},!0)}setShellType(e){return this._state.shell!==e?(this._state={...this._state,shell:e},!0):!1}setSelection(e){this._selection=e}_setProcessId(e){this._pidPromiseComplete?(this._pidPromiseComplete(e),this._pidPromiseComplete=void 0):this._pidPromise.then(t=>{t!==e&&(this._pidPromise=Promise.resolve(e))})}},I_=class{get onProcessReady(){return this._onProcessReady.event}constructor(e){this._pty=e,this.id=0,this.shouldPersist=!1,this._onProcessData=new P,this.onProcessData=this._onProcessData.event,this._onProcessReady=new P,this._onDidChangeProperty=new P,this.onDidChangeProperty=this._onDidChangeProperty.event,this._onProcessExit=new P,this.onProcessExit=this._onProcessExit.event}refreshProperty(e){throw new Error(`refreshProperty is not suppported in extension owned terminals. property: ${e}`)}updateProperty(e,t){throw new Error(`updateProperty is not suppported in extension owned terminals. property: ${e}, value: ${t}`)}async start(){}shutdown(){this._pty.close()}input(e){this._pty.handleInput?.(e)}resize(e,t){this._pty.setDimensions?.({columns:e,rows:t})}clearBuffer(){}async processBinary(e){}acknowledgeDataEvent(e){}async setUnicodeVersion(e){}getInitialCwd(){return Promise.resolve("")}getCwd(){return Promise.resolve("")}startSendingEvents(e){this._pty.onDidWrite(t=>this._onProcessData.fire(t)),this._pty.onDidClose?.((t=void 0)=>{this._onProcessExit.fire(t===void 0?void 0:t)}),this._pty.onDidOverrideDimensions?.(t=>{t&&this._onDidChangeProperty.fire({type:"overrideDimensions",value:{cols:t.columns,rows:t.rows}})}),this._pty.onDidChangeName?.(t=>{this._onDidChangeProperty.fire({type:"title",value:t})}),this._pty.open(e||void 0),e&&this._pty.setDimensions?.(e),this._onProcessReady.fire({pid:-1,cwd:"",windowsPty:void 0})}},GL=1,k_=class extends se{get activeTerminal(){return this._activeTerminal?.value}get terminals(){return this._terminals.map(t=>t.value)}constructor(t,i,r){super(),this._extHostCommands=i,this._terminals=[],this._terminalProcesses=new Map,this._terminalProcessDisposables={},this._extensionTerminalAwaitingStart={},this._getTerminalPromises={},this._environmentVariableCollections=new Map,this._lastQuickFixCommands=this._register(new Cn),this._linkProviders=new Set,this._completionProviders=new Map,this._profileProviders=new Map,this._quickFixProviders=new Map,this._terminalLinkCache=new Map,this._terminalLinkCancellationSource=new Map,this._onDidCloseTerminal=new P,this.onDidCloseTerminal=this._onDidCloseTerminal.event,this._onDidOpenTerminal=new P,this.onDidOpenTerminal=this._onDidOpenTerminal.event,this._onDidChangeActiveTerminal=new P,this.onDidChangeActiveTerminal=this._onDidChangeActiveTerminal.event,this._onDidChangeTerminalDimensions=new P,this.onDidChangeTerminalDimensions=this._onDidChangeTerminalDimensions.event,this._onDidChangeTerminalState=new P,this.onDidChangeTerminalState=this._onDidChangeTerminalState.event,this._onDidChangeShell=new P,this.onDidChangeShell=this._onDidChangeShell.event,this._onDidWriteTerminalData=new P({onWillAddFirstListener:()=>this._proxy.$startSendingDataEvents(),onDidRemoveLastListener:()=>this._proxy.$stopSendingDataEvents()}),this.onDidWriteTerminalData=this._onDidWriteTerminalData.event,this._onDidExecuteCommand=new P({onWillAddFirstListener:()=>this._proxy.$startSendingCommandEvents(),onDidRemoveLastListener:()=>this._proxy.$stopSendingCommandEvents()}),this.onDidExecuteTerminalCommand=this._onDidExecuteCommand.event,this._proxy=r.getProxy(W.MainThreadTerminalService),this._bufferer=new WL(this._proxy.$sendProcessData),this._proxy.$registerProcessSupport(t),this._extHostCommands.registerArgumentProcessor({processArgument:n=>{const s=o=>{const a=o;return this.getTerminalById(a.instanceId)?.value};switch(n?.$mid){case 15:return s(n);default:{if(Array.isArray(n))for(let o=0;o<n.length&&n[o].$mid===15;o++)n[o]=s(n[o]);return n}}}}),this._register({dispose:()=>{for(const[n,s]of this._terminalProcesses)s.shutdown(!0)}})}getDefaultShell(t){return(t?this._defaultAutomationProfile:this._defaultProfile)?.path||""}getDefaultShellArgs(t){return(t?this._defaultAutomationProfile:this._defaultProfile)?.args||[]}createExtensionTerminal(t,i){const r=new BD(this._proxy,$t(),t,t.name),n=new I_(t.pty);return r.createExtensionTerminal(t.location,i,this._serializeParentTerminal(t,i).resolvedExtHostIdentifier,VD(t.iconPath),JL(t.color)).then(s=>{const o=this._setupExtHostProcessListeners(s,n);this._terminalProcessDisposables[s]=o}),this._terminals.push(r),r.value}_serializeParentTerminal(t,i){if(i=i||{},t.location&&typeof t.location=="object"&&"parentTerminal"in t.location){const r=t.location.parentTerminal;if(r){const n=this._terminals.find(s=>s.value===r);n&&(i.resolvedExtHostIdentifier=n._id)}}else t.location&&typeof t.location!="object"?i.location=t.location:i.location&&typeof i.location=="object"&&"splitActiveTerminal"in i.location&&(i.location={splitActiveTerminal:!0});return i}attachPtyToTerminal(t,i){if(!this.getTerminalById(t))throw new Error(`Cannot resolve terminal with id ${t} for virtual process`);const n=new I_(i),s=this._setupExtHostProcessListeners(t,n);this._terminalProcessDisposables[t]=s}async $acceptActiveTerminalChanged(t){const i=this._activeTerminal;if(t===null){this._activeTerminal=void 0,i!==this._activeTerminal&&this._onDidChangeActiveTerminal.fire(this._activeTerminal);return}const r=this.getTerminalById(t);r&&(this._activeTerminal=r,i!==this._activeTerminal&&this._onDidChangeActiveTerminal.fire(this._activeTerminal.value))}async $acceptTerminalProcessData(t,i){const r=this.getTerminalById(t);r&&this._onDidWriteTerminalData.fire({terminal:r.value,data:i})}async $acceptTerminalDimensions(t,i,r){const n=this.getTerminalById(t);n&&n.setDimensions(i,r)&&this._onDidChangeTerminalDimensions.fire({terminal:n.value,dimensions:n.value.dimensions})}async $acceptDidExecuteCommand(t,i){const r=this.getTerminalById(t);r&&this._onDidExecuteCommand.fire({terminal:r.value,...i})}async $acceptTerminalMaximumDimensions(t,i,r){this._terminalProcesses.get(t)?.resize(i,r)}async $acceptTerminalTitleChange(t,i){const r=this.getTerminalById(t);r&&(r.name=i)}async $acceptTerminalClosed(t,i,r){const n=this._getTerminalObjectIndexById(this._terminals,t);if(n!==null){const s=this._terminals.splice(n,1)[0];s.setExitStatus(i,r),this._onDidCloseTerminal.fire(s.value)}}$acceptTerminalOpened(t,i,r,n){if(i){const a=this._getTerminalObjectIndexById(this._terminals,i);if(a!==null){this._terminals[a]._id=t,this._onDidOpenTerminal.fire(this.terminals[a]),this._terminals[a].isOpen=!0;return}}const s={name:n.name,shellPath:n.executable,shellArgs:n.args,cwd:typeof n.cwd=="string"?n.cwd:y.revive(n.cwd),env:n.env,hideFromUser:n.hideFromUser},o=new BD(this._proxy,t,s,r);this._terminals.push(o),this._onDidOpenTerminal.fire(o.value),o.isOpen=!0}async $acceptTerminalProcessId(t,i){this.getTerminalById(t)?._setProcessId(i)}async $startExtensionTerminal(t,i){const r=this.getTerminalById(t);if(!r)return{message:h(2938,null,t)};r.isOpen||await new Promise(s=>{const o=this.onDidOpenTerminal(async a=>{a===r.value&&(o.dispose(),s())})});const n=this._terminalProcesses.get(t);n?n.startSendingEvents(i):this._extensionTerminalAwaitingStart[t]={initialDimensions:i}}_setupExtHostProcessListeners(t,i){const r=new he;r.add(i.onProcessReady(s=>this._proxy.$sendProcessReady(t,s.pid,s.cwd,s.windowsPty))),r.add(i.onDidChangeProperty(s=>this._proxy.$sendProcessProperty(t,s))),this._bufferer.startBuffering(t,i.onProcessData),r.add(i.onProcessExit(s=>this._onProcessExit(t,s))),this._terminalProcesses.set(t,i);const n=this._extensionTerminalAwaitingStart[t];return n&&i instanceof I_&&(i.startSendingEvents(n.initialDimensions),delete this._extensionTerminalAwaitingStart[t]),r}$acceptProcessAckDataEvent(t,i){this._terminalProcesses.get(t)?.acknowledgeDataEvent(i)}$acceptProcessInput(t,i){this._terminalProcesses.get(t)?.input(i)}$acceptTerminalInteraction(t){const i=this.getTerminalById(t);i?.setInteractedWith()&&this._onDidChangeTerminalState.fire(i.value)}$acceptTerminalSelection(t,i){this.getTerminalById(t)?.setSelection(i)}$acceptProcessResize(t,i,r){try{this._terminalProcesses.get(t)?.resize(i,r)}catch(n){if(n.code!=="EPIPE"&&n.code!=="ERR_IPC_CHANNEL_CLOSED")throw n}}$acceptProcessShutdown(t,i){this._terminalProcesses.get(t)?.shutdown(i)}$acceptProcessRequestInitialCwd(t){this._terminalProcesses.get(t)?.getInitialCwd().then(i=>this._proxy.$sendProcessProperty(t,{type:"initialCwd",value:i}))}$acceptProcessRequestCwd(t){this._terminalProcesses.get(t)?.getCwd().then(i=>this._proxy.$sendProcessProperty(t,{type:"cwd",value:i}))}$acceptProcessRequestLatency(t){return Promise.resolve(t)}registerProfileProvider(t,i,r){if(this._profileProviders.has(i))throw new Error(`Terminal profile provider "${i}" already registered`);return this._profileProviders.set(i,r),this._proxy.$registerProfileProvider(i,t.identifier.value),new Ce(()=>{this._profileProviders.delete(i),this._proxy.$unregisterProfileProvider(i)})}registerTerminalCompletionProvider(t,i,...r){if(this._completionProviders.has(i.id))throw new Error(`Terminal completion provider "${i.id}" already registered`);return this._completionProviders.set(i.id,i),this._proxy.$registerCompletionProvider(i.id,t.identifier.value,...r),new Ce(()=>{this._completionProviders.delete(i.id),this._proxy.$unregisterCompletionProvider(i.id)})}async $provideTerminalCompletions(t,i){const r=new ft().token;if(r.isCancellationRequested||!this.activeTerminal)return;const n=this._completionProviders.get(t);if(!n)return;const s=await n.provideTerminalCompletions(this.activeTerminal,i,r);if(s!=null)return V1.from(s)}$acceptTerminalShellType(t,i){const r=this.getTerminalById(t);r?.setShellType(i)&&this._onDidChangeTerminalState.fire(r.value)}registerTerminalQuickFixProvider(t,i,r){if(this._quickFixProviders.has(t))throw new Error(`Terminal quick fix provider "${t}" is already registered`);return this._quickFixProviders.set(t,r),this._proxy.$registerQuickFixProvider(t,i),new Ce(()=>{this._quickFixProviders.delete(t),this._proxy.$unregisterQuickFixProvider(t)})}async $provideTerminalQuickFixes(t,i){const r=new ft().token;if(r.isCancellationRequested)return;const n=this._quickFixProviders.get(t);if(!n)return;const s=await n.provideTerminalQuickFixes(i,r);if(s===null||Array.isArray(s)&&s.length===0)return;const o=new he;if(this._lastQuickFixCommands.value=o,!Array.isArray(s))return s?Tf.from(s,this._extHostCommands.converter,o):void 0;const a=[];for(const l of s){const c=Tf.from(l,this._extHostCommands.converter,o);c&&a.push(c)}return a}async $createContributedProfileTerminal(t,i){const r=new ft().token;let n=await this._profileProviders.get(t)?.provideTerminalProfile(r);if(!r.isCancellationRequested){if(n&&!("options"in n)&&(n={options:n}),!n||!("options"in n))throw new Error(`No terminal profile options provided for id "${t}"`);if("pty"in n.options){this.createExtensionTerminal(n.options,i);return}this.createTerminalFromOptions(n.options,i)}}registerLinkProvider(t){return this._linkProviders.add(t),this._linkProviders.size===1&&this._proxy.$startLinkProvider(),new Ce(()=>{this._linkProviders.delete(t),this._linkProviders.size===0&&this._proxy.$stopLinkProvider()})}async $provideLinks(t,i){const r=this.getTerminalById(t);if(!r)return[];this._terminalLinkCache.delete(t),this._terminalLinkCancellationSource.get(t)?.dispose(!0);const s=new ft;this._terminalLinkCancellationSource.set(t,s);const o=[],a={terminal:r.value,line:i},l=[];for(const d of this._linkProviders)l.push(Ro.withAsyncBody(async f=>{s.token.onCancellationRequested(()=>f({provider:d,links:[]}));const p=await d.provideTerminalLinks(a,s.token)||[];s.token.isCancellationRequested||f({provider:d,links:p})}));const c=await Promise.all(l);if(s.token.isCancellationRequested)return[];const u=new Map;for(const d of c)d&&d.links.length>0&&o.push(...d.links.map(f=>{const p={id:GL++,startIndex:f.startIndex,length:f.length,label:f.tooltip};return u.set(p.id,{provider:d.provider,link:f}),p}));return this._terminalLinkCache.set(t,u),o}$activateLink(t,i){const r=this._terminalLinkCache.get(t)?.get(i);r&&r.provider.handleTerminalLink(r.link)}_onProcessExit(t,i){this._bufferer.stopBuffering(t),this._terminalProcesses.delete(t),delete this._extensionTerminalAwaitingStart[t];const r=this._terminalProcessDisposables[t];r&&(r.dispose(),delete this._terminalProcessDisposables[t]),this._proxy.$sendProcessExit(t,i)}getTerminalById(t){return this._getTerminalObjectById(this._terminals,t)}getTerminalIdByApiObject(t){const i=this._terminals.findIndex(r=>r.value===t);return i>=0?i:null}_getTerminalObjectById(t,i){const r=this._getTerminalObjectIndexById(t,i);return r!==null?t[r]:null}_getTerminalObjectIndexById(t,i){const r=t.findIndex(n=>n._id===i);return r>=0?r:null}getEnvironmentVariableCollection(t){let i=this._environmentVariableCollections.get(t.identifier.value);return i||(i=this._register(new WD),this._setEnvironmentVariableCollection(t.identifier.value,i)),i.getScopedEnvironmentVariableCollection(void 0)}_syncEnvironmentVariableCollection(t,i){const r=UL(i.map),n=BL(i.descriptionMap);this._proxy.$setEnvironmentVariableCollection(t,i.persistent,r.length===0?void 0:r,n)}$initEnvironmentVariableCollections(t){t.forEach(i=>{const r=i[0],n=this._register(new WD(i[1]));this._setEnvironmentVariableCollection(r,n)})}$acceptDefaultProfile(t,i){const r=this._defaultProfile;this._defaultProfile=t,this._defaultAutomationProfile=i,r?.path!==t.path&&this._onDidChangeShell.fire(t.path)}_setEnvironmentVariableCollection(t,i){this._environmentVariableCollections.set(t,i),this._register(i.onDidChangeCollection(()=>{this._syncEnvironmentVariableCollection(t,i)}))}};k_=__decorate([__param(1,no),__param(2,Ue)],k_);var WD=class extends se{get persistent(){return this._persistent}set persistent(e){this._persistent=e,this._onDidChangeCollection.fire()}get onDidChangeCollection(){return this._onDidChangeCollection&&this._onDidChangeCollection.event}constructor(e){super(),this.map=new Map,this.scopedCollections=new Map,this.descriptionMap=new Map,this._persistent=!0,this._onDidChangeCollection=new P,this.map=new Map(e)}getScopedEnvironmentVariableCollection(e){const t=this.getScopeKey(e);let i=this.scopedCollections.get(t);return i||(i=new QL(this,e),this.scopedCollections.set(t,i),this._register(i.onDidChangeCollection(()=>this._onDidChangeCollection.fire()))),i}replace(e,t,i,r){this._setIfDiffers(e,{value:t,type:Zo.Replace,options:i??{applyAtProcessCreation:!0},scope:r})}append(e,t,i,r){this._setIfDiffers(e,{value:t,type:Zo.Append,options:i??{applyAtProcessCreation:!0},scope:r})}prepend(e,t,i,r){this._setIfDiffers(e,{value:t,type:Zo.Prepend,options:i??{applyAtProcessCreation:!0},scope:r})}_setIfDiffers(e,t){if(t.options&&t.options.applyAtProcessCreation===!1&&!t.options.applyAtShellIntegration)throw new Error("EnvironmentVariableMutatorOptions must apply at either process creation or shell integration");const i=this.getKey(e,t.scope),r=this.map.get(i),n=t.options?{applyAtProcessCreation:t.options.applyAtProcessCreation??!1,applyAtShellIntegration:t.options.applyAtShellIntegration??!1}:{applyAtProcessCreation:!0};if(!r||r.value!==t.value||r.type!==t.type||r.options?.applyAtProcessCreation!==n.applyAtProcessCreation||r.options?.applyAtShellIntegration!==n.applyAtShellIntegration||r.scope?.workspaceFolder?.index!==t.scope?.workspaceFolder?.index){const s=this.getKey(e,t.scope),o={variable:e,...t,options:n};this.map.set(s,o),this._onDidChangeCollection.fire()}}get(e,t){const i=this.getKey(e,t),r=this.map.get(i);return r?zD(r):void 0}getKey(e,t){const i=this.getScopeKey(t);return i.length?`${e}:::${i}`:e}getScopeKey(e){return this.getWorkspaceKey(e?.workspaceFolder)??""}getWorkspaceKey(e){return e?e.uri.toString():void 0}getVariableMap(e){const t=new Map;for(const[i,r]of this.map)this.getScopeKey(r.scope)===this.getScopeKey(e)&&t.set(r.variable,zD(r));return t}delete(e,t){const i=this.getKey(e,t);this.map.delete(i),this._onDidChangeCollection.fire()}clear(e){if(e?.workspaceFolder){for(const[t,i]of this.map)i.scope?.workspaceFolder?.index===e.workspaceFolder.index&&this.map.delete(t);this.clearDescription(e)}else this.map.clear(),this.descriptionMap.clear();this._onDidChangeCollection.fire()}setDescription(e,t){const i=this.getScopeKey(t),r=this.descriptionMap.get(i);if(!r||r.description!==e){let n;typeof e=="string"?n=e:n=e?.value.split(`

`)[0];const s={description:n,scope:t};this.descriptionMap.set(i,s),this._onDidChangeCollection.fire()}}getDescription(e){const t=this.getScopeKey(e);return this.descriptionMap.get(t)?.description}clearDescription(e){const t=this.getScopeKey(e);this.descriptionMap.delete(t)}},QL=class{get persistent(){return this.collection.persistent}set persistent(e){this.collection.persistent=e}get onDidChangeCollection(){return this._onDidChangeCollection&&this._onDidChangeCollection.event}constructor(e,t){this.collection=e,this.scope=t,this._onDidChangeCollection=new P}getScoped(e){return this.collection.getScopedEnvironmentVariableCollection(e)}replace(e,t,i){this.collection.replace(e,t,i,this.scope)}append(e,t,i){this.collection.append(e,t,i,this.scope)}prepend(e,t,i){this.collection.prepend(e,t,i,this.scope)}get(e){return this.collection.get(e,this.scope)}forEach(e,t){this.collection.getVariableMap(this.scope).forEach((i,r)=>e.call(t,r,i,this),this.scope)}[Symbol.iterator](){return this.collection.getVariableMap(this.scope).entries()}delete(e){this.collection.delete(e,this.scope),this._onDidChangeCollection.fire(void 0)}clear(){this.collection.clear(this.scope)}set description(e){this.collection.setDescription(e,this.scope)}get description(){return this.collection.getDescription(this.scope)}},P_=class extends k_{constructor(t,i){super(!1,t,i)}createTerminal(t,i,r){throw new eg}createTerminalFromOptions(t,i){throw new eg}};P_=__decorate([__param(0,no),__param(1,Ue)],P_);function VD(e){if(!(!e||typeof e=="string"))return"id"in e?{id:e.id,color:e.color}:e}function JL(e){return Fo.isThemeColor(e)?e:void 0}function zD(e){const t={...e};return delete t.scope,t.options=t.options??void 0,delete t.variable,t}var XL=U("progressService"),qD;(function(e){e[e.Explorer=1]="Explorer",e[e.Scm=3]="Scm",e[e.Extensions=5]="Extensions",e[e.Window=10]="Window",e[e.Notification=15]="Notification",e[e.Dialog=20]="Dialog"})(qD||(qD={}));var iq=Object.freeze({total(){},worked(){},done(){}}),T_=class{static{this.None=Object.freeze({report(){}})}get value(){return this._value}constructor(e){this.callback=e}report(e){this._value=e,this.callback(this._value)}},jD=class extends se{constructor(t,i){super(),this.deferred=new Dr,i.withProgress(t,r=>(this.reporter=r,this.lastStep&&r.report(this.lastStep),this.deferred.p)),this._register(ne(()=>this.deferred.complete()))}report(t){this.reporter?this.reporter.report(t):this.lastStep=t}};jD=__decorate([__param(1,XL)],jD);var nq=U("editorProgressService"),GD="__",sq=U("IAuthenticationService"),oq=U("IAuthenticationExtensionsService"),A_=U("IExtHostAuthentication"),R_=class{constructor(t){this._authenticationProviders=new Map,this._onDidChangeSessions=new P,this._getSessionTaskSingler=new ZL,this._proxy=t.getProxy(W.MainThreadAuthentication)}getExtensionScopedSessionsEvent(t){const i=t.toLowerCase();return ct.chain(this._onDidChangeSessions.event,r=>r.filter(n=>!n.extensionIdFilter||n.extensionIdFilter.includes(i)).map(n=>({provider:n.provider})))}async getSession(t,i,r,n={}){const s=Oe.toKey(t.identifier),o=[...r].sort().join(" "),l=Object.keys(n).sort().map(c=>`${c}:${!!n[c]}`).join(", ");return await this._getSessionTaskSingler.getOrCreate(`${s} ${i} ${o} ${l}`,async()=>{await this._proxy.$ensureProvider(i);const c=t.displayName||t.name;return this._proxy.$getSession(i,r,s,c,n)})}async getAccounts(t){return await this._proxy.$ensureProvider(t),await this._proxy.$getAccounts(t)}async removeSession(t,i){const r=this._authenticationProviders.get(t);return r?r.provider.removeSession(i):this._proxy.$removeSession(t,i)}registerAuthenticationProvider(t,i,r,n){if(this._authenticationProviders.get(t))throw new Error(`An authentication provider with id '${t}' is already registered.`);this._authenticationProviders.set(t,{label:i,provider:r,options:n??{supportsMultipleAccounts:!1}});const s=r.onDidChangeSessions(o=>this._proxy.$sendDidChangeSessions(t,o));return this._proxy.$registerAuthenticationProvider(t,i,n?.supportsMultipleAccounts??!1),new Ce(()=>{s.dispose(),this._authenticationProviders.delete(t),this._proxy.$unregisterAuthenticationProvider(t)})}async $createSession(t,i,r){const n=this._authenticationProviders.get(t);if(n)return await n.provider.createSession(i,r);throw new Error(`Unable to find authentication provider with handle: ${t}`)}async $removeSession(t,i){const r=this._authenticationProviders.get(t);if(r)return await r.provider.removeSession(i);throw new Error(`Unable to find authentication provider with handle: ${t}`)}async $getSessions(t,i,r){const n=this._authenticationProviders.get(t);if(n)return await n.provider.getSessions(i,r);throw new Error(`Unable to find authentication provider with handle: ${t}`)}$onDidChangeAuthenticationSessions(t,i,r){return t.startsWith(GD)||this._onDidChangeSessions.fire({provider:{id:t,label:i},extensionIdFilter:r}),Promise.resolve()}};R_=__decorate([__param(0,Ue)],R_);var ZL=class{constructor(){this._inFlightPromises=new Map}getOrCreate(e,t){const i=this._inFlightPromises.get(e);if(i)return i;const r=t().finally(()=>this._inFlightPromises.delete(e));return this._inFlightPromises.set(e,r),r}},KL={label:h(5609,null),order:Number.MAX_SAFE_INTEGER},jf,L_=U("IExtHostLanguageModels"),QD=class{constructor(e,t){this.option=e,this.stream=new Ng,this.stream=t??new Ng}},YL=class{constructor(){this._responseStreams=new Map,this._defaultStream=new Ng,this._isDone=!1;const e=this;this.apiObject={get stream(){return e._defaultStream.asyncIterable},get text(){return fl.map(e._defaultStream.asyncIterable,t=>{if(t instanceof mt)return t.value}).coalesce()}}}*_streams(){if(this._responseStreams.size>0)for(const[,e]of this._responseStreams)yield e.stream;else yield this._defaultStream}handleFragment(e){if(this._isDone)return;let t=this._responseStreams.get(e.index);t||(this._responseStreams.size===0?t=new QD(e.index,this._defaultStream):t=new QD(e.index),this._responseStreams.set(e.index,t));let i;e.part.type==="text"?i=new mt(e.part.value):e.part.type==="data"?i=new mt(""):i=new Qs(e.part.toolCallId,e.part.name,e.part.parameters),t.stream.emitOne(i)}reject(e){this._isDone=!0;for(const t of this._streams())t.reject(e)}resolve(){this._isDone=!0;for(const e of this._streams())e.resolve()}},N_=class{static{jf=this}static{this._idPool=1}constructor(t,i,r){this._logService=i,this._extHostAuthentication=r,this._onDidChangeModelAccess=new P,this._onDidChangeProviders=new P,this.onDidChangeProviders=this._onDidChangeProviders.event,this._languageModels=new Map,this._allLanguageModelData=new Map,this._modelAccessList=new Xr,this._pendingRequest=new Map,this._ignoredFileProviders=new Map,this._languageAccessInformationExtensions=new Set,this._proxy=t.getProxy(W.MainThreadLanguageModels)}dispose(){this._onDidChangeModelAccess.dispose(),this._onDidChangeProviders.dispose()}registerLanguageModel(t,i,r,n){const s=jf._idPool++;this._languageModels.set(s,{extension:t.identifier,provider:r,languageModelId:i});let o;n.auth&&(o={providerLabel:t.displayName||t.name,accountLabel:typeof n.auth=="object"?n.auth.label:void 0}),this._proxy.$registerLanguageModelProvider(s,`${Oe.toKey(t.identifier)}/${i}`,{extension:t.identifier,id:i,vendor:n.vendor??Oe.toKey(t.identifier),name:n.name??"",family:n.family??"",cost:n.cost,description:n.description,version:n.version,maxInputTokens:n.maxInputTokens,maxOutputTokens:n.maxOutputTokens,auth:o,targetExtensions:n.extensions,isDefault:n.isDefault,isUserSelectable:n.isUserSelectable,modelPickerCategory:n.category??KL,capabilities:n.capabilities});const a=r.onDidReceiveLanguageModelResponse2?.(({extensionId:l,participant:c,tokenCount:u})=>{this._proxy.$whenLanguageModelChatRequestMade(i,new Oe(l),c,u)});return ne(()=>{this._languageModels.delete(s),this._proxy.$unregisterProvider(s),a?.dispose()})}async $startChatRequest(t,i,r,n,s,o){const a=this._languageModels.get(t);if(!a)throw new Error("Provider not found");const l=new T_(async u=>{if(o.isCancellationRequested){this._logService.warn(`[CHAT](${a.extension.value}) CANNOT send progress because the REQUEST IS CANCELLED`);return}let d;if(u.part instanceof Qs?d={type:"tool_use",name:u.part.name,parameters:u.part.input,toolCallId:u.part.callId}:u.part instanceof mt?d={type:"text",value:u.part.value}:u.part instanceof qn&&(d={type:"data",value:{mimeType:u.part.mimeType,data:ae.wrap(u.part.data)}}),!d){this._logService.warn(`[CHAT](${a.extension.value}) UNKNOWN part ${JSON.stringify(u)}`);return}this._proxy.$reportResponsePart(i,{index:u.index,part:d})});let c;try{c=a.provider.provideLanguageModelResponse(n.value.map(Tc.to),s,Oe.toKey(r),l,o)}catch(u){throw u}Promise.resolve(c).then(()=>{this._proxy.$reportResponseDone(i,void 0)},u=>{this._proxy.$reportResponseDone(i,wo(u))})}$provideTokenLength(t,i,r){const n=this._languageModels.get(t);return n?Promise.resolve(n.provider.provideTokenCount(i,r)):Promise.resolve(0)}$acceptChatModelMetadata(t){if(t.added)for(const{identifier:i,metadata:r}of t.added)this._allLanguageModelData.set(i,{metadata:r,apiObjects:new Xr});if(t.removed)for(const i of t.removed){this._allLanguageModelData.delete(i);for(const[r,n]of this._pendingRequest)n.languageModelId===i&&(n.res.reject(new xr),this._pendingRequest.delete(r))}t.added?.forEach(i=>this._fakeAuthPopulate(i.metadata)),this._onDidChangeProviders.fire(void 0)}async getDefaultLanguageModel(t){const i=Jt.find(this._allLanguageModelData.entries(),([,r])=>!!r.metadata.isDefault)?.[0];if(i)return this.getLanguageModelByIdentifier(t,i)}async getLanguageModelByIdentifier(t,i){const r=this._allLanguageModelData.get(i);if(!r)return;this._isUsingAuth(t.identifier,r.metadata)&&await this._fakeAuthPopulate(r.metadata);let n=r.apiObjects.get(t.identifier);if(!n){const s=this;n={id:r.metadata.id,vendor:r.metadata.vendor,family:r.metadata.family,version:r.metadata.version,name:r.metadata.name,capabilities:{supportsImageToText:r.metadata.capabilities?.vision??!1,supportsToolCalling:r.metadata.capabilities?.toolCalling??!1},maxInputTokens:r.metadata.maxInputTokens,countTokens(o,a){if(!s._allLanguageModelData.has(i))throw cn.NotFound(i);return s._computeTokenLength(i,o,a??Xe.None)},sendRequest(o,a,l){if(!s._allLanguageModelData.has(i))throw cn.NotFound(i);return s._sendChatRequest(t,i,o,a??{},l??Xe.None)}},Object.freeze(n),r.apiObjects.set(t.identifier,n)}return n}async selectLanguageModels(t,i){const r=await this._proxy.$selectChatModels({...i,extension:t.identifier}),n=[];for(const s of r){const o=await this.getLanguageModelByIdentifier(t,s);o&&n.push(o)}return n}async _sendChatRequest(t,i,r,n,s){const o=this._convertMessages(t,r),a=t.identifier,l=this._allLanguageModelData.get(i)?.metadata;if(!l||!this._allLanguageModelData.has(i))throw cn.NotFound(`Language model '${i}' is unknown.`);if(this._isUsingAuth(a,l)&&(!await this._getAuthAccess(t,{identifier:l.extension,displayName:l.auth.providerLabel},n.justification,!1)||!this._modelAccessList.get(a)?.has(l.extension)))throw cn.NoPermissions(`Language model '${i}' cannot be used by '${a.value}'.`);const c=Math.random()*1e6|0,u=new YL;this._pendingRequest.set(c,{languageModelId:i,res:u});try{await this._proxy.$tryStartChatRequest(a,i,c,new ai(o),n,s)}catch(d){throw this._pendingRequest.delete(c),cn.tryDeserialize(d)??d}return u.apiObject}_convertMessages(t,i){const r=[];for(const n of i)n.role===Ai.System&&N(t,"languageModelSystem"),r.push(Tc.from(n));return r}async $acceptResponsePart(t,i){const r=this._pendingRequest.get(t);r&&r.res.handleFragment(i)}async $acceptResponseDone(t,i){const r=this._pendingRequest.get(t);r&&(this._pendingRequest.delete(t),i?r.res.reject(cn.tryDeserialize(i)??Jw(i)):r.res.resolve())}async _getAuthAccess(t,i,r,n){const s=GD+i.identifier.value;if(await this._extHostAuthentication.getSession(t,s,[],{silent:!0}))return this.$updateModelAccesslist([{from:t.identifier,to:i.identifier,enabled:!0}]),!0;if(n)return!1;try{const a=r?h(2929,null,i.displayName,r):void 0;return await this._extHostAuthentication.getSession(t,s,[],{forceNewSession:{detail:a}}),this.$updateModelAccesslist([{from:t.identifier,to:i.identifier,enabled:!0}]),!0}catch{return!1}}_isUsingAuth(t,i){return!!i.auth&&!Oe.equals(i.extension,t)}async _fakeAuthPopulate(t){if(t.auth)for(const i of this._languageAccessInformationExtensions)try{await this._getAuthAccess(i,{identifier:t.extension,displayName:""},void 0,!0)}catch(r){this._logService.error("Fake Auth request failed"),this._logService.error(r)}}async _computeTokenLength(t,i,r){if(!this._allLanguageModelData.get(t))throw cn.NotFound(`Language model '${t}' is unknown.`);const s=Jt.find(this._languageModels.values(),o=>o.languageModelId===t);return s?s.provider.provideTokenCount(i,r):this._proxy.$countTokens(t,typeof i=="string"?i:Tc.from(i),r)}$updateModelAccesslist(t){const i=new Array;for(const{from:r,to:n,enabled:s}of t){const o=this._modelAccessList.get(r)??new vs;if(o.has(n)!==s){s?o.add(n):o.delete(n),this._modelAccessList.set(r,o);const l={from:r,to:n};i.push(l),this._onDidChangeModelAccess.fire(l)}}}createLanguageModelAccessInformation(t){this._languageAccessInformationExtensions.add(t);const i=this,r=ct.signal(ct.filter(this._onDidChangeModelAccess.event,s=>Oe.equals(s.from,t.identifier))),n=ct.signal(this._onDidChangeProviders.event);return{get onDidChange(){return ct.any(r,n)},canSendRequest(s){let o;e:for(const[l,c]of i._allLanguageModelData)for(const u of c.apiObjects.values())if(u===s){o=c.metadata;break e}if(!o)return;if(!i._isUsingAuth(t.identifier,o))return!0;const a=i._modelAccessList.get(t.identifier);if(a)return a.has(o.extension)}}}fileIsIgnored(t,i,r=Xe.None){return N(t,"chatParticipantAdditions"),this._proxy.$fileIsIgnored(i,r)}async $isFileIgnored(t,i,r){const n=this._ignoredFileProviders.get(t);if(!n)throw new Error("Unknown LanguageModelIgnoredFileProvider");return await n.provideFileIgnored(y.revive(i),r)??!1}registerIgnoredFileProvider(t,i){N(t,"chatParticipantPrivate");const r=jf._idPool++;return this._proxy.$registerFileIgnoreProvider(r),this._ignoredFileProviders.set(r,i),ne(()=>{this._proxy.$unregisterFileIgnoreProvider(r),this._ignoredFileProviders.delete(r)})}};N_=jf=__decorate([__param(0,Ue),__param(1,qe),__param(2,A_)],N_);function Vc(e,t=oi){return oT(e,t)?e.charAt(0).toUpperCase()+e.slice(1):e}function eN(e,t){return e.replace(/^~($|\/|\\)/,`${t}$1`)}var JD;(function(e){e[e.TEXT=0]="TEXT",e[e.VARIABLE=1]="VARIABLE",e[e.SEPARATOR=2]="SEPARATOR"})(JD||(JD={}));var tN=60,iN=tN*60,M_=iN*24,cq=M_*7,uq=M_*30,dq=M_*365;function rN(e){return e.getFullYear()+"-"+String(e.getMonth()+1).padStart(2,"0")+"-"+String(e.getDate()).padStart(2,"0")+"T"+String(e.getHours()).padStart(2,"0")+":"+String(e.getMinutes()).padStart(2,"0")+":"+String(e.getSeconds()).padStart(2,"0")+"."+(e.getMilliseconds()/1e3).toFixed(3).slice(2,5)+"Z"}var nN={DateTimeFormat(e,t){try{return new Intl.DateTimeFormat(e,t)}catch{return new Intl.DateTimeFormat(void 0,t)}},Collator(e,t){try{return new Intl.Collator(e,t)}catch{return new Intl.Collator(void 0,t)}},Segmenter(e,t){try{return new Intl.Segmenter(e,t)}catch{return new Intl.Segmenter(void 0,t)}},Locale(e,t){try{return new Intl.Locale(e,t)}catch{return new Intl.Locale(In,t)}}},XD;(function(e){e[e.MAX_SAFE_SMALL_INTEGER=1073741824]="MAX_SAFE_SMALL_INTEGER",e[e.MIN_SAFE_SMALL_INTEGER=-1073741824]="MIN_SAFE_SMALL_INTEGER",e[e.MAX_UINT_8=255]="MAX_UINT_8",e[e.MAX_UINT_16=65535]="MAX_UINT_16",e[e.MAX_UINT_32=4294967295]="MAX_UINT_32",e[e.UNICODE_SUPPLEMENTARY_PLANE_BEGIN=65536]="UNICODE_SUPPLEMENTARY_PLANE_BEGIN"})(XD||(XD={}));function ZD(e){return e<0?0:e>255?255:e|0}function Ua(e){return e<0?0:e>4294967295?4294967295:e|0}var KD=class s7{constructor(t){const i=ZD(t);this._defaultValue=i,this._asciiMap=s7._createAsciiMap(i),this._map=new Map}static _createAsciiMap(t){const i=new Uint8Array(256);return i.fill(t),i}set(t,i){const r=ZD(i);t>=0&&t<256?this._asciiMap[t]=r:this._map.set(t,r)}get(t){return t>=0&&t<256?this._asciiMap[t]:this._map.get(t)||this._defaultValue}clear(){this._asciiMap.fill(this._defaultValue),this._map.clear()}},YD;(function(e){e[e.False=0]="False",e[e.True=1]="True"})(YD||(YD={}));var eI;(function(e){e[e.Regular=0]="Regular",e[e.Whitespace=1]="Whitespace",e[e.WordSeparator=2]="WordSeparator"})(eI||(eI={}));var sN=class extends KD{constructor(e,t){super(0),this._segmenter=null,this._cachedLine=null,this._cachedSegments=[],this.intlSegmenterLocales=t,this.intlSegmenterLocales.length>0?this._segmenter=nN.Segmenter(this.intlSegmenterLocales,{granularity:"word"}):this._segmenter=null;for(let i=0,r=e.length;i<r;i++)this.set(e.charCodeAt(i),2);this.set(32,1),this.set(9,1)}findPrevIntlWordBeforeOrAtOffset(e,t){let i=null;for(const r of this._getIntlSegmenterWordsOnLine(e)){if(r.index>t)break;i=r}return i}findNextIntlWordAtOrAfterOffset(e,t){for(const i of this._getIntlSegmenterWordsOnLine(e))if(!(i.index<t))return i;return null}_getIntlSegmenterWordsOnLine(e){return this._segmenter?this._cachedLine===e?this._cachedSegments:(this._cachedLine=e,this._cachedSegments=this._filterWordSegments(this._segmenter.segment(e)),this._cachedSegments):[]}_filterWordSegments(e){const t=[];for(const i of e)this._isWordLike(i)&&t.push(i);return t}_isWordLike(e){return!!e.isWordLike}},tI=new ng(10);function oN(e,t){const i=`${e}/${t.join(",")}`;let r=tI.get(i);return r||(r=new sN(e,t),tI.set(i,r)),r}var O_;(function(e){e[e.Left=1]="Left",e[e.Center=2]="Center",e[e.Right=4]="Right",e[e.Full=7]="Full"})(O_||(O_={}));var iI;(function(e){e[e.Left=1]="Left",e[e.Center=2]="Center",e[e.Right=3]="Right"})(iI||(iI={}));var rI;(function(e){e[e.Inline=1]="Inline",e[e.Gutter=2]="Gutter"})(rI||(rI={}));var nI;(function(e){e[e.Normal=1]="Normal",e[e.Underlined=2]="Underlined"})(nI||(nI={}));var sI;(function(e){e[e.Both=0]="Both",e[e.Right=1]="Right",e[e.Left=2]="Left",e[e.None=3]="None"})(sI||(sI={}));var oI;(function(e){e[e.TextDefined=0]="TextDefined",e[e.LF=1]="LF",e[e.CRLF=2]="CRLF"})(oI||(oI={}));var aI;(function(e){e[e.LF=1]="LF",e[e.CRLF=2]="CRLF"})(aI||(aI={}));var lI;(function(e){e[e.LF=0]="LF",e[e.CRLF=1]="CRLF"})(lI||(lI={}));var F_=class{constructor(e,t){this._findMatchBrand=void 0,this.range=e,this.matches=t}},cI;(function(e){e[e.AlwaysGrowsWhenTypingAtEdges=0]="AlwaysGrowsWhenTypingAtEdges",e[e.NeverGrowsWhenTypingAtEdges=1]="NeverGrowsWhenTypingAtEdges",e[e.GrowsOnlyWhenTypingBefore=2]="GrowsOnlyWhenTypingBefore",e[e.GrowsOnlyWhenTypingAfter=3]="GrowsOnlyWhenTypingAfter"})(cI||(cI={}));var uI;(function(e){e[e.Left=0]="Left",e[e.Right=1]="Right",e[e.None=2]="None",e[e.LeftOfInjectedText=3]="LeftOfInjectedText",e[e.RightOfInjectedText=4]="RightOfInjectedText"})(uI||(uI={}));var dI;(function(e){e[e.FIRST_LINE_DETECTION_LENGTH_LIMIT=1e3]="FIRST_LINE_DETECTION_LENGTH_LIMIT"})(dI||(dI={}));var aN=class{constructor(e,t,i){this.regex=e,this.wordSeparators=t,this.simpleSearch=i}},lN=class{constructor(e,t,i){this.reverseEdits=e,this.changes=t,this.trimAutoWhitespaceLineNumbers=i}},hI=class{constructor(e,t,i,r){this.searchString=e,this.isRegex=t,this.matchCase=i,this.wordSeparators=r}parseSearchRequest(){if(this.searchString==="")return null;let e;this.isRegex?e=fI(this.searchString):e=this.searchString.indexOf(`
`)>=0;let t=null;try{t=$P(this.searchString,this.isRegex,{matchCase:this.matchCase,wholeWord:!1,multiline:e,global:!0,unicode:!0})}catch{return null}if(!t)return null;let i=!this.isRegex&&!e;return i&&this.searchString.toLowerCase()!==this.searchString.toUpperCase()&&(i=this.matchCase),new aN(t,this.wordSeparators?oN(this.wordSeparators,[]):null,i?this.searchString:null)}};function fI(e){if(!e||e.length===0)return!1;for(let t=0,i=e.length;t<i;t++){const r=e.charCodeAt(t);if(r===10)return!0;if(r===92){if(t++,t>=i)break;const n=e.charCodeAt(t);if(n===110||n===114||n===87)return!0}}return!1}function pI(e,t,i){if(!i)return new F_(e,null);const r=[];for(let n=0,s=t.length;n<s;n++)r[n]=t[n];return new F_(e,r)}function cN(e,t,i,r,n){if(r===0)return!0;const s=t.charCodeAt(r-1);if(e.get(s)!==0||s===13||s===10)return!0;if(n>0){const o=t.charCodeAt(r);if(e.get(o)!==0)return!0}return!1}function uN(e,t,i,r,n){if(r+n===i)return!0;const s=t.charCodeAt(r+n);if(e.get(s)!==0||s===13||s===10)return!0;if(n>0){const o=t.charCodeAt(r+n-1);if(e.get(o)!==0)return!0}return!1}function gI(e,t,i,r,n){return cN(e,t,i,r,n)&&uN(e,t,i,r,n)}var dN=class{constructor(e,t){this._wordSeparators=e,this._searchRegex=t,this._prevMatchStartIndex=-1,this._prevMatchLength=0}reset(e){this._searchRegex.lastIndex=e,this._prevMatchStartIndex=-1,this._prevMatchLength=0}next(e){const t=e.length;let i;do{if(this._prevMatchStartIndex+this._prevMatchLength===t||(i=this._searchRegex.exec(e),!i))return null;const r=i.index,n=i[0].length;if(r===this._prevMatchStartIndex&&n===this._prevMatchLength){if(n===0){ub(e,t,this._searchRegex.lastIndex)>65535?this._searchRegex.lastIndex+=2:this._searchRegex.lastIndex+=1;continue}return null}if(this._prevMatchStartIndex=r,this._prevMatchLength=n,!this._wordSeparators||gI(this._wordSeparators,e,t,r,n))return i}while(i);return null}};function mI(e){return e.scheme!==V.file&&e.scheme!==V.vscodeRemote}function hN(e){if(e.folders.length)return e.folders.every(t=>mI(t.uri))?e.folders[0].uri:void 0;if(e.configuration&&mI(e.configuration))return e.configuration}function fN(e){return hN(e)?.scheme}var pN=Wm,vI=U("remoteAgentService"),hq=new class{constructor(){this.maxSampleCount=5,this.sampleDelay=2e3,this.initial=[],this.maxInitialCount=3,this.average=[],this.maxAverageCount=100,this.highLatencyMultiple=2,this.highLatencyMinThreshold=500,this.highLatencyMaxThreshold=1500,this.lastMeasurement=void 0}get latency(){return this.lastMeasurement}async measure(e){let t=1/0;for(let r=0;r<this.maxSampleCount;r++){const n=await e.getRoundTripTime();if(n===void 0)return;t=Math.min(t,n/2),await sr(this.sampleDelay)}this.average.push(t),this.average.length>this.maxAverageCount&&this.average.shift();let i;return this.initial.length<this.maxInitialCount?this.initial.push(t):i=this.initial.reduce((r,n)=>r+n,0)/this.initial.length,this.lastMeasurement={initial:i,current:t,average:this.average.reduce((r,n)=>r+n,0)/this.average.length,high:typeof i>"u"?!1:t>this.highLatencyMaxThreshold||t>this.highLatencyMinThreshold&&t>i*this.highLatencyMultiple},this.lastMeasurement}},$_,gN=U("pathService"),_I=$_=class{constructor(t,i,r,n){this.localUserHome=t,this.remoteAgentService=i,this.environmentService=r,this.contextService=n,this.resolveOS=(async()=>(await this.remoteAgentService.getEnvironment())?.os||cl)(),this.resolveUserHome=(async()=>{const s=await this.remoteAgentService.getEnvironment();return this.maybeUnresolvedUserHome=s?.userHome??t})()}hasValidBasename(t,i,r){return typeof i=="string"||typeof i>"u"?this.resolveOS.then(n=>this.doHasValidBasename(t,n,i)):this.doHasValidBasename(t,i,r)}doHasValidBasename(t,i,r){return t.scheme===V.file||t.scheme===V.vscodeRemote?sT(r??nr(t),i===1):!0}get defaultUriScheme(){return $_.findDefaultUriScheme(this.environmentService,this.contextService)}static findDefaultUriScheme(t,i){if(t.remoteAuthority)return V.vscodeRemote;const r=fN(i.getWorkspace());if(r)return r;const n=i.getWorkspace().folders[0];if(n)return n.uri.scheme;const s=i.getWorkspace().configuration;return s?s.scheme:V.file}userHome(t){return t?.preferLocal?this.localUserHome:this.resolveUserHome}get resolvedUserHome(){return this.maybeUnresolvedUserHome}get path(){return this.resolveOS.then(t=>t===1?Dt:Ne)}async fileURI(t){let i="";if(await this.resolveOS===1&&(t=t.replace(/\\/g,"/")),t[0]==="/"&&t[1]==="/"){const n=t.indexOf("/",2);n===-1?(i=t.substring(2),t="/"):(i=t.substring(2,n),t=t.substring(n)||"/")}return y.from({scheme:V.file,authority:i,path:t,query:"",fragment:""})}};_I=$_=__decorate([__param(1,vI),__param(2,pN),__param(3,Yg)],_I);function mN(e){return typeof e=="object"&&"uri"in e&&"pattern"in e}var wI=class{constructor(t,i,r,n,s,o){this.configurationService=t,this.workspaceContextService=i,this.editorGroupsService=r,this.logService=n,this.pathService=s,this.uriIdentityService=o}aiText(t,i,r={}){return{...this.commonQuery(i?.map(em),r),type:3,contentPattern:t}}text(t,i,r={}){t=this.getContentPattern(t,r);const n=this.configurationService.getValue(),s=i&&i.some(a=>!this.configurationService.getValue({resource:a}).search.useRipgrep);return{...this.commonQuery(i?.map(em),r),type:2,contentPattern:t,previewOptions:r.previewOptions,maxFileSize:r.maxFileSize,usePCRE2:n.search.usePCRE2||s||!1,surroundingContext:r.surroundingContext,userDisabledExcludesAndIgnoreFiles:r.disregardExcludeSettings&&r.disregardIgnoreFiles}}getContentPattern(t,i){const r=this.configurationService.getValue();t.isRegExp&&(t.pattern=t.pattern.replace(/\r?\n/g,"\\n"));const n={...t,wordSeparators:r.editor.wordSeparators};return this.isCaseSensitive(t,i)&&(n.isCaseSensitive=!0),this.isMultiline(t)&&(n.isMultiline=!0),i.notebookSearchConfig?.includeMarkupInput&&(n.notebookInfo||(n.notebookInfo={}),n.notebookInfo.isInNotebookMarkdownInput=i.notebookSearchConfig.includeMarkupInput),i.notebookSearchConfig?.includeMarkupPreview&&(n.notebookInfo||(n.notebookInfo={}),n.notebookInfo.isInNotebookMarkdownPreview=i.notebookSearchConfig.includeMarkupPreview),i.notebookSearchConfig?.includeCodeInput&&(n.notebookInfo||(n.notebookInfo={}),n.notebookInfo.isInNotebookCellInput=i.notebookSearchConfig.includeCodeInput),i.notebookSearchConfig?.includeOutput&&(n.notebookInfo||(n.notebookInfo={}),n.notebookInfo.isInNotebookCellOutput=i.notebookSearchConfig.includeOutput),n}file(t,i={}){return{...this.commonQuery(t,i),type:1,filePattern:i.filePattern?i.filePattern.trim():i.filePattern,exists:i.exists,sortByScore:i.sortByScore,cacheKey:i.cacheKey,shouldGlobMatchFilePattern:i.shouldGlobSearch}}handleIncludeExclude(t,i){if(!t)return{};if(Array.isArray(t)){if(t=t.filter(r=>r.length>0).map(Gf),!t.length)return{}}else t=Gf(t);return i?this.parseSearchPaths(t):{pattern:H_(...Array.isArray(t)?t:[t])}}commonQuery(t=[],i={}){let r=Array.isArray(i.excludePattern)?i.excludePattern.map(u=>u.pattern).flat():i.excludePattern;r=r?.length===1?r[0]:r;const n=this.handleIncludeExclude(i.includePattern,i.expandPatterns),s=this.handleIncludeExclude(r,i.expandPatterns),o=t.length>1,a=(n.searchPaths&&n.searchPaths.length?n.searchPaths.map(u=>this.getFolderQueryForSearchPath(u,i,s)):t.map(u=>this.getFolderQueryForRoot(u,i,s,o))).filter(u=>!!u),l={_reason:i._reason,folderQueries:a,usingSearchPaths:!!(n.searchPaths&&n.searchPaths.length),extraFileResources:i.extraFileResources,excludePattern:s.pattern,includePattern:n.pattern,onlyOpenEditors:i.onlyOpenEditors,maxResults:i.maxResults,onlyFileScheme:i.onlyFileScheme};if(i.onlyOpenEditors){const u=xt(this.editorGroupsService.groups.flatMap(p=>p.editors.map(m=>m.resource)));this.logService.trace("QueryBuilder#commonQuery - openEditor URIs",JSON.stringify(u));const d=u.filter(p=>cD(l,p.fsPath)),f=this.commonQueryFromFileList(d);return this.logService.trace("QueryBuilder#commonQuery - openEditor Query",JSON.stringify(f)),{...l,...f}}const c=i.extraFileResources&&i.extraFileResources.filter(u=>cD(l,u.fsPath));return l.extraFileResources=c&&c.length?c:void 0,l}commonQueryFromFileList(t){const i=[],r=new Ft,n={};let s=!1;return t.forEach(o=>{if(o.scheme===V.walkThrough)return;if(_T(o)){const l=this.workspaceContextService.getWorkspaceFolder(o)?.uri??this.uriIdentityService.extUri.dirname(o);let c=r.get(l);c||(s=!0,c={folder:l,includePattern:{}},i.push(c),r.set(l,c));const u=ul(l.fsPath,o.fsPath);xo(c.includePattern)[u.replace(/\\/g,"/")]=!0}else o.fsPath&&(s=!0,n[o.fsPath]=!0)}),{folderQueries:i,includePattern:n,usingSearchPaths:!0,excludePattern:s?void 0:{"**/*":!0}}}isCaseSensitive(t,i){if(i.isSmartCase){if(t.isRegExp){if(pb(t.pattern,!0))return!0}else if(pb(t.pattern))return!0}return!!t.isCaseSensitive}isMultiline(t){return t.isMultiline||t.isRegExp&&fI(t.pattern)||t.pattern.indexOf(`
`)>=0?!0:!!t.isMultiline}parseSearchPaths(t){const i=d=>Bu(d)||/^\.\.?([\/\\]|$)/.test(d),n=(Array.isArray(t)?t:_N(t)).map(d=>{const f=this.pathService.resolvedUserHome;return f?eN(d,f.scheme===V.file?f.fsPath:f.path):d}),s=ey(n,d=>i(d)?"searchPaths":"exprSegments"),o=(s.exprSegments||[]).map(d=>Cg(d,"/")).map(d=>Cg(d,"\\")).map(d=>(d[0]==="."&&(d="*"+d),wN(d))),a={},l=this.expandSearchPathPatterns(s.searchPaths||[]);l&&l.length&&(a.searchPaths=l);const c=o.flat(),u=H_(...c);return u&&(a.pattern=u),a}getExcludesForFolder(t,i){return i.disregardExcludeSettings?void 0:Q2(t,!i.disregardSearchExcludeSettings)}expandSearchPathPatterns(t){if(!t||!t.length)return[];const i=t.flatMap(n=>{let{pathPortion:s,globPortion:o}=vN(n);return o&&(o=U_(o)),this.expandOneSearchPath(s).flatMap(l=>this.resolveOneSearchPathPattern(l,o))}),r=new Map;return i.forEach(n=>{const s=n.searchPath.toString(),o=r.get(s);o?n.pattern&&(o.pattern=o.pattern||{},o.pattern[n.pattern]=!0):r.set(s,{searchPath:n.searchPath,pattern:n.pattern?H_(n.pattern):void 0})}),Array.from(r.values())}expandOneSearchPath(t){if(Bu(t)){const i=this.workspaceContextService.getWorkspace().folders;return i[0]&&i[0].uri.scheme!==V.file?[{searchPath:i[0].uri.with({path:t})}]:[{searchPath:y.file(ko(t))}]}if(this.workspaceContextService.getWorkbenchState()===2){const i=this.workspaceContextService.getWorkspace().folders[0].uri;if(t=Gf(t),t.startsWith("../")||t===".."){const n=Ne.resolve(i.path,t);return[{searchPath:i.with({path:n})}]}const r=U_(t);return[{searchPath:i,pattern:r}]}else{if(t==="./"||t===".\\")return[];{const i=t.replace(/^\.[\/\\]/,""),n=this.workspaceContextService.getWorkspace().folders.map(s=>{const o=i.match(new RegExp(`^${ps(s.name)}(?:/(.*)|$)`));return o?{match:o,folder:s}:null}).filter(ji);if(n.length)return n.map(s=>{const o=s.match[1];return{searchPath:s.folder.uri,pattern:o&&U_(o)}});{const s=t.match(/\.[\/\\](.+)[\/\\]?/),o=s?s[1]:t,a=h(14378,null,o);throw new Error(a)}}}}resolveOneSearchPathPattern(t,i){const r=t.pattern&&i?`${t.pattern}/${i}`:t.pattern||i,n=[{searchPath:t.searchPath,pattern:r}];return r&&!r.endsWith("**")&&n.push({searchPath:t.searchPath,pattern:r+"/**"}),n}getFolderQueryForSearchPath(t,i,r){const n=this.getFolderQueryForRoot(em(t.searchPath),i,r,!1);return n?{...n,includePattern:t.pattern}:null}getFolderQueryForRoot(t,i,r,n){let s;const o=y.isUri(t)?t:t.uri;let a=i.excludePattern?.map(p=>{const m=i.excludePattern&&mN(p)?p.uri:void 0;return!m||!(y.isUri(t)&&this.uriIdentityService.extUri.isEqual(t,m))?m:void 0});if(a?.length||(a=[void 0]),r.searchPaths){const p=r.searchPaths.filter(m=>ms(m.searchPath,o))[0];if(p&&!p.pattern)return null;p&&(s=p.pattern)}const l=this.configurationService.getValue({resource:o}),u={...this.getExcludesForFolder(l,i)||{},...s||{}},d=y.isUri(t)?nr(t):t.name,f=a.map(p=>Object.keys(u).length>0?{folder:p,pattern:u}:void 0).filter(p=>p);return{folder:o,folderName:n?d:void 0,excludePattern:f,fileEncoding:l.files&&l.files.encoding,disregardIgnoreFiles:typeof i.disregardIgnoreFiles=="boolean"?i.disregardIgnoreFiles:!l.search.useIgnoreFiles,disregardGlobalIgnoreFiles:typeof i.disregardGlobalIgnoreFiles=="boolean"?i.disregardGlobalIgnoreFiles:!l.search.useGlobalIgnoreFiles,disregardParentIgnoreFiles:typeof i.disregardParentIgnoreFiles=="boolean"?i.disregardParentIgnoreFiles:!l.search.useParentIgnoreFiles,ignoreSymlinks:typeof i.ignoreSymlinks=="boolean"?i.ignoreSymlinks:!l.search.followSymlinks}}};wI=__decorate([__param(0,Cd),__param(1,Yg),__param(2,UR),__param(3,qe),__param(4,gN),__param(5,zE)],wI);function vN(e){const t=e.match(/[\*\{\}\(\)\[\]\?]/);if(t){const i=t.index,r=e.substr(0,i).match(/[/|\\][^/\\]*$/);if(r){let n=e.substr(0,r.index);return n.match(/[/\\]/)||(n+="/"),{pathPortion:n,globPortion:e.substr((r.index||0)+1)}}}return{pathPortion:e}}function H_(...e){return e.length?e.reduce((t,i)=>(t[i]=!0,t),Object.create(null)):void 0}function _N(e){return Nm(e,",").map(t=>t.trim()).filter(t=>!!t.length)}function wN(e){return[`**/${e}/**`,`**/${e}`].map(i=>i.replace(/\*\*\/\*\*/g,"**"))}function Gf(e){return e.replace(/\\/g,"/")}function U_(e){return Gf(e).replace(/^\.\//,"").replace(/\/+$/g,"")}var yN=7e3;function bN(e,t){const i=t.activationEvents;if(!i)return Promise.resolve(void 0);const r=[],n=[];for(const u of i)if(/^workspaceContains:/.test(u)){const d=u.substr(18);d.indexOf("*")>=0||d.indexOf("?")>=0||e.forceUsingSearch?n.push(d):r.push(d)}if(r.length===0&&n.length===0)return Promise.resolve(void 0);const{promise:s,resolve:o}=bT(),a=u=>o({activationEvent:u}),l=Promise.all(r.map(u=>xN(e,u,a))).then(()=>{}),c=SN(e,t.identifier,n,a);return Promise.all([l,c]).then(()=>{o(void 0)}),s}async function xN(e,t,i){for(const r of e.folders)if(await e.exists(Zt(y.revive(r),t))){i(`workspaceContains:${t}`);return}}async function SN(e,t,i,r){if(i.length===0)return Promise.resolve(void 0);const n=new ft,s=e.checkExists(e.folders,i,n.token),o=setTimeout(async()=>{n.cancel(),e.logService.info(`Not activating extension '${t.value}': Timed out while searching for 'workspaceContains' pattern ${i.join(",")}`)},yN);let a=!1;try{a=await s}catch(l){br(l)||Qt(l)}n.dispose(),clearTimeout(o),a&&r(`workspaceContains:${i.join(",")}`)}var yI=class{constructor(e){this._onDidChangePassword=new P,this.onDidChangePassword=this._onDidChangePassword.event,this._proxy=e.getProxy(W.MainThreadSecretState)}async $onDidChangePassword(e){this._onDidChangePassword.fire(e)}get(e,t){return this._proxy.$getPassword(e,t)}store(e,t,i){return this._proxy.$setPassword(e,t,i)}delete(e,t){return this._proxy.$deletePassword(e,t)}},B_=U("IExtHostSecretState"),EN=class{#e;constructor(e,t){this.disposables=new he,this._id=Oe.toKey(e.identifier),this.#e=t,this.onDidChange=ct.map(ct.filter(this.#e.onDidChangePassword,i=>i.extensionId===this._id),i=>({key:i.key}),this.disposables)}dispose(){this.disposables.dispose()}get(e){return this.#e.get(this._id,e)}store(e,t){return this.#e.store(this._id,e,t)}delete(e){return this.#e.delete(this._id,e)}},W_=class{constructor(t,i,r){this.logService=r,this.bundleCache=new Map,this._proxy=i.getProxy(W.MainThreadLocalization),this.currentLanguage=t.environment.appLanguage,this.isDefaultLanguage=this.currentLanguage===In,this.logService.info(`[ExtHostLocalization] Service initialized with language: ${this.currentLanguage}, isDefaultLanguage: ${this.isDefaultLanguage}`)}getMessage(t,i){const{message:r,args:n,comment:s}=i;if(this.isDefaultLanguage)return ob(r,n??{});let o=r;s&&s.length>0&&(o+=`/${Array.isArray(s)?s.join(""):s}`);const a=this.bundleCache.get(t)?.contents[o];return a||this.logService.warn(`[ExtHostLocalization] Using default string since no string found in i18n bundle that has the key: ${o}`),ob(a??r,n??{})}getBundle(t){return this.bundleCache.get(t)?.contents}getBundleUri(t){return this.bundleCache.get(t)?.uri}async initializeLocalizedMessages(t){if(this.logService.info(`[ExtHostLocalization] Initializing localized messages for extension: ${t.identifier.value}, isBuiltin: ${t.isBuiltin}`),this.isDefaultLanguage||!t.l10n&&!t.isBuiltin){this.logService.info(`[ExtHostLocalization] Skipping localization for ${t.identifier.value}: using default language(${this.isDefaultLanguage}) or extension doesn't support localization(l10n: ${!!t.l10n}, isBuiltin: ${t.isBuiltin})`);return}if(this.bundleCache.has(t.identifier.value)){this.logService.info(`[ExtHostLocalization] Bundle already cached for extension: ${t.identifier.value}`);return}let i;this.logService.info(`[ExtHostLocalization] Getting bundle location for extension: ${t.identifier.value}`);const r=await this.getBundleLocation(t);if(!r){this.logService.error(`[ExtHostLocalization] No bundle location found for extension ${t.identifier.value}`);return}this.logService.info(`[ExtHostLocalization] Bundle location for ${t.identifier.value}: ${r.toString()}`);try{this.logService.info(`[ExtHostLocalization] Fetching bundle contents for ${t.identifier.value} from ${r.toString()}`);const n=await this._proxy.$fetchBundleContents(r);this.logService.info(`[ExtHostLocalization] Bundle content received for ${t.identifier.value}, parsing JSON`);const s=JSON.parse(n);t.identifier.value==="Tencent-Cloud.coding-copilot"?(this.logService.info(`[ExtHostLocalization] Using simple format for ${t.identifier.value}`),i=s):i=t.isBuiltin?s.contents?.bundle:s,this.logService.info(`[ExtHostLocalization] Bundle parsed successfully for ${t.identifier.value}, keys count: ${i?Object.keys(i).length:0}`)}catch(n){this.logService.error(`[ExtHostLocalization] Failed to load translations for ${t.identifier.value} from ${r}: ${n.message}`),this.logService.error(`[ExtHostLocalization] Error stack: ${n.stack}`);return}i?(this.logService.info(`[ExtHostLocalization] Caching bundle for ${t.identifier.value}`),this.bundleCache.set(t.identifier.value,{contents:i,uri:r})):this.logService.warn(`[ExtHostLocalization] No contents found in bundle for ${t.identifier.value}`)}async getBundleLocation(t){if(this.logService.info(`[ExtHostLocalization] Getting bundle location for ${t.identifier.value}, isBuiltin: ${t.isBuiltin}`),t.identifier.value==="Tencent-Cloud.coding-copilot"&&t.l10n){const i=y.joinPath(t.extensionLocation,t.l10n,`bundle.l10n.${this.currentLanguage}.json`);return this.logService.info(`[ExtHostLocalization] Using extension's own l10n for ${t.identifier.value}: ${i.toString()}`),i}if(t.isBuiltin){this.logService.info(`[ExtHostLocalization] Fetching built-in bundle URI for ${t.identifier.value}, language: ${this.currentLanguage}`);const i=await this._proxy.$fetchBuiltInBundleUri(t.identifier.value,this.currentLanguage),r=y.revive(i);return this.logService.info(`[ExtHostLocalization] Built-in bundle URI for ${t.identifier.value}: ${r?r.toString():"undefined"}`),r}if(t.l10n){const i=y.joinPath(t.extensionLocation,t.l10n,`bundle.l10n.${this.currentLanguage}.json`);return this.logService.info(`[ExtHostLocalization] Extension bundle path for ${t.identifier.value}: ${i.toString()}`),i}this.logService.info(`[ExtHostLocalization] No l10n property found for extension ${t.identifier.value}`)}};W_=__decorate([__param(0,Yt),__param(1,Ue),__param(2,qe)],W_);var V_=U("IExtHostLocalizationService"),z_=U("IExtHostManagedSockets"),q_=class{constructor(t){this._remoteSocketIdCounter=0,this._factory=null,this._managedRemoteSockets=new Map,this._proxy=t.getProxy(W.MainThreadManagedSockets)}setFactory(t,i){for(const r of this._managedRemoteSockets.values())r.dispose();this._factory&&this._proxy.$unregisterSocketFactory(this._factory.socketFactoryId),this._factory=new CN(t,i),this._proxy.$registerSocketFactory(this._factory.socketFactoryId)}async $openRemoteSocket(t){if(!this._factory||this._factory.socketFactoryId!==t)throw new Error(`No socket factory with id ${t}`);const i=++this._remoteSocketIdCounter,r=await this._factory.makeConnection(),n=new he;return this._managedRemoteSockets.set(i,new DN(i,r,n)),n.add(ne(()=>this._managedRemoteSockets.delete(i))),n.add(r.onDidEnd(()=>{this._proxy.$onDidManagedSocketEnd(i),n.dispose()})),n.add(r.onDidClose(s=>{this._proxy.$onDidManagedSocketClose(i,s?.stack??s?.message),n.dispose()})),n.add(r.onDidReceiveMessage(s=>this._proxy.$onDidManagedSocketHaveData(i,ae.wrap(s)))),i}$remoteSocketWrite(t,i){this._managedRemoteSockets.get(t)?.actual.send(i.buffer)}$remoteSocketEnd(t){const i=this._managedRemoteSockets.get(t);i&&(i.actual.end(),i.dispose())}async $remoteSocketDrain(t){await this._managedRemoteSockets.get(t)?.actual.drain?.()}};q_=__decorate([__param(0,Ue)],q_);var CN=class{constructor(e,t){this.socketFactoryId=e,this.makeConnection=t}},DN=class extends se{constructor(e,t,i){super(),this.socketId=e,this.actual=t,this._register(i)}},j_,bI=U("IHostUtils"),G_=j_=class extends se{constructor(t,i,r,n,s,o,a,l,c,u,d,f,p){super(),this._extHostManagedSockets=f,this._extHostLanguageModels=p,this._onDidChangeRemoteConnectionData=this._register(new P),this.onDidChangeRemoteConnectionData=this._onDidChangeRemoteConnectionData.event,this._realPathCache=new Map,this._isTerminating=!1,this._hostUtils=i,this._extHostContext=r,this._initData=a,this._extHostWorkspace=n,this._extHostConfiguration=s,this._logService=o,this._extHostTunnelService=c,this._extHostTerminalService=u,this._extHostLocalizationService=d,this._mainThreadWorkspaceProxy=this._extHostContext.getProxy(W.MainThreadWorkspace),this._mainThreadTelemetryProxy=this._extHostContext.getProxy(W.MainThreadTelemetry),this._mainThreadExtensionsProxy=this._extHostContext.getProxy(W.MainThreadExtensionService),this._almostReadyToRunExtensions=new Cr,this._readyToStartExtensionHost=new Cr,this._readyToRunExtensions=new Cr,this._eagerExtensionsActivated=new Cr,this._activationEventsReader=new kN(this._initData.extensions.activationEvents),this._globalRegistry=new Bc(this._activationEventsReader,this._initData.extensions.allExtensions);const m=new vs(this._initData.extensions.myExtensions);this._myRegistry=new Bc(this._activationEventsReader,EI(this._globalRegistry,m)),ds&&(this._logService.info(`Creating extension host with the following global extensions: ${Ba(this._globalRegistry)}`),this._logService.info(`Creating extension host with the following local extensions: ${Ba(this._myRegistry)}`)),this._storage=new AD(this._extHostContext,this._logService),this._secretState=new yI(this._extHostContext),this._storagePath=l,this._instaService=this._store.add(t.createChild(new Xg([g_,this._storage],[B_,this._secretState]))),this._activator=this._register(new f_(this._myRegistry,this._globalRegistry,{onExtensionActivationError:(_,b,E)=>{this._mainThreadExtensionsProxy.$onExtensionActivationError(_,wo(b),E)},actualActivateExtension:async(_,b)=>{if(Bc.isHostExtension(_,this._myRegistry,this._globalRegistry))return await this._mainThreadExtensionsProxy.$activateExtension(_,b),new ML;const E=this._myRegistry.getExtensionDescription(_);return this._activateExtension(E,b)}},this._logService)),this._extensionPathIndex=null,this._resolvers=Object.create(null),this._started=!1,this._remoteConnectionData=this._initData.remote.connectionData}getRemoteConnectionData(){return this._remoteConnectionData}async initialize(){try{await this._beforeAlmostReadyToRunExtensions(),this._almostReadyToRunExtensions.open(),await this._extHostWorkspace.waitForInitializeCall(),di("code/extHost/ready"),this._readyToStartExtensionHost.open(),this._initData.autoStart&&this._startExtensionHost()}catch(t){Qt(t)}}async _deactivateAll(){this._storagePath.onWillDeactivateAll();let t=[];try{t=this._myRegistry.getAllExtensionDescriptions().map(s=>s.identifier).filter(s=>this.isActivated(s)).map(s=>this._deactivate(s))}catch{}await Promise.all(t)}terminate(t,i=0){if(this._isTerminating)return;this._isTerminating=!0,this._logService.info(`Extension host terminating: ${t}`),this._logService.flush(),this._extHostTerminalService.dispose(),this._activator.dispose(),Kp(n=>{this._logService.error(n)}),this._extHostContext.dispose();const r=this._deactivateAll();Promise.race([sr(5e3),r]).finally(()=>{this._hostUtils.pid?this._logService.info(`Extension host with pid ${this._hostUtils.pid} exiting with code ${i}`):this._logService.info(`Extension host exiting with code ${i}`),this._logService.flush(),this._logService.dispose(),this._hostUtils.exit(i)})}isActivated(t){return this._readyToRunExtensions.isOpen()?this._activator.isActivated(t):!1}async getExtension(t){const i=await this._mainThreadExtensionsProxy.$getExtension(t);return i&&{...i,identifier:new Oe(i.identifier.value),extensionLocation:y.revive(i.extensionLocation)}}_activateByEvent(t,i){return this._activator.activateByEvent(t,i)}_activateById(t,i){return this._activator.activateById(t,i)}activateByIdWithErrors(t,i){return this._activateById(t,i).then(()=>{const r=this._activator.getActivatedExtension(t);if(r.activationFailed)return Promise.reject(r.activationFailedError)})}getExtensionRegistry(){return this._readyToRunExtensions.wait().then(t=>this._myRegistry)}getExtensionExports(t){if(this._readyToRunExtensions.isOpen())return this._activator.getActivatedExtension(t).exports;try{return this._activator.getActivatedExtension(t).exports}catch{return null}}async _realPathExtensionUri(t){if(t.scheme===V.file&&this._hostUtils.fsRealpath){const i=t.fsPath;this._realPathCache.has(i)||this._realPathCache.set(i,this._hostUtils.fsRealpath(i));const r=await this._realPathCache.get(i);return y.file(r)}return t}async getExtensionPathIndex(){return this._extensionPathIndex||(this._extensionPathIndex=this._createExtensionPathIndex(this._myRegistry.getAllExtensionDescriptions()).then(t=>new IN(t))),this._extensionPathIndex}async _createExtensionPathIndex(t){const i=Rn.forUris(r=>gT.ignorePathCasing(r));return await Promise.all(t.map(async r=>{if(this._getEntryPoint(r)){const n=await this._realPathExtensionUri(r.extensionLocation);i.set(n,r)}})),i}_deactivate(t){let i=Promise.resolve(void 0);if(!this._readyToRunExtensions.isOpen()||!this._activator.isActivated(t))return i;const r=this._activator.getActivatedExtension(t);if(!r)return i;try{typeof r.module.deactivate=="function"&&(i=Promise.resolve(r.module.deactivate()).then(void 0,n=>(this._logService.error(n),Promise.resolve(void 0))))}catch(n){this._logService.error(`An error occurred when deactivating the extension '${t.value}':`),this._logService.error(n)}try{r.disposable.dispose()}catch(n){this._logService.error(`An error occurred when disposing the subscriptions for extension '${t.value}':`),this._logService.error(n)}return i}async _activateExtension(t,i){return this._initData.remote.isRemote?this._mainThreadExtensionsProxy.$onWillActivateExtension(t.identifier):await this._mainThreadExtensionsProxy.$onWillActivateExtension(t.identifier),this._doActivateExtension(t,i).then(r=>{const n=r.activationTimes;return this._mainThreadExtensionsProxy.$onDidActivateExtension(t.identifier,n.codeLoadingTime,n.activateCallTime,n.activateResolvedTime,i),this._logExtensionActivationTimes(t,i,"success",n),r},r=>{throw this._logExtensionActivationTimes(t,i,"failure"),r})}_logExtensionActivationTimes(t,i,r,n){const s=SI(t,i);this._mainThreadTelemetryProxy.$publicLog2("extensionActivationTimes",{...s,...n||{},outcome:r})}_doActivateExtension(t,i){const r=SI(t,i);this._mainThreadTelemetryProxy.$publicLog2("activatePlugin",r);const n=this._getEntryPoint(t);if(!n)return Promise.resolve(new NL(Bf.NONE));this._logService.info(`ExtensionService#_doActivateExtension ${t.identifier.value}, startup: ${i.startup}, activationEvent: '${i.activationEvent}'${t.identifier.value!==i.extensionId.value?`, root cause: ${i.extensionId.value}`:""}`),this._logService.flush();const s=this._isESM(t),o=new he,a=new h_(i.startup);return Promise.all([s?this._loadESMModule(t,Zt(t.extensionLocation,n),a):this._loadCommonJSModule(t,Zt(t.extensionLocation,n),a),this._loadExtensionContext(t,o)]).then(l=>(di(`code/extHost/willActivateExtension/${t.identifier.value}`),j_._callActivate(this._logService,t.identifier,l[0],l[1],o,a))).then(l=>(di(`code/extHost/didActivateExtension/${t.identifier.value}`),l))}_loadExtensionContext(t,i){const r=this._extHostLanguageModels.createLanguageModelAccessInformation(t),n=i.add(new OL(t,this._storage)),s=i.add(new RD(t.identifier.value,!1,this._storage)),o=i.add(new EN(t,this._secretState)),a=t.isUnderDevelopment?this._initData.environment.extensionTestsLocationURI?ma.Test:ma.Development:ma.Production,l=this._initData.remote.isRemote?zs.Workspace:zs.UI;return this._logService.trace(`ExtensionService#loadExtensionContext ${t.identifier.value}`),Promise.all([n.whenReady,s.whenReady,this._storagePath.whenReady]).then(()=>{const c=this;let u,d;const f=Ke(t,"ipc")?this._initData.messagePorts?.get(Oe.toKey(t.identifier)):void 0;return Object.freeze({globalState:n,workspaceState:s,secrets:o,subscriptions:[],get languageModelAccessInformation(){return r},get extensionUri(){return t.extensionLocation},get extensionPath(){return t.extensionLocation.fsPath},asAbsolutePath(p){return bg(t.extensionLocation.fsPath,p)},get storagePath(){return c._storagePath.workspaceValue(t)?.fsPath},get globalStoragePath(){return c._storagePath.globalValue(t).fsPath},get logPath(){return bg(c._initData.logsLocation.fsPath,t.identifier.value)},get logUri(){return y.joinPath(c._initData.logsLocation,t.identifier.value)},get storageUri(){return c._storagePath.workspaceValue(t)},get globalStorageUri(){return c._storagePath.globalValue(t)},get extensionMode(){return a},get extension(){return u===void 0&&(u=new zc(c,t.identifier,t,l,!1)),u},get extensionRuntime(){return N(t,"extensionRuntime"),c.extensionRuntime},get environmentVariableCollection(){return c._extHostTerminalService.getEnvironmentVariableCollection(t)},get messagePassingProtocol(){if(!d){if(!f)return;const p=ct.buffer(ct.fromDOMEventEmitter(f,"message",m=>m.data));f.start(),d={onDidReceiveMessage:p,postMessage:f.postMessage.bind(f)}}return d}})})}static _callActivate(t,i,r,n,s,o){return r=r||{activate:void 0,deactivate:void 0},this._callActivateOptional(t,i,r,n,o).then(a=>new Wf(!1,null,o.build(),r,a,ne(()=>{s.dispose(),zr(n.subscriptions)})))}static _callActivateOptional(t,i,r,n,s){if(typeof r.activate=="function")try{s.activateCallStart(),t.trace(`ExtensionService#_callActivateOptional ${i.value}`);const o=typeof global=="object"?global:self,a=r.activate.apply(o,[n]);return s.activateCallStop(),s.activateResolveStart(),Promise.resolve(a).then(l=>(s.activateResolveStop(),l))}catch(o){return Promise.reject(o)}else return Promise.resolve(r)}_activateOneStartupFinished(t,i){this._activateById(t.identifier,{startup:!1,extensionId:t.identifier,activationEvent:i}).then(void 0,r=>{this._logService.error(r)})}_activateAllStartupFinishedDeferred(t,i=0){const n=Date.now();Ny(()=>{for(let s=i;s<t.length;s+=1){const o=t[s];for(const a of o.activationEvents??[])if(a==="onStartupFinished")if(Date.now()-n>50){this._activateAllStartupFinishedDeferred(t,s);break}else this._activateOneStartupFinished(o,a)}})}_activateAllStartupFinished(){this._mainThreadExtensionsProxy.$setPerformanceMarks(eP()),this._extHostConfiguration.getConfigProvider().then(t=>{const i=t.getConfiguration("extensions.experimental").get("deferredStartupFinishedActivation"),r=this._myRegistry.getAllExtensionDescriptions();if(i)this._activateAllStartupFinishedDeferred(r);else for(const n of r)if(n.activationEvents)for(const s of n.activationEvents)s==="onStartupFinished"&&this._activateOneStartupFinished(n,s)})}_handleEagerExtensions(){const t=this._activateByEvent("*",!0).then(void 0,o=>{this._logService.error(o)});this._register(this._extHostWorkspace.onDidChangeWorkspace(o=>this._handleWorkspaceContainsEagerExtensions(o.added)));const i=this._extHostWorkspace.workspace?this._extHostWorkspace.workspace.folders:[],r=this._handleWorkspaceContainsEagerExtensions(i),n=this._handleRemoteResolverEagerExtensions(),s=Promise.all([n,t,r]).then(()=>{});return Promise.race([s,sr(1e4)]).then(()=>{this._activateAllStartupFinished()}),s}_handleWorkspaceContainsEagerExtensions(t){return t.length===0?Promise.resolve(void 0):Promise.all(this._myRegistry.getAllExtensionDescriptions().map(i=>this._handleWorkspaceContainsEagerExtension(t,i))).then(()=>{})}async _handleWorkspaceContainsEagerExtension(t,i){if(this.isActivated(i.identifier))return;const r=!this._initData.remote.isRemote&&!!this._initData.remote.authority,n={logService:this._logService,folders:t.map(o=>o.uri),forceUsingSearch:r||!this._hostUtils.fsExists,exists:o=>this._hostUtils.fsExists(o.fsPath),checkExists:(o,a,l)=>this._mainThreadWorkspaceProxy.$checkExists(o,a,l)},s=await bN(n,i);if(s)return this._activateById(i.identifier,{startup:!0,extensionId:i.identifier,activationEvent:s.activationEvent}).then(void 0,o=>this._logService.error(o))}async _handleRemoteResolverEagerExtensions(){if(this._initData.remote.authority)return this._activateByEvent(`onResolveRemoteAuthority:${this._initData.remote.authority}`,!1)}async $extensionTestsExecute(){await this._eagerExtensionsActivated.wait();try{return await this._doHandleExtensionTests()}catch(t){throw console.error(t),t}}async _doHandleExtensionTests(){const{extensionDevelopmentLocationURI:t,extensionTestsLocationURI:i}=this._initData.environment;if(!t||!i)throw new Error(h(2925,null));const r=(await this.getExtensionPathIndex()).findSubstr(i),s=await(this._isESM(r,i.path)?this._loadESMModule(null,i,new h_(!1)):this._loadCommonJSModule(null,i,new h_(!1)));if(!s||typeof s.run!="function")throw new Error(h(2926,null,i.toString()));return new Promise((o,a)=>{const l=(d,f)=>{d?(ds&&this._logService.error("Test runner called back with error",d),a(d)):(ds&&(f?this._logService.info(`Test runner called back with ${f} failures.`):this._logService.info("Test runner called back with successful outcome.")),o(typeof f=="number"&&f>0?1:0))},c=rr(i),u=s.run(c,l);u&&u.then&&u.then(()=>{ds&&this._logService.info("Test runner finished successfully."),o(0)}).catch(d=>{ds&&this._logService.error("Test runner finished with error",d),a(d instanceof Error&&d.stack?d.stack:String(d))})})}_startExtensionHost(){if(this._started)throw new Error("Extension host is already started!");return this._started=!0,this._readyToStartExtensionHost.wait().then(()=>this._readyToRunExtensions.open()).then(()=>Promise.race([this._activator.waitForActivatingExtensions(),sr(1e3)])).then(()=>this._handleEagerExtensions()).then(()=>{this._eagerExtensionsActivated.open(),this._logService.info("Eager extensions activated")})}registerRemoteAuthorityResolver(t,i){return this._resolvers[t]=i,ne(()=>{delete this._resolvers[t]})}async getRemoteExecServer(t){const{resolver:i}=await this._activateAndGetResolver(t);return i?.resolveExecServer?.(t,{resolveAttempt:0})}async _activateAndGetResolver(t){const i=t.indexOf("+");if(i===-1)throw new Xo("Not an authority that can be resolved!",nn.InvalidAuthority);const r=t.substr(0,i);return await this._almostReadyToRunExtensions.wait(),await this._activateByEvent(`onResolveRemoteAuthority:${r}`,!1),{authorityPrefix:r,resolver:this._resolvers[r]}}async $resolveAuthority(t,i){const r=us.create(!1),n=()=>`[resolveAuthority(${l4(t)},${i})][${r.elapsed()}ms] `,s=C=>this._logService.info(`${n()}${C}`),o=C=>this._logService.warn(`${n()}${C}`),a=(C,T=void 0)=>this._logService.error(`${n()}${C}`,T),l=C=>{if(C instanceof Xo)return{type:"error",error:{code:C._code,message:C._message,detail:C._detail}};throw C},c=async C=>{s(`activating resolver for ${C}...`);const{resolver:T,authorityPrefix:j}=await this._activateAndGetResolver(C);if(!T)throw a(`no resolver for ${j}`),new Xo(`No remote extension installed to resolve ${j}.`,nn.NoResolverFound);return{resolver:T,authorityPrefix:j,remoteAuthority:C}},u=t.split(/@|%40/g).reverse();s(`activating remote resolvers ${u.join(" -> ")}`);let d;try{d=await Promise.all(u.map(c)).catch(async C=>{if(!(C instanceof Xo)||C._code!==nn.InvalidAuthority)throw C;return o(`resolving nested authorities failed: ${C.message}`),[await c(t)]})}catch(C){return l(C)}const f=new RT;f.cancelAndSet(()=>s("waiting..."),1e3);let p,m;for(const[C,{authorityPrefix:T,resolver:j,remoteAuthority:M}]of d.entries())try{if(C===d.length-1)s("invoking final resolve()..."),di(`code/extHost/willResolveAuthority/${T}`),p=await j.resolve(M,{resolveAttempt:i,execServer:m}),di(`code/extHost/didResolveAuthorityOK/${T}`),s("setting tunnel factory..."),this._register(await this._extHostTunnelService.setTunnelFactory(j,eh.isManagedResolvedAuthority(p)?p:void 0));else{if(s(`invoking resolveExecServer() for ${M}`),di(`code/extHost/willResolveExecServer/${T}`),m=await j.resolveExecServer?.(M,{resolveAttempt:i,execServer:m}),!m)throw new Xo(`Exec server was not available for ${M}`,nn.NoResolverFound);di(`code/extHost/didResolveExecServerOK/${T}`)}}catch(B){return di(`code/extHost/didResolveAuthorityError/${T}`),a("returned an error",B),f.dispose(),l(B)}f.dispose();const _={environmentTunnels:p.environmentTunnels,features:p.tunnelFeatures?{elevation:p.tunnelFeatures.elevation,privacyOptions:p.tunnelFeatures.privacyOptions,protocol:p.tunnelFeatures.protocol===void 0?!0:p.tunnelFeatures.protocol}:void 0},b={extensionHostEnv:p.extensionHostEnv,isTrusted:p.isTrusted,authenticationSession:p.authenticationSessionForInitializingExtensions?{id:p.authenticationSessionForInitializingExtensions.id,providerId:p.authenticationSessionForInitializingExtensions.providerId}:void 0};s(`returned ${eh.isManagedResolvedAuthority(p)?"managed authority":`${p.host}:${p.port}`}`);let E;if(eh.isManagedResolvedAuthority(p)){const C=i;this._extHostManagedSockets.setFactory(C,p.makeConnection),E={authority:t,connectTo:new u2(C),connectionToken:p.connectionToken}}else E={authority:t,connectTo:new d2(p.host,p.port),connectionToken:p.connectionToken};return{type:"ok",value:{authority:E,options:b,tunnelInformation:_}}}async $getCanonicalURI(t,i){this._logService.info(`$getCanonicalURI invoked for authority (${l4(t)})`);const{resolver:r}=await this._activateAndGetResolver(t);if(!r)return null;const n=y.revive(i);if(typeof r.getCanonicalURI>"u")return n;const s=await Kt(()=>r.getCanonicalURI(n));return s||n}async $startExtensionHost(t){t.toAdd.forEach(o=>o.extensionLocation=y.revive(o.extensionLocation));const{globalRegistry:i,myExtensions:r}=xI(this._activationEventsReader,this._globalRegistry,this._myRegistry,t),n=await this._createExtensionPathIndex(r);return(await this.getExtensionPathIndex()).setSearchTree(n),this._globalRegistry.set(i.getAllExtensionDescriptions()),this._myRegistry.set(r),ds&&(this._logService.info(`$startExtensionHost: global extensions: ${Ba(this._globalRegistry)}`),this._logService.info(`$startExtensionHost: local extensions: ${Ba(this._myRegistry)}`)),this._startExtensionHost()}$activateByEvent(t,i){return i===1?this._almostReadyToRunExtensions.wait().then(r=>this._activateByEvent(t,!1)):this._readyToRunExtensions.wait().then(r=>this._activateByEvent(t,!1))}async $activate(t,i){return await this._readyToRunExtensions.wait(),this._myRegistry.getExtensionDescription(t)?(await this._activateById(t,i),!0):!1}async $deltaExtensions(t){t.toAdd.forEach(o=>o.extensionLocation=y.revive(o.extensionLocation));const{globalRegistry:i,myExtensions:r}=xI(this._activationEventsReader,this._globalRegistry,this._myRegistry,t),n=await this._createExtensionPathIndex(r);return(await this.getExtensionPathIndex()).setSearchTree(n),this._globalRegistry.set(i.getAllExtensionDescriptions()),this._myRegistry.set(r),ds&&(this._logService.info(`$deltaExtensions: global extensions: ${Ba(this._globalRegistry)}`),this._logService.info(`$deltaExtensions: local extensions: ${Ba(this._myRegistry)}`)),Promise.resolve(void 0)}async $test_latency(t){return t}async $test_up(t){return t.byteLength}async $test_down(t){const i=ae.alloc(t),r=Math.random()%256;for(let n=0;n<t;n++)i.writeUInt8(r,n);return i}async $updateRemoteConnectionData(t){this._remoteConnectionData=t,this._onDidChangeRemoteConnectionData.fire()}_isESM(t,i){return i??=t?.main,i?.endsWith(".mjs")||t?.type==="module"&&!i?.endsWith(".cjs")}};G_=j_=__decorate([__param(0,gl),__param(1,bI),__param(2,Ue),__param(3,hn),__param(4,fn),__param(5,qe),__param(6,Yt),__param(7,v_),__param(8,x_),__param(9,Ha),__param(10,V_),__param(11,z_),__param(12,L_)],G_);function xI(e,t,i,r){e.addActivationEvents(r.addActivationEvents);const n=new Bc(e,t.getAllExtensionDescriptions());n.deltaExtensions(r.toAdd,r.toRemove);const s=new vs(i.getAllExtensionDescriptions().map(a=>a.identifier));for(const a of r.myToRemove)s.delete(a);for(const a of r.myToAdd)s.add(a);const o=EI(n,s);return{globalRegistry:n,myExtensions:o}}function SI(e,t){return{id:e.identifier.value,name:e.name,extensionVersion:e.version,publisherDisplayName:e.publisher,activationEvents:e.activationEvents?e.activationEvents.join(","):null,isBuiltin:e.isBuiltin,reason:t.activationEvent,reasonId:t.extensionId.value}}function Ba(e){return e.getAllExtensionDescriptions().map(t=>t.identifier.value).join(",")}var Yn=U("IExtHostExtensionService"),zc=class{#e;#t;#i;constructor(e,t,i,r,n){this.#e=e,this.#t=t,this.#i=i.identifier,this.id=i.identifier.value,this.extensionUri=i.extensionLocation,this.extensionPath=ko(rr(i.extensionLocation)),this.packageJSON=i,this.extensionKind=r,this.isFromDifferentExtensionHost=n}get isActive(){return this.#e.isActivated(this.#i)}get exports(){if(!(this.packageJSON.api==="none"||this.isFromDifferentExtensionHost))return this.#e.getExtensionExports(this.#i)}async activate(){if(this.isFromDifferentExtensionHost)throw new Error("Cannot activate foreign extension");return await this.#e.activateByIdWithErrors(this.#i,{startup:!1,extensionId:this.#t,activationEvent:"api"}),this.exports}};function EI(e,t){return e.getAllExtensionDescriptions().filter(i=>t.has(i.identifier))}var IN=class{constructor(e){this._searchTree=e}setSearchTree(e){this._searchTree=e}findSubstr(e){return this._searchTree.findSubstr(e)}forEach(e){return this._searchTree.forEach(e)}},kN=class{constructor(e){this._map=new Xr,this.addActivationEvents(e)}readActivationEvents(e){return this._map.get(e.identifier)??[]}addActivationEvents(e){for(const t of Object.keys(e))this._map.set(t,e[t])}},CI=class{static async installEarlyHandler(e){Error.stackTraceLimit=100;const t=e.get(qe),r=e.get(Ue).getProxy(W.MainThreadErrors);Kp(n=>{t.error(n);const s=wo(n);r.$onUnexpectedError(s)})}static async installFullHandler(e){const t=e.get(qe),i=e.get(Ue),r=e.get(Yn),n=e.get(qf),s=i.getProxy(W.MainThreadExtensionService),o=i.getProxy(W.MainThreadErrors),a=await r.getExtensionPathIndex(),l=new WeakMap;function c(f,p){if(l.has(f))return l.get(f).stack;let m="",_,b;for(const C of p)m+=`
	at ${C.toString()}`,b=C.getFileName(),!_&&b&&(_=a.findSubstr(y.file(b)));const E=`${f.name||"Error"}: ${f.message||""}${m}`;return l.set(f,{extensionIdentifier:_?.identifier,stack:E}),E}const u=Symbol("prepareStackTrace wrapped");let d=c;Object.defineProperty(Error,"prepareStackTrace",{configurable:!1,get(){return d},set(f){if(f===c||!f||f[u]){d=f||c;return}d=function(p,m){return c(p,m),f.call(Error,p,m)},Object.assign(d,{[u]:!0})}}),Kp(f=>{t.error(f);const p=wo(f);let m;if(f instanceof Gb?m=f.extension:m=l.get(f)?.extensionIdentifier,m){s.$onExtensionRuntimeError(m,p);const _=n.onExtensionError(m,f);t.trace("forwarded error to extension?",_,m)}}),tl.addListener(f=>{o.$onUnexpectedError(f)})}},PN=class o7{constructor(t,i,r,n,s){this._hostUtils=r,this._rpcProtocol=new BT(t,null,n),i=o7._transform(i,this._rpcProtocol);const o=new Xg(...f8());o.set(Yt,{_serviceBrand:void 0,...i,messagePorts:s}),o.set(Ue,new v8(this._rpcProtocol)),o.set(id,new _8(n)),o.set(bI,r);const a=new m8(o,!0);a.invokeFunction(CI.installEarlyHandler),this._logService=a.invokeFunction(l=>l.get(qe)),di("code/extHost/didCreateServices"),this._hostUtils.pid?this._logService.info(`Extension host with pid ${this._hostUtils.pid} started`):this._logService.info("Extension host started"),this._logService.trace("initData",i),this._extensionService=a.invokeFunction(l=>l.get(Yn)),this._extensionService.initialize(),a.invokeFunction(CI.installFullHandler)}async asBrowserUri(t){const i=this._rpcProtocol.getProxy(W.MainThreadExtensionService);return y.revive(await i.$asBrowserUri(t))}terminate(t){this._extensionService.terminate(t)}static _transform(t,i){t.extensions.allExtensions.forEach(n=>{n.extensionLocation=y.revive(i.transformIncomingURIs(n.extensionLocation))}),t.environment.appRoot=y.revive(i.transformIncomingURIs(t.environment.appRoot));const r=t.environment.extensionDevelopmentLocationURI;return r&&(t.environment.extensionDevelopmentLocationURI=r.map(n=>y.revive(i.transformIncomingURIs(n)))),t.environment.extensionTestsLocationURI=y.revive(i.transformIncomingURIs(t.environment.extensionTestsLocationURI)),t.environment.globalStorageHome=y.revive(i.transformIncomingURIs(t.environment.globalStorageHome)),t.environment.workspaceStorageHome=y.revive(i.transformIncomingURIs(t.environment.workspaceStorageHome)),t.nlsBaseUrl=y.revive(i.transformIncomingURIs(t.nlsBaseUrl)),t.logsLocation=y.revive(i.transformIncomingURIs(t.logsLocation)),t.workspace=i.transformIncomingURIs(t.workspace),t}},TN=function(t){const i=r=>{globalThis.removeEventListener("message",i);const n=r.data;Object.defineProperties(globalThis,{postMessage:{value(s,o){n.postMessage(s,o)}},onmessage:{get(){return n.onmessage},set(s){n.onmessage=s}}}),n.addEventListener("message",s=>{globalThis.dispatchEvent(new MessageEvent("message",{data:s.data,ports:s.ports?[...s.ports]:void 0}))}),n.start(),globalThis.Worker=class{constructor(){throw new TypeError("Nested workers from within nested worker are NOT supported.")}},importScripts(t)};globalThis.addEventListener("message",i)}.toString(),AN=class extends EventTarget{constructor(e,t,i){super(),this.onmessage=null,this.onmessageerror=null,this.onerror=null;const r=`((${TN})('${t}'))`,n=new Blob([r],{type:"application/javascript"}),s=URL.createObjectURL(n),o=new MessageChannel,a=s,l={type:"_newWorker",id:a,port:o.port2,url:s,options:i};e(l,[o.port2]),this.postMessage=o.port1.postMessage.bind(o.port1),this.terminate=()=>{e({type:"_terminateWorker",id:a}),URL.revokeObjectURL(s),o.port1.close(),o.port2.close()},Object.defineProperties(this,{onmessage:{get(){return o.port1.onmessage},set(c){o.port1.onmessage=c}},onmessageerror:{get(){return o.port1.onmessageerror},set(c){o.port1.onmessageerror=c}}}),o.port1.addEventListener("messageerror",c=>{const u=new MessageEvent("messageerror",{data:c.data});this.dispatchEvent(u)}),o.port1.addEventListener("message",c=>{const u=new MessageEvent("message",{data:c.data});this.dispatchEvent(u)}),o.port1.start()}},_q=new I("inOutput",!1),wq=new I("activeLogOutput",!1),yq=new I("activeLogOutput.isLog",!1),bq=new I("activeLogOutput.levelSettable",!1),xq=new I("activeLogOutput.level",""),Sq=new I("activeLogOutput.levelIsDefault",!1),Eq=new I("outputView.scrollLock",!1),Cq=new I("activeOutputChannel",""),Dq=new I("output.filter.trace",!0),Iq=new I("output.filter.debug",!0),kq=new I("output.filter.info",!0),Pq=new I("output.filter.warning",!0),Tq=new I("output.filter.error",!0),Aq=new I("outputFilterFocus",!1),Rq=new I("output.filter.categories",""),Lq=U("outputService"),qc;(function(e){e[e.Append=1]="Append",e[e.Replace=2]="Replace",e[e.Clear=3]="Clear"})(qc||(qc={}));var RN={OutputChannels:"workbench.contributions.outputChannels"};function LN(e){return Array.isArray(e.source)}var NN=class extends se{constructor(){super(...arguments),this.channels=new Map,this._onDidRegisterChannel=this._register(new P),this.onDidRegisterChannel=this._onDidRegisterChannel.event,this._onDidRemoveChannel=this._register(new P),this.onDidRemoveChannel=this._onDidRemoveChannel.event,this._onDidUpdateChannelFiles=this._register(new P),this.onDidUpdateChannelSources=this._onDidUpdateChannelFiles.event}registerChannel(e){this.channels.has(e.id)||(this.channels.set(e.id,e),this._onDidRegisterChannel.fire(e.id))}getChannels(){const e=[];return this.channels.forEach(t=>e.push(t)),e}getChannel(e){return this.channels.get(e)}updateChannelSources(e,t){const i=this.channels.get(e);i&&LN(i)&&(i.source=t,this._onDidUpdateChannelFiles.fire(i))}removeChannel(e){const t=this.channels.get(e);t&&(this.channels.delete(e),this._onDidRemoveChannel.fire(t))}};Ht.add(RN.OutputChannels,new NN);var DI=class extends cx{constructor(e,t,i,r,n){super(),this.id=e,this.name=t,this.logger=i,this.proxy=r,this.extension=n,this.offset=0,this.visible=!1,this.setLevel(i.getLevel()),this._register(i.onDidChangeLogLevel(s=>this.setLevel(s))),this._register(ne(()=>this.proxy.$dispose(this.id)))}get logLevel(){return this.getLevel()}appendLine(e){this.append(e+`
`)}append(e){this.info(e)}clear(){const e=this.offset;this.logger.flush(),this.proxy.$update(this.id,qc.Clear,e)}replace(e){const t=this.offset;this.info(e),this.proxy.$update(this.id,qc.Replace,t),this.visible&&this.logger.flush()}show(e,t){this.logger.flush(),this.proxy.$reveal(this.id,!!(typeof e=="boolean"?e:t))}hide(){this.proxy.$close(this.id)}log(e,t){this.offset+=ae.fromString(t).byteLength,l8(this.logger,e,t),this.visible&&(this.logger.flush(),this.proxy.$update(this.id,qc.Append))}},MN=class extends DI{appendLine(e){this.append(e)}},Q_=class{constructor(t,i,r,n,s,o){this.initData=i,this.extHostFileSystem=r,this.extHostFileSystemInfo=n,this.loggerService=s,this.logService=o,this.extensionLogDirectoryPromise=new Map,this.namePool=1,this.channels=new Map,this.visibleChannelId=null,this.proxy=t.getProxy(W.MainThreadOutputService),this.outputsLocation=this.extHostFileSystemInfo.extUri.joinPath(i.logsLocation,`output_logging_${rN(new Date).replace(/-|:|\.\d+Z$/g,"")}`)}$setVisibleChannel(t){this.visibleChannelId=t;for(const[i,r]of this.channels)r.visible=i===this.visibleChannelId}createOutputChannel(t,i,r){if(t=t.trim(),!t)throw new Error("illegal argument `name`. must not be falsy");const n=typeof i=="object"&&i.log,s=Me(i)?i:void 0;if(Me(s)&&!s.trim())throw new Error("illegal argument `languageId`. must not be empty");let o;const a=this.initData.environment.extensionLogLevel?.find(([u])=>Oe.equals(r.identifier,u))?.[1];a&&(o=h8(a));const l=new he,c=n?this.doCreateLogOutputChannel(t,o,r,l):this.doCreateOutputChannel(t,s,r,l);return c.then(u=>{this.channels.set(u.id,u),u.visible=u.id===this.visibleChannelId,l.add(ne(()=>this.channels.delete(u.id)))}),n?this.createExtHostLogOutputChannel(t,o??this.logService.getLevel(),c,l):this.createExtHostOutputChannel(t,c,l)}async doCreateOutputChannel(t,i,r,n){this.outputDirectoryPromise||(this.outputDirectoryPromise=this.extHostFileSystem.value.createDirectory(this.outputsLocation).then(()=>this.outputsLocation));const s=await this.outputDirectoryPromise,o=this.extHostFileSystemInfo.extUri.joinPath(s,`${this.namePool++}-${t.replace(/[\\/:\*\?"<>\|]/g,"")}.log`),a=n.add(this.loggerService.createLogger(o,{logLevel:"always",donotRotate:!0,donotUseFormatters:!0,hidden:!0})),l=await this.proxy.$register(t,o,i,r.identifier.value);return n.add(ne(()=>this.loggerService.deregisterLogger(o))),new DI(l,t,a,this.proxy,r)}async doCreateLogOutputChannel(t,i,r,n){const s=await this.createExtensionLogDirectory(r),o=t.replace(/[\\/:\*\?"<>\|]/g,""),a=this.extHostFileSystemInfo.extUri.joinPath(s,`${o}.log`),l=`${r.identifier.value}.${o}`,c=n.add(this.loggerService.createLogger(a,{id:l,name:t,logLevel:i,extensionId:r.identifier.value}));return n.add(ne(()=>this.loggerService.deregisterLogger(a))),new MN(l,t,c,this.proxy,r)}createExtensionLogDirectory(t){let i=this.extensionLogDirectoryPromise.get(t.identifier.value);if(!i){const r=t.identifier.value.replace(/[\\/:\*\?"<>\|]/g,"_"),n=this.extHostFileSystemInfo.extUri.joinPath(this.initData.logsLocation,r);this.extensionLogDirectoryPromise.set(t.identifier.value,i=(async()=>{try{await this.extHostFileSystem.value.createDirectory(n)}catch(s){if(md(s)!==_e.FileExists)throw s}return n})())}return i}createExtHostOutputChannel(t,i,r){const n=()=>{if(r.isDisposed)throw new Error("Channel has been closed")};return i.then(s=>r.add(s)),{get name(){return t},append(s){n(),i.then(o=>o.append(s))},appendLine(s){n(),i.then(o=>o.appendLine(s))},clear(){n(),i.then(s=>s.clear())},replace(s){n(),i.then(o=>o.replace(s))},show(s,o){n(),i.then(a=>a.show(s,o))},hide(){n(),i.then(s=>s.hide())},dispose(){r.dispose()}}}createExtHostLogOutputChannel(t,i,r,n){const s=()=>{if(n.isDisposed)throw new Error("Channel has been closed")},o=n.add(new P);function a(l){i=l,o.fire(l)}return r.then(l=>{l.logLevel!==i&&a(l.logLevel),n.add(l.onDidChangeLogLevel(c=>a(c)))}),{...this.createExtHostOutputChannel(t,r,n),get logLevel(){return i},onDidChangeLogLevel:o.event,trace(l,...c){s(),r.then(u=>u.trace(l,...c))},debug(l,...c){s(),r.then(u=>u.debug(l,...c))},info(l,...c){s(),r.then(u=>u.info(l,...c))},warn(l,...c){s(),r.then(u=>u.warn(l,...c))},error(l,...c){s(),r.then(u=>u.error(l,...c))}}}};Q_=__decorate([__param(0,Ue),__param(1,Yt),__param(2,zf),__param(3,Oo),__param(4,xl),__param(5,qe)],Q_);var II=U("IExtHostOutputService"),jc,J_=class{static{jc=this}static{this._handlePool=0}static{this._maxEventSize=250}constructor(t,i){this._logService=i,this._provider=new Map,this._proxy=t.getProxy(W.MainThreadDecorations)}registerFileDecorationProvider(t,i){const r=jc._handlePool++;this._provider.set(r,{provider:t,extensionDescription:i}),this._proxy.$registerDecorationProvider(r,i.identifier.value);const n=t.onDidChangeFileDecorations&&t.onDidChangeFileDecorations(s=>{if(!s){this._proxy.$onDidChange(r,null);return}const o=Fi(s);if(o.length<=jc._maxEventSize){this._proxy.$onDidChange(r,o);return}this._logService.warn("[Decorations] CAPPING events from decorations provider",i.identifier.value,o.length);const a=o.map(u=>({uri:u,rank:OP(u.path,"/")})),l=s9(a,(u,d)=>u.rank-d.rank||gs(u.uri.path,d.uri.path)),c=[];e:for(const u of l){let d;for(const f of u){const p=Po(f.uri.path);if(d!==p&&(d=p,c.push(f.uri)>=jc._maxEventSize))break e}}this._proxy.$onDidChange(r,c)});return new Ce(()=>{n?.dispose(),this._proxy.$unregisterDecorationProvider(r),this._provider.delete(r)})}async $provideDecorations(t,i,r){if(!this._provider.has(t))return Object.create(null);const n=Object.create(null),{provider:s,extensionDescription:o}=this._provider.get(t);return await Promise.all(i.map(async a=>{try{const{uri:l,id:c}=a,u=await Promise.resolve(s.provideFileDecoration(y.revive(l),r));if(!u)return;try{Fv.validate(u),u.badge&&typeof u.badge!="string"&&N(o,"codiconDecoration"),n[c]=[u.propagate,u.tooltip,u.badge,u.color]}catch(d){this._logService.warn(`INVALID decoration from extension '${o.identifier.value}': ${d}`)}}catch(l){this._logService.error(l)}})),n}};J_=jc=__decorate([__param(0,Ue),__param(1,qe)],J_);var kI=U("IExtHostDecorations"),ON=class{constructor(e){this.values=e,this.prefixSum=new Uint32Array(e.length),this.prefixSumValidIndex=new Int32Array(1),this.prefixSumValidIndex[0]=-1}getCount(){return this.values.length}insertValues(e,t){e=Ua(e);const i=this.values,r=this.prefixSum,n=t.length;return n===0?!1:(this.values=new Uint32Array(i.length+n),this.values.set(i.subarray(0,e),0),this.values.set(i.subarray(e),e+n),this.values.set(t,e),e-1<this.prefixSumValidIndex[0]&&(this.prefixSumValidIndex[0]=e-1),this.prefixSum=new Uint32Array(this.values.length),this.prefixSumValidIndex[0]>=0&&this.prefixSum.set(r.subarray(0,this.prefixSumValidIndex[0]+1)),!0)}setValue(e,t){return e=Ua(e),t=Ua(t),this.values[e]===t?!1:(this.values[e]=t,e-1<this.prefixSumValidIndex[0]&&(this.prefixSumValidIndex[0]=e-1),!0)}removeValues(e,t){e=Ua(e),t=Ua(t);const i=this.values,r=this.prefixSum;if(e>=i.length)return!1;const n=i.length-e;return t>=n&&(t=n),t===0?!1:(this.values=new Uint32Array(i.length-t),this.values.set(i.subarray(0,e),0),this.values.set(i.subarray(e+t),e),this.prefixSum=new Uint32Array(this.values.length),e-1<this.prefixSumValidIndex[0]&&(this.prefixSumValidIndex[0]=e-1),this.prefixSumValidIndex[0]>=0&&this.prefixSum.set(r.subarray(0,this.prefixSumValidIndex[0]+1)),!0)}getTotalSum(){return this.values.length===0?0:this._getPrefixSum(this.values.length-1)}getPrefixSum(e){return e<0?0:(e=Ua(e),this._getPrefixSum(e))}_getPrefixSum(e){if(e<=this.prefixSumValidIndex[0])return this.prefixSum[e];let t=this.prefixSumValidIndex[0]+1;t===0&&(this.prefixSum[0]=this.values[0],t++),e>=this.values.length&&(e=this.values.length-1);for(let i=t;i<=e;i++)this.prefixSum[i]=this.prefixSum[i-1]+this.values[i];return this.prefixSumValidIndex[0]=Math.max(this.prefixSumValidIndex[0],e),this.prefixSum[e]}getIndexOf(e){e=Math.floor(e),this.getTotalSum();let t=0,i=this.values.length-1,r=0,n=0,s=0;for(;t<=i;)if(r=t+(i-t)/2|0,n=this.prefixSum[r],s=n-this.values[r],e<s)i=r-1;else if(e>=n)t=r+1;else break;return new FN(r,e-s)}},FN=class{constructor(e,t){this.index=e,this.remainder=t,this._prefixSumIndexOfResultBrand=void 0,this.index=e,this.remainder=t}},$N=class{constructor(e,t,i,r){this._uri=e,this._lines=t,this._eol=i,this._versionId=r,this._lineStarts=null,this._cachedTextValue=null}dispose(){this._lines.length=0}get version(){return this._versionId}getText(){return this._cachedTextValue===null&&(this._cachedTextValue=this._lines.join(this._eol)),this._cachedTextValue}onEvents(e){e.eol&&e.eol!==this._eol&&(this._eol=e.eol,this._lineStarts=null);const t=e.changes;for(const i of t)this._acceptDeleteRange(i.range),this._acceptInsertText(new Bi(i.range.startLineNumber,i.range.startColumn),i.text);this._versionId=e.versionId,this._cachedTextValue=null}_ensureLineStarts(){if(!this._lineStarts){const e=this._eol.length,t=this._lines.length,i=new Uint32Array(t);for(let r=0;r<t;r++)i[r]=this._lines[r].length+e;this._lineStarts=new ON(i)}}_setLineText(e,t){this._lines[e]=t,this._lineStarts&&this._lineStarts.setValue(e,this._lines[e].length+this._eol.length)}_acceptDeleteRange(e){if(e.startLineNumber===e.endLineNumber){if(e.startColumn===e.endColumn)return;this._setLineText(e.startLineNumber-1,this._lines[e.startLineNumber-1].substring(0,e.startColumn-1)+this._lines[e.startLineNumber-1].substring(e.endColumn-1));return}this._setLineText(e.startLineNumber-1,this._lines[e.startLineNumber-1].substring(0,e.startColumn-1)+this._lines[e.endLineNumber-1].substring(e.endColumn-1)),this._lines.splice(e.startLineNumber,e.endLineNumber-e.startLineNumber),this._lineStarts&&this._lineStarts.removeValues(e.startLineNumber,e.endLineNumber-e.startLineNumber)}_acceptInsertText(e,t){if(t.length===0)return;const i=lb(t);if(i.length===1){this._setLineText(e.lineNumber-1,this._lines[e.lineNumber-1].substring(0,e.column-1)+i[0]+this._lines[e.lineNumber-1].substring(e.column-1));return}i[i.length-1]+=this._lines[e.lineNumber-1].substring(e.column-1),this._setLineText(e.lineNumber-1,this._lines[e.lineNumber-1].substring(0,e.column-1)+i[0]);const r=new Uint32Array(i.length-1);for(let n=1;n<i.length;n++)this._lines.splice(e.lineNumber+n-1,0,i[n]),r[n-1]=i[n].length+this._eol.length;this._lineStarts&&this._lineStarts.insertValues(e.lineNumber,r)}},PI="`~!@#$%^&*()-=+[{]}\\|;:'\",.<>/?";function HN(e=""){let t="(-?\\d*\\.\\d\\w*)|([^";for(const i of PI)e.indexOf(i)>=0||(t+="\\"+i);return t+="\\s]+)",new RegExp(t,"g")}var UN=HN();function TI(e){let t=UN;if(e&&e instanceof RegExp)if(e.global)t=e;else{let i="g";e.ignoreCase&&(i+="i"),e.multiline&&(i+="m"),e.unicode&&(i+="u"),t=new RegExp(e.source,i)}return t.lastIndex=0,t}var AI=new Dn;AI.unshift({maxLen:1e3,windowSize:15,timeBudget:150});function RI(e,t,i,r,n){if(t=TI(t),n||(n=Jt.first(AI)),i.length>n.maxLen){let c=e-n.maxLen/2;return c<0?c=0:r+=c,i=i.substring(c,e+n.maxLen/2),RI(e,t,i,r,n)}const s=Date.now(),o=e-1-r;let a=-1,l=null;for(let c=1;!(Date.now()-s>=n.timeBudget);c++){const u=o-n.windowSize*c;t.lastIndex=Math.max(0,u);const d=BN(t,i,o,a);if(!d&&l||(l=d,u<=0))break;a=u}if(l){const c={word:l[0],startColumn:r+1+l.index,endColumn:r+1+l.index+l[0].length};return t.lastIndex=0,c}return null}function BN(e,t,i,r){let n;for(;n=e.exec(t);){const s=n.index||0;if(s<=i&&e.lastIndex>=i)return n;if(r>0&&s>r)return null}return null}var X_=new Map;function WN(e,t){t?X_.set(e,t):X_.delete(e)}function VN(e){return X_.get(e)}var zN=class extends $N{constructor(e,t,i,r,n,s,o,a){super(t,i,r,n),this._proxy=e,this._languageId=s,this._isDirty=o,this._encoding=a,this._isDisposed=!1}dispose(){si(!this._isDisposed),this._isDisposed=!0,this._isDirty=!1}equalLines(e){return Sr(this._lines,e)}get document(){if(!this._document){const e=this;this._document={get uri(){return e._uri},get fileName(){return e._uri.fsPath},get isUntitled(){return e._uri.scheme===V.untitled},get languageId(){return e._languageId},get version(){return e._versionId},get isClosed(){return e._isDisposed},get isDirty(){return e._isDirty},get encoding(){return e._encoding},save(){return e._save()},getText(t){return t?e._getTextInRange(t):e.getText()},get eol(){return e._eol===`
`?ur.LF:ur.CRLF},get lineCount(){return e._lines.length},lineAt(t){return e._lineAt(t)},offsetAt(t){return e._offsetAt(t)},positionAt(t){return e._positionAt(t)},validateRange(t){return e._validateRange(t)},validatePosition(t){return e._validatePosition(t)},getWordRangeAtPosition(t,i){return e._getWordRangeAtPosition(t,i)},[Symbol.for("debug.description")](){return`TextDocument(${e._uri.toString()})`}}}return Object.freeze(this._document)}_acceptLanguageId(e){si(!this._isDisposed),this._languageId=e}_acceptIsDirty(e){si(!this._isDisposed),this._isDirty=e}_acceptEncoding(e){si(!this._isDisposed),this._encoding=e}_save(){return this._isDisposed?Promise.reject(new Error("Document has been closed")):this._proxy.$trySaveDocument(this._uri)}_getTextInRange(e){const t=this._validateRange(e);if(t.isEmpty)return"";if(t.isSingleLine)return this._lines[t.start.line].substring(t.start.character,t.end.character);const i=this._eol,r=t.start.line,n=t.end.line,s=[];s.push(this._lines[r].substring(t.start.character));for(let o=r+1;o<n;o++)s.push(this._lines[o]);return s.push(this._lines[n].substring(0,t.end.character)),s.join(i)}_lineAt(e){let t;if(e instanceof Ie?t=e.line:typeof e=="number"&&(t=e),typeof t!="number"||t<0||t>=this._lines.length||Math.floor(t)!==t)throw new Error("Illegal value for `line`");return new qN(t,this._lines[t],t===this._lines.length-1)}_offsetAt(e){return e=this._validatePosition(e),this._ensureLineStarts(),this._lineStarts.getPrefixSum(e.line-1)+e.character}_positionAt(e){e=Math.floor(e),e=Math.max(0,e),this._ensureLineStarts();const t=this._lineStarts.getIndexOf(e),i=this._lines[t.index].length;return new Ie(t.index,Math.min(t.remainder,i))}_validateRange(e){if(!(e instanceof ye))throw new Error("Invalid argument");const t=this._validatePosition(e.start),i=this._validatePosition(e.end);return t===e.start&&i===e.end?e:new ye(t.line,t.character,i.line,i.character)}_validatePosition(e){if(!(e instanceof Ie))throw new Error("Invalid argument");if(this._lines.length===0)return e.with(0,0);let{line:t,character:i}=e,r=!1;if(t<0)t=0,i=0,r=!0;else if(t>=this._lines.length)t=this._lines.length-1,i=this._lines[t].length,r=!0;else{const n=this._lines[t].length;i<0?(i=0,r=!0):i>n&&(i=n,r=!0)}return r?new Ie(t,i):e}_getWordRangeAtPosition(e,t){const i=this._validatePosition(e);if(!t)t=VN(this._languageId);else if(ab(t))throw new Error(`[getWordRangeAtPosition]: ignoring custom regexp '${t.source}' because it matches the empty string.`);const r=RI(i.character+1,TI(t),this._lines[i.line],0);if(r)return new ye(i.line,r.startColumn-1,i.line,r.endColumn-1)}},qN=class{constructor(e,t,i){this._line=e,this._text=t,this._isLastLine=i}get lineNumber(){return this._line}get text(){return this._text}get range(){return new ye(this._line,0,this._line,this._text.length)}get rangeIncludingLineBreak(){return this._isLastLine?this.range:new ye(this._line,0,this._line+1,0)}get firstNonWhitespaceCharacterIndex(){return/^(\s*)/.exec(this._text)[1].length}get isEmptyOrWhitespace(){return this.firstNonWhitespaceCharacterIndex===this._text.length}},Qf=class{constructor(e){this._prefix=e,this._lastId=0}nextId(){return this._prefix+ ++this._lastId}},Oq=new Qf("id#"),jN=class a7{static{this._Keys=new Qf("TextEditorDecorationType")}constructor(t,i,r){const n=a7._Keys.nextId();t.$registerTextEditorDecorationType(i.identifier,n,m1.from(r)),this.value=Object.freeze({key:n,dispose(){t.$removeTextEditorDecorationType(n)}})}},GN=class{constructor(e,t){this._collectedEdits=[],this._setEndOfLine=void 0,this._finalized=!1,this._document=e,this._documentVersionId=e.version,this._undoStopBefore=t.undoStopBefore,this._undoStopAfter=t.undoStopAfter}finalize(){return this._finalized=!0,{documentVersionId:this._documentVersionId,edits:this._collectedEdits,setEndOfLine:this._setEndOfLine,undoStopBefore:this._undoStopBefore,undoStopAfter:this._undoStopAfter}}_throwIfFinalized(){if(this._finalized)throw new Error("Edit is only valid while callback runs")}replace(e,t){this._throwIfFinalized();let i=null;if(e instanceof Ie)i=new ye(e,e);else if(e instanceof ye)i=e;else throw new Error("Unrecognized location");this._pushEdit(i,t,!1)}insert(e,t){this._throwIfFinalized(),this._pushEdit(new ye(e,e),t,!0)}delete(e){this._throwIfFinalized();let t=null;if(e instanceof ye)t=e;else throw new Error("Unrecognized location");this._pushEdit(t,null,!0)}_pushEdit(e,t,i){const r=this._document.validateRange(e);this._collectedEdits.push({range:r,text:t,forceMoveMarkers:i})}setEndOfLine(e){if(this._throwIfFinalized(),e!==ur.LF&&e!==ur.CRLF)throw Se("endOfLine");this._setEndOfLine=e}},QN=class{constructor(e,t,i,r){this._proxy=e,this._id=t,this._accept(i),this._logService=r;const n=this;this.value={get tabSize(){return n._tabSize},set tabSize(s){n._setTabSize(s)},get indentSize(){return n._indentSize},set indentSize(s){n._setIndentSize(s)},get insertSpaces(){return n._insertSpaces},set insertSpaces(s){n._setInsertSpaces(s)},get cursorStyle(){return n._cursorStyle},set cursorStyle(s){n._setCursorStyle(s)},get lineNumbers(){return n._lineNumbers},set lineNumbers(s){n._setLineNumbers(s)}}}_accept(e){this._tabSize=e.tabSize,this._indentSize=e.indentSize,this._originalIndentSize=e.originalIndentSize,this._insertSpaces=e.insertSpaces,this._cursorStyle=e.cursorStyle,this._lineNumbers=Sa.to(e.lineNumbers)}_validateTabSize(e){if(e==="auto")return"auto";if(typeof e=="number"){const t=Math.floor(e);return t>0?t:null}if(typeof e=="string"){const t=parseInt(e,10);return isNaN(t)?null:t>0?t:null}return null}_setTabSize(e){const t=this._validateTabSize(e);if(t!==null){if(typeof t=="number"){if(this._tabSize===t)return;this._tabSize=t}this._warnOnError("setTabSize",this._proxy.$trySetOptions(this._id,{tabSize:t}))}}_validateIndentSize(e){if(e==="tabSize")return"tabSize";if(typeof e=="number"){const t=Math.floor(e);return t>0?t:null}if(typeof e=="string"){const t=parseInt(e,10);return isNaN(t)?null:t>0?t:null}return null}_setIndentSize(e){const t=this._validateIndentSize(e);if(t!==null){if(typeof t=="number"){if(this._originalIndentSize===t)return;this._indentSize=t,this._originalIndentSize=t}this._warnOnError("setIndentSize",this._proxy.$trySetOptions(this._id,{indentSize:t}))}}_validateInsertSpaces(e){return e==="auto"?"auto":e==="false"?!1:!!e}_setInsertSpaces(e){const t=this._validateInsertSpaces(e);if(typeof t=="boolean"){if(this._insertSpaces===t)return;this._insertSpaces=t}this._warnOnError("setInsertSpaces",this._proxy.$trySetOptions(this._id,{insertSpaces:t}))}_setCursorStyle(e){this._cursorStyle!==e&&(this._cursorStyle=e,this._warnOnError("setCursorStyle",this._proxy.$trySetOptions(this._id,{cursorStyle:e})))}_setLineNumbers(e){this._lineNumbers!==e&&(this._lineNumbers=e,this._warnOnError("setLineNumbers",this._proxy.$trySetOptions(this._id,{lineNumbers:Sa.from(e)})))}assign(e){const t={};let i=!1;if(typeof e.tabSize<"u"){const r=this._validateTabSize(e.tabSize);r==="auto"?(i=!0,t.tabSize=r):typeof r=="number"&&this._tabSize!==r&&(this._tabSize=r,i=!0,t.tabSize=r)}if(typeof e.indentSize<"u"){const r=this._validateIndentSize(e.indentSize);r==="tabSize"?(i=!0,t.indentSize=r):typeof r=="number"&&this._originalIndentSize!==r&&(this._indentSize=r,this._originalIndentSize=r,i=!0,t.indentSize=r)}if(typeof e.insertSpaces<"u"){const r=this._validateInsertSpaces(e.insertSpaces);r==="auto"?(i=!0,t.insertSpaces=r):this._insertSpaces!==r&&(this._insertSpaces=r,i=!0,t.insertSpaces=r)}typeof e.cursorStyle<"u"&&this._cursorStyle!==e.cursorStyle&&(this._cursorStyle=e.cursorStyle,i=!0,t.cursorStyle=e.cursorStyle),typeof e.lineNumbers<"u"&&this._lineNumbers!==e.lineNumbers&&(this._lineNumbers=e.lineNumbers,i=!0,t.lineNumbers=Sa.from(e.lineNumbers)),i&&this._warnOnError("setOptions",this._proxy.$trySetOptions(this._id,t))}_warnOnError(e,t){t.catch(i=>{this._logService.warn(`ExtHostTextEditorOptions '${e}' failed:'`),this._logService.warn(i)})}},JN=class{constructor(e,t,i,r,n,s,o,a){this.id=e,this._proxy=t,this._logService=i,this._disposed=!1,this._hasDecorationsForKey=new Set,this._selections=n,this._options=new QN(this._proxy,this.id,s,i),this._visibleRanges=o,this._viewColumn=a;const l=this;this.value=Object.freeze({get document(){return r.value},set document(c){throw new os("document")},get selection(){return l._selections&&l._selections[0]},set selection(c){if(!(c instanceof on))throw Se("selection");l._selections=[c],l._trySetSelection()},get selections(){return l._selections},set selections(c){if(!Array.isArray(c)||c.some(u=>!(u instanceof on)))throw Se("selections");l._selections=c,l._trySetSelection()},get visibleRanges(){return l._visibleRanges},set visibleRanges(c){throw new os("visibleRanges")},get diffInformation(){return l._diffInformation},get options(){return l._options.value},set options(c){l._disposed||l._options.assign(c)},get viewColumn(){return l._viewColumn},set viewColumn(c){throw new os("viewColumn")},edit(c,u={undoStopBefore:!0,undoStopAfter:!0}){if(l._disposed)return Promise.reject(new Error("TextEditor#edit not possible on closed editors"));const d=new GN(r.value,u);return c(d),l._applyEdit(d)},insertSnippet(c,u,d={undoStopBefore:!0,undoStopAfter:!0}){if(l._disposed)return Promise.reject(new Error("TextEditor#insertSnippet not possible on closed editors"));let f;if(!u||Array.isArray(u)&&u.length===0)f=l._selections.map(p=>F.from(p));else if(u instanceof Ie){const{lineNumber:p,column:m}=Be.from(u);f=[{startLineNumber:p,startColumn:m,endLineNumber:p,endColumn:m}]}else if(u instanceof ye)f=[F.from(u)];else{f=[];for(const p of u)if(p instanceof ye)f.push(F.from(p));else{const{lineNumber:m,column:_}=Be.from(p);f.push({startLineNumber:m,startColumn:_,endLineNumber:m,endColumn:_})}}return d.keepWhitespace===void 0&&(d.keepWhitespace=!1),t.$tryInsertSnippet(e,r.value.version,c.value,f,d)},setDecorations(c,u){const d=u.length===0;d&&!l._hasDecorationsForKey.has(c.key)||(d?l._hasDecorationsForKey.delete(c.key):l._hasDecorationsForKey.add(c.key),l._runOnProxy(()=>{if(J4(u))return t.$trySetDecorations(e,c.key,V2(u));{const f=new Array(4*u.length);for(let p=0,m=u.length;p<m;p++){const _=u[p];f[4*p]=_.start.line+1,f[4*p+1]=_.start.character+1,f[4*p+2]=_.end.line+1,f[4*p+3]=_.end.character+1}return t.$trySetDecorationsFast(e,c.key,f)}}))},revealRange(c,u){l._runOnProxy(()=>t.$tryRevealRange(e,F.from(c),u||dh.Default))},show(c){t.$tryShowEditor(e,Rt.from(c))},hide(){t.$tryHideEditor(e)},[Symbol.for("debug.description")](){return`TextEditor(${this.document.uri.toString()})`}})}dispose(){si(!this._disposed),this._disposed=!0}_acceptOptions(e){si(!this._disposed),this._options._accept(e)}_acceptVisibleRanges(e){si(!this._disposed),this._visibleRanges=e}_acceptViewColumn(e){si(!this._disposed),this._viewColumn=e}_acceptSelections(e){si(!this._disposed),this._selections=e}_acceptDiffInformation(e){si(!this._disposed),this._diffInformation=e}async _trySetSelection(){const e=this._selections.map(fr.from);return await this._runOnProxy(()=>this._proxy.$trySetSelections(this.id,e)),this.value}_applyEdit(e){const t=e.finalize();if(t.edits.length===0&&!t.setEndOfLine)return Promise.resolve(!0);const i=t.edits.map(n=>n.range);i.sort((n,s)=>n.end.line===s.end.line?n.end.character===s.end.character?n.start.line===s.start.line?n.start.character-s.start.character:n.start.line-s.start.line:n.end.character-s.end.character:n.end.line-s.end.line);for(let n=0,s=i.length-1;n<s;n++){const o=i[n].end;if(i[n+1].start.isBefore(o))return Promise.reject(new Error("Overlapping ranges are not allowed!"))}const r=t.edits.map(n=>({range:F.from(n.range),text:n.text,forceMoveMarkers:n.forceMoveMarkers}));return this._proxy.$tryApplyEdits(this.id,t.documentVersionId,r,{setEndOfLine:typeof t.setEndOfLine=="number"?Ea.from(t.setEndOfLine):void 0,undoStopBefore:t.undoStopBefore,undoStopAfter:t.undoStopAfter})}_runOnProxy(e){return this._disposed?(this._logService.warn("TextEditor is closed/disposed"),Promise.resolve(void 0)):e().then(()=>this,t=>(t instanceof Error&&t.name==="DISPOSED"||this._logService.warn(t),null))}},XN=class{constructor(e){this.value=e,this._count=0}ref(){this._count++}unref(){return--this._count===0}},Z_=class{constructor(t,i){this._extHostRpc=t,this._logService=i,this._activeEditorId=null,this._editors=new Map,this._documents=new Ft,this._onDidAddDocuments=new P,this._onDidRemoveDocuments=new P,this._onDidChangeVisibleTextEditors=new P,this._onDidChangeActiveTextEditor=new P,this.onDidAddDocuments=this._onDidAddDocuments.event,this.onDidRemoveDocuments=this._onDidRemoveDocuments.event,this.onDidChangeVisibleTextEditors=this._onDidChangeVisibleTextEditors.event,this.onDidChangeActiveTextEditor=this._onDidChangeActiveTextEditor.event}$acceptDocumentsAndEditorsDelta(t){this.acceptDocumentsAndEditorsDelta(t)}acceptDocumentsAndEditorsDelta(t){const i=[],r=[],n=[];if(t.removedDocuments)for(const s of t.removedDocuments){const o=y.revive(s),a=this._documents.get(o);a?.unref()&&(this._documents.delete(o),i.push(a.value))}if(t.addedDocuments)for(const s of t.addedDocuments){const o=y.revive(s.uri);let a=this._documents.get(o);if(a&&o.scheme!==V.vscodeNotebookCell&&o.scheme!==V.vscodeInteractiveInput)throw new Error(`document '${o} already exists!'`);a||(a=new XN(new zN(this._extHostRpc.getProxy(W.MainThreadDocuments),o,s.lines,s.EOL,s.versionId,s.languageId,s.isDirty,s.encoding)),this._documents.set(o,a),r.push(a.value)),a.ref()}if(t.removedEditors)for(const s of t.removedEditors){const o=this._editors.get(s);this._editors.delete(s),o&&n.push(o)}if(t.addedEditors)for(const s of t.addedEditors){const o=y.revive(s.documentUri);si(this._documents.has(o),`document '${o}' does not exist`),si(!this._editors.has(s.id),`editor '${s.id}' already exists!`);const a=this._documents.get(o).value,l=new JN(s.id,this._extHostRpc.getProxy(W.MainThreadTextEditors),this._logService,new Ci(()=>a.document),s.selections.map(fr.to),s.options,s.visibleRanges.map(c=>F.to(c)),typeof s.editorPosition=="number"?Rt.to(s.editorPosition):void 0);this._editors.set(s.id,l)}t.newActiveEditor!==void 0&&(si(t.newActiveEditor===null||this._editors.has(t.newActiveEditor),`active editor '${t.newActiveEditor}' does not exist`),this._activeEditorId=t.newActiveEditor),zr(i),zr(n),t.removedDocuments&&this._onDidRemoveDocuments.fire(i),t.addedDocuments&&this._onDidAddDocuments.fire(r),(t.removedEditors||t.addedEditors)&&this._onDidChangeVisibleTextEditors.fire(this.allEditors().map(s=>s.value)),t.newActiveEditor!==void 0&&this._onDidChangeActiveTextEditor.fire(this.activeEditor())}getDocument(t){return this._documents.get(t)?.value}allDocuments(){return Jt.map(this._documents.values(),t=>t.value)}getEditor(t){return this._editors.get(t)}activeEditor(t){if(!this._activeEditorId)return;const i=this._editors.get(this._activeEditorId);return t?i:i?.value}allEditors(){return[...this._editors.values()]}};Z_=__decorate([__param(0,Ue),__param(1,qe)],Z_);var Wa=U("IExtHostDocumentsAndEditors"),Jf=U("IExtHostApiDeprecationService"),K_=class{constructor(t,i){this._extHostLogService=i,this._reportedUsages=new Set,this._telemetryShape=t.getProxy(W.MainThreadTelemetry)}report(t,i,r){const n=this.getUsageKey(t,i);this._reportedUsages.has(n)||(this._reportedUsages.add(n),i.isUnderDevelopment&&this._extHostLogService.warn(`[Deprecation Warning] '${t}' is deprecated. ${r}`),this._telemetryShape.$publicLog2("extHostDeprecatedApiUsage",{extensionId:i.identifier.value,apiId:t}))}getUsageKey(t,i){return`${t}-${i.identifier.value}`}};K_=__decorate([__param(0,Ue),__param(1,qe)],K_);var Hq=Object.freeze(new class{report(e,t,i){}}),ZN={activeComment:{proposal:"https://raw.githubusercontent.com/microsoft/vscode/main/src/vscode-dts/vscode.proposed.activeComment.d.ts"},aiRelatedInformation:{proposal:"https://raw.githubusercontent.com/microsoft/vscode/main/src/vscode-dts/vscode.proposed.aiRelatedInformation.d.ts"},aiSettingsSearch:{proposal:"https://raw.githubusercontent.com/microsoft/vscode/main/src/vscode-dts/vscode.proposed.aiSettingsSearch.d.ts"},aiTextSearchProvider:{proposal:"https://raw.githubusercontent.com/microsoft/vscode/main/src/vscode-dts/vscode.proposed.aiTextSearchProvider.d.ts",version:2},authLearnMore:{proposal:"https://raw.githubusercontent.com/microsoft/vscode/main/src/vscode-dts/vscode.proposed.authLearnMore.d.ts"},authSession:{proposal:"https://raw.githubusercontent.com/microsoft/vscode/main/src/vscode-dts/vscode.proposed.authSession.d.ts"},canonicalUriProvider:{proposal:"https://raw.githubusercontent.com/microsoft/vscode/main/src/vscode-dts/vscode.proposed.canonicalUriProvider.d.ts"},chatEditing:{proposal:"https://raw.githubusercontent.com/microsoft/vscode/main/src/vscode-dts/vscode.proposed.chatEditing.d.ts"},chatParticipantAdditions:{proposal:"https://raw.githubusercontent.com/microsoft/vscode/main/src/vscode-dts/vscode.proposed.chatParticipantAdditions.d.ts"},chatParticipantPrivate:{proposal:"https://raw.githubusercontent.com/microsoft/vscode/main/src/vscode-dts/vscode.proposed.chatParticipantPrivate.d.ts",version:9},chatProvider:{proposal:"https://raw.githubusercontent.com/microsoft/vscode/main/src/vscode-dts/vscode.proposed.chatProvider.d.ts"},chatReferenceBinaryData:{proposal:"https://raw.githubusercontent.com/microsoft/vscode/main/src/vscode-dts/vscode.proposed.chatReferenceBinaryData.d.ts"},chatReferenceDiagnostic:{proposal:"https://raw.githubusercontent.com/microsoft/vscode/main/src/vscode-dts/vscode.proposed.chatReferenceDiagnostic.d.ts"},chatStatusItem:{proposal:"https://raw.githubusercontent.com/microsoft/vscode/main/src/vscode-dts/vscode.proposed.chatStatusItem.d.ts"},chatTab:{proposal:"https://raw.githubusercontent.com/microsoft/vscode/main/src/vscode-dts/vscode.proposed.chatTab.d.ts"},codeActionAI:{proposal:"https://raw.githubusercontent.com/microsoft/vscode/main/src/vscode-dts/vscode.proposed.codeActionAI.d.ts"},codeActionRanges:{proposal:"https://raw.githubusercontent.com/microsoft/vscode/main/src/vscode-dts/vscode.proposed.codeActionRanges.d.ts"},codiconDecoration:{proposal:"https://raw.githubusercontent.com/microsoft/vscode/main/src/vscode-dts/vscode.proposed.codiconDecoration.d.ts"},commentReactor:{proposal:"https://raw.githubusercontent.com/microsoft/vscode/main/src/vscode-dts/vscode.proposed.commentReactor.d.ts"},commentReveal:{proposal:"https://raw.githubusercontent.com/microsoft/vscode/main/src/vscode-dts/vscode.proposed.commentReveal.d.ts"},commentThreadApplicability:{proposal:"https://raw.githubusercontent.com/microsoft/vscode/main/src/vscode-dts/vscode.proposed.commentThreadApplicability.d.ts"},commentingRangeHint:{proposal:"https://raw.githubusercontent.com/microsoft/vscode/main/src/vscode-dts/vscode.proposed.commentingRangeHint.d.ts"},commentsDraftState:{proposal:"https://raw.githubusercontent.com/microsoft/vscode/main/src/vscode-dts/vscode.proposed.commentsDraftState.d.ts"},contribAccessibilityHelpContent:{proposal:"https://raw.githubusercontent.com/microsoft/vscode/main/src/vscode-dts/vscode.proposed.contribAccessibilityHelpContent.d.ts"},contribCommentEditorActionsMenu:{proposal:"https://raw.githubusercontent.com/microsoft/vscode/main/src/vscode-dts/vscode.proposed.contribCommentEditorActionsMenu.d.ts"},contribCommentPeekContext:{proposal:"https://raw.githubusercontent.com/microsoft/vscode/main/src/vscode-dts/vscode.proposed.contribCommentPeekContext.d.ts"},contribCommentThreadAdditionalMenu:{proposal:"https://raw.githubusercontent.com/microsoft/vscode/main/src/vscode-dts/vscode.proposed.contribCommentThreadAdditionalMenu.d.ts"},contribCommentsViewThreadMenus:{proposal:"https://raw.githubusercontent.com/microsoft/vscode/main/src/vscode-dts/vscode.proposed.contribCommentsViewThreadMenus.d.ts"},contribDebugCreateConfiguration:{proposal:"https://raw.githubusercontent.com/microsoft/vscode/main/src/vscode-dts/vscode.proposed.contribDebugCreateConfiguration.d.ts"},contribDiffEditorGutterToolBarMenus:{proposal:"https://raw.githubusercontent.com/microsoft/vscode/main/src/vscode-dts/vscode.proposed.contribDiffEditorGutterToolBarMenus.d.ts"},contribEditSessions:{proposal:"https://raw.githubusercontent.com/microsoft/vscode/main/src/vscode-dts/vscode.proposed.contribEditSessions.d.ts"},contribEditorContentMenu:{proposal:"https://raw.githubusercontent.com/microsoft/vscode/main/src/vscode-dts/vscode.proposed.contribEditorContentMenu.d.ts"},contribLabelFormatterWorkspaceTooltip:{proposal:"https://raw.githubusercontent.com/microsoft/vscode/main/src/vscode-dts/vscode.proposed.contribLabelFormatterWorkspaceTooltip.d.ts"},contribMenuBarHome:{proposal:"https://raw.githubusercontent.com/microsoft/vscode/main/src/vscode-dts/vscode.proposed.contribMenuBarHome.d.ts"},contribMergeEditorMenus:{proposal:"https://raw.githubusercontent.com/microsoft/vscode/main/src/vscode-dts/vscode.proposed.contribMergeEditorMenus.d.ts"},contribMultiDiffEditorMenus:{proposal:"https://raw.githubusercontent.com/microsoft/vscode/main/src/vscode-dts/vscode.proposed.contribMultiDiffEditorMenus.d.ts"},contribNotebookStaticPreloads:{proposal:"https://raw.githubusercontent.com/microsoft/vscode/main/src/vscode-dts/vscode.proposed.contribNotebookStaticPreloads.d.ts"},contribRemoteHelp:{proposal:"https://raw.githubusercontent.com/microsoft/vscode/main/src/vscode-dts/vscode.proposed.contribRemoteHelp.d.ts"},contribShareMenu:{proposal:"https://raw.githubusercontent.com/microsoft/vscode/main/src/vscode-dts/vscode.proposed.contribShareMenu.d.ts"},contribSourceControlHistoryItemMenu:{proposal:"https://raw.githubusercontent.com/microsoft/vscode/main/src/vscode-dts/vscode.proposed.contribSourceControlHistoryItemMenu.d.ts"},contribSourceControlHistoryTitleMenu:{proposal:"https://raw.githubusercontent.com/microsoft/vscode/main/src/vscode-dts/vscode.proposed.contribSourceControlHistoryTitleMenu.d.ts"},contribSourceControlInputBoxMenu:{proposal:"https://raw.githubusercontent.com/microsoft/vscode/main/src/vscode-dts/vscode.proposed.contribSourceControlInputBoxMenu.d.ts"},contribSourceControlTitleMenu:{proposal:"https://raw.githubusercontent.com/microsoft/vscode/main/src/vscode-dts/vscode.proposed.contribSourceControlTitleMenu.d.ts"},contribStatusBarItems:{proposal:"https://raw.githubusercontent.com/microsoft/vscode/main/src/vscode-dts/vscode.proposed.contribStatusBarItems.d.ts"},contribViewContainerTitle:{proposal:"https://raw.githubusercontent.com/microsoft/vscode/main/src/vscode-dts/vscode.proposed.contribViewContainerTitle.d.ts"},contribViewsRemote:{proposal:"https://raw.githubusercontent.com/microsoft/vscode/main/src/vscode-dts/vscode.proposed.contribViewsRemote.d.ts"},contribViewsWelcome:{proposal:"https://raw.githubusercontent.com/microsoft/vscode/main/src/vscode-dts/vscode.proposed.contribViewsWelcome.d.ts"},customEditorMove:{proposal:"https://raw.githubusercontent.com/microsoft/vscode/main/src/vscode-dts/vscode.proposed.customEditorMove.d.ts"},debugVisualization:{proposal:"https://raw.githubusercontent.com/microsoft/vscode/main/src/vscode-dts/vscode.proposed.debugVisualization.d.ts"},defaultChatParticipant:{proposal:"https://raw.githubusercontent.com/microsoft/vscode/main/src/vscode-dts/vscode.proposed.defaultChatParticipant.d.ts",version:4},diffCommand:{proposal:"https://raw.githubusercontent.com/microsoft/vscode/main/src/vscode-dts/vscode.proposed.diffCommand.d.ts"},diffContentOptions:{proposal:"https://raw.githubusercontent.com/microsoft/vscode/main/src/vscode-dts/vscode.proposed.diffContentOptions.d.ts"},documentFiltersExclusive:{proposal:"https://raw.githubusercontent.com/microsoft/vscode/main/src/vscode-dts/vscode.proposed.documentFiltersExclusive.d.ts"},editCode:{proposal:"https://raw.githubusercontent.com/microsoft/vscode/main/src/vscode-dts/vscode.proposed.editCode.d.ts"},editSessionIdentityProvider:{proposal:"https://raw.githubusercontent.com/microsoft/vscode/main/src/vscode-dts/vscode.proposed.editSessionIdentityProvider.d.ts"},editorBottomWidget:{proposal:"https://raw.githubusercontent.com/microsoft/vscode/main/src/vscode-dts/vscode.proposed.editorBottomWidget.d.ts"},editorHoverVerbosityLevel:{proposal:"https://raw.githubusercontent.com/microsoft/vscode/main/src/vscode-dts/vscode.proposed.editorHoverVerbosityLevel.d.ts"},editorInsets:{proposal:"https://raw.githubusercontent.com/microsoft/vscode/main/src/vscode-dts/vscode.proposed.editorInsets.d.ts"},embeddings:{proposal:"https://raw.githubusercontent.com/microsoft/vscode/main/src/vscode-dts/vscode.proposed.embeddings.d.ts"},extensionRuntime:{proposal:"https://raw.githubusercontent.com/microsoft/vscode/main/src/vscode-dts/vscode.proposed.extensionRuntime.d.ts"},extensionsAny:{proposal:"https://raw.githubusercontent.com/microsoft/vscode/main/src/vscode-dts/vscode.proposed.extensionsAny.d.ts"},externalUriOpener:{proposal:"https://raw.githubusercontent.com/microsoft/vscode/main/src/vscode-dts/vscode.proposed.externalUriOpener.d.ts"},fileSearchProvider:{proposal:"https://raw.githubusercontent.com/microsoft/vscode/main/src/vscode-dts/vscode.proposed.fileSearchProvider.d.ts"},fileSearchProvider2:{proposal:"https://raw.githubusercontent.com/microsoft/vscode/main/src/vscode-dts/vscode.proposed.fileSearchProvider2.d.ts"},findFiles2:{proposal:"https://raw.githubusercontent.com/microsoft/vscode/main/src/vscode-dts/vscode.proposed.findFiles2.d.ts",version:2},findTextInFiles:{proposal:"https://raw.githubusercontent.com/microsoft/vscode/main/src/vscode-dts/vscode.proposed.findTextInFiles.d.ts"},findTextInFiles2:{proposal:"https://raw.githubusercontent.com/microsoft/vscode/main/src/vscode-dts/vscode.proposed.findTextInFiles2.d.ts"},fsChunks:{proposal:"https://raw.githubusercontent.com/microsoft/vscode/main/src/vscode-dts/vscode.proposed.fsChunks.d.ts"},idToken:{proposal:"https://raw.githubusercontent.com/microsoft/vscode/main/src/vscode-dts/vscode.proposed.idToken.d.ts"},inlineChat:{proposal:"https://raw.githubusercontent.com/microsoft/vscode/main/src/vscode-dts/vscode.proposed.inlineChat.d.ts"},inlineCompletionsAdditions:{proposal:"https://raw.githubusercontent.com/microsoft/vscode/main/src/vscode-dts/vscode.proposed.inlineCompletionsAdditions.d.ts"},inlineDiffWidget:{proposal:"https://raw.githubusercontent.com/microsoft/vscode/main/src/vscode-dts/vscode.proposed.inlineDiffWidget.d.ts"},inlineEdit:{proposal:"https://raw.githubusercontent.com/microsoft/vscode/main/src/vscode-dts/vscode.proposed.inlineEdit.d.ts"},interactive:{proposal:"https://raw.githubusercontent.com/microsoft/vscode/main/src/vscode-dts/vscode.proposed.interactive.d.ts"},interactiveWindow:{proposal:"https://raw.githubusercontent.com/microsoft/vscode/main/src/vscode-dts/vscode.proposed.interactiveWindow.d.ts"},ipc:{proposal:"https://raw.githubusercontent.com/microsoft/vscode/main/src/vscode-dts/vscode.proposed.ipc.d.ts"},languageModelCapabilities:{proposal:"https://raw.githubusercontent.com/microsoft/vscode/main/src/vscode-dts/vscode.proposed.languageModelCapabilities.d.ts"},languageModelDataPart:{proposal:"https://raw.githubusercontent.com/microsoft/vscode/main/src/vscode-dts/vscode.proposed.languageModelDataPart.d.ts",version:2},languageModelSystem:{proposal:"https://raw.githubusercontent.com/microsoft/vscode/main/src/vscode-dts/vscode.proposed.languageModelSystem.d.ts"},languageStatusText:{proposal:"https://raw.githubusercontent.com/microsoft/vscode/main/src/vscode-dts/vscode.proposed.languageStatusText.d.ts"},mappedEditsProvider:{proposal:"https://raw.githubusercontent.com/microsoft/vscode/main/src/vscode-dts/vscode.proposed.mappedEditsProvider.d.ts"},mcpConfigurationProvider:{proposal:"https://raw.githubusercontent.com/microsoft/vscode/main/src/vscode-dts/vscode.proposed.mcpConfigurationProvider.d.ts"},multiDocumentHighlightProvider:{proposal:"https://raw.githubusercontent.com/microsoft/vscode/main/src/vscode-dts/vscode.proposed.multiDocumentHighlightProvider.d.ts"},nativeWindowHandle:{proposal:"https://raw.githubusercontent.com/microsoft/vscode/main/src/vscode-dts/vscode.proposed.nativeWindowHandle.d.ts"},newSymbolNamesProvider:{proposal:"https://raw.githubusercontent.com/microsoft/vscode/main/src/vscode-dts/vscode.proposed.newSymbolNamesProvider.d.ts"},notebookCellExecution:{proposal:"https://raw.githubusercontent.com/microsoft/vscode/main/src/vscode-dts/vscode.proposed.notebookCellExecution.d.ts"},notebookCellExecutionState:{proposal:"https://raw.githubusercontent.com/microsoft/vscode/main/src/vscode-dts/vscode.proposed.notebookCellExecutionState.d.ts"},notebookControllerAffinityHidden:{proposal:"https://raw.githubusercontent.com/microsoft/vscode/main/src/vscode-dts/vscode.proposed.notebookControllerAffinityHidden.d.ts"},notebookDeprecated:{proposal:"https://raw.githubusercontent.com/microsoft/vscode/main/src/vscode-dts/vscode.proposed.notebookDeprecated.d.ts"},notebookExecution:{proposal:"https://raw.githubusercontent.com/microsoft/vscode/main/src/vscode-dts/vscode.proposed.notebookExecution.d.ts"},notebookKernelSource:{proposal:"https://raw.githubusercontent.com/microsoft/vscode/main/src/vscode-dts/vscode.proposed.notebookKernelSource.d.ts"},notebookLiveShare:{proposal:"https://raw.githubusercontent.com/microsoft/vscode/main/src/vscode-dts/vscode.proposed.notebookLiveShare.d.ts"},notebookMessaging:{proposal:"https://raw.githubusercontent.com/microsoft/vscode/main/src/vscode-dts/vscode.proposed.notebookMessaging.d.ts"},notebookMime:{proposal:"https://raw.githubusercontent.com/microsoft/vscode/main/src/vscode-dts/vscode.proposed.notebookMime.d.ts"},notebookReplDocument:{proposal:"https://raw.githubusercontent.com/microsoft/vscode/main/src/vscode-dts/vscode.proposed.notebookReplDocument.d.ts"},notebookVariableProvider:{proposal:"https://raw.githubusercontent.com/microsoft/vscode/main/src/vscode-dts/vscode.proposed.notebookVariableProvider.d.ts"},portsAttributes:{proposal:"https://raw.githubusercontent.com/microsoft/vscode/main/src/vscode-dts/vscode.proposed.portsAttributes.d.ts"},profileContentHandlers:{proposal:"https://raw.githubusercontent.com/microsoft/vscode/main/src/vscode-dts/vscode.proposed.profileContentHandlers.d.ts"},quickDiffProvider:{proposal:"https://raw.githubusercontent.com/microsoft/vscode/main/src/vscode-dts/vscode.proposed.quickDiffProvider.d.ts"},quickInputButtonLocation:{proposal:"https://raw.githubusercontent.com/microsoft/vscode/main/src/vscode-dts/vscode.proposed.quickInputButtonLocation.d.ts"},quickPickItemTooltip:{proposal:"https://raw.githubusercontent.com/microsoft/vscode/main/src/vscode-dts/vscode.proposed.quickPickItemTooltip.d.ts"},quickPickSortByLabel:{proposal:"https://raw.githubusercontent.com/microsoft/vscode/main/src/vscode-dts/vscode.proposed.quickPickSortByLabel.d.ts"},resolvers:{proposal:"https://raw.githubusercontent.com/microsoft/vscode/main/src/vscode-dts/vscode.proposed.resolvers.d.ts"},scmActionButton:{proposal:"https://raw.githubusercontent.com/microsoft/vscode/main/src/vscode-dts/vscode.proposed.scmActionButton.d.ts"},scmHistoryProvider:{proposal:"https://raw.githubusercontent.com/microsoft/vscode/main/src/vscode-dts/vscode.proposed.scmHistoryProvider.d.ts"},scmMultiDiffEditor:{proposal:"https://raw.githubusercontent.com/microsoft/vscode/main/src/vscode-dts/vscode.proposed.scmMultiDiffEditor.d.ts"},scmSelectedProvider:{proposal:"https://raw.githubusercontent.com/microsoft/vscode/main/src/vscode-dts/vscode.proposed.scmSelectedProvider.d.ts"},scmTextDocument:{proposal:"https://raw.githubusercontent.com/microsoft/vscode/main/src/vscode-dts/vscode.proposed.scmTextDocument.d.ts"},scmValidation:{proposal:"https://raw.githubusercontent.com/microsoft/vscode/main/src/vscode-dts/vscode.proposed.scmValidation.d.ts"},selectionAction:{proposal:"https://raw.githubusercontent.com/microsoft/vscode/main/src/vscode-dts/vscode.proposed.selectionAction.d.ts"},shareProvider:{proposal:"https://raw.githubusercontent.com/microsoft/vscode/main/src/vscode-dts/vscode.proposed.shareProvider.d.ts"},speech:{proposal:"https://raw.githubusercontent.com/microsoft/vscode/main/src/vscode-dts/vscode.proposed.speech.d.ts"},statusBarItemTooltip:{proposal:"https://raw.githubusercontent.com/microsoft/vscode/main/src/vscode-dts/vscode.proposed.statusBarItemTooltip.d.ts"},tabInputMultiDiff:{proposal:"https://raw.githubusercontent.com/microsoft/vscode/main/src/vscode-dts/vscode.proposed.tabInputMultiDiff.d.ts"},tabInputTextMerge:{proposal:"https://raw.githubusercontent.com/microsoft/vscode/main/src/vscode-dts/vscode.proposed.tabInputTextMerge.d.ts"},taskPresentationGroup:{proposal:"https://raw.githubusercontent.com/microsoft/vscode/main/src/vscode-dts/vscode.proposed.taskPresentationGroup.d.ts"},taskProblemMatcherStatus:{proposal:"https://raw.githubusercontent.com/microsoft/vscode/main/src/vscode-dts/vscode.proposed.taskProblemMatcherStatus.d.ts"},telemetry:{proposal:"https://raw.githubusercontent.com/microsoft/vscode/main/src/vscode-dts/vscode.proposed.telemetry.d.ts"},terminalChatProvider:{proposal:"https://raw.githubusercontent.com/microsoft/vscode/main/src/vscode-dts/vscode.proposed.terminalChatProvider.d.ts"},terminalCompletionProvider:{proposal:"https://raw.githubusercontent.com/microsoft/vscode/main/src/vscode-dts/vscode.proposed.terminalCompletionProvider.d.ts"},terminalDataWriteEvent:{proposal:"https://raw.githubusercontent.com/microsoft/vscode/main/src/vscode-dts/vscode.proposed.terminalDataWriteEvent.d.ts"},terminalDimensions:{proposal:"https://raw.githubusercontent.com/microsoft/vscode/main/src/vscode-dts/vscode.proposed.terminalDimensions.d.ts"},terminalExecuteCommandEvent:{proposal:"https://raw.githubusercontent.com/microsoft/vscode/main/src/vscode-dts/vscode.proposed.terminalExecuteCommandEvent.d.ts"},terminalQuickFixProvider:{proposal:"https://raw.githubusercontent.com/microsoft/vscode/main/src/vscode-dts/vscode.proposed.terminalQuickFixProvider.d.ts"},terminalSelection:{proposal:"https://raw.githubusercontent.com/microsoft/vscode/main/src/vscode-dts/vscode.proposed.terminalSelection.d.ts"},terminalSelectionAction:{proposal:"https://raw.githubusercontent.com/microsoft/vscode/main/src/vscode-dts/vscode.proposed.terminalSelectionAction.d.ts"},terminalShellEnv:{proposal:"https://raw.githubusercontent.com/microsoft/vscode/main/src/vscode-dts/vscode.proposed.terminalShellEnv.d.ts"},testObserver:{proposal:"https://raw.githubusercontent.com/microsoft/vscode/main/src/vscode-dts/vscode.proposed.testObserver.d.ts"},testRelatedCode:{proposal:"https://raw.githubusercontent.com/microsoft/vscode/main/src/vscode-dts/vscode.proposed.testRelatedCode.d.ts"},textEditorDiffInformation:{proposal:"https://raw.githubusercontent.com/microsoft/vscode/main/src/vscode-dts/vscode.proposed.textEditorDiffInformation.d.ts"},textSearchComplete2:{proposal:"https://raw.githubusercontent.com/microsoft/vscode/main/src/vscode-dts/vscode.proposed.textSearchComplete2.d.ts"},textSearchProvider:{proposal:"https://raw.githubusercontent.com/microsoft/vscode/main/src/vscode-dts/vscode.proposed.textSearchProvider.d.ts"},textSearchProvider2:{proposal:"https://raw.githubusercontent.com/microsoft/vscode/main/src/vscode-dts/vscode.proposed.textSearchProvider2.d.ts"},timeline:{proposal:"https://raw.githubusercontent.com/microsoft/vscode/main/src/vscode-dts/vscode.proposed.timeline.d.ts"},tokenInformation:{proposal:"https://raw.githubusercontent.com/microsoft/vscode/main/src/vscode-dts/vscode.proposed.tokenInformation.d.ts"},toolProgress:{proposal:"https://raw.githubusercontent.com/microsoft/vscode/main/src/vscode-dts/vscode.proposed.toolProgress.d.ts"},treeViewActiveItem:{proposal:"https://raw.githubusercontent.com/microsoft/vscode/main/src/vscode-dts/vscode.proposed.treeViewActiveItem.d.ts"},treeViewMarkdownMessage:{proposal:"https://raw.githubusercontent.com/microsoft/vscode/main/src/vscode-dts/vscode.proposed.treeViewMarkdownMessage.d.ts"},treeViewReveal:{proposal:"https://raw.githubusercontent.com/microsoft/vscode/main/src/vscode-dts/vscode.proposed.treeViewReveal.d.ts"},tunnelFactory:{proposal:"https://raw.githubusercontent.com/microsoft/vscode/main/src/vscode-dts/vscode.proposed.tunnelFactory.d.ts"},tunnels:{proposal:"https://raw.githubusercontent.com/microsoft/vscode/main/src/vscode-dts/vscode.proposed.tunnels.d.ts"},valueSelectionInQuickPick:{proposal:"https://raw.githubusercontent.com/microsoft/vscode/main/src/vscode-dts/vscode.proposed.valueSelectionInQuickPick.d.ts"},workspaceTrust:{proposal:"https://raw.githubusercontent.com/microsoft/vscode/main/src/vscode-dts/vscode.proposed.workspaceTrust.d.ts"}},Xf=Object.freeze(ZN),Y_=Ht.as(Id.JSONContribution),KN=class Vp{static _toSet(t){const i=new vs;for(let r=0,n=t.length;r<n;r++)i.add(t[r].description.identifier);return i}static compute(t,i){if(!t||!t.length)return new Vp(i,[]);if(!i||!i.length)return new Vp([],t);const r=this._toSet(t),n=this._toSet(i),s=i.filter(a=>!r.has(a.description.identifier)),o=t.filter(a=>!n.has(a.description.identifier));return new Vp(s,o)}constructor(t,i){this.added=t,this.removed=i}},YN=class{constructor(e,t,i){this.name=e,this.defaultExtensionKind=t,this.canHandleResolver=i,this._handler=null,this._users=null,this._delta=null}setHandler(e){if(this._handler!==null)throw new Error("Handler already set!");return this._handler=e,this._handle(),{dispose:()=>{this._handler=null}}}acceptUsers(e){this._delta=KN.compute(this._users,e),this._users=e,this._handle()}_handle(){if(!(this._handler===null||this._users===null||this._delta===null))try{this._handler(this._users,this._delta)}catch(e){Qt(e)}}},eM={type:"string",enum:["ui","workspace"],enumDescriptions:[h(14079,null),h(14080,null)]},LI="vscode://schemas/vscode-extensions",e0={properties:{engines:{type:"object",description:h(14081,null),properties:{vscode:{type:"string",description:h(14082,null),default:"^1.22.0"}}},publisher:{description:h(14083,null),type:"string"},displayName:{description:h(14084,null),type:"string"},categories:{description:h(14085,null),type:"array",uniqueItems:!0,items:{oneOf:[{type:"string",enum:zb},{type:"string",const:"Languages",deprecationMessage:h(14086,null)}]}},galleryBanner:{type:"object",description:h(14087,null),properties:{color:{description:h(14088,null),type:"string"},theme:{description:h(14089,null),type:"string",enum:["dark","light"]}}},contributes:{description:h(14090,null),type:"object",properties:{},default:{}},preview:{type:"boolean",description:h(14091,null)},enableProposedApi:{type:"boolean",deprecationMessage:h(14092,null)},enabledApiProposals:{markdownDescription:h(14093,null),type:"array",uniqueItems:!0,items:{type:"string",enum:Object.keys(Xf).map(e=>e),markdownEnumDescriptions:Object.values(Xf).map(e=>e.proposal)}},api:{markdownDescription:h(14094,null),type:"string",enum:["none"],enumDescriptions:[h(14095,null)]},activationEvents:{description:h(14096,null),type:"array",items:{type:"string",defaultSnippets:[{label:"onWebviewPanel",description:h(14097,null),body:"onWebviewPanel:viewType"},{label:"onLanguage",description:h(14098,null),body:"onLanguage:${1:languageId}"},{label:"onCommand",description:h(14099,null),body:"onCommand:${2:commandId}"},{label:"onDebug",description:h(14100,null),body:"onDebug"},{label:"onDebugInitialConfigurations",description:h(14101,null),body:"onDebugInitialConfigurations"},{label:"onDebugDynamicConfigurations",description:h(14102,null),body:"onDebugDynamicConfigurations"},{label:"onDebugResolve",description:h(14103,null),body:"onDebugResolve:${6:type}"},{label:"onDebugAdapterProtocolTracker",description:h(14104,null),body:"onDebugAdapterProtocolTracker:${6:type}"},{label:"workspaceContains",description:h(14105,null),body:"workspaceContains:${4:filePattern}"},{label:"onStartupFinished",description:h(14106,null),body:"onStartupFinished"},{label:"onTaskType",description:h(14107,null),body:"onTaskType:${1:taskType}"},{label:"onFileSystem",description:h(14108,null),body:"onFileSystem:${1:scheme}"},{label:"onEditSession",description:h(14109,null),body:"onEditSession:${1:scheme}"},{label:"onSearch",description:h(14110,null),body:"onSearch:${7:scheme}"},{label:"onView",body:"onView:${5:viewId}",description:h(14111,null)},{label:"onUri",body:"onUri",description:h(14112,null)},{label:"onOpenExternalUri",body:"onOpenExternalUri",description:h(14113,null)},{label:"onCustomEditor",body:"onCustomEditor:${9:viewType}",description:h(14114,null)},{label:"onNotebook",body:"onNotebook:${1:type}",description:h(14115,null)},{label:"onAuthenticationRequest",body:"onAuthenticationRequest:${11:authenticationProviderId}",description:h(14116,null)},{label:"onRenderer",description:h(14117,null),body:"onRenderer:${11:rendererId}"},{label:"onTerminalProfile",body:"onTerminalProfile:${1:terminalId}",description:h(14118,null)},{label:"onTerminalQuickFixRequest",body:"onTerminalQuickFixRequest:${1:quickFixId}",description:h(14119,null)},{label:"onWalkthrough",body:"onWalkthrough:${1:walkthroughID}",description:h(14120,null)},{label:"onIssueReporterOpened",body:"onIssueReporterOpened",description:h(14121,null)},{label:"onChatParticipant",body:"onChatParticipant:${1:participantId}",description:h(14122,null)},{label:"onLanguageModelTool",body:"onLanguageModelTool:${1:toolId}",description:h(14123,null)},{label:"onTerminalCompletionsRequested",body:"onTerminalCompletionsRequested",description:h(14124,null)},{label:"onMcpCollection",description:h(14125,null),body:"onMcpCollection:${2:collectionId}"},{label:"*",description:h(14126,null),body:"*"}]}},badges:{type:"array",description:h(14127,null),items:{type:"object",required:["url","href","description"],properties:{url:{type:"string",description:h(14128,null)},href:{type:"string",description:h(14129,null)},description:{type:"string",description:h(14130,null)}}}},markdown:{type:"string",description:h(14131,null),enum:["github","standard"],default:"github"},qna:{default:"marketplace",description:h(14132,null),anyOf:[{type:["string","boolean"],enum:["marketplace",!1]},{type:"string"}]},extensionDependencies:{description:h(14133,null),type:"array",uniqueItems:!0,items:{type:"string",pattern:Zm}},extensionPack:{description:h(14134,null),type:"array",uniqueItems:!0,items:{type:"string",pattern:Zm}},extensionKind:{description:h(14135,null),type:"array",items:eM,default:["workspace"],defaultSnippets:[{body:["ui"],description:h(14136,null)},{body:["workspace"],description:h(14137,null)},{body:["ui","workspace"],description:h(14138,null)},{body:["workspace","ui"],description:h(14139,null)},{body:[],description:h(14140,null)}]},capabilities:{description:h(14141,null),type:"object",properties:{virtualWorkspaces:{description:h(14142,null),type:["boolean","object"],defaultSnippets:[{label:"limited",body:{supported:"${1:limited}",description:"${2}"}},{label:"false",body:{supported:!1,description:"${2}"}}],default:(!0).valueOf,properties:{supported:{markdownDescription:h(14143,null),type:["string","boolean"],enum:["limited",!0,!1],enumDescriptions:[h(14144,null),h(14145,null),h(14146,null)]},description:{type:"string",markdownDescription:h(14147,null)}}},untrustedWorkspaces:{description:h(14148,null),type:"object",required:["supported"],defaultSnippets:[{body:{supported:"${1:limited}",description:"${2}"}}],properties:{supported:{markdownDescription:h(14149,null),type:["string","boolean"],enum:["limited",!0,!1],enumDescriptions:[h(14150,null),h(14151,null),h(14152,null)]},restrictedConfigurations:{description:h(14153,null),type:"array",items:{type:"string"}},description:{type:"string",markdownDescription:h(14154,null)}}}}},sponsor:{description:h(14155,null),type:"object",defaultSnippets:[{body:{url:"${1:https:}"}}],properties:{url:{description:h(14156,null),type:"string"}}},scripts:{type:"object",properties:{"vscode:prepublish":{description:h(14157,null),type:"string"},"vscode:uninstall":{description:h(14158,null),type:"string"}}},icon:{type:"string",description:h(14159,null)},l10n:{type:"string",description:h(14160,null)},pricing:{type:"string",markdownDescription:h(14161,null),enum:["Free","Trial"],default:"Free"}}},tM=class{constructor(){this._extensionPoints=new Map}registerExtensionPoint(e){if(this._extensionPoints.has(e.extensionPoint))throw new Error("Duplicate extension point: "+e.extensionPoint);const t=new YN(e.extensionPoint,e.defaultExtensionKind,e.canHandleResolver);return this._extensionPoints.set(e.extensionPoint,t),e.activationEventsGenerator&&e2.register(e.extensionPoint,e.activationEventsGenerator),e0.properties.contributes.properties[e.extensionPoint]=e.jsonSchema,Y_.registerSchema(LI,e0),t}getExtensionPoints(){return Array.from(this._extensionPoints.values())}},NI={ExtensionsRegistry:"ExtensionsRegistry"};Ht.add(NI.ExtensionsRegistry,new tM);var iM=Ht.as(NI.ExtensionsRegistry);Y_.registerSchema(LI,e0),Y_.registerSchema(Q3,{properties:{extensionEnabledApiProposals:{description:h(14162,null),type:"object",properties:{},additionalProperties:{anyOf:[{type:"array",uniqueItems:!0,items:{type:"string",enum:Object.keys(Xf),markdownEnumDescriptions:Object.values(Xf).map(e=>e.proposal)}}]}}}});var rM={type:"object",additionalProperties:!1,properties:{type:{type:"string",description:h(11499,null)},required:{type:"array",items:{type:"string"}},properties:{type:"object",description:h(11500,null),additionalProperties:{$ref:"http://json-schema.org/draft-07/schema#"}},when:{type:"string",markdownDescription:h(11501,null),default:""}}},t0;(function(e){function t(i,r,n){if(!i)return;const s=Me(i.type)?i.type:void 0;if(!s||s.length===0){n.error(h(11502,null));return}const o=[];if(Array.isArray(i.required))for(const a of i.required)Me(a)&&o.push(a);return{extensionId:r.value,taskType:s,required:o,properties:i.properties?nt(i.properties):{},when:i.when?It.deserialize(i.when):void 0}}e.from=t})(t0||(t0={}));var nM=iM.registerExtensionPoint({extensionPoint:"taskDefinitions",activationEventsGenerator:(e,t)=>{for(const i of e)i.type&&t.push(`onTaskType:${i.type}`)},jsonSchema:{description:h(11503,null),type:"array",items:rM}}),sM=class{constructor(){this._onDefinitionsChanged=new P,this.onDefinitionsChanged=this._onDefinitionsChanged.event,this.taskTypes=Object.create(null),this.readyPromise=new Promise((e,t)=>{nM.setHandler((i,r)=>{this._schema=void 0;try{for(const n of r.removed){const s=n.value;for(const o of s)this.taskTypes&&o.type&&this.taskTypes[o.type]&&delete this.taskTypes[o.type]}for(const n of r.added){const s=n.value;for(const o of s){const a=t0.from(o,n.description.identifier,n.collector);a&&(this.taskTypes[a.taskType]=a)}}(r.removed.length>0||r.added.length>0)&&this._onDefinitionsChanged.fire()}catch{}e(void 0)})})}onReady(){return this.readyPromise}get(e){return this.taskTypes[e]}all(){return Object.keys(this.taskTypes).map(e=>this.taskTypes[e])}getJsonSchema(){if(this._schema===void 0){const e=[];for(const t of this.all()){const i={type:"object",additionalProperties:!1};t.required.length>0&&(i.required=t.required.slice(0)),t.properties!==void 0?i.properties=nt(t.properties):i.properties=Object.create(null),i.properties.type={type:"string",enum:[t.taskType]},e.push(i)}this._schema={oneOf:e}}return this._schema}},oM=new sM,aM="settings",Uq=new I("taskRunning",!1,h(11504,null)),Bq=new I("taskTerminalActive",!1,h(11505,null)),Wq=Fu(11507,"Tasks"),Zf;(function(e){e[e.Escape=1]="Escape",e[e.Strong=2]="Strong",e[e.Weak=3]="Weak"})(Zf||(Zf={})),function(e){function t(i){if(!i)return e.Strong;switch(i.toLowerCase()){case"escape":return e.Escape;case"strong":return e.Strong;case"weak":return e.Weak;default:return e.Strong}}e.from=t}(Zf||(Zf={}));var MI;(function(e){e.defaults={cwd:"${workspaceFolder}"}})(MI||(MI={}));var Gc;(function(e){e[e.Always=1]="Always",e[e.Silent=2]="Silent",e[e.Never=3]="Never"})(Gc||(Gc={})),function(e){function t(i){switch(i.toLowerCase()){case"always":return e.Always;case"silent":return e.Silent;case"never":return e.Never;default:return e.Always}}e.fromString=t}(Gc||(Gc={}));var Qc;(function(e){e[e.Never=1]="Never",e[e.OnProblem=2]="OnProblem",e[e.Always=3]="Always"})(Qc||(Qc={})),function(e){function t(i){switch(i.toLowerCase()){case"always":return e.Always;case"never":return e.Never;case"onproblem":return e.OnProblem;default:return e.OnProblem}}e.fromString=t}(Qc||(Qc={}));var Jc;(function(e){e[e.Shared=1]="Shared",e[e.Dedicated=2]="Dedicated",e[e.New=3]="New"})(Jc||(Jc={})),function(e){function t(i){switch(i.toLowerCase()){case"shared":return e.Shared;case"dedicated":return e.Dedicated;case"new":return e.New;default:return e.Shared}}e.fromString=t}(Jc||(Jc={}));var OI;(function(e){e.defaults={echo:!0,reveal:Gc.Always,revealProblems:Qc.Never,focus:!1,panel:Jc.Shared,showReuseMessage:!0,clear:!1}})(OI||(OI={}));var Kf;(function(e){e[e.Shell=1]="Shell",e[e.Process=2]="Process",e[e.CustomExecution=3]="CustomExecution"})(Kf||(Kf={})),function(e){function t(r){switch(r.toLowerCase()){case"shell":return e.Shell;case"process":return e.Process;case"customExecution":return e.CustomExecution;default:return e.Process}}e.fromString=t;function i(r){switch(r){case e.Shell:return"shell";case e.Process:return"process";case e.CustomExecution:return"customExecution";default:return"process"}}e.toString=i}(Kf||(Kf={}));var FI;(function(e){function t(i){return Me(i)?i:i.value}e.value=t})(FI||(FI={}));var $I;(function(e){e.Clean={_id:"clean",isDefault:!1},e.Build={_id:"build",isDefault:!1},e.Rebuild={_id:"rebuild",isDefault:!1},e.Test={_id:"test",isDefault:!1};function t(r){return r===e.Clean._id||r===e.Build._id||r===e.Rebuild._id||r===e.Test._id}e.is=t;function i(r){if(r!==void 0)return Me(r)?t(r)?{_id:r,isDefault:!1}:void 0:r}e.from=i})($I||($I={}));var HI;(function(e){e[e.Global=1]="Global",e[e.Workspace=2]="Workspace",e[e.Folder=3]="Folder"})(HI||(HI={}));var UI;(function(e){e.Workspace="workspace",e.Extension="extension",e.InMemory="inMemory",e.WorkspaceFile="workspaceFile",e.User="user";function t(i){switch(i){case e.User:return 2;case e.WorkspaceFile:return 5;default:return 6}}e.toConfigurationTarget=t})(UI||(UI={}));var BI;(function(e){e.parallel="parallel",e.sequence="sequence"})(BI||(BI={}));var i0;(function(e){e[e.default=1]="default",e[e.folderOpen=2]="folderOpen"})(i0||(i0={}));var WI;(function(e){e.defaults={reevaluateOnRerun:!0,runOn:i0.default,instanceLimit:1}})(WI||(WI={}));var Yf;(function(e){e[e.Process=1]="Process",e[e.Terminal=2]="Terminal"})(Yf||(Yf={})),function(e){e._default=e.Terminal}(Yf||(Yf={}));var VI;(function(e){e[e.V0_1_0=1]="V0_1_0",e[e.V2_0_0=2]="V2_0_0"})(VI||(VI={}));var zI;(function(e){e.SingleRun="singleRun",e.Background="background"})(zI||(zI={}));var so;(function(e){e.Changed="changed",e.ProcessStarted="processStarted",e.ProcessEnded="processEnded",e.Terminated="terminated",e.Start="start",e.AcquiredInput="acquiredInput",e.DependsOnStarted="dependsOnStarted",e.Active="active",e.Inactive="inactive",e.End="end",e.ProblemMatcherStarted="problemMatcherStarted",e.ProblemMatcherEnded="problemMatcherEnded",e.ProblemMatcherFoundErrors="problemMatcherFoundErrors"})(so||(so={}));var qI;(function(e){e[e.System=0]="System",e[e.User=1]="User",e[e.FolderOpen=2]="FolderOpen",e[e.ConfigurationChange=3]="ConfigurationChange",e[e.Reconnect=4]="Reconnect"})(qI||(qI={}));var jI;(function(e){function t(l){return{taskId:l._id,taskName:l.configurationProperties.name,runType:l.configurationProperties.isBackground?"background":"singleRun",group:l.configurationProperties.group,__task:l}}function i(l,c,u){return{...t(l),kind:so.Start,terminalId:c,resolvedVariables:u}}e.start=i;function r(l,c,u){return{...t(l),kind:so.ProcessStarted,terminalId:c,processId:u}}e.processStarted=r;function n(l,c,u){return{...t(l),kind:so.ProcessEnded,terminalId:c,exitCode:u}}e.processEnded=n;function s(l,c,u){return{...t(l),kind:so.Terminated,exitReason:u,terminalId:c}}e.terminated=s;function o(l,c,u){return{...t(c),kind:l,terminalId:u}}e.general=o;function a(){return{kind:so.Changed}}e.changed=a})(jI||(jI={}));var ep;(function(e){function t(r){const n=Object.keys(r).sort();let s="";for(const o of n){let a=r[o];a instanceof Object?a=t(a):typeof a=="string"&&(a=a.replace(/,/g,",,")),s+=o+","+a+","}return s}function i(r){const s={_key:t(r),type:r.taskType};return Object.assign(s,r),s}e.create=i})(ep||(ep={}));var GI;(function(e){e.AutoDetect="task.autoDetect",e.SaveBeforeRun="task.saveBeforeRun",e.ShowDecorations="task.showDecorations",e.ProblemMatchersNeverPrompt="task.problemMatchers.neverPrompt",e.SlowProviderWarning="task.slowProviderWarning",e.QuickOpenHistory="task.quickOpen.history",e.QuickOpenDetail="task.quickOpen.detail",e.QuickOpenSkip="task.quickOpen.skip",e.QuickOpenShowAll="task.quickOpen.showAll",e.AllowAutomaticTasks="task.allowAutomaticTasks",e.Reconnection="task.reconnection",e.VerboseLogging="task.verboseLogging"})(GI||(GI={}));var QI;(function(e){e.Tasks="tasks",e.SuppressTaskName="tasks.suppressTaskName",e.Windows="tasks.windows",e.Osx="tasks.osx",e.Linux="tasks.linux",e.ShowOutput="tasks.showOutput",e.IsShellCommand="tasks.isShellCommand",e.ServiceTestSetting="tasks.service.testSetting"})(QI||(QI={}));var JI;(function(e){function t(i,r){const n=oM.get(i.type);if(n===void 0){const l=nt(i);return delete l._key,ep.create(l)}const s=Object.create(null);s.type=n.taskType;const o=new Set;n.required.forEach(l=>o.add(l));const a=n.properties;for(const l of Object.keys(a)){const c=i[l];if(c!=null)s[l]=c;else if(o.has(l)){const u=a[l];if(u.default!==void 0)s[l]=nt(u.default);else switch(u.type){case"boolean":s[l]=!1;break;case"number":case"integer":s[l]=0;break;case"string":s[l]="";break;default:r.error(h(11506,null,JSON.stringify(i,void 0,0),l));return}}}return ep.create(s)}e.createTaskIdentifier=t})(JI||(JI={}));var tp;(function(e){function t(r){if(r!=null)return r}e.from=t;function i(r){if(r!=null)return r}e.to=i})(tp||(tp={}));var ip;(function(e){function t(r){if(r!=null)return r}e.from=t;function i(r){if(r!=null)return r}e.to=i})(ip||(ip={}));var r0;(function(e){function t(r){if(r!=null)return r}e.from=t;function i(r){if(r!=null)return r}e.to=i})(r0||(r0={}));var Xc;(function(e){function t(n){if(n){const s=n;return s&&!!s.process}else return!1}e.is=t;function i(n){if(n==null)return;const s={process:n.process,args:n.args};return n.options&&(s.options=r0.from(n.options)),s}e.from=i;function r(n){if(n!=null)return new aa(n.process,n.args,n.options)}e.to=r})(Xc||(Xc={}));var n0;(function(e){function t(r){if(r!=null)return r}e.from=t;function i(r){if(r!=null)return r}e.to=i})(n0||(n0={}));var Zc;(function(e){function t(n){if(n){const s=n;return s&&(!!s.commandLine||!!s.command)}else return!1}e.is=t;function i(n){if(n==null)return;const s={};return n.commandLine!==void 0?s.commandLine=n.commandLine:(s.command=n.command,s.args=n.args),n.options&&(s.options=n0.from(n.options)),s}e.from=i;function r(n){if(!(n==null||n.command===void 0&&n.commandLine===void 0))return n.commandLine?new Hs(n.commandLine,n.options):new Hs(n.command,n.args?n.args:[],n.options)}e.to=r})(Zc||(Zc={}));var pn;(function(e){function t(n){if(n){const s=n;return s&&s.customExecution==="customExecution"}else return!1}e.is=t;function i(n){return{customExecution:"customExecution"}}e.from=i;function r(n,s){return s.get(n)}e.to=r})(pn||(pn={}));var XI;(function(e){function t(i,r){let n;return i.scope!==void 0&&typeof i.scope!="number"?n=i.scope.uri:i.scope!==void 0&&typeof i.scope=="number"&&(i.scope===Bn.Workspace&&r&&r.workspaceFile?n=r.workspaceFile:n=aM),{id:i._id,workspaceFolder:n}}e.from=t})(XI||(XI={}));var s0;(function(e){function t(i){if(i!=null)return{_id:i.id,isDefault:i.isDefault}}e.from=t})(s0||(s0={}));var es;(function(e){function t(n,s){if(n==null)return[];const o=[];for(const a of n){const l=i(a,s);l&&o.push(l)}return o}e.fromMany=t;function i(n,s){if(n==null)return;let o;n.execution instanceof aa?o=Xc.from(n.execution):n.execution instanceof Hs?o=Zc.from(n.execution):n.execution&&n.execution instanceof Dv&&(o=pn.from(n.execution));const a=tp.from(n.definition);let l;return n.scope?typeof n.scope=="number"?l=n.scope:l=n.scope.uri:l=Bn.Workspace,!a||!l?void 0:{_id:n._id,definition:a,name:n.name,source:{extensionId:s.identifier.value,label:n.source,scope:l},execution:o,isBackground:n.isBackground,group:s0.from(n.group),presentationOptions:ip.from(n.presentationOptions),problemMatchers:Fi(n.problemMatchers),hasDefinedMatchers:n.hasDefinedMatchers,runOptions:n.runOptions?n.runOptions:{reevaluateOnRerun:!0},detail:n.detail}}e.from=i;async function r(n,s,o){if(n==null)return;let a;Xc.is(n.execution)?a=Xc.to(n.execution):Zc.is(n.execution)?a=Zc.to(n.execution):pn.is(n.execution)&&(a=pn.to(n._id,o));const l=tp.to(n.definition);let c;if(n.source&&(n.source.scope!==void 0?typeof n.source.scope=="number"?c=n.source.scope:c=await s.resolveWorkspaceFolder(y.revive(n.source.scope)):c=Bn.Workspace),!l||!c)return;const u=new gh(l,c,n.name,n.source.label,a,n.problemMatchers);return n.isBackground!==void 0&&(u.isBackground=n.isBackground),n.group!==void 0&&(u.group=tc.from(n.group._id),u.group&&n.group.isDefault&&(u.group=new tc(u.group.id,u.group.label),n.group.isDefault===!0&&(u.group.isDefault=n.group.isDefault))),n.presentationOptions&&(u.presentationOptions=ip.to(n.presentationOptions)),n._id&&(u._id=n._id),n.detail&&(u.detail=n.detail),u}e.to=r})(es||(es={}));var o0;(function(e){function t(r){return r}e.from=t;function i(r){if(r)return Object.assign(Object.create(null),r)}e.to=i})(o0||(o0={}));var a0=class{#e;constructor(e,t,i){this._id=t,this._task=i,this.#e=e}get task(){return this._task}terminate(){this.#e.terminateTask(this)}fireDidStartProcess(e){}fireDidEndProcess(e){}},l0=class{constructor(t,i,r,n,s,o,a,l){this._onDidExecuteTask=new P,this._onDidTerminateTask=new P,this._onDidTaskProcessStarted=new P,this._onDidTaskProcessEnded=new P,this._onDidStartTaskProblemMatchers=new P,this._onDidEndTaskProblemMatchers=new P,this._proxy=t.getProxy(W.MainThreadTask),this._workspaceProvider=r,this._editorService=n,this._configurationService=s,this._terminalService=o,this._handleCounter=0,this._handlers=new Map,this._taskExecutions=new Map,this._taskExecutionPromises=new Map,this._providedCustomExecutions2=new Map,this._notProvidedCustomExecutions=new Set,this._activeCustomExecutions2=new Map,this._logService=a,this._deprecationService=l,this._proxy.$registerSupportedExecutions(!0)}registerTaskProvider(t,i,r){if(!r)return new Ce(()=>{});const n=this.nextHandle();return this._handlers.set(n,{type:i,provider:r,extension:t}),this._proxy.$registerTaskProvider(n,i),new Ce(()=>{this._handlers.delete(n),this._proxy.$unregisterTaskProvider(n)})}registerTaskSystem(t,i){this._proxy.$registerTaskSystem(t,i)}fetchTasks(t){return this._proxy.$fetchTasks(o0.from(t)).then(async i=>{const r=[];for(const n of i){const s=await es.to(n,this._workspaceProvider,this._providedCustomExecutions2);s&&r.push(s)}return r})}get taskExecutions(){const t=[];return this._taskExecutions.forEach(i=>t.push(i)),t}terminateTask(t){if(!(t instanceof a0))throw new Error("No valid task execution provided");return this._proxy.$terminateTask(t._id)}get onDidStartTask(){return this._onDidExecuteTask.event}async $onDidStartTask(t,i,r){const n=this._providedCustomExecutions2.get(t.id);n&&(this._activeCustomExecutions2.set(t.id,n),this._terminalService.attachPtyToTerminal(i,await n.callback(r))),this._lastStartedTask=t.id,this._onDidExecuteTask.fire({execution:await this.getTaskExecution(t)})}get onDidEndTask(){return this._onDidTerminateTask.event}async $OnDidEndTask(t){if(!this._taskExecutionPromises.has(t.id))return;const i=await this.getTaskExecution(t);this._taskExecutionPromises.delete(t.id),this._taskExecutions.delete(t.id),this.customExecutionComplete(t),this._onDidTerminateTask.fire({execution:i})}get onDidStartTaskProcess(){return this._onDidTaskProcessStarted.event}async $onDidStartTaskProcess(t){const i=await this.getTaskExecution(t.id);this._onDidTaskProcessStarted.fire({execution:i,processId:t.processId})}get onDidEndTaskProcess(){return this._onDidTaskProcessEnded.event}async $onDidEndTaskProcess(t){const i=await this.getTaskExecution(t.id);this._onDidTaskProcessEnded.fire({execution:i,exitCode:t.exitCode})}get onDidStartTaskProblemMatchers(){return this._onDidStartTaskProblemMatchers.event}async $onDidStartTaskProblemMatchers(t){let i;try{i=await this.getTaskExecution(t.execution.id)}catch{return}this._onDidStartTaskProblemMatchers.fire({execution:i})}get onDidEndTaskProblemMatchers(){return this._onDidEndTaskProblemMatchers.event}async $onDidEndTaskProblemMatchers(t){let i;try{i=await this.getTaskExecution(t.execution.id)}catch{return}this._onDidEndTaskProblemMatchers.fire({execution:i,hasErrors:t.hasErrors})}$provideTasks(t,i){const r=this._handlers.get(t);if(!r)return Promise.reject(new Error("no handler found"));const n=[],s=Kt(()=>r.provider.provideTasks(Xe.None)).then(o=>this.provideTasksInternal(i,n,r,o));return new Promise(o=>{s.then(a=>{Promise.all(n).then(()=>{o(a)})})})}async $resolveTask(t,i){const r=this._handlers.get(t);if(!r)return Promise.reject(new Error("no handler found"));if(i.definition.type!==r.type)throw new Error(`Unexpected: Task of type [${i.definition.type}] cannot be resolved by provider of type [${r.type}].`);const n=await es.to(i,this._workspaceProvider,this._providedCustomExecutions2);if(!n)throw new Error("Unexpected: Task cannot be resolved.");const s=await r.provider.resolveTask(n,Xe.None);if(!s)return;this.checkDeprecation(s,r);const o=es.from(s,r.extension);if(!o)throw new Error("Unexpected: Task cannot be resolved.");if(s.definition!==n.definition)throw new Error("Unexpected: The resolved task definition must be the same object as the original task definition. The task definition cannot be changed.");return pn.is(o.execution)&&await this.addCustomExecution(o,s,!0),await this.resolveTaskInternal(o)}nextHandle(){return this._handleCounter++}async addCustomExecution(t,i,r){const n=await this._proxy.$createTaskId(t);!r&&!this._providedCustomExecutions2.has(n)&&(this._notProvidedCustomExecutions.add(n),this._activeCustomExecutions2.set(n,i.execution)),this._providedCustomExecutions2.set(n,i.execution)}async getTaskExecution(t,i){if(typeof t=="string"){const s=this._taskExecutionPromises.get(t);if(!s)throw new as("Unexpected: The specified task is missing an execution");return s}const r=this._taskExecutionPromises.get(t.id);if(r)return r;let n;return i?n=Promise.resolve(new a0(this,t.id,i)):n=es.to(t.task,this._workspaceProvider,this._providedCustomExecutions2).then(s=>{if(!s)throw new as("Unexpected: Task does not exist.");return new a0(this,t.id,s)}),this._taskExecutionPromises.set(t.id,n),n.then(s=>(this._taskExecutions.set(t.id,s),s))}checkDeprecation(t,i){t._deprecated&&this._deprecationService.report("Task.constructor",i.extension,"Use the Task constructor that takes a `scope` instead.")}customExecutionComplete(t){this._activeCustomExecutions2.get(t.id)&&this._activeCustomExecutions2.delete(t.id),this._notProvidedCustomExecutions.has(t.id)&&this._lastStartedTask!==t.id&&(this._providedCustomExecutions2.delete(t.id),this._notProvidedCustomExecutions.delete(t.id));const r=this._notProvidedCustomExecutions.values();let n=r.next();for(;!n.done;)!this._activeCustomExecutions2.has(n.value)&&this._lastStartedTask!==n.value&&(this._providedCustomExecutions2.delete(n.value),this._notProvidedCustomExecutions.delete(n.value)),n=r.next()}};l0=__decorate([__param(0,Ue),__param(1,Yt),__param(2,hn),__param(3,Wa),__param(4,fn),__param(5,Ha),__param(6,qe),__param(7,Jf)],l0);var c0=class extends l0{constructor(t,i,r,n,s,o,a,l){super(t,i,r,n,s,o,a,l),this.registerTaskSystem(V.vscodeRemote,{scheme:V.vscodeRemote,authority:"",platform:aP(0)})}async executeTask(t,i){if(!i.execution)throw new Error("Tasks to execute must include an execution");const r=es.from(i,t);if(r===void 0)throw new Error("Task is not valid");if(pn.is(r.execution))await this.addCustomExecution(r,i,!1);else throw new eg;const n=await this.getTaskExecution(await this._proxy.$getTaskExecution(r),i);return this._proxy.$executeTask(r).catch(s=>{throw new Error(s)}),n}provideTasksInternal(t,i,r,n){const s=[];if(n)for(const o of n){if(this.checkDeprecation(o,r),!o.definition||!t[o.definition.type]){const l=o.source?o.source:"No task source";this._logService.warn(`The task [${l}, ${o.name}] uses an undefined task type. The task will be ignored in the future.`)}const a=es.from(o,r.extension);a&&pn.is(a.execution)?(s.push(a),i.push(this.addCustomExecution(a,o,!0))):this._logService.warn("Only custom execution tasks supported.")}return{tasks:s,extension:r.extension}}async resolveTaskInternal(t){if(pn.is(t.execution))return t;this._logService.warn("Only custom execution tasks supported.")}async $resolveVariables(t,i){return{process:void 0,variables:Object.create(null)}}async $jsonTasksSupported(){return!1}async $findExecutable(t,i,r){}};c0=__decorate([__param(0,Ue),__param(1,Yt),__param(2,hn),__param(3,Wa),__param(4,fn),__param(5,Ha),__param(6,qe),__param(7,Jf)],c0);var ZI=U("IExtHostTask"),lM=class{constructor(){this.pendingRequests=new Map,this.queue=[],this._onError=new P,this._onExit=new P,this.sequence=1}get onError(){return this._onError.event}get onExit(){return this._onExit.event}onMessage(e){this.messageCallback&&this._onError.fire(new Error("attempt to set more than one 'Message' callback")),this.messageCallback=e}onEvent(e){this.eventCallback&&this._onError.fire(new Error("attempt to set more than one 'Event' callback")),this.eventCallback=e}onRequest(e){this.requestCallback&&this._onError.fire(new Error("attempt to set more than one 'Request' callback")),this.requestCallback=e}sendResponse(e){e.seq>0?this._onError.fire(new Error(`attempt to send more than one response for command ${e.command}`)):this.internalSend("response",e)}sendRequest(e,t,i,r){const n={command:e};if(t&&Object.keys(t).length>0&&(n.arguments=t),this.internalSend("request",n),typeof r=="number"){const s=setTimeout(()=>{clearTimeout(s);const o=this.pendingRequests.get(n.seq);if(o){this.pendingRequests.delete(n.seq);const a={type:"response",seq:0,request_seq:n.seq,success:!1,command:e,message:h(6659,null,r,e)};o(a)}},r)}return i&&this.pendingRequests.set(n.seq,i),n.seq}acceptMessage(e){this.messageCallback?this.messageCallback(e):(this.queue.push(e),this.queue.length===1&&this.processQueue())}needsTaskBoundaryBetween(e,t){return e.type!=="event"||t.type!=="event"}async processQueue(){let e;for(;this.queue.length;){if((!e||this.needsTaskBoundaryBetween(this.queue[0],e))&&await sr(0),e=this.queue.shift(),!e)return;switch(e.type){case"event":this.eventCallback?.(e);break;case"request":this.requestCallback?.(e);break;case"response":{const t=e,i=this.pendingRequests.get(t.request_seq);i&&(this.pendingRequests.delete(t.request_seq),i(t));break}}}}internalSend(e,t){t.type=e,t.seq=this.sequence++,this.sendMessage(t)}async cancelPendingRequests(){if(this.pendingRequests.size===0)return Promise.resolve();const e=new Map;this.pendingRequests.forEach((t,i)=>e.set(i,t)),await sr(500),e.forEach((t,i)=>{t({type:"response",seq:0,request_seq:i,success:!1,command:"canceled",message:"canceled"}),this.pendingRequests.delete(i)})}getPendingRequestIds(){return Array.from(this.pendingRequests.keys())}dispose(){this.queue=[]}};function cM(e){return e.type&&(e.label||e.program||e.runtime)}var uM=/^[a-zA-Z][a-zA-Z0-9\+\-\.]+:/;function dM(e){return!!(e&&e.match(uM))}function KI(e){if(typeof e.path=="string"&&!(typeof e.sourceReference=="number"&&e.sourceReference>0)){if(dM(e.path))return y.parse(e.path);if(Bu(e.path))return y.file(e.path)}return e.path}function YI(e){if(typeof e.path=="object"){const t=y.revive(e.path);if(t)return t.scheme===V.file?t.fsPath:t.toString()}return e.path}function hM(e,t){const i=t?KI:YI,r=nt(e);return e5(r,(n,s)=>{n&&s&&(s.path=i(s))}),r}function fM(e,t){const i=t?KI:YI,r=nt(e);return e5(r,(n,s)=>{!n&&s&&(s.path=i(s))}),r}function e5(e,t){switch(e.type){case"event":{const i=e;switch(i.event){case"output":t(!1,i.body.source);break;case"loadedSource":t(!1,i.body.source);break;case"breakpoint":t(!1,i.body.breakpoint.source);break;default:break}break}case"request":{const i=e;switch(i.command){case"setBreakpoints":t(!0,i.arguments.source);break;case"breakpointLocations":t(!0,i.arguments.source);break;case"source":t(!0,i.arguments.source);break;case"gotoTargets":t(!0,i.arguments.source);break;case"launchVSCode":i.arguments.args.forEach(r=>t(!1,r));break;default:break}break}case"response":{const i=e;if(i.success&&i.body)switch(i.command){case"stackTrace":i.body.stackFrames.forEach(r=>t(!1,r.source));break;case"loadedSources":i.body.sources.forEach(r=>t(!1,r));break;case"scopes":i.body.scopes.forEach(r=>t(!1,r.source));break;case"setFunctionBreakpoints":i.body.breakpoints.forEach(r=>t(!1,r.source));break;case"setBreakpoints":i.body.breakpoints.forEach(r=>t(!1,r.source));break;case"disassemble":i.body?.instructions.forEach(n=>t(!1,n.location));break;case"locations":t(!1,i.body?.source);break;default:break}break}}}var Kc=U("IExtHostEditorTabs"),t5=class{constructor(e,t,i){this._activeTabIdGetter=i,this._parentGroup=t,this.acceptDtoUpdate(e)}get apiObject(){if(!this._apiObject){const e=this,t={get isActive(){return e._dto.id===e._activeTabIdGetter()},get label(){return e._dto.label},get input(){return e._input},get isDirty(){return e._dto.isDirty},get isPinned(){return e._dto.isPinned},get isPreview(){return e._dto.isPreview},get group(){return e._parentGroup.apiObject}};this._apiObject=Object.freeze(t)}return this._apiObject}get tabId(){return this._dto.id}acceptDtoUpdate(e){this._dto=e,this._input=this._initInput()}_initInput(){switch(this._dto.input.kind){case 1:return new qv(y.revive(this._dto.input.uri));case 2:return new Uh(y.revive(this._dto.input.original),y.revive(this._dto.input.modified));case 3:return new k4(y.revive(this._dto.input.base),y.revive(this._dto.input.input1),y.revive(this._dto.input.input2),y.revive(this._dto.input.result));case 6:return new jv(y.revive(this._dto.input.uri),this._dto.input.viewType);case 7:return new P4(this._dto.input.viewType);case 4:return new Gv(y.revive(this._dto.input.uri),this._dto.input.notebookType);case 5:return new Qv(y.revive(this._dto.input.original),y.revive(this._dto.input.modified),this._dto.input.notebookType);case 8:return new T4;case 9:return new A4(y.revive(this._dto.input.uri),y.revive(this._dto.input.inputBoxUri));case 10:return new R4;case 11:return new L4(this._dto.input.diffEditors.map(e=>new Uh(y.revive(e.original),y.revive(e.modified))));default:return}}},pM=class{constructor(e,t){this._tabs=[],this._activeTabId="",this._dto=e,this._activeGroupIdGetter=t;for(const i of e.tabs)i.isActive&&(this._activeTabId=i.id),this._tabs.push(new t5(i,this,()=>this.activeTabId()))}get apiObject(){if(!this._apiObject){const e=this,t={get isActive(){return e._dto.groupId===e._activeGroupIdGetter()},get viewColumn(){return Rt.to(e._dto.viewColumn)},get activeTab(){return e._tabs.find(i=>i.tabId===e._activeTabId)?.apiObject},get tabs(){return Object.freeze(e._tabs.map(i=>i.apiObject))}};this._apiObject=Object.freeze(t)}return this._apiObject}get groupId(){return this._dto.groupId}get tabs(){return this._tabs}acceptGroupDtoUpdate(e){this._dto=e}acceptTabOperation(e){if(e.kind===0){const i=new t5(e.tabDto,this,()=>this.activeTabId());return this._tabs.splice(e.index,0,i),e.tabDto.isActive&&(this._activeTabId=i.tabId),i}else if(e.kind===1){const i=this._tabs.splice(e.index,1)[0];if(!i)throw new Error(`Tab close updated received for index ${e.index} which does not exist`);return i.tabId===this._activeTabId&&(this._activeTabId=""),i}else if(e.kind===3){if(e.oldIndex===void 0)throw new Error("Invalid old index on move IPC");const i=this._tabs.splice(e.oldIndex,1)[0];if(!i)throw new Error(`Tab move updated received for index ${e.oldIndex} which does not exist`);return this._tabs.splice(e.index,0,i),i}const t=this._tabs.find(i=>i.tabId===e.tabDto.id);if(!t)throw new Error("INVALID tab");return e.tabDto.isActive?this._activeTabId=e.tabDto.id:this._activeTabId===e.tabDto.id&&!e.tabDto.isActive&&(this._activeTabId=""),t.acceptDtoUpdate(e.tabDto),t}activeTabId(){return this._activeTabId}},u0=class{constructor(t){this._onDidChangeTabs=new P,this._onDidChangeTabGroups=new P,this._extHostTabGroups=[],this._proxy=t.getProxy(W.MainThreadEditorTabs)}get tabGroups(){if(!this._apiObject){const t=this,i={onDidChangeTabGroups:t._onDidChangeTabGroups.event,onDidChangeTabs:t._onDidChangeTabs.event,get all(){return Object.freeze(t._extHostTabGroups.map(r=>r.apiObject))},get activeTabGroup(){const r=t._activeGroupId;return xo(t._extHostTabGroups.find(s=>s.groupId===r)?.apiObject)},close:async(r,n)=>{const s=Array.isArray(r)?r:[r];return s.length?gM(s[0])?this._closeGroups(s,n):this._closeTabs(s,n):!0}};this._apiObject=Object.freeze(i)}return this._apiObject}$acceptEditorTabModel(t){const i=new Set(this._extHostTabGroups.map(c=>c.groupId)),r=new Set(t.map(c=>c.groupId)),n=u9(i,r),s=this._extHostTabGroups.filter(c=>n.removed.includes(c.groupId)).map(c=>c.apiObject),o=[],a=[];this._extHostTabGroups=t.map(c=>{const u=new pM(c,()=>this._activeGroupId);return n.added.includes(u.groupId)?o.push(u.apiObject):a.push(u.apiObject),u});const l=xo(t.find(c=>c.isActive===!0)?.groupId);l!==void 0&&this._activeGroupId!==l&&(this._activeGroupId=l),this._onDidChangeTabGroups.fire(Object.freeze({opened:o,closed:s,changed:a}))}$acceptTabGroupUpdate(t){const i=this._extHostTabGroups.find(r=>r.groupId===t.groupId);if(!i)throw new Error("Update Group IPC call received before group creation.");i.acceptGroupDtoUpdate(t),t.isActive&&(this._activeGroupId=t.groupId),this._onDidChangeTabGroups.fire(Object.freeze({changed:[i.apiObject],opened:[],closed:[]}))}$acceptTabOperation(t){const i=this._extHostTabGroups.find(n=>n.groupId===t.groupId);if(!i)throw new Error("Update Tabs IPC call received before group creation.");const r=i.acceptTabOperation(t);switch(t.kind){case 0:this._onDidChangeTabs.fire(Object.freeze({opened:[r.apiObject],closed:[],changed:[]}));return;case 1:this._onDidChangeTabs.fire(Object.freeze({opened:[],closed:[r.apiObject],changed:[]}));return;case 3:case 2:this._onDidChangeTabs.fire(Object.freeze({opened:[],closed:[],changed:[r.apiObject]}));return}}_findExtHostTabFromApi(t){for(const i of this._extHostTabGroups)for(const r of i.tabs)if(r.apiObject===t)return r}_findExtHostTabGroupFromApi(t){return this._extHostTabGroups.find(i=>i.apiObject===t)}async _closeTabs(t,i){const r=[];for(const n of t){const s=this._findExtHostTabFromApi(n);if(!s)throw new Error("Tab close: Invalid tab not found!");r.push(s.tabId)}return this._proxy.$closeTab(r,i)}async _closeGroups(t,i){const r=[];for(const n of t){const s=this._findExtHostTabGroupFromApi(n);if(!s)throw new Error("Group close: Invalid group not found!");r.push(s.groupId)}return this._proxy.$closeGroup(r,i)}};u0=__decorate([__param(0,Ue)],u0);function gM(e){return e.tabs!==void 0}var mM=0,i5=new WeakMap,rp=U("IExtHostTesting"),d0=class extends se{constructor(t,i,r,n){super(),this.logService=i,this.commands=r,this.editors=n,this.resultsChangedEmitter=this._register(new P),this.controllers=new Map,this.defaultProfilesChangedEmitter=this._register(new P),this.followupProviders=new Set,this.testFollowups=new Map,this.onResultsChanged=this.resultsChangedEmitter.event,this.results=[],this.proxy=t.getProxy(W.MainThreadTesting),this.observer=new xM(this.proxy),this.runTracker=new wM(this.proxy,i),r.registerArgumentProcessor({processArgument:s=>{switch(s?.$mid){case 16:{const o=s,a=o.tests[o.tests.length-1].item.extId;return this.controllers.get(Re.root(a))?.collection.tree.get(a)?.actual??$D(s)}case 18:{const{test:o,message:a}=s,l=o.item.extId;return{test:this.controllers.get(Re.root(l))?.collection.tree.get(l)?.actual??$D({$mid:16,tests:[o]}),message:ka.to(a)}}default:return s}}}),r.registerCommand(!1,"testing.getExplorerSelection",async()=>{const s=await r.executeCommand("_testing.getExplorerSelection"),o=a=>{const l=this.controllers.get(Re.root(a));if(l)return Re.isRoot(a)?l.controller:l.collection.tree.get(a)?.actual};return{include:s?.include.map(o).filter(ji)||[],exclude:s?.exclude.map(o).filter(ji)||[]}})}createTestController(t,i,r,n){if(this.controllers.has(i))throw new Error(`Attempt to insert a duplicate controller with ID "${i}"`);const s=new he,o=s.add(new qL(i,r,this.editors));o.root.label=r;const a=new Map,l=new Set,c=this.proxy,u=()=>{let p=0;n&&(p|=2);const m=f.relatedCodeProvider;return m&&(m?.provideRelatedTests&&(p|=8),m?.provideRelatedCode&&(p|=4)),p},d={items:o.root.children,get label(){return r},set label(p){r=p,o.root.label=p,c.$updateController(i,{label:r})},get refreshHandler(){return n},set refreshHandler(p){n=p,c.$updateController(i,{capabilities:u()})},get id(){return i},get relatedCodeProvider(){return f.relatedCodeProvider},set relatedCodeProvider(p){N(t,"testRelatedCode"),f.relatedCodeProvider=p,c.$updateController(i,{capabilities:u()})},createRunProfile:(p,m,_,b,E,C)=>{let T=ml(p);for(;a.has(T);)T++;return new o5(this.proxy,a,l,this.defaultProfilesChangedEmitter.event,i,T,p,m,_,b,E,C)},createTestItem(p,m,_){return new Wc(i,p,m,_)},createTestRun:(p,m,_=!0)=>this.runTracker.createTestRun(t,i,o,p,m,_),invalidateTestResults:p=>{if(p===void 0)this.proxy.$markTestRetired(void 0);else{const m=p instanceof Array?p:[p];this.proxy.$markTestRetired(m.map(_=>Re.fromExtHostTestItem(_,i).toString()))}},set resolveHandler(p){o.resolveHandler=p},get resolveHandler(){return o.resolveHandler},dispose:()=>{s.dispose()}},f={controller:d,collection:o,profiles:a,extension:t,activeProfiles:l};return c.$registerTestController(i,r,u()),s.add(ne(()=>c.$unregisterTestController(i))),this.controllers.set(i,f),s.add(ne(()=>this.controllers.delete(i))),s.add(o.onDidGenerateDiff(p=>c.$publishDiff(i,p.map(Xd.serialize)))),d}createTestObserver(){return this.observer.checkout()}async runTests(t,i=Xe.None){const r=n5(t);if(!r)throw new Error("The request passed to `vscode.test.runTests` must include a profile");const n=this.controllers.get(r.controllerId);if(!n)throw new Error("Controller not found");await this.proxy.$runTests({preserveFocus:t.preserveFocus??!0,group:Pa.from(r.kind),targets:[{testIds:t.include?.map(s=>Re.fromExtHostTestItem(s,n.collection.root.id).toString())??[n.collection.root.id],profileId:r.profileId,controllerId:r.controllerId}],exclude:t.exclude?.map(s=>s.id)},i)}registerTestFollowupProvider(t){return this.followupProviders.add(t),{dispose:()=>{this.followupProviders.delete(t)}}}async $getTestsRelatedToCode(t,i,r){const n=this.editors.getDocument(y.revive(t));if(!n)return[];const s=Be.to(i),o=[];return await Promise.all([...this.controllers.values()].map(async a=>{let l;try{l=await a.relatedCodeProvider?.provideRelatedTests?.(n.document,s,r)}catch(c){r.isCancellationRequested||this.logService.warn(`Error thrown while providing related tests for ${a.controller.label}`,c)}if(l){for(const c of l)o.push(Re.fromExtHostTestItem(c,a.controller.id).toString());a.collection.flushDiff()}})),o}async $getCodeRelatedToTest(t,i){const r=this.controllers.get(Re.root(t));if(!r)return[];const n=r.collection.tree.get(t);return n?(await r.relatedCodeProvider?.provideRelatedCode?.(n.actual,i))?.map(vi.from)??[]:[]}$syncTests(){for(const{collection:t}of this.controllers.values())t.flushDiff();return Promise.resolve()}async $getCoverageDetails(t,i,r){return(await this.runTracker.getCoverageDetails(t,i,r))?.map(kc.fromDetails)}async $disposeRun(t){this.runTracker.disposeTestRun(t)}$configureRunProfile(t,i){this.controllers.get(t)?.profiles.get(i)?.configureHandler?.()}$setDefaultRunProfiles(t){const i=new Map;for(const[r,n]of Object.entries(t)){const s=this.controllers.get(r);if(!s)continue;const o=new Map,a=n.filter(c=>!s.activeProfiles.has(c)),l=[...s.activeProfiles].filter(c=>!n.includes(c));for(const c of a)o.set(c,!0),s.activeProfiles.add(c);for(const c of l)o.set(c,!1),s.activeProfiles.delete(c);o.size&&i.set(r,o)}this.defaultProfilesChangedEmitter.fire(i)}async $refreshTests(t,i){await this.controllers.get(t)?.controller.refreshHandler?.(i)}$publishTestResults(t){this.results=Object.freeze(t.map(i=>{const r=M1.to(i),n=i.tasks.findIndex(s=>s.hasCoverage);return n!==-1&&(r.getDetailedCoverage=(s,o=Xe.None)=>this.proxy.$getCoverageDetails(i.id,n,s,o).then(a=>a.map(kc.to))),i5.set(r,i.id),r}).concat(this.results).sort((i,r)=>r.completedAt-i.completedAt).slice(0,32)),this.resultsChangedEmitter.fire()}async $expandTest(t,i){const r=this.controllers.get(Re.fromString(t).controllerId)?.collection;r&&(await r.expand(t,i<0?1/0:i),r.flushDiff())}$acceptDiff(t){this.observer.applyDiff(t.map(i=>Xd.deserialize({asCanonicalUri:r=>r},i)))}async $runControllerTests(t,i){return Promise.all(t.map(r=>this.runControllerTestRequest(r,!1,i)))}async $startContinuousRun(t,i){const r=new ft(i),n=await Promise.all(t.map(s=>this.runControllerTestRequest(s,!0,r.token)));return!i.isCancellationRequested&&!n.some(s=>s.error)&&await new Promise(s=>i.onCancellationRequested(s)),r.dispose(!0),n}async $provideTestFollowups(t,i){const r=this.results.find(o=>i5.get(o)===t.resultId),n=r&&SM(Re.fromString(t.extId),r?.results);if(!n)return[];let s=[];return await Promise.all([...this.followupProviders].map(async o=>{try{const a=await o.provideFollowup(r,n,t.taskIndex,t.messageIndex,i);a&&(s=s.concat(a))}catch(a){this.logService.error("Error thrown while providing followup for test message",a)}})),i.isCancellationRequested?[]:s.map(o=>{const a=mM++;return this.testFollowups.set(a,o),{title:o.title,id:a}})}$disposeTestFollowups(t){for(const i of t)this.testFollowups.delete(i)}$executeTestFollowup(t){const i=this.testFollowups.get(t);return i?this.commands.executeCommand(i.command,...i.arguments||[]):Promise.resolve()}$cancelExtensionTestRun(t,i){t===void 0?this.runTracker.cancelAllRuns():this.runTracker.cancelRunById(t,i)}getMetadataForRun(t){for(const i of this.runTracker.trackers){const r=i.getTaskIdForRun(t);if(r)return{taskId:r,runId:i.id}}}async runControllerTestRequest(t,i,r){const n=this.controllers.get(t.controllerId);if(!n)return{};const{collection:s,profiles:o,extension:a}=n,l=o.get(t.profileId);if(!l)return{};const c=t.testIds.map(p=>s.tree.get(p)).filter(ji),u=t.excludeExtIds.map(p=>n.collection.tree.get(p)).filter(ji).filter(p=>c.some(m=>m.fullId.compare(p.fullId)===2));if(!c.length)return{};const d=new Mh(c.some(p=>p.actual instanceof E_)?void 0:c.map(p=>p.actual),u.map(p=>p.actual),l,i),f=$R(t)&&this.runTracker.prepareForMainThreadTestRun(a,d,s5.fromInternal(t,n.collection),l,r);try{return await l.runHandler(d,r),{}}catch(p){return{error:String(p)}}finally{f&&f.hasRunningTasks&&!r.isCancellationRequested&&await ct.toPromise(f.onEnd)}}};d0=__decorate([__param(0,Ue),__param(1,qe),__param(2,no),__param(3,Wa)],d0);var vM=1e4,r5;(function(e){e[e.Running=0]="Running",e[e.Cancelling=1]="Cancelling",e[e.Ended=2]="Ended"})(r5||(r5={}));var _M=class extends se{get hasRunningTasks(){return this.running>0}get id(){return this.dto.id}constructor(e,t,i,r,n,s){super(),this.dto=e,this.proxy=t,this.logService=i,this.profile=r,this.extension=n,this.state=0,this.running=0,this.tasks=new Map,this.sharedTestIds=new Set,this.endEmitter=this._register(new P),this.publishedCoverage=new Map,this.onEnd=this.endEmitter.event,this.cts=this._register(new ft(s));const o=this._register(new Ao(()=>this.forciblyEndTasks(),vM));this._register(this.cts.token.onCancellationRequested(()=>o.schedule()));const a=new P;this.onDidDispose=a.event,this._register(ne(()=>{a.fire(),a.dispose()}))}getTaskIdForRun(e){for(const[t,{run:i}]of this.tasks)if(i===e)return t}cancel(e){e?this.tasks.get(e)?.cts.cancel():this.state===0?(this.cts.cancel(),this.state=1):this.state===1&&this.forciblyEndTasks()}async getCoverageDetails(e,t,i){const[,r]=Re.fromString(e).path,n=this.publishedCoverage.get(e);if(!n)return[];const{report:s,extIds:o}=n,a=this.tasks.get(r);if(!a)throw new Error("unreachable: run task was not found");let l;if(t&&s instanceof Hh){const u=o.indexOf(t);if(u===-1)return[];l=s.includesTests[u]}return await(l?this.profile?.loadDetailedCoverageForTest?.(a.run,s,l,i):this.profile?.loadDetailedCoverage?.(a.run,s,i))??[]}createRun(e){const t=this.dto.id,i=this.dto.controllerId,r=$t(),n=c=>(u,...d)=>{if(o){this.logService.warn(`Setting the state of test "${u.id}" is a no-op after the run ends.`);return}this.ensureTestIsKnown(u),c(u,...d)},s=(c,u)=>{const d=u instanceof Array?u.map(ka.from):[ka.from(u)];if(c.uri&&c.range){const f={range:F.from(c.range),uri:c.uri};for(const p of d)p.location=p.location||f}this.proxy.$appendTestMessagesInRun(t,r,Re.fromExtHostTestItem(c,i).toString(),d)};let o=!1;const a=this._register(new ft(this.cts.token)),l={isPersisted:this.dto.isPersisted,token:a.token,name:e,onDidDispose:this.onDidDispose,addCoverage:c=>{if(o)return;const u=c instanceof Hh?c.includesTests:[];if(u.length)for(const p of u)this.ensureTestIsKnown(p);const d=c.uri.toString(),f=new Re([t,r,d]).toString();this.publishedCoverage.set(f,{report:c,extIds:u.map(p=>Re.fromExtHostTestItem(p,i).toString())}),this.proxy.$appendCoverage(t,r,kc.fromFile(i,f,c))},enqueued:n(c=>{this.proxy.$updateTestStateInRun(t,r,Re.fromExtHostTestItem(c,i).toString(),1)}),skipped:n(c=>{this.proxy.$updateTestStateInRun(t,r,Re.fromExtHostTestItem(c,i).toString(),5)}),started:n(c=>{this.proxy.$updateTestStateInRun(t,r,Re.fromExtHostTestItem(c,i).toString(),2)}),errored:n((c,u,d)=>{s(c,u),this.proxy.$updateTestStateInRun(t,r,Re.fromExtHostTestItem(c,i).toString(),6,d)}),failed:n((c,u,d)=>{s(c,u),this.proxy.$updateTestStateInRun(t,r,Re.fromExtHostTestItem(c,i).toString(),4,d)}),passed:n((c,u)=>{this.proxy.$updateTestStateInRun(t,r,Re.fromExtHostTestItem(c,this.dto.controllerId).toString(),3,u)}),appendOutput:(c,u,d)=>{o||(d&&this.ensureTestIsKnown(d),this.proxy.$appendOutputToRun(t,r,ae.fromString(c),u&&vi.from(u),d&&Re.fromExtHostTestItem(d,i).toString()))},end:()=>{o||(o=!0,this.proxy.$finishedTestRunTask(t,r),--this.running||this.markEnded())}};return this.running++,this.tasks.set(r,{run:l,cts:a}),this.proxy.$startedTestRunTask(t,{id:r,ctrlId:this.dto.controllerId,name:e||this.extension.displayName||this.extension.identifier.value,running:!0}),l}forciblyEndTasks(){for(const{run:e}of this.tasks.values())e.end()}markEnded(){this.state!==2&&(this.state=2,this.endEmitter.fire())}ensureTestIsKnown(e){if(!(e instanceof Wc))throw new Zd(e.id);if(this.sharedTestIds.has(Re.fromExtHostTestItem(e,this.dto.controllerId).toString()))return;const t=[],i=this.dto.colllection.root;for(;;){const r=Jn.from(e);if(t.unshift(r),this.sharedTestIds.has(r.extId)||(this.sharedTestIds.add(r.extId),e===i))break;e=e.parent||i}this.proxy.$addTestsToRun(this.dto.controllerId,this.dto.id,t)}dispose(){this.markEnded(),super.dispose()}},wM=class{get trackers(){return this.tracked.values()}constructor(e,t){this.proxy=e,this.logService=t,this.tracked=new Map,this.trackedById=new Map}getCoverageDetails(e,t,i){const r=Re.root(e);return this.trackedById.get(r)?.getCoverageDetails(e,t,i)||[]}disposeTestRun(e){this.trackedById.get(e)?.dispose(),this.trackedById.delete(e);for(const[t,{id:i}]of this.tracked)i===e&&this.tracked.delete(t)}prepareForMainThreadTestRun(e,t,i,r,n){return this.getTracker(t,i,r,e,n)}cancelRunById(e,t){this.trackedById.get(e)?.cancel(t)}cancelAllRuns(){for(const e of this.tracked.values())e.cancel()}createTestRun(e,t,i,r,n,s){const o=this.tracked.get(r);if(o)return o.createRun(n);const a=s5.fromPublic(t,i,r,s),l=n5(r);this.proxy.$startedExtensionTestRun({controllerId:t,continuous:!!r.continuous,profile:l&&{group:Pa.from(l.kind),id:l.profileId},exclude:r.exclude?.map(u=>Re.fromExtHostTestItem(u,i.root.id).toString())??[],id:a.id,include:r.include?.map(u=>Re.fromExtHostTestItem(u,i.root.id).toString())??[i.root.id],preserveFocus:r.preserveFocus??!0,persist:s});const c=this.getTracker(r,a,r.profile,e);return ct.once(c.onEnd)(()=>{this.proxy.$finishedExtensionTestRun(a.id)}),c.createRun(n)}getTracker(e,t,i,r,n){const s=new _M(t,this.proxy,this.logService,i,r,n);return this.tracked.set(e,s),this.trackedById.set(s.id,s),s}},n5=e=>{if(e.profile){if(!(e.profile instanceof o5))throw new Error("TestRunRequest.profile is not an instance created from TestController.createRunProfile");return e.profile}},s5=class Fw{static fromPublic(t,i,r,n){return new Fw(t,$t(),n,i)}static fromInternal(t,i){return new Fw(t.controllerId,t.runId,!0,i)}constructor(t,i,r,n){this.controllerId=t,this.id=i,this.isPersisted=r,this.colllection=n}},yM=class{get isEmpty(){return this.added.size===0&&this.removed.size===0&&this.updated.size===0}constructor(e){this.emitter=e,this.added=new Set,this.updated=new Set,this.removed=new Set,this.alreadyRemoved=new Set}add(e){this.added.add(e)}update(e){Object.assign(e.revived,Jn.toPlain(e.item)),this.added.has(e)||this.updated.add(e)}remove(e){if(this.added.has(e)){this.added.delete(e);return}this.updated.delete(e);const t=Re.parentId(e.item.extId);if(t&&this.alreadyRemoved.has(t.toString())){this.alreadyRemoved.add(e.item.extId);return}this.removed.add(e)}getChangeEvent(){const{added:e,updated:t,removed:i}=this;return{get added(){return[...e].map(r=>r.revived)},get updated(){return[...t].map(r=>r.revived)},get removed(){return[...i].map(r=>r.revived)}}}complete(){this.isEmpty||this.emitter.fire(this.getChangeEvent())}},bM=class extends HR{constructor(){super(...arguments),this.changeEmitter=new P,this.onDidChangeTests=this.changeEmitter.event}get rootTests(){return this.roots}getMirroredTestDataById(e){return this.items.get(e)}getMirroredTestDataByReference(e){return this.items.get(e.id)}createItem(e,t){return{...e,revived:Jn.toPlain(e.item),depth:t?t.depth+1:0,children:new Set}}createChangeCollector(){return new yM(this.changeEmitter)}},xM=class{constructor(e){this.proxy=e}checkout(){this.current||(this.current=this.createObserverData());const e=this.current;return e.observers++,{onDidChangeTest:e.tests.onDidChangeTests,get tests(){return[...e.tests.rootTests].map(t=>t.revived)},dispose:sg(()=>{--e.observers===0&&(this.proxy.$unsubscribeFromDiffs(),this.current=void 0)})}}getMirroredTestDataByReference(e){return this.current?.tests.getMirroredTestDataByReference(e)}applyDiff(e){this.current?.tests.apply(e)}createObserverData(){const e=new bM({asCanonicalUri:t=>t});return this.proxy.$subscribeToDiffs(),{observers:0,tests:e}}},Yc=(e,t,i,r)=>{i?Object.assign(i,r):t.$updateTestRunConfig(e.controllerId,e.profileId,r)},o5=class extends E4{#e;#t;#i;#r;#s;get label(){return this._label}set label(e){e!==this._label&&(this._label=e,Yc(this,this.#e,this.#r,{label:e}))}get supportsContinuousRun(){return this._supportsContinuousRun}set supportsContinuousRun(e){e!==this._supportsContinuousRun&&(this._supportsContinuousRun=e,Yc(this,this.#e,this.#r,{supportsContinuousRun:e}))}get isDefault(){return this.#t.has(this.profileId)}set isDefault(e){e!==this.isDefault&&(e?this.#t.add(this.profileId):this.#t.delete(this.profileId),Yc(this,this.#e,this.#r,{isDefault:e}))}get tag(){return this._tag}set tag(e){e?.id!==this._tag?.id&&(this._tag=e,Yc(this,this.#e,this.#r,{tag:e?pr.namespace(this.controllerId,e.id):null}))}get configureHandler(){return this._configureHandler}set configureHandler(e){e!==this._configureHandler&&(this._configureHandler=e,Yc(this,this.#e,this.#r,{hasConfigurationHandler:!!e}))}get onDidChangeDefault(){return ct.chain(this.#i,e=>e.map(t=>t.get(this.controllerId)?.get(this.profileId)).filter(ji))}constructor(e,t,i,r,n,s,o,a,l,c=!1,u=void 0,d=!1){super(n,s,a),this._label=o,this.runHandler=l,this._tag=u,this._supportsContinuousRun=d,this.#e=e,this.#s=t,this.#t=i,this.#i=r,t.set(s,this);const f=Pa.from(a);c&&i.add(s),this.#r={profileId:s,controllerId:n,tag:u?pr.namespace(this.controllerId,u.id):null,label:o,group:f,isDefault:c,hasConfigurationHandler:!1,supportsContinuousRun:d},queueMicrotask(()=>{this.#r&&(this.#e.$publishTestRunProfile(this.#r),this.#r=void 0)})}dispose(){this.#s?.delete(this.profileId)&&(this.#s=void 0,this.#e.$removeTestProfile(this.controllerId,this.profileId)),this.#r=void 0}};function SM(e,t){for(let i=0;i<e.path.length;i++){const r=t.find(n=>n.id===e.path[i]);if(!r)return;if(i===e.path.length-1)return r;t=r.children}}var Gq=U("configurationResolverService"),tt;(function(e){e.Unknown="unknown",e.Env="env",e.Config="config",e.Command="command",e.Input="input",e.ExtensionInstallFolder="extensionInstallFolder",e.WorkspaceFolder="workspaceFolder",e.Cwd="cwd",e.WorkspaceFolderBasename="workspaceFolderBasename",e.UserHome="userHome",e.LineNumber="lineNumber",e.ColumnNumber="columnNumber",e.SelectedText="selectedText",e.File="file",e.FileWorkspaceFolder="fileWorkspaceFolder",e.FileWorkspaceFolderBasename="fileWorkspaceFolderBasename",e.RelativeFile="relativeFile",e.RelativeFileDirname="relativeFileDirname",e.FileDirname="fileDirname",e.FileExtname="fileExtname",e.FileBasename="fileBasename",e.FileBasenameNoExtension="fileBasenameNoExtension",e.FileDirnameBasename="fileDirnameBasename",e.ExecPath="execPath",e.ExecInstallFolder="execInstallFolder",e.PathSeparator="pathSeparator",e.PathSeparatorAlias="/"})(tt||(tt={}));var EM=Object.values(tt).filter(e=>typeof e=="string"),_i=class extends as{constructor(e,t){super(t),this.variable=e}},a5=class $w{static{this.VARIABLE_LHS="${"}constructor(t){this.locations=new Map,this.newReplacementNotifiers=new Set,typeof t=="string"?(this.stringRoot=!0,this.root={value:t}):(this.stringRoot=!1,this.root=structuredClone(t))}static parse(t){if(t instanceof $w)return t;const i=new $w(t);return i.applyPlatformSpecificKeys(),i.parseObject(i.root),i}applyPlatformSpecificKeys(){const t=this.root,i=oi?"windows":Hi?"osx":Gr?"linux":void 0;i&&t&&typeof t=="object"&&t.hasOwnProperty(i)&&Object.keys(t[i]).forEach(r=>t[r]=t[i][r]),delete t.windows,delete t.osx,delete t.linux}parseVariable(t,i){if(t[i]!=="$"||t[i+1]!=="{")return;let r=i+2,n=1;for(;r<t.length;){if(t[r]==="{")n++;else if(t[r]==="}"&&(n--,n===0))break;r++}if(n!==0)return;const s=t.slice(i,r+1),o=t.substring(i+2,r),a=o.indexOf(":");return a===-1?{replacement:{id:s,name:o,inner:o},end:r}:{replacement:{id:s,inner:o,name:o.slice(0,a),arg:o.slice(a+1)},end:r}}parseObject(t){if(!(typeof t!="object"||t===null)){if(Array.isArray(t)){for(let i=0;i<t.length;i++){const r=t[i];typeof r=="string"?this.parseString(t,i,r):this.parseObject(r)}return}for(const[i,r]of Object.entries(t))typeof r=="string"?this.parseString(t,i,r):this.parseObject(r);for(const[i]of Object.entries(t))this.parseString(t,i,i,!0)}}parseString(t,i,r,n,s){let o=0;for(;o<r.length;){const a=r.indexOf("${",o);if(a===-1)break;const l=this.parseVariable(r,a);if(l){if(o=l.end+1,s?.includes(l.replacement.id))continue;const c=this.locations.get(l.replacement.id)||{locations:[],replacement:l.replacement},u={object:t,propertyName:i,replaceKeyName:n};c.locations.push(u),this.locations.set(l.replacement.id,c),c.resolved?this._resolveAtLocation(l.replacement,u,c.resolved,s):this.newReplacementNotifiers.forEach(d=>d(l.replacement))}else o=a+2}}*unresolved(){const t=new Map,i=r=>{t.set(r.id,r)};for(const r of this.locations.values())r.resolved===void 0&&t.set(r.replacement.id,r.replacement);for(this.newReplacementNotifiers.add(i);;){const r=Jt.first(t);if(!r)break;const[n,s]=r;yield s,t.delete(n)}this.newReplacementNotifiers.delete(i)}resolved(){return Jt.map(Jt.filter(this.locations.values(),t=>!!t.resolved),t=>[t.replacement,t.resolved])}resolve(t,i){typeof i!="object"&&(i={value:String(i)});const r=this.locations.get(t.id);if(r&&(r.resolved=i,i.value!==void 0))for(const n of r.locations||Jt.empty())this._resolveAtLocation(t,n,i)}_resolveAtLocation(t,{replaceKeyName:i,propertyName:r,object:n},s,o=[]){if(s.value!==void 0){if(o.push(t.id),i&&typeof r=="string"){const a=n[r],l=r.replaceAll(t.id,s.value);delete n[r],n[l]=a,this.parseString(n,l,s.value,!0,o)}else this.parseString(n,r,s.value,!1,o),n[r]=n[r].replaceAll(t.id,s.value);o.pop()}}toObject(){return this.stringRoot?this.root.value:this.root}},CM=class{constructor(e,t,i,r){this._contributedVariables=new Map,this.resolvableVariables=new Set(EM),this._context=e,this._labelService=t,this._userHomePromise=i,r&&(this._envVariablesPromise=r.then(n=>this.prepareEnv(n)))}prepareEnv(e){if(oi){const t=Object.create(null);return Object.keys(e).forEach(i=>{t[i.toLowerCase()]=e[i]}),t}return e}async resolveWithEnvironment(e,t,i){const r=a5.parse(i);for(const n of r.unresolved()){const s=await this.evaluateSingleVariable(n,t?.uri,e);s!==void 0&&r.resolve(n,String(s))}return r.toObject()}async resolveAsync(e,t){const i=a5.parse(t);for(const r of i.unresolved()){const n=await this.evaluateSingleVariable(r,e?.uri);n!==void 0&&i.resolve(r,String(n))}return i.toObject()}resolveWithInteractionReplace(e,t){throw new Error("resolveWithInteractionReplace not implemented.")}resolveWithInteraction(e,t){throw new Error("resolveWithInteraction not implemented.")}contributeVariable(e,t){if(this._contributedVariables.has(e))throw new Error("Variable "+e+" is contributed twice.");this.resolvableVariables.add(e),this._contributedVariables.set(e,t)}fsPath(e){return this._labelService?this._labelService.getUriLabel(e,{noPrefix:!0}):e.fsPath}async evaluateSingleVariable(e,t,i,r){const n={env:i!==void 0?this.prepareEnv(i):await this._envVariablesPromise,userHome:i!==void 0?void 0:await this._userHomePromise},{name:s,arg:o}=e,a=u=>{const d=this._context.getFilePath();if(d)return Vc(d);throw new _i(u,h(13876,null,e.id))},l=u=>{const d=a(u);if(this._context.getWorkspaceFolderPathForFile){const f=this._context.getWorkspaceFolderPathForFile();if(f)return Vc(f)}throw new _i(u,h(13877,null,e.id,ki(d)))},c=u=>{if(o){const d=this._context.getFolderUri(o);if(d)return d;throw new _i(u,h(13878,null,u,o))}if(t)return t;throw this._context.getWorkspaceFolderCount()>1?new _i(u,h(13879,null,u)):new _i(u,h(13880,null,u))};switch(s){case"env":if(o){if(n.env){const u=n.env[oi?o.toLowerCase():o];if(Me(u))return u}return""}throw new _i(tt.Env,h(13881,null,e.id));case"config":if(o){const u=this._context.getConfigurationValue(t,o);if(Et(u))throw new _i(tt.Config,h(13882,null,e.id,o));if(St(u))throw new _i(tt.Config,h(13883,null,e.id,o));return u}throw new _i(tt.Config,h(13884,null,e.id));case"command":return this.resolveFromMap(tt.Command,e.id,o,r,"command");case"input":return this.resolveFromMap(tt.Input,e.id,o,r,"input");case"extensionInstallFolder":if(o){const u=await this._context.getExtension(o);if(!u)throw new _i(tt.ExtensionInstallFolder,h(13885,null,e.id,o));return this.fsPath(u.extensionLocation)}throw new _i(tt.ExtensionInstallFolder,h(13886,null,e.id));default:switch(s){case"workspaceRoot":case"workspaceFolder":{const u=c(tt.WorkspaceFolder);return u?Vc(this.fsPath(u)):void 0}case"cwd":{if(!t&&!o)return Do();const u=c(tt.Cwd);return u?Vc(this.fsPath(u)):void 0}case"workspaceRootFolderName":case"workspaceFolderBasename":{const u=c(tt.WorkspaceFolderBasename);return u?Vc(ki(this.fsPath(u))):void 0}case"userHome":if(n.userHome)return n.userHome;throw new _i(tt.UserHome,h(13887,null,e.id));case"lineNumber":{const u=this._context.getLineNumber();if(u)return u;throw new _i(tt.LineNumber,h(13888,null,e.id))}case"columnNumber":{const u=this._context.getColumnNumber();if(u)return u;throw new Error(h(13889,null,e.id))}case"selectedText":{const u=this._context.getSelectedText();if(u)return u;throw new _i(tt.SelectedText,h(13890,null,e.id))}case"file":return a(tt.File);case"fileWorkspaceFolder":return l(tt.FileWorkspaceFolder);case"fileWorkspaceFolderBasename":return ki(l(tt.FileWorkspaceFolderBasename));case"relativeFile":return t||o?ul(this.fsPath(c(tt.RelativeFile)),a(tt.RelativeFile)):a(tt.RelativeFile);case"relativeFileDirname":{const u=Po(a(tt.RelativeFileDirname));if(t||o){const d=ul(this.fsPath(c(tt.RelativeFileDirname)),u);return d.length===0?".":d}return u}case"fileDirname":return Po(a(tt.FileDirname));case"fileExtname":return xg(a(tt.FileExtname));case"fileBasename":return ki(a(tt.FileBasename));case"fileBasenameNoExtension":{const u=ki(a(tt.FileBasenameNoExtension));return u.slice(0,u.length-xg(u).length)}case"fileDirnameBasename":return ki(Po(a(tt.FileDirnameBasename)));case"execPath":{const u=this._context.getExecPath();return u||e.id}case"execInstallFolder":{const u=this._context.getAppRoot();return u||e.id}case"pathSeparator":case"/":return tr;default:try{return this.resolveFromMap(tt.Unknown,e.id,o,r,void 0)}catch{return e.id}}}}resolveFromMap(e,t,i,r,n){if(i&&r){const s=n===void 0?r[i]:r[n+":"+i];if(typeof s=="string")return s;throw new _i(e,h(13891,null,t))}return t}},h0=U("IExtHostVariableResolverProvider"),DM=class extends CM{constructor(e,t,i,r,n,s,o){function a(){if(i){const l=i.activeEditor();if(l)return l.document.uri;const c=r.tabGroups.all.find(u=>u.isActive)?.activeTab;if(c!==void 0){if(c.input instanceof Uh||c.input instanceof Qv)return c.input.modified;if(c.input instanceof qv||c.input instanceof Gv||c.input instanceof jv)return c.input.uri}}}super({getFolderUri:l=>{const c=s.folders.filter(u=>u.name===l);if(c&&c.length>0)return c[0].uri},getWorkspaceFolderCount:()=>s.folders.length,getConfigurationValue:(l,c)=>n.getConfiguration(void 0,l).get(c),getAppRoot:()=>Do(),getExecPath:()=>Io.VSCODE_EXEC_PATH,getFilePath:()=>{const l=a();if(l)return ko(l.fsPath)},getWorkspaceFolderPathForFile:()=>{if(t){const l=a();if(l){const c=t.getWorkspaceFolder(l);if(c)return ko(c.uri.fsPath)}}},getSelectedText:()=>{if(i){const l=i.activeEditor();if(l&&!l.selection.isEmpty)return l.document.getText(l.selection)}},getLineNumber:()=>{if(i){const l=i.activeEditor();if(l)return String(l.selection.end.line+1)}},getColumnNumber:()=>{if(i){const l=i.activeEditor();if(l)return String(l.selection.end.character+1)}},getExtension:l=>e.getExtension(l)},void 0,o?Promise.resolve(o):void 0,Promise.resolve(Io))}},f0=class extends se{constructor(t,i,r,n,s){super(),this.extensionService=t,this.workspaceService=i,this.editorService=r,this.configurationService=n,this.editorTabs=s,this._resolver=new Ci(async()=>{const o=await this.configurationService.getConfigProvider(),l={folders:await this.workspaceService.getWorkspaceFolders2()||[]};return this._register(this.workspaceService.onDidChangeWorkspace(async c=>{l.folders=await this.workspaceService.getWorkspaceFolders2()||[]})),new DM(this.extensionService,this.workspaceService,this.editorService,this.editorTabs,o,l,this.homeDir())})}getResolver(){return this._resolver.value}homeDir(){}};f0=__decorate([__param(0,Yn),__param(1,hn),__param(2,Wa),__param(3,fn),__param(4,Kc)],f0);var l5=U("IExtHostDebugService"),p0=class extends se{get onDidStartDebugSession(){return this._onDidStartDebugSession.event}get onDidTerminateDebugSession(){return this._onDidTerminateDebugSession.event}get onDidChangeActiveDebugSession(){return this._onDidChangeActiveDebugSession.event}get activeDebugSession(){return this._activeDebugSession?.api}get onDidReceiveDebugSessionCustomEvent(){return this._onDidReceiveDebugSessionCustomEvent.event}get activeDebugConsole(){return this._activeDebugConsole.value}constructor(t,i,r,n,s,o,a,l){super(),this._workspaceService=i,this._extensionService=r,this._configurationService=n,this._editorTabs=s,this._variableResolver=o,this._commands=a,this._testing=l,this._debugSessions=new Map,this._debugVisualizationTreeItemIdsCounter=0,this._debugVisualizationProviders=new Map,this._debugVisualizationTrees=new Map,this._debugVisualizationTreeItemIds=new WeakMap,this._debugVisualizationElements=new Map,this._visualizers=new Map,this._visualizerIdCounter=0,this._configProviderHandleCounter=0,this._configProviders=[],this._adapterFactoryHandleCounter=0,this._adapterFactories=[],this._trackerFactoryHandleCounter=0,this._trackerFactories=[],this._debugAdapters=new Map,this._debugAdaptersTrackers=new Map,this._onDidStartDebugSession=this._register(new P),this._onDidTerminateDebugSession=this._register(new P),this._onDidChangeActiveDebugSession=this._register(new P),this._onDidReceiveDebugSessionCustomEvent=this._register(new P),this._debugServiceProxy=t.getProxy(W.MainThreadDebugService),this._onDidChangeBreakpoints=this._register(new P),this._onDidChangeActiveStackItem=this._register(new P),this._activeDebugConsole=new kM(this._debugServiceProxy),this._breakpoints=new Map,this._extensionService.getExtensionRegistry().then(c=>{this._register(c.onDidChange(u=>{this.registerAllDebugTypes(c)})),this.registerAllDebugTypes(c)}),this._telemetryProxy=t.getProxy(W.MainThreadTelemetry)}async $getVisualizerTreeItem(t,i){const r=this.hydrateVisualizationContext(i);if(!r)return;const n=await this._debugVisualizationTrees.get(t)?.getTreeItem?.(r);return n?this.convertVisualizerTreeItem(t,n):void 0}registerDebugVisualizationTree(t,i,r){const n=Oe.toKey(t.identifier),s=this.extensionVisKey(n,i);if(this._debugVisualizationProviders.has(s))throw new Error(`A debug visualization provider with id '${i}' is already registered`);return this._debugVisualizationTrees.set(s,r),this._debugServiceProxy.$registerDebugVisualizerTree(s,!!r.editItem),ne(()=>{this._debugServiceProxy.$unregisterDebugVisualizerTree(s),this._debugVisualizationTrees.delete(i)})}async $getVisualizerTreeItemChildren(t,i){const r=this._debugVisualizationElements.get(i)?.item;return r?(await this._debugVisualizationTrees.get(t)?.getChildren?.(r))?.map(s=>this.convertVisualizerTreeItem(t,s))||[]:[]}async $editVisualizerTreeItem(t,i){const r=this._debugVisualizationElements.get(t);if(!r)return;const n=await this._debugVisualizationTrees.get(r.provider)?.editItem?.(r.item,i);return this.convertVisualizerTreeItem(r.provider,n||r.item)}$disposeVisualizedTree(t){const i=this._debugVisualizationElements.get(t);if(!i)return;const r=[i.children];for(const n of r)if(n)for(const s of n)r.push(this._debugVisualizationElements.get(s)?.children),this._debugVisualizationElements.delete(s)}convertVisualizerTreeItem(t,i){let r=this._debugVisualizationTreeItemIds.get(i);return r||(r=this._debugVisualizationTreeItemIdsCounter++,this._debugVisualizationTreeItemIds.set(i,r),this._debugVisualizationElements.set(r,{provider:t,item:i})),Q1.from(i,r)}asDebugSourceUri(t,i){const r=t;if(typeof r.sourceReference=="number"&&r.sourceReference>0){let n=`debug:${encodeURIComponent(r.path||"")}`,s="?";return i&&(n+=`${s}session=${encodeURIComponent(i.id)}`,s="&"),n+=`${s}ref=${r.sourceReference}`,y.parse(n)}else{if(r.path)return y.file(r.path);throw new Error("cannot create uri from DAP 'source' object; properties 'path' and 'sourceReference' are both missing.")}}registerAllDebugTypes(t){const i=[];for(const r of t.getAllExtensionDescriptions())if(r.contributes){const n=r.contributes.debuggers;if(n&&n.length>0)for(const s of n)cM(s)&&i.push(s.type)}this._debugServiceProxy.$registerDebugTypes(i)}get activeStackItem(){return this._activeStackItem}get onDidChangeActiveStackItem(){return this._onDidChangeActiveStackItem.event}get onDidChangeBreakpoints(){return this._onDidChangeBreakpoints.event}get breakpoints(){const t=[];return this._breakpoints.forEach(i=>t.push(i)),t}async $resolveDebugVisualizer(t,i){const r=this._visualizers.get(t);if(!r)throw new Error(`No debug visualizer found with id '${t}'`);let{v:n,provider:s,extensionId:o}=r;if(n.visualization||(n=await s.resolveDebugVisualization?.(n,i)||n,r.v=n),!n.visualization)throw new Error(`No visualization returned from resolveDebugVisualization in '${s}'`);return this.serializeVisualization(o,n.visualization)}async $executeDebugVisualizerCommand(t){const i=this._visualizers.get(t);if(!i)throw new Error(`No debug visualizer found with id '${t}'`);const r=i.v.visualization;r&&"command"in r&&this._commands.executeCommand(r.command,...r.arguments||[])}hydrateVisualizationContext(t){const i=this._debugSessions.get(t.sessionId);return i&&{session:i.api,variable:t.variable,containerId:t.containerId,frameId:t.frameId,threadId:t.threadId}}async $provideDebugVisualizers(t,i,r,n){const s=this.hydrateVisualizationContext(r),o=this.extensionVisKey(t,i),a=this._debugVisualizationProviders.get(o);if(!s||!a)return[];const l=await a.provideDebugVisualization(s,n);return l?l.map(c=>{const u=++this._visualizerIdCounter;this._visualizers.set(u,{v:c,provider:a,extensionId:t});const d=c.iconPath?this.getIconPathOrClass(c.iconPath):void 0;return{id:u,name:c.name,iconClass:d?.iconClass,iconPath:d?.iconPath,visualization:this.serializeVisualization(t,c.visualization)}}):[]}$disposeDebugVisualizers(t){for(const i of t)this._visualizers.delete(i)}registerDebugVisualizationProvider(t,i,r){if(!t.contributes?.debugVisualizers?.some(o=>o.id===i))throw new Error(`Extensions may only call registerDebugVisualizationProvider() for renderers they contribute (got ${i})`);const n=Oe.toKey(t.identifier),s=this.extensionVisKey(n,i);if(this._debugVisualizationProviders.has(s))throw new Error(`A debug visualization provider with id '${i}' is already registered`);return this._debugVisualizationProviders.set(s,r),this._debugServiceProxy.$registerDebugVisualizer(n,i),ne(()=>{this._debugServiceProxy.$unregisterDebugVisualizer(n,i),this._debugVisualizationProviders.delete(i)})}addBreakpoints(t){const i=t.filter(s=>{const o=s.id;return this._breakpoints.has(o)?!1:(this._breakpoints.set(o,s),!0)});this.fireBreakpointChanges(i,[],[]);const r=[],n=new Map;for(const s of i)if(s instanceof Ws){let o=n.get(s.location.uri.toString());o||(o={type:"sourceMulti",uri:s.location.uri,lines:[]},n.set(s.location.uri.toString(),o),r.push(o)),o.lines.push({id:s.id,enabled:s.enabled,condition:s.condition,hitCondition:s.hitCondition,logMessage:s.logMessage,line:s.location.range.start.line,character:s.location.range.start.character,mode:s.mode})}else s instanceof Vs&&r.push({type:"function",id:s.id,enabled:s.enabled,hitCondition:s.hitCondition,logMessage:s.logMessage,condition:s.condition,functionName:s.functionName,mode:s.mode});return this._debugServiceProxy.$registerBreakpoints(r)}removeBreakpoints(t){const i=t.filter(o=>this._breakpoints.delete(o.id));this.fireBreakpointChanges([],i,[]);const r=i.filter(o=>o instanceof Ws).map(o=>o.id),n=i.filter(o=>o instanceof Vs).map(o=>o.id),s=i.filter(o=>o instanceof wh).map(o=>o.id);return this._debugServiceProxy.$unregisterBreakpoints(r,n,s)}startDebugging(t,i,r){const n=r.testRun&&this._testing.getMetadataForRun(r.testRun);return this._debugServiceProxy.$startDebugging(t?t.uri:void 0,i,{parentSessionID:r.parentSession?r.parentSession.id:void 0,lifecycleManagedByParent:r.lifecycleManagedByParent,repl:r.consoleMode===Ih.MergeWithParent?"mergeWithParent":"separate",noDebug:r.noDebug,compact:r.compact,suppressSaveBeforeStart:r.suppressSaveBeforeStart,testRun:n&&{runId:n.runId,taskId:n.taskId},suppressDebugStatusbar:r.suppressDebugStatusbar??r.debugUI?.simple,suppressDebugToolbar:r.suppressDebugToolbar??r.debugUI?.simple,suppressDebugView:r.suppressDebugView??r.debugUI?.simple})}stopDebugging(t){return this._debugServiceProxy.$stopDebugging(t?t.id:void 0)}registerDebugConfigurationProvider(t,i,r){if(!i)return new Ce(()=>{});const n=this._configProviderHandleCounter++;return this._configProviders.push({type:t,handle:n,provider:i}),this._debugServiceProxy.$registerDebugConfigurationProvider(t,r,!!i.provideDebugConfigurations,!!i.resolveDebugConfiguration,!!i.resolveDebugConfigurationWithSubstitutedVariables,n),new Ce(()=>{this._configProviders=this._configProviders.filter(s=>s.provider!==i),this._debugServiceProxy.$unregisterDebugConfigurationProvider(n)})}registerDebugAdapterDescriptorFactory(t,i,r){if(!r)return new Ce(()=>{});if(!this.definesDebugType(t,i))throw new Error(`a DebugAdapterDescriptorFactory can only be registered from the extension that defines the '${i}' debugger.`);if(this.getAdapterDescriptorFactoryByType(i))throw new Error("a DebugAdapterDescriptorFactory can only be registered once per a type.");const n=this._adapterFactoryHandleCounter++;return this._adapterFactories.push({type:i,handle:n,factory:r}),this._debugServiceProxy.$registerDebugAdapterDescriptorFactory(i,n),new Ce(()=>{this._adapterFactories=this._adapterFactories.filter(s=>s.factory!==r),this._debugServiceProxy.$unregisterDebugAdapterDescriptorFactory(n)})}registerDebugAdapterTrackerFactory(t,i){if(!i)return new Ce(()=>{});const r=this._trackerFactoryHandleCounter++;return this._trackerFactories.push({type:t,handle:r,factory:i}),new Ce(()=>{this._trackerFactories=this._trackerFactories.filter(n=>n.factory!==i)})}async $runInTerminal(t,i){return Promise.resolve(void 0)}async $substituteVariables(t,i){let r;const n=await this.getFolder(t);return n&&(r={uri:n.uri,name:n.name,index:n.index,toResource:()=>{throw new Error("Not implemented")}}),(await this._variableResolver.getResolver()).resolveAsync(r,i)}createDebugAdapter(t,i){if(t instanceof nc)return new TM(t.implementation)}createSignService(){}async $startDASession(t,i){const r=this,n=await this.getSession(i);return this.getAdapterDescriptor(this.getAdapterDescriptorFactoryByType(n.type),n).then(s=>{if(!s)throw new Error(`Couldn't find a debug adapter descriptor for debug type '${n.type}' (extension might have failed to activate)`);const o=this.createDebugAdapter(s,n);if(!o)throw new Error(`Couldn't create a debug adapter for type '${n.type}'.`);const a=o;return this._debugAdapters.set(t,a),this.getDebugAdapterTrackers(n).then(l=>(l&&this._debugAdaptersTrackers.set(t,l),a.onMessage(async c=>{if(c.type==="request"&&c.command==="handshake"){const u=c,d={type:"response",seq:0,command:u.command,request_seq:u.seq,success:!0};this._signService||(this._signService=this.createSignService());try{if(this._signService){const f=await this._signService.sign(u.arguments.value);d.body={signature:f},a.sendResponse(d)}else throw new Error("no signer")}catch(f){d.success=!1,d.message=f.message,a.sendResponse(d)}}else{l&&l.onDidSendMessage&&l.onDidSendMessage(c);try{c=fM(c,!0)}catch(u){const d=c.type+"_"+(c.command??c.event??"");throw this._telemetryProxy.$publicLog2("debugProtocolMessageError",{type:d,from:n.type}),u}r._debugServiceProxy.$acceptDAMessage(t,c)}}),a.onError(c=>{l&&l.onError&&l.onError(c),this._debugServiceProxy.$acceptDAError(t,c.name,c.message,c.stack)}),a.onExit(c=>{l&&l.onExit&&l.onExit(c??void 0,void 0),this._debugServiceProxy.$acceptDAExit(t,c??void 0,void 0)}),l&&l.onWillStartSession&&l.onWillStartSession(),a.startSession()))})}$sendDAMessage(t,i){i=hM(i,!1);const r=this._debugAdaptersTrackers.get(t);r&&r.onWillReceiveMessage&&r.onWillReceiveMessage(i),this._debugAdapters.get(t)?.sendMessage(i)}$stopDASession(t){const i=this._debugAdaptersTrackers.get(t);this._debugAdaptersTrackers.delete(t),i&&i.onWillStopSession&&i.onWillStopSession();const r=this._debugAdapters.get(t);return this._debugAdapters.delete(t),r?r.stopSession():Promise.resolve(void 0)}$acceptBreakpointsDelta(t){const i=[],r=[],n=[];if(t.added)for(const s of t.added){const o=s.id;if(o&&!this._breakpoints.has(o)){let a;if(s.type==="function")a=new Vs(s.functionName,s.enabled,s.condition,s.hitCondition,s.logMessage,s.mode);else if(s.type==="data")a=new wh(s.label,s.dataId,s.canPersist,s.enabled,s.hitCondition,s.condition,s.logMessage,s.mode);else{const l=y.revive(s.uri);a=new Ws(new Wi(l,new Ie(s.line,s.character)),s.enabled,s.condition,s.hitCondition,s.logMessage,s.mode)}E2(a,o),this._breakpoints.set(o,a),i.push(a)}}if(t.removed)for(const s of t.removed){const o=this._breakpoints.get(s);o&&(this._breakpoints.delete(s),r.push(o))}if(t.changed){for(const s of t.changed)if(s.id){const o=this._breakpoints.get(s.id);if(o){if(o instanceof Vs&&s.type==="function"){const a=o;a.enabled=s.enabled,a.condition=s.condition,a.hitCondition=s.hitCondition,a.logMessage=s.logMessage,a.functionName=s.functionName}else if(o instanceof Ws&&s.type==="source"){const a=o;a.enabled=s.enabled,a.condition=s.condition,a.hitCondition=s.hitCondition,a.logMessage=s.logMessage,a.location=new Wi(y.revive(s.uri),new Ie(s.line,s.character))}n.push(o)}}}this.fireBreakpointChanges(i,r,n)}async $acceptStackFrameFocus(t){let i;if(t){const r=await this.getSession(t.sessionId);t.kind==="thread"?i=new w4(r.api,t.threadId):i=new _4(r.api,t.threadId,t.frameId)}this._activeStackItem=i,this._onDidChangeActiveStackItem.fire(this._activeStackItem)}$provideDebugConfigurations(t,i,r){return Kt(async()=>{const n=this.getConfigProviderByHandle(t);if(!n)throw new Error("no DebugConfigurationProvider found");if(!n.provideDebugConfigurations)throw new Error("DebugConfigurationProvider has no method provideDebugConfigurations");const s=await this.getFolder(i);return n.provideDebugConfigurations(s,r)}).then(n=>{if(!n)throw new Error("nothing returned from DebugConfigurationProvider.provideDebugConfigurations");return n})}$resolveDebugConfiguration(t,i,r,n){return Kt(async()=>{const s=this.getConfigProviderByHandle(t);if(!s)throw new Error("no DebugConfigurationProvider found");if(!s.resolveDebugConfiguration)throw new Error("DebugConfigurationProvider has no method resolveDebugConfiguration");const o=await this.getFolder(i);return s.resolveDebugConfiguration(o,r,n)})}$resolveDebugConfigurationWithSubstitutedVariables(t,i,r,n){return Kt(async()=>{const s=this.getConfigProviderByHandle(t);if(!s)throw new Error("no DebugConfigurationProvider found");if(!s.resolveDebugConfigurationWithSubstitutedVariables)throw new Error("DebugConfigurationProvider has no method resolveDebugConfigurationWithSubstitutedVariables");const o=await this.getFolder(i);return s.resolveDebugConfigurationWithSubstitutedVariables(o,r,n)})}async $provideDebugAdapter(t,i){const r=this.getAdapterDescriptorFactoryByHandle(t);if(!r)return Promise.reject(new Error("no adapter descriptor factory found for handle"));const n=await this.getSession(i);return this.getAdapterDescriptor(r,n).then(s=>{if(!s)throw new Error(`Couldn't find a debug adapter descriptor for debug type '${n.type}'`);return this.convertToDto(s)})}async $acceptDebugSessionStarted(t){const i=await this.getSession(t);this._onDidStartDebugSession.fire(i.api)}async $acceptDebugSessionTerminated(t){const i=await this.getSession(t);i&&(this._onDidTerminateDebugSession.fire(i.api),this._debugSessions.delete(i.id))}async $acceptDebugSessionActiveChanged(t){this._activeDebugSession=t?await this.getSession(t):void 0,this._onDidChangeActiveDebugSession.fire(this._activeDebugSession?.api)}async $acceptDebugSessionNameChanged(t,i){(await this.getSession(t))?._acceptNameChanged(i)}async $acceptDebugSessionCustomEvent(t,i){const n={session:(await this.getSession(t)).api,event:i.event,body:i.body};this._onDidReceiveDebugSessionCustomEvent.fire(n)}convertToDto(t){if(t instanceof yh)return this.convertExecutableToDto(t);if(t instanceof rc)return this.convertServerToDto(t);if(t instanceof bh)return this.convertPipeServerToDto(t);if(t instanceof nc)return this.convertImplementationToDto(t);throw new Error("convertToDto unexpected type")}convertExecutableToDto(t){return{type:"executable",command:t.command,args:t.args,options:t.options}}convertServerToDto(t){return{type:"server",port:t.port,host:t.host}}convertPipeServerToDto(t){return{type:"pipeServer",path:t.path}}convertImplementationToDto(t){return{type:"implementation"}}getAdapterDescriptorFactoryByType(t){const i=this._adapterFactories.filter(r=>r.type===t);if(i.length>0)return i[0].factory}getAdapterDescriptorFactoryByHandle(t){const i=this._adapterFactories.filter(r=>r.handle===t);if(i.length>0)return i[0].factory}getConfigProviderByHandle(t){const i=this._configProviders.filter(r=>r.handle===t);if(i.length>0)return i[0].provider}definesDebugType(t,i){if(t.contributes){const r=t.contributes.debuggers;if(r&&r.length>0){for(const n of r)if(n.label&&n.type&&n.type===i)return!0}}return!1}getDebugAdapterTrackers(t){const r=t.configuration.type,n=this._trackerFactories.filter(s=>s.type===r||s.type==="*").map(s=>Kt(()=>s.factory.createDebugAdapterTracker(t.api)).then(o=>o,o=>null));return Promise.race([Promise.all(n).then(s=>{const o=xt(s);if(o.length>0)return new PM(o)}),new Promise(s=>setTimeout(()=>s(void 0),1e3))]).catch(s=>{})}async getAdapterDescriptor(t,i){const r=i.configuration.debugServer;if(typeof r=="number")return Promise.resolve(new rc(r));if(t){const s=await this._extensionService.getExtensionRegistry();return Kt(()=>t.createDebugAdapterDescriptor(i.api,this.daExecutableFromPackage(i,s))).then(o=>{if(o)return o})}const n=await this._extensionService.getExtensionRegistry();return Promise.resolve(this.daExecutableFromPackage(i,n))}daExecutableFromPackage(t,i){}fireBreakpointChanges(t,i,r){(t.length>0||i.length>0||r.length>0)&&this._onDidChangeBreakpoints.fire(Object.freeze({added:t,removed:i,changed:r}))}async getSession(t){if(t)if(typeof t=="string"){const i=this._debugSessions.get(t);if(i)return i}else{let i=this._debugSessions.get(t.id);if(!i){const r=await this.getFolder(t.folderUri),n=t.parent?this._debugSessions.get(t.parent):void 0;i=new IM(this._debugServiceProxy,t.id,t.type,t.name,r,t.configuration,n?.api),this._debugSessions.set(i.id,i),this._debugServiceProxy.$sessionCached(i.id)}return i}throw new Error("cannot find session")}getFolder(t){if(t){const i=y.revive(t);return this._workspaceService.resolveWorkspaceFolder(i)}return Promise.resolve(void 0)}extensionVisKey(t,i){return`${t}\0${i}`}serializeVisualization(t,i){if(i){if("title"in i&&"command"in i)return{type:0};if("treeId"in i)return{type:1,id:`${t}\0${i.treeId}`};throw new Error("Unsupported debug visualization type")}}getIconPathOrClass(t){const i=this.getIconUris(t);let r,n;return"id"in i?n=kt.asClassName(i):r=i,{iconPath:r,iconClass:n}}getIconUris(t){if(t instanceof ci)return{id:t.id};const i=typeof t=="object"&&"dark"in t?t.dark:t,r=typeof t=="object"&&"light"in t?t.light:t;return{dark:typeof i=="string"?y.file(i):i,light:typeof r=="string"?y.file(r):r}}};p0=__decorate([__param(0,Ue),__param(1,hn),__param(2,Yn),__param(3,fn),__param(4,Kc),__param(5,h0),__param(6,no),__param(7,rp)],p0);var IM=class{constructor(e,t,i,r,n,s,o){this._debugServiceProxy=e,this._id=t,this._type=i,this._name=r,this._workspaceFolder=n,this._configuration=s,this._parentSession=o}get api(){const e=this;return this.apiSession??=Object.freeze({id:e._id,type:e._type,get name(){return e._name},set name(t){e._name=t,e._debugServiceProxy.$setDebugSessionName(e._id,t)},parentSession:e._parentSession,workspaceFolder:e._workspaceFolder,configuration:e._configuration,customRequest(t,i){return e._debugServiceProxy.$customDebugAdapterRequest(e._id,t,i)},getDebugProtocolBreakpoint(t){return e._debugServiceProxy.$getDebugProtocolBreakpoint(e._id,t.id)}})}get id(){return this._id}get type(){return this._type}_acceptNameChanged(e){this._name=e}get configuration(){return this._configuration}},kM=class{constructor(e){this.value=Object.freeze({append(t){e.$appendDebugConsole(t)},appendLine(t){this.append(t+`
`)}})}},PM=class{constructor(e){this.trackers=e}onWillStartSession(){this.trackers.forEach(e=>e.onWillStartSession?e.onWillStartSession():void 0)}onWillReceiveMessage(e){this.trackers.forEach(t=>t.onWillReceiveMessage?t.onWillReceiveMessage(e):void 0)}onDidSendMessage(e){this.trackers.forEach(t=>t.onDidSendMessage?t.onDidSendMessage(e):void 0)}onWillStopSession(){this.trackers.forEach(e=>e.onWillStopSession?e.onWillStopSession():void 0)}onError(e){this.trackers.forEach(t=>t.onError?t.onError(e):void 0)}onExit(e,t){this.trackers.forEach(i=>i.onExit?i.onExit(e,t):void 0)}},TM=class extends lM{constructor(e){super(),this.implementation=e,e.onDidSendMessage(t=>{this.acceptMessage(t)})}startSession(){return Promise.resolve(void 0)}sendMessage(e){this.implementation.handleMessage(e)}stopSession(){return this.implementation.dispose(),Promise.resolve(void 0)}},g0=class extends p0{constructor(t,i,r,n,s,o,a,l){super(t,i,r,n,s,o,a,l)}};g0=__decorate([__param(0,Ue),__param(1,hn),__param(2,Yn),__param(3,fn),__param(4,Kc),__param(5,h0),__param(6,no),__param(7,rp)],g0);function AM(e){return"uri"in e&&"ranges"in e&&"preview"in e}function RM(e){return e.folderOptions.map(t=>({folder:t.folder,excludes:t.excludes.map(i=>typeof i=="string"?i:i.pattern),includes:t.includes,useGlobalIgnoreFiles:t.useIgnoreFiles.global,useIgnoreFiles:t.useIgnoreFiles.local,useParentIgnoreFiles:t.useIgnoreFiles.parent,followSymlinks:t.followSymlinks,maxResults:e.maxResults,session:e.session}))}var c5=class{constructor(e){this.provider=e}provideFileSearchResults(e,t,i){return(async()=>{const n=RM(t);return Promise.all(n.map(s=>this.provider.provideFileSearchResults({pattern:e},s,i)))})().then(n=>xt(n).flat())}};function LM(e){return e.folderOptions.map(t=>({folder:t.folder,excludes:t.excludes.map(i=>typeof i=="string"?i:i.pattern),includes:t.includes,useGlobalIgnoreFiles:t.useIgnoreFiles.global,useIgnoreFiles:t.useIgnoreFiles.local,useParentIgnoreFiles:t.useIgnoreFiles.parent,followSymlinks:t.followSymlinks,maxResults:e.maxResults,previewOptions:NM(e.previewOptions),maxFileSize:e.maxFileSize,encoding:t.encoding,afterContext:e.surroundingContext,beforeContext:e.surroundingContext}))}function NM(e){return{matchLines:e?.matchLines??Y1.matchLines,charsPerLine:e?.charsPerLine??Y1.charsPerLine}}function MM(e){if(AM(e)){const t=Fi(e.ranges).map((i,r)=>{const s=Fi(e.preview.matches)[r];return{sourceRange:i,previewRange:s}});return new Xn(e.uri,t,e.preview.text)}else return new Z1(e.uri,e.text,e.lineNumber)}var OM=class{constructor(e){this.provider=e}provideTextSearchResults(e,t,i,r){const n=a=>{FM(a)&&i.report(MM(a))};return(async()=>xt(await Promise.all(LM(t).map(a=>this.provider.provideTextSearchResults(e,a,{report:l=>n(l)},r)))).reduce((a,l)=>({limitHit:a.limitHit||l.limitHit}),{limitHit:!1}))().then(a=>({limitHit:a.limitHit,message:xt(Fi(a.message))}))}};function FM(e){if($M(e)){if(Array.isArray(e.ranges)){if(!Array.isArray(e.preview.matches))return console.warn("INVALID - A text search provider match's`ranges` and`matches` properties must have the same type."),!1;if(e.preview.matches.length!==e.ranges.length)return console.warn("INVALID - A text search provider match's`ranges` and`matches` properties must have the same length."),!1}else if(Array.isArray(e.preview.matches))return console.warn("INVALID - A text search provider match's`ranges` and`matches` properties must have the same length."),!1}return!0}function $M(e){return!!e.preview}var u5=class extends Rn{constructor(e,t,i=()=>!1){const r=new vx(i,()=>!1);super(r);const n=new Ft;e.forEach((s,o)=>{const a=s.folder.with({query:"",fragment:""});n.has(a)?n.get(a).push({fq:s,i:o}):n.set(a,[{fq:s,i:o}])}),n.forEach((s,o)=>{const a=new Map;for(const l of s){const c=t(l.fq,l.i);a.set(this.encodeKey(l.fq.folder),c)}super.set(o,a)})}findQueryFragmentAwareSubstr(e){const t=super.findSubstr(e.with({query:"",fragment:""}));if(!t)return;const i=this.encodeKey(e);return t.get(i)}forEachFolderQueryInfo(e){return this.forEach(t=>t.forEach(i=>e(i)))}encodeKey(e){let t="";return e.query&&(t+=e.query),e.fragment&&(t+="#"+e.fragment),t}},HM=class{constructor(e,t,i){this.config=e,this.provider=t,this.sessionLifecycle=i,this.isLimitHit=!1,this.resultCount=0,this.isCanceled=!1,this.filePattern=e.filePattern,this.includePattern=e.includePattern&&zo(e.includePattern),this.maxResults=e.maxResults||void 0,this.exists=e.exists,this.activeCancellationTokens=new Set,this.globalExcludePattern=e.excludePattern&&zo(e.excludePattern)}cancel(){this.isCanceled=!0,this.activeCancellationTokens.forEach(e=>e.cancel()),this.activeCancellationTokens=new Set}search(e){const t=this.config.folderQueries||[];return new Promise((i,r)=>{const n=s=>{this.resultCount++,e(s)};if(this.isCanceled)return i({limitHit:this.isLimitHit});this.config.extraFileResources&&this.config.extraFileResources.forEach(s=>{const o=s.toString(),a=ki(o);this.globalExcludePattern&&this.globalExcludePattern(o,a)||this.matchFile(n,{base:s,basename:a})}),this.doSearch(t,n).then(s=>{i({limitHit:this.isLimitHit,stats:s||void 0})},s=>{r(new Error(Lo(s)))})})}async doSearch(e,t){const i=new ft,r=e.map(c=>this.getSearchOptionsForFolder(c)),n=this.provider instanceof c5?this.sessionLifecycle?.tokenSource.token:this.sessionLifecycle?.obj,s={folderOptions:r,maxResults:this.config.maxResults??Y4,session:n},o=c=>{const u=new dD(this.config,c),d=!u.hasSiblingExcludeClauses();return{queryTester:u,noSiblingsClauses:d,folder:c.folder,tree:this.initDirectoryTree()}},a=new u5(e,o);let l;try{this.activeCancellationTokens.add(i),l=us.create();const c=await this.provider.provideFileSearchResults(this.config.filePattern||"",s,i.token),u=l.elapsed(),d=us.create();return this.isCanceled&&!this.isLimitHit||(c&&c.forEach(f=>{const p=a.findQueryFragmentAwareSubstr(f),m=Ne.relative(p.folder.path,f.path);if(p.noSiblingsClauses){const _=ki(f.path);this.matchFile(t,{base:p.folder,relativePath:m,basename:_});return}this.addDirectoryEntries(p.tree,p.folder,m,t)}),this.isCanceled&&!this.isLimitHit)?null:(a.forEachFolderQueryInfo(f=>{this.matchDirectoryTree(f.tree,f.queryTester,t)}),{providerTime:u,postProcessTime:d.elapsed()})}finally{i.dispose(),this.activeCancellationTokens.delete(i)}}getSearchOptionsForFolder(e){const t=Na(this.config.includePattern,e.includePattern);let i=e.excludePattern?.map(n=>({folder:n.folder,patterns:Na(this.config.excludePattern,n.pattern)}));i?.length||(i=[{folder:void 0,patterns:Na(this.config.excludePattern,void 0)}]);const r=fD(i);return{folder:e.folder,excludes:r,includes:t,useIgnoreFiles:{local:!e.disregardIgnoreFiles,parent:!e.disregardParentIgnoreFiles,global:!e.disregardGlobalIgnoreFiles},followSymlinks:!e.ignoreSymlinks}}initDirectoryTree(){const e={rootEntries:[],pathToEntries:Object.create(null)};return e.pathToEntries["."]=e.rootEntries,e}addDirectoryEntries({pathToEntries:e},t,i,r){if(i===this.filePattern){const s=ki(this.filePattern);this.matchFile(r,{base:t,relativePath:this.filePattern,basename:s})}function n(s){const o=ki(s),a=Po(s);let l=e[a];l||(l=e[a]=[],n(a)),l.push({base:t,relativePath:s,basename:o})}n(i)}matchDirectoryTree({rootEntries:e,pathToEntries:t},i,r){const n=this,s=this.filePattern;function o(a){const l=Z2(()=>a.map(c=>c.basename));for(let c=0,u=a.length;c<u;c++){const d=a[c],{relativePath:f,basename:p}=d;if(i.matchesExcludesSync(f,p,s!==p?l:void 0))continue;const m=t[f];if(m)o(m);else{if(f===s)continue;n.matchFile(r,d)}if(n.isLimitHit)break}}o(e)}matchFile(e,t){(!this.includePattern||t.relativePath&&this.includePattern(t.relativePath,t.basename))&&((this.exists||this.maxResults&&this.resultCount>=this.maxResults)&&(this.isLimitHit=!0,this.cancel()),this.isLimitHit||e(t))}},UM=class{constructor(){this._obj=new Object,this.tokenSource=new ft}get obj(){if(this._obj)return this._obj;throw new Error("Session object has been dereferenced.")}cancel(){this.tokenSource.cancel(),this._obj=void 0}},BM=class l7{constructor(){this.sessions=new Map}static{this.BATCH_SIZE=512}fileSearch(t,i,r,n){const s=this.getSessionTokenSource(t.cacheKey),o=new HM(t,i,s);let a=0;const l=c=>{a+=c.length,r(c.map(u=>this.rawMatchToSearchItem(u)))};return this.doSearch(o,l7.BATCH_SIZE,l,n).then(c=>({limitHit:c.limitHit,stats:c.stats?{fromCache:!1,type:"fileSearchProvider",resultCount:a,detailStats:c.stats}:void 0,messages:[]}))}clearCache(t){this.sessions.get(t)?.cancel(),this.sessions.delete(t)}getSessionTokenSource(t){if(t)return this.sessions.has(t)||this.sessions.set(t,new UM),this.sessions.get(t)}rawMatchToSearchItem(t){return t.relativePath?{resource:Zt(t.base,t.relativePath)}:{resource:t.base}}doSearch(t,i,r,n){const s=n.onCancellationRequested(()=>{t.cancel()}),o=l=>{l&&(a.push(l),i>0&&a.length>=i&&(r(a),a=[]))};let a=[];return t.search(o).then(l=>(a.length&&r(a),s.dispose(),l),l=>(a.length&&r(a),s.dispose(),Promise.reject(l)))}},d5=class{constructor(e,t,i){this.queryProviderPair=e,this.fileUtils=t,this.processType=i,this.collector=null,this.isLimitHit=!1,this.resultCount=0}get query(){return this.queryProviderPair.query}search(e,t,i){const r=this.query.folderQueries||[],n=new ft(t);return new Promise((s,o)=>{this.collector=new VM(e);let a=!1;const l=(c,u)=>{if(!(c instanceof K1)&&!a&&!this.isLimitHit){const d=this.resultSize(c);c instanceof Xn&&typeof this.query.maxResults=="number"&&this.resultCount+d>this.query.maxResults&&(this.isLimitHit=!0,a=!0,n.cancel(),c=this.trimResultToSize(c,this.query.maxResults-this.resultCount));const f=this.resultSize(c);this.resultCount+=f;const p=c instanceof Xn;(f>0||!p)&&this.collector.add(c,u)}};this.doSearch(r,l,n.token,i).then(c=>{n.dispose(),this.collector.flush(),s({limitHit:this.isLimitHit||c?.limitHit,messages:this.getMessagesFromResults(c),stats:{type:this.processType}})},c=>{n.dispose();const u=Lo(c);o(new Error(u))})})}getMessagesFromResults(e){return e?.message?Array.isArray(e.message)?e.message:[e.message]:[]}resultSize(e){return e instanceof Xn?Array.isArray(e.ranges)?e.ranges.length:1:0}trimResultToSize(e,t){return new Xn(e.uri,e.ranges.slice(0,t),e.previewText)}async doSearch(e,t,i,r){const n=new u5(e,(u,d)=>({queryTester:new dD(this.query,u),folder:u.folder,folderIdx:d}),()=>!0),s=[],o={report:u=>{if(u instanceof K1)r?.(u);else{if(u.uri===void 0)throw Error("Text search result URI is undefined. Please check provider implementation.");const d=n.findQueryFragmentAwareSubstr(u.uri),f=d.folder.scheme===V.file?X2(()=>this.fileUtils.readdir(Zu(u.uri))):void 0,p=Cb(d.folder,u.uri);if(p){const m=d.queryTester.includedInQuery(p,ki(p),f);An(m)?s.push(m.then(_=>{_&&t(u,d.folderIdx)})):m&&t(u,d.folderIdx)}}}},l={folderOptions:e.map(u=>this.getSearchOptionsForFolder(u)),maxFileSize:this.query.maxFileSize,maxResults:this.query.maxResults??Y4,previewOptions:this.query.previewOptions??Y1,surroundingContext:this.query.surroundingContext??0};"usePCRE2"in this.query&&(l.usePCRE2=this.query.usePCRE2);let c;return this.queryProviderPair.query.type===3?c=await this.queryProviderPair.provider.provideAITextSearchResults(this.queryProviderPair.query.contentPattern,l,o,i):c=await this.queryProviderPair.provider.provideTextSearchResults(WM(this.queryProviderPair.query.contentPattern),l,o,i),s.length&&await Promise.all(s),c}getSearchOptionsForFolder(e){const t=Na(this.query.includePattern,e.includePattern);let i=e.excludePattern?.map(s=>({folder:s.folder,patterns:Na(this.query.excludePattern,s.pattern)}));(!i||i.length===0)&&(i=[{folder:void 0,patterns:Na(this.query.excludePattern,void 0)}]);const r=fD(i);return{folder:y.from(e.folder),excludes:r,includes:t,useIgnoreFiles:{local:!e.disregardIgnoreFiles,parent:!e.disregardParentIgnoreFiles,global:!e.disregardGlobalIgnoreFiles},followSymlinks:!e.ignoreSymlinks,encoding:(e.fileEncoding&&this.fileUtils.toCanonicalName(e.fileEncoding))??""}}};function WM(e){return{isCaseSensitive:e.isCaseSensitive||!1,isRegExp:e.isRegExp||!1,isWordMatch:e.isWordMatch||!1,isMultiline:e.isMultiline||!1,pattern:e.pattern}}var VM=class{constructor(e){this._onResult=e,this._currentFolderIdx=-1,this._currentFileMatch=null,this._batchedCollector=new qM(512,t=>this.sendItems(t))}add(e,t){this._currentFileMatch&&(this._currentFolderIdx!==t||!ms(this._currentUri,e.uri))&&(this.pushToCollector(),this._currentFileMatch=null),this._currentFileMatch||(this._currentFolderIdx=t,this._currentFileMatch={resource:e.uri,results:[]}),this._currentFileMatch.results.push(zM(e))}pushToCollector(){const e=this._currentFileMatch&&this._currentFileMatch.results?this._currentFileMatch.results.length:0;this._batchedCollector.addItem(this._currentFileMatch,e)}flush(){this.pushToCollector(),this._batchedCollector.flush()}sendItems(e){this._onResult(e)}};function zM(e){return e instanceof Xn?{previewText:e.previewText,rangeLocations:e.ranges.map(t=>({preview:{startLineNumber:t.previewRange.start.line,startColumn:t.previewRange.start.character,endLineNumber:t.previewRange.end.line,endColumn:t.previewRange.end.character},source:{startLineNumber:t.sourceRange.start.line,startColumn:t.sourceRange.start.character,endLineNumber:t.sourceRange.end.line,endColumn:t.sourceRange.end.character}}))}:{text:e.text,lineNumber:e.lineNumber}}var qM=class Hw{static{this.TIMEOUT=4e3}static{this.START_BATCH_AFTER_COUNT=50}constructor(t,i){this.maxBatchSize=t,this.cb=i,this.totalNumberCompleted=0,this.batch=[],this.batchSize=0}addItem(t,i){t&&this.addItemToBatch(t,i)}addItems(t,i){t&&this.addItemsToBatch(t,i)}addItemToBatch(t,i){this.batch.push(t),this.batchSize+=i,this.onUpdate()}addItemsToBatch(t,i){this.batch=this.batch.concat(t),this.batchSize+=i,this.onUpdate()}onUpdate(){this.totalNumberCompleted<Hw.START_BATCH_AFTER_COUNT?this.flush():this.batchSize>=this.maxBatchSize?this.flush():this.timeoutHandle||(this.timeoutHandle=setTimeout(()=>{this.flush()},Hw.TIMEOUT))}flush(){this.batchSize&&(this.totalNumberCompleted+=this.batchSize,this.cb(this.batch),this.batch=[],this.batchSize=0,this.timeoutHandle&&(clearTimeout(this.timeoutHandle),this.timeoutHandle=0))}},h5=U("IExtHostSearch"),m0=class{constructor(t,i,r){this.extHostRpc=t,this._uriTransformer=i,this._logService=r,this._proxy=this.extHostRpc.getProxy(W.MainThreadSearch),this._handlePool=0,this._textSearchProvider=new Map,this._textSearchUsedSchemes=new Set,this._aiTextSearchProvider=new Map,this._aiTextSearchUsedSchemes=new Set,this._fileSearchProvider=new Map,this._fileSearchUsedSchemes=new Set,this._fileSearchManager=new BM}_transformScheme(t){return this._uriTransformer.transformOutgoingScheme(t)}registerTextSearchProviderOld(t,i){if(this._textSearchUsedSchemes.has(t))throw new Error(`a text search provider for the scheme '${t}' is already registered`);this._textSearchUsedSchemes.add(t);const r=this._handlePool++;return this._textSearchProvider.set(r,new OM(i)),this._proxy.$registerTextSearchProvider(r,this._transformScheme(t)),ne(()=>{this._textSearchUsedSchemes.delete(t),this._textSearchProvider.delete(r),this._proxy.$unregisterProvider(r)})}registerTextSearchProvider(t,i){if(this._textSearchUsedSchemes.has(t))throw new Error(`a text search provider for the scheme '${t}' is already registered`);this._textSearchUsedSchemes.add(t);const r=this._handlePool++;return this._textSearchProvider.set(r,i),this._proxy.$registerTextSearchProvider(r,this._transformScheme(t)),ne(()=>{this._textSearchUsedSchemes.delete(t),this._textSearchProvider.delete(r),this._proxy.$unregisterProvider(r)})}registerAITextSearchProvider(t,i){if(this._aiTextSearchUsedSchemes.has(t))throw new Error(`an AI text search provider for the scheme '${t}'is already registered`);this._aiTextSearchUsedSchemes.add(t);const r=this._handlePool++;return this._aiTextSearchProvider.set(r,i),this._proxy.$registerAITextSearchProvider(r,this._transformScheme(t)),ne(()=>{this._aiTextSearchUsedSchemes.delete(t),this._aiTextSearchProvider.delete(r),this._proxy.$unregisterProvider(r)})}registerFileSearchProviderOld(t,i){if(this._fileSearchUsedSchemes.has(t))throw new Error(`a file search provider for the scheme '${t}' is already registered`);this._fileSearchUsedSchemes.add(t);const r=this._handlePool++;return this._fileSearchProvider.set(r,new c5(i)),this._proxy.$registerFileSearchProvider(r,this._transformScheme(t)),ne(()=>{this._fileSearchUsedSchemes.delete(t),this._fileSearchProvider.delete(r),this._proxy.$unregisterProvider(r)})}registerFileSearchProvider(t,i){if(this._fileSearchUsedSchemes.has(t))throw new Error(`a file search provider for the scheme '${t}' is already registered`);this._fileSearchUsedSchemes.add(t);const r=this._handlePool++;return this._fileSearchProvider.set(r,i),this._proxy.$registerFileSearchProvider(r,this._transformScheme(t)),ne(()=>{this._fileSearchUsedSchemes.delete(t),this._fileSearchProvider.delete(r),this._proxy.$unregisterProvider(r)})}$provideFileSearchResults(t,i,r,n){const s=v0(r),o=this._fileSearchProvider.get(t);if(o)return this._fileSearchManager.fileSearch(s,o,a=>{this._proxy.$handleFileMatch(t,i,a.map(l=>l.resource))},n);throw new Error("unknown provider: "+t)}async doInternalFileSearchWithCustomCallback(t,i,r){return{messages:[]}}$clearCache(t){return this._fileSearchManager.clearCache(t),Promise.resolve(void 0)}$provideTextSearchResults(t,i,r,n){const s=this._textSearchProvider.get(t);if(!s||!s.provideTextSearchResults)throw new Error(`Unknown Text Search Provider ${t}`);const o=v0(r);return this.createTextSearchManager(o,s).search(l=>this._proxy.$handleTextMatch(t,i,l),n)}$provideAITextSearchResults(t,i,r,n){const s=this._aiTextSearchProvider.get(t);if(!s||!s.provideAITextSearchResults)throw new Error(`Unknown AI Text Search Provider ${t}`);const o=v0(r);return this.createAITextSearchManager(o,s).search(l=>this._proxy.$handleTextMatch(t,i,l),n,l=>this._proxy.$handleKeywordResult(t,i,l))}$enableExtensionHostSearch(){}async $getAIName(t){const i=this._aiTextSearchProvider.get(t);if(!(!i||!i.provideAITextSearchResults))return i.name??"AI"}createTextSearchManager(t,i){return new d5({query:t,provider:i},{readdir:r=>Promise.resolve([]),toCanonicalName:r=>r},"textSearchProvider")}createAITextSearchManager(t,i){return new d5({query:t,provider:i},{readdir:r=>Promise.resolve([]),toCanonicalName:r=>r},"aiTextSearchProvider")}};m0=__decorate([__param(0,Ue),__param(1,id),__param(2,qe)],m0);function v0(e){return{...e,folderQueries:e.folderQueries&&e.folderQueries.map(jM),extraFileResources:e.extraFileResources&&e.extraFileResources.map(t=>y.revive(t))}}function jM(e){return Pt(e)}var _0,w0=class{static{_0=this}static{this.InitialState={focused:!0,active:!0}}getState(){const t=this._state;return{get focused(){return t.focused},get active(){return t.active}}}constructor(t,i){this._onDidChangeWindowState=new P,this.onDidChangeWindowState=this._onDidChangeWindowState.event,this._state=_0.InitialState,t.handle&&(this._nativeHandle=Lu(t.handle).buffer),this._proxy=i.getProxy(W.MainThreadWindow),this._proxy.$getInitialState().then(({isFocused:r,isActive:n})=>{this.onDidChangeWindowProperty("focused",r),this.onDidChangeWindowProperty("active",n)})}get nativeHandle(){return this._nativeHandle}$onDidChangeActiveNativeWindowHandle(t){this._nativeHandle=t?Lu(t).buffer:void 0}$onDidChangeWindowFocus(t){this.onDidChangeWindowProperty("focused",t)}$onDidChangeWindowActive(t){this.onDidChangeWindowProperty("active",t)}onDidChangeWindowProperty(t,i){i!==this._state[t]&&(this._state={...this._state,[t]:i},this._onDidChangeWindowState.fire(this._state))}openUri(t,i){let r;if(typeof t=="string"){r=t;try{t=y.parse(t)}catch{return Promise.reject(`Invalid uri - '${t}'`)}}return Gu(t.scheme)?Promise.reject("Invalid scheme - cannot be empty"):t.scheme===V.command?Promise.reject(`Invalid scheme '${t.scheme}'`):this._proxy.$openUri(t,r,i)}async asExternalUri(t,i){if(Gu(t.scheme))return Promise.reject("Invalid scheme - cannot be empty");const r=await this._proxy.$asExternalUri(t,i);return y.from(r)}};w0=_0=__decorate([__param(0,Yt),__param(1,Ue)],w0);var f5=U("IExtHostWindow"),y0=class extends u8{constructor(t,i){super(i.logLevel,i.logsLocation,i.loggers.map(r=>Pt(r))),this._proxy=t.getProxy(W.MainThreadLogger)}$setLogLevel(t,i){i?this.setLogLevel(y.revive(i),t):this.setLogLevel(t)}setVisibility(t,i){super.setVisibility(t,i),this._proxy.$setVisibility(t,i)}doCreateLogger(t,i,r){return new GM(this._proxy,t,i,r)}};y0=__decorate([__param(0,Ue),__param(1,Yt)],y0);var GM=class extends cx{constructor(e,t,i,r){super(r?.logLevel==="always"),this.proxy=e,this.file=t,this.isLoggerCreated=!1,this.buffer=[],this.setLevel(i),this.proxy.$createLogger(t,r).then(()=>{this.doLog(this.buffer),this.isLoggerCreated=!0})}log(e,t){const i=[[e,t]];this.isLoggerCreated?this.doLog(i):this.buffer.push(...i)}doLog(e){this.proxy.$log(this.file,e)}flush(){this.proxy.$flush(this.file)}},p5=U("IExtHostTerminalShellIntegration"),b0=class extends se{constructor(t,i){super(),this._extHostTerminalService=i,this._activeShellIntegrations=new Map,this._onDidChangeTerminalShellIntegration=new P,this.onDidChangeTerminalShellIntegration=this._onDidChangeTerminalShellIntegration.event,this._onDidStartTerminalShellExecution=new P,this.onDidStartTerminalShellExecution=this._onDidStartTerminalShellExecution.event,this._onDidEndTerminalShellExecution=new P,this.onDidEndTerminalShellExecution=this._onDidEndTerminalShellExecution.event,this._proxy=t.getProxy(W.MainThreadTerminalShellIntegration),this._register(ne(()=>{for(const[r,n]of this._activeShellIntegrations)n.dispose();this._activeShellIntegrations.clear()}))}$shellIntegrationChange(t){const i=this._extHostTerminalService.getTerminalById(t);if(!i)return;const r=i.value;let n=this._activeShellIntegrations.get(t);n||(n=new QM(i.value,this._onDidStartTerminalShellExecution),this._activeShellIntegrations.set(t,n),n.store.add(i.onWillDispose(()=>this._activeShellIntegrations.get(t)?.dispose())),n.store.add(n.onDidRequestShellExecution(s=>this._proxy.$executeCommand(t,s))),n.store.add(n.onDidRequestEndExecution(s=>this._onDidEndTerminalShellExecution.fire(s))),n.store.add(n.onDidRequestChangeShellIntegration(s=>this._onDidChangeTerminalShellIntegration.fire(s))),i.shellIntegration=n.value),this._onDidChangeTerminalShellIntegration.fire({terminal:r,shellIntegration:n.value})}$shellExecutionStart(t,i,r,n,s){this._activeShellIntegrations.has(t)||this.$shellIntegrationChange(t);const o={value:i,confidence:r,isTrusted:n};this._activeShellIntegrations.get(t)?.startShellExecution(o,y.revive(s))}$shellExecutionEnd(t,i,r,n,s){const o={value:i,confidence:r,isTrusted:n};this._activeShellIntegrations.get(t)?.endShellExecution(o,s)}$shellExecutionData(t,i){this._activeShellIntegrations.get(t)?.emitData(i)}$shellEnvChange(t,i,r,n){this._activeShellIntegrations.get(t)?.setEnv(i,r,n)}$cwdChange(t,i){this._activeShellIntegrations.get(t)?.setCwd(y.revive(i))}$closeTerminal(t){this._activeShellIntegrations.get(t)?.dispose(),this._activeShellIntegrations.delete(t)}};b0=__decorate([__param(0,Ue),__param(1,Ha)],b0);var QM=class extends se{get currentExecution(){return this._currentExecution}constructor(e,t){super(),this._terminal=e,this._onDidStartTerminalShellExecution=t,this._pendingExecutions=[],this.store=this._register(new he),this._onDidRequestChangeShellIntegration=this._register(new P),this.onDidRequestChangeShellIntegration=this._onDidRequestChangeShellIntegration.event,this._onDidRequestShellExecution=this._register(new P),this.onDidRequestShellExecution=this._onDidRequestShellExecution.event,this._onDidRequestEndExecution=this._register(new P),this.onDidRequestEndExecution=this._onDidRequestEndExecution.event,this._onDidRequestNewExecution=this._register(new P),this.onDidRequestNewExecution=this._onDidRequestNewExecution.event;const i=this;this.value={get cwd(){return i._cwd},get env(){if(i._env)return Object.freeze({isTrusted:i._env.isTrusted,value:Object.freeze({...i._env.value})})},executeCommand(r,n){let s=r;if(n)for(const l of n)!l.match(/["'`]/)&&l.match(/\s/)?s+=` "${l}"`:s+=` ${l}`;i._onDidRequestShellExecution.fire(s);const o={value:s,confidence:ec.High,isTrusted:!0};return i.requestNewShellExecution(o,i._cwd).value}}}requestNewShellExecution(e,t){const i=new g5(e,t??this._cwd);return np(e.value).length>1&&(this._currentExecutionProperties={isMultiLine:!0,unresolvedCommandLines:np(e.value)}),this._pendingExecutions.push(i),this._onDidRequestNewExecution.fire(e.value),i}startShellExecution(e,t){if(this._pendingEndingExecution&&(this._onDidRequestEndExecution.fire({terminal:this._terminal,shellIntegration:this.value,execution:this._pendingEndingExecution.value,exitCode:void 0}),this._pendingEndingExecution=void 0),this._currentExecution){if(this._currentExecutionProperties?.isMultiLine&&this._currentExecutionProperties.unresolvedCommandLines){const r=m5(this._currentExecutionProperties.unresolvedCommandLines,e);if(r){this._currentExecutionProperties.unresolvedCommandLines=r.unresolvedCommandLines;return}}this._currentExecution.endExecution(void 0),this._currentExecution.flush(),this._onDidRequestEndExecution.fire({terminal:this._terminal,shellIntegration:this.value,execution:this._currentExecution.value,exitCode:void 0})}let i;if(e.confidence===ec.High)for(const[r,n]of this._pendingExecutions.entries())if(n.value.commandLine.value===e.value){i=n,this._currentExecutionProperties={isMultiLine:!1,unresolvedCommandLines:void 0},i=n,this._pendingExecutions.splice(r,1);break}else{const s=m5(np(n.value.commandLine.value),e);if(s){this._currentExecutionProperties={isMultiLine:!0,unresolvedCommandLines:s.unresolvedCommandLines},i=n,this._pendingExecutions.splice(r,1);break}}else i=this._pendingExecutions.shift();i||(i=new g5(e,t??this._cwd)),this._currentExecution=i,this._onDidStartTerminalShellExecution.fire({terminal:this._terminal,shellIntegration:this.value,execution:this._currentExecution.value})}emitData(e){this.currentExecution?.emitData(e)}endShellExecution(e,t){if(!(this._currentExecutionProperties?.isMultiLine&&this._currentExecutionProperties.unresolvedCommandLines&&this._currentExecutionProperties.unresolvedCommandLines.length>0)&&this._currentExecution){const i=this._currentExecutionProperties?.isMultiLine?this._currentExecution.value.commandLine:e;this._currentExecution.endExecution(i);const r=this._currentExecution;this._pendingEndingExecution=r,this._currentExecution=void 0,r.flush().then(()=>{this._pendingEndingExecution===r&&(this._onDidRequestEndExecution.fire({terminal:this._terminal,shellIntegration:this.value,execution:r.value,exitCode:t}),this._pendingEndingExecution=void 0)})}}setEnv(e,t,i){const r={};for(let n=0;n<e.length;n++)r[e[n]]=t[n];this._env={value:r,isTrusted:i},this._fireChangeEvent()}setCwd(e){let t=!1;y.isUri(this._cwd)?t=!y.isUri(e)||this._cwd.toString()!==e.toString():this._cwd!==e&&(t=!0),t&&(this._cwd=e,this._fireChangeEvent())}_fireChangeEvent(){this._onDidRequestChangeShellIntegration.fire({terminal:this._terminal,shellIntegration:this.value})}},g5=class{constructor(e,t){this._commandLine=e,this.cwd=t,this._isEnded=!1;const i=this;this.value={get commandLine(){return i._commandLine},get cwd(){return i.cwd},read(){return i._createDataStream()}}}_createDataStream(){if(!this._dataStream){if(this._isEnded)return fl.EMPTY;this._dataStream=new JM}return this._dataStream.createIterable()}emitData(e){this._isEnded||this._dataStream?.emitData(e)}endExecution(e){e&&(this._commandLine=e),this._dataStream?.endExecution(),this._isEnded=!0}async flush(){this._dataStream&&(await this._dataStream.flush(),this._dataStream.dispose(),this._dataStream=void 0)}},JM=class extends se{constructor(){super(...arguments),this._iterables=[],this._emitters=[]}createIterable(){this._barrier||(this._barrier=new Cr);const e=this._barrier,t=new fl(async i=>{this._emitters.push(i),await e.wait()});return this._iterables.push(t),t}emitData(e){for(const t of this._emitters)t.emitOne(e)}endExecution(){this._barrier?.open()}async flush(){await Promise.all(this._iterables.map(e=>e.toPromise()))}};function np(e){return e.split(`
`).map(t=>t.trim()).filter(t=>t.length>0)}function m5(e,t){if(e.length===0)return!1;const i=[...e],r=np(t.value);if(i&&i.length>0){for(;i.length>0&&i[0]===r[0];)i.shift(),r.shift();if(r.length===0)return{unresolvedCommandLines:i}}return!1}var v5;(function(e){e[e.CR=13]="CR",e[e.LF=10]="LF",e[e.COLON=58]="COLON",e[e.SPACE=32]="SPACE"})(v5||(v5={}));var x0=class{constructor(e){this.dataBuffer="",this.eventTypeBuffer="",this.buffer=[],this.endedOnCR=!1,this.onEventHandler=e,this.decoder=new TextDecoder("utf-8")}getLastEventId(){return this.lastEventIdBuffer}getReconnectionTime(){return this.reconnectionTime}feed(e){if(e.length===0)return;let t=0;for(this.endedOnCR&&e[0]===10&&t++,this.endedOnCR=!1;t<e.length;){const i=e.indexOf(13,t),r=e.indexOf(10,t),n=i===-1?r:r===-1?i:Math.min(i,r);if(n===-1)break;let s="";for(const o of this.buffer)s+=this.decoder.decode(o,{stream:!0});s+=this.decoder.decode(e.subarray(t,n)),this.processLine(s),this.buffer.length=0,t=n+(e[n]===13&&e[n+1]===10?2:1)}t<e.length?this.buffer.push(e.subarray(t)):this.endedOnCR=e[e.length-1]===13}processLine(e){if(!e.length){this.dispatchEvent();return}if(e.startsWith(":"))return;let t,i;const r=e.indexOf(":");r===-1?(t=e,i=""):(t=e.substring(0,r),i=e.substring(r+1),i.startsWith(" ")&&(i=i.substring(1))),this.processField(t,i)}processField(e,t){switch(e){case"event":this.eventTypeBuffer=t;break;case"data":this.dataBuffer+=t,this.dataBuffer+=`
`;break;case"id":t.includes("\0")?this.currentEventId=void 0:this.currentEventId=this.lastEventIdBuffer=t;break;case"retry":/^\d+$/.test(t)&&(this.reconnectionTime=parseInt(t,10));break}}dispatchEvent(){if(this.dataBuffer===""){this.dataBuffer="",this.eventTypeBuffer="";return}this.dataBuffer.endsWith(`
`)&&(this.dataBuffer=this.dataBuffer.substring(0,this.dataBuffer.length-1));const e={type:this.eventTypeBuffer||"message",data:this.dataBuffer};this.currentEventId!==void 0&&(e.id=this.currentEventId),this.reconnectionTime!==void 0&&(e.retry=this.reconnectionTime),this.onEventHandler(e),this.reset()}reset(){this.dataBuffer="",this.eventTypeBuffer="",this.currentEventId=void 0}},S0=U("IExtHostMpcService"),E0=class extends se{constructor(t){super(),this._initialProviderPromises=new Set,this._sseEventSources=this._register(new Pu),this._unresolvedMcpServers=new Map,this._proxy=t.getProxy(W.MainThreadMcp)}$startMcp(t,i){this._startMcp(t,bc.fromSerialized(i))}_startMcp(t,i){if(i.type===2){this._sseEventSources.set(t,new XM(t,i,this._proxy));return}throw new Error("not implemented")}$stopMcp(t){this._sseEventSources.has(t)&&(this._sseEventSources.deleteAndDispose(t),this._proxy.$onDidChangeState(t,{state:0}))}$sendMessage(t,i){this._sseEventSources.get(t)?.send(i)}async $waitForInitialCollectionProviders(){await Promise.all(this._initialProviderPromises)}async $resolveMcpLaunch(t,i){const r=this._unresolvedMcpServers.get(t);if(!r)return;const n=r.servers.find(o=>o.label===i);if(!n)return;if(!r.provider.resolveMcpServerDefinition)return Fc.from(n);const s=await r.provider.resolveMcpServerDefinition(n,Xe.None);return s?Fc.from(s):void 0}registerMcpConfigurationProvider(t,i,r){const n=new he,s=t.contributes?.modelContextServerCollections?.find(c=>c.id===i);if(!s)throw new Error(`MCP configuration providers must be registered in the contributes.modelContextServerCollections array within your package.json, but "${i}" was not`);const o={id:B2(t.identifier,i),isTrustedByDefault:!0,label:s?.label??t.displayName??t.name,scope:1,canResolveLaunch:typeof r.resolveMcpServerDefinition=="function",extensionId:t.identifier.value},a=async()=>{const c=await r.provideMcpServerDefinitions(Xe.None);this._unresolvedMcpServers.set(o.id,{servers:c??[],provider:r});const u=[];for(const d of c??[]){let f=Oe.toKey(t.identifier)+"/"+d.label;if(u.some(p=>p.id===f)){let p=2;for(;u.some(m=>m.id===f+p);)p++;f=f+p}u.push({id:f,label:d.label,cacheNonce:d.version,launch:Fc.from(d)})}this._proxy.$upsertMcpCollection(o,u)};n.add(ne(()=>{this._unresolvedMcpServers.delete(o.id),this._proxy.$deleteMcpCollection(o.id)})),r.onDidChangeServerDefinitions&&n.add(r.onDidChangeServerDefinitions(a)),r.onDidChange&&n.add(r.onDidChange(a));const l=new Promise(c=>{setTimeout(()=>a().finally(()=>{this._initialProviderPromises.delete(l),c()}),0)});return this._initialProviderPromises.add(l),n}};E0=__decorate([__param(0,Ue)],E0);var _5;(function(e){e[e.Unknown=0]="Unknown",e[e.Http=1]="Http",e[e.SSE=2]="SSE"})(_5||(_5={}));var XM=class extends se{constructor(e,t,i){super(),this._id=e,this._launch=t,this._proxy=i,this._requestSequencer=new ST,this._postEndpoint=new Dr,this._mode={value:0},this._cts=new ft,this._abortCtrl=new AbortController,this._register(ne(()=>{this._abortCtrl.abort(),this._cts.dispose(!0)})),this._proxy.$onDidChangeState(this._id,{state:2})}async send(e){try{await this._requestSequencer.queue(()=>this._mode.value===2?this._sendLegacySSE(this._mode.endpoint,e):this._sendStreamableHttp(e,this._mode.value===1?this._mode.sessionId:void 0))}catch(t){const i=`Error sending message to ${this._launch.uri}: ${String(t)}`;this._proxy.$onDidChangeState(this._id,{state:3,message:i})}}async _sendStreamableHttp(e,t){const i=new TextEncoder().encode(e),r={...Object.fromEntries(this._launch.headers),"Content-Type":"application/json","Content-Length":String(i.length),Accept:"text/event-stream, application/json"};t&&(r["Mcp-Session-Id"]=t);const n=await fetch(this._launch.uri.toString(!0),{method:"POST",signal:this._abortCtrl.signal,headers:r,body:i}),s=this._mode.value===0,o=n.headers.get("Mcp-Session-Id");if(o&&(this._mode={value:1,sessionId:o}),this._mode.value===0&&n.status>=400&&n.status<500){this._log(Ee.Info,`${n.status} status sending message to ${this._launch.uri}, will attempt to fall back to legacy SSE`);const a=await this._attachSSE();a&&(this._mode={value:2,endpoint:a},await this._sendLegacySSE(a,e));return}if(n.status>=300){const a=this._mode.value===1&&!!this._mode.sessionId;this._proxy.$onDidChangeState(this._id,{state:3,message:`${n.status} status sending message to ${this._launch.uri}: ${await this._getErrText(n)}`+a?"; will retry with new session ID":"",shouldRetry:a});return}this._mode.value===0&&(this._mode={value:1,sessionId:void 0}),s&&this._attachStreamableBackchannel(),this._handleSuccessfulStreamableHttp(n)}async _handleSuccessfulStreamableHttp(e){if(e.status!==202)switch(e.headers.get("Content-Type")?.toLowerCase()){case"text/event-stream":{const t=new x0(i=>{i.type==="message"&&this._proxy.$onDidReceiveMessage(this._id,i.data)});try{await this._doSSE(t,e)}catch(i){this._log(Ee.Warning,`Error reading SSE stream: ${String(i)}`)}break}case"application/json":this._proxy.$onDidReceiveMessage(this._id,await e.text());break;default:{const t=await e.text();ZM(t)?this._proxy.$onDidReceiveMessage(this._id,t):this._log(Ee.Warning,`Unexpected ${e.status} response for request: ${t}`)}}}async _attachStreamableBackchannel(){let e;for(let t=0;!this._store.isDisposed;t++){await sr(Math.min(t*1e3,3e4),this._cts.token);let i;try{const n={...Object.fromEntries(this._launch.headers),Accept:"text/event-stream"};this._mode.value===1&&this._mode.sessionId!==void 0&&(n["Mcp-Session-Id"]=this._mode.sessionId),e&&(n["Last-Event-ID"]=e),i=await fetch(this._launch.uri.toString(!0),{method:"GET",signal:this._abortCtrl.signal,headers:n})}catch{this._log(Ee.Info,`Error connecting to ${this._launch.uri} for async notifications, will retry`);continue}if(i.status>=400){this._log(Ee.Debug,`${i.status} status connecting to ${this._launch.uri} for async notifications; they will be disabled: ${await this._getErrText(i)}`);return}t=0;const r=new x0(n=>{n.type==="message"&&this._proxy.$onDidReceiveMessage(this._id,n.data),n.id&&(e=n.id)});try{await this._doSSE(r,i)}catch(n){this._log(Ee.Info,`Error reading from async stream, we will reconnect: ${n}`)}}}async _attachSSE(){const e=new Dr;let t;try{if(t=await fetch(this._launch.uri.toString(!0),{method:"GET",signal:this._abortCtrl.signal,headers:{...Object.fromEntries(this._launch.headers),Accept:"text/event-stream"}}),t.status>=300){this._proxy.$onDidChangeState(this._id,{state:3,message:`${t.status} status connecting to ${this._launch.uri} as SSE: ${await this._getErrText(t)}`});return}}catch(r){this._proxy.$onDidChangeState(this._id,{state:3,message:`Error connecting to ${this._launch.uri} as SSE: ${r}`});return}const i=new x0(r=>{r.type==="message"?this._proxy.$onDidReceiveMessage(this._id,r.data):r.type==="endpoint"&&e.complete(new URL(r.data,this._launch.uri.toString(!0)).toString())});return this._register(ne(()=>e.cancel())),this._doSSE(i,t).catch(r=>{this._proxy.$onDidChangeState(this._id,{state:3,message:`Error reading SSE stream: ${String(r)}`})}),e.p}async _sendLegacySSE(e,t){const i=new TextEncoder().encode(t),r=await fetch(e,{method:"POST",signal:this._abortCtrl.signal,headers:{...Object.fromEntries(this._launch.headers),"Content-Type":"application/json","Content-Length":String(i.length)},body:i});r.status>=300&&this._log(Ee.Warning,`${r.status} status sending message to ${this._postEndpoint}: ${await this._getErrText(r)}`)}async _doSSE(e,t){if(!t.body)return;const i=t.body.getReader();let r;do{try{r=await Ku(i.read(),this._cts.token)}catch(n){if(i.cancel(),this._store.isDisposed)return;throw n}r.value&&e.feed(r.value)}while(!r.done)}_log(e,t){this._store.isDisposed||this._proxy.$onDidPublishLog(this._id,e,t)}async _getErrText(e){try{return await e.text()}catch{return e.statusText}}};function ZM(e){try{return JSON.parse(e),!0}catch{return!1}}Ze(V_,W_,1),Ze(xl,y0,1),Ze(Jf,K_,1),Ze(no,D_,0),Ze(A_,R_,0),Ze(L_,N_,0),Ze(fn,d_,0),Ze(zf,m_,0),Ze(rp,d0,0),Ze(l5,g0,0),Ze(kI,J_,0),Ze(Wa,Z_,0),Ze(z_,q_,0),Ze(Oo,I8,0),Ze(II,Q_,1),Ze(h5,m0,0),Ze(g_,AD,0),Ze(ZI,c0,0),Ze(Ha,P_,0),Ze(p5,b0,0),Ze(x_,S_,0),Ze(f5,w0,0),Ze(hn,a_,0),Ze(B_,yI,0),Ze(Kc,u0,0),Ze(h0,f0,0),Ze(S0,E0,0);var KM=class extends se{constructor(e,t=[]){super(),this.logger=new c8([e,...t]),this._register(e.onDidChangeLogLevel(i=>this.setLevel(i)))}get onDidChangeLogLevel(){return this.logger.onDidChangeLogLevel}setLevel(e){this.logger.setLevel(e)}getLevel(){return this.logger.getLevel()}trace(e,...t){this.logger.trace(e,...t)}debug(e,...t){this.logger.debug(e,...t)}info(e,...t){this.logger.info(e,...t)}warn(e,...t){this.logger.warn(e,...t)}error(e,...t){this.logger.error(e,...t)}flush(){this.logger.flush()}},C0=class extends KM{constructor(t,i,r){const n=r.remote.isRemote?"remoteexthost":t?"workerexthost":"exthost",s=r.remote.isRemote?h(2930,null):h(t?2931:2932,null);super(i.createLogger(n,{name:s}))}};C0=__decorate([__param(1,xl),__param(2,Yt)],C0);var w5={tabSize:4,indentSize:4,insertSpaces:!0,detectIndentation:!0,trimAutoWhitespace:!0,largeFileOptimizations:!0,bracketPairColorizationOptions:{enabled:!0,independentColorPoolPerBracketType:!1}},Ni,D0=globalThis.vscode;if(typeof D0<"u"&&typeof D0.context<"u"){const e=D0.context.configuration();if(e)Ni=e.product;else throw new Error("Sandbox: unable to resolve product configuration from preload script.")}else if(globalThis._VSCODE_PRODUCT_JSON&&globalThis._VSCODE_PACKAGE_JSON){if(Ni=globalThis._VSCODE_PRODUCT_JSON,Io.VSCODE_DEV&&Object.assign(Ni,{nameShort:`${Ni.nameShort} Dev`,nameLong:`${Ni.nameLong} Dev`,dataFolderName:`${Ni.dataFolderName}-dev`,serverDataFolderName:Ni.serverDataFolderName?`${Ni.serverDataFolderName}-dev`:void 0}),!Ni.version){const e=globalThis._VSCODE_PACKAGE_JSON;Object.assign(Ni,{version:e.version})}}else Ni={},Object.keys(Ni).length===0&&Object.assign(Ni,{version:"1.95.0-dev",nameShort:"Code - OSS Dev",nameLong:"Code - OSS Dev",applicationName:"code-oss",dataFolderName:".vscode-oss",urlProtocol:"code-oss",reportIssueUrl:"https://github.com/microsoft/vscode/issues/new",licenseName:"MIT",licenseUrl:"https://github.com/microsoft/vscode/blob/main/LICENSE.txt",serverLicenseUrl:"https://github.com/microsoft/vscode/blob/main/LICENSE.txt"});var YM=Ni,y5;(function(e){e[e.None=0]="None",e[e.Keep=1]="Keep",e[e.Brackets=2]="Brackets",e[e.Advanced=3]="Advanced",e[e.Full=4]="Full"})(y5||(y5={}));var eO=8,tO=class{constructor(){this.stableMinimapLayoutInput=null,this.stableFitMaxMinimapScale=0,this.stableFitRemainingWidth=0}},je=class{constructor(e,t,i,r){this.id=e,this.name=t,this.defaultValue=i,this.schema=r}applyUpdate(e,t){return op(e,t)}compute(e,t,i){return i}},sp=class{constructor(e,t){this.newValue=e,this.didChange=t}};function op(e,t){if(typeof e!="object"||typeof t!="object"||!e||!t)return new sp(t,e!==t);if(Array.isArray(e)||Array.isArray(t)){const r=Array.isArray(e)&&Array.isArray(t)&&Sr(e,t);return new sp(t,!r)}let i=!1;for(const r in t)if(t.hasOwnProperty(r)){const n=op(e[r],t[r]);n.didChange&&(e[r]=n.newValue,i=!0)}return new sp(e,i)}var oo=class{constructor(e){this.schema=void 0,this.id=e,this.name="_never_",this.defaultValue=void 0}applyUpdate(e,t){return op(e,t)}validate(e){return this.defaultValue}},Va=class{constructor(e,t,i,r){this.id=e,this.name=t,this.defaultValue=i,this.schema=r}applyUpdate(e,t){return op(e,t)}validate(e){return typeof e>"u"?this.defaultValue:e}compute(e,t,i){return i}};function G(e,t){return typeof e>"u"?t:e==="false"?!1:!!e}var ve=class extends Va{constructor(e,t,i,r=void 0){typeof r<"u"&&(r.type="boolean",r.default=i),super(e,t,i,r)}validate(e){return G(e,this.defaultValue)}};function iO(e,t,i,r){if(typeof e>"u")return t;let n=parseInt(e,10);return isNaN(n)?t:(n=Math.max(i,n),n=Math.min(r,n),n|0)}var $e=class c7 extends Va{static clampedInt(t,i,r,n){return iO(t,i,r,n)}constructor(t,i,r,n,s,o=void 0){typeof o<"u"&&(o.type="integer",o.default=r,o.minimum=n,o.maximum=s),super(t,i,r,o),this.minimum=n,this.maximum=s}validate(t){return c7.clampedInt(t,this.defaultValue,this.minimum,this.maximum)}},$r=class u7 extends Va{static clamp(t,i,r){return t<i?i:t>r?r:t}static float(t,i){if(typeof t=="number")return t;if(typeof t>"u")return i;const r=parseFloat(t);return isNaN(r)?i:r}constructor(t,i,r,n,s){typeof s<"u"&&(s.type="number",s.default=r),super(t,i,r,s),this.validationFn=n}validate(t){return this.validationFn(u7.float(t,this.defaultValue))}},wi=class d7 extends Va{static string(t,i){return typeof t!="string"?i:t}constructor(t,i,r,n=void 0){typeof n<"u"&&(n.type="string",n.default=r),super(t,i,r,n)}validate(t){return d7.string(t,this.defaultValue)}};function it(e,t,i,r){return typeof e!="string"?t:r&&e in r?r[e]:i.indexOf(e)===-1?t:e}var Ye=class extends Va{constructor(e,t,i,r,n=void 0){typeof n<"u"&&(n.type="string",n.enum=r,n.default=i),super(e,t,i,n),this._allowedValues=r}validate(e){return it(e,this.defaultValue,this._allowedValues)}},eu=class extends je{constructor(e,t,i,r,n,s,o=void 0){typeof o<"u"&&(o.type="string",o.enum=n,o.default=r),super(e,t,i,o),this._allowedValues=n,this._convert=s}validate(e){return typeof e!="string"?this.defaultValue:this._allowedValues.indexOf(e)===-1?this.defaultValue:this._convert(e)}};function rO(e){switch(e){case"none":return 0;case"keep":return 1;case"brackets":return 2;case"advanced":return 3;case"full":return 4}}var nO=class extends je{constructor(){super(2,"accessibilitySupport",0,{type:"string",enum:["auto","on","off"],enumDescriptions:[h(319,null),h(320,null),h(321,null)],default:"auto",tags:["accessibility"],description:h(322,null)})}validate(e){switch(e){case"auto":return 0;case"off":return 1;case"on":return 2}return this.defaultValue}compute(e,t,i){return i===0?e.accessibilitySupport:i}},sO=class extends je{constructor(){const e={insertSpace:!0,ignoreEmptyLines:!0};super(23,"comments",e,{"editor.comments.insertSpace":{type:"boolean",default:e.insertSpace,description:h(323,null)},"editor.comments.ignoreEmptyLines":{type:"boolean",default:e.ignoreEmptyLines,description:h(324,null)}})}validate(e){if(!e||typeof e!="object")return this.defaultValue;const t=e;return{insertSpace:G(t.insertSpace,this.defaultValue.insertSpace),ignoreEmptyLines:G(t.ignoreEmptyLines,this.defaultValue.ignoreEmptyLines)}}},b5;(function(e){e[e.Hidden=0]="Hidden",e[e.Blink=1]="Blink",e[e.Smooth=2]="Smooth",e[e.Phase=3]="Phase",e[e.Expand=4]="Expand",e[e.Solid=5]="Solid"})(b5||(b5={}));function oO(e){switch(e){case"blink":return 1;case"smooth":return 2;case"phase":return 3;case"expand":return 4;case"solid":return 5}}var gr;(function(e){e[e.Line=1]="Line",e[e.Block=2]="Block",e[e.Underline=3]="Underline",e[e.LineThin=4]="LineThin",e[e.BlockOutline=5]="BlockOutline",e[e.UnderlineThin=6]="UnderlineThin"})(gr||(gr={}));function x5(e){switch(e){case"line":return gr.Line;case"block":return gr.Block;case"underline":return gr.Underline;case"line-thin":return gr.LineThin;case"block-outline":return gr.BlockOutline;case"underline-thin":return gr.UnderlineThin}}var aO=class extends oo{constructor(){super(148)}compute(e,t,i){const r=["monaco-editor"];return t.get(41)&&r.push(t.get(41)),e.extraEditorClassName&&r.push(e.extraEditorClassName),t.get(75)==="default"?r.push("mouse-default"):t.get(75)==="copy"&&r.push("mouse-copy"),t.get(116)&&r.push("showUnused"),t.get(145)&&r.push("showDeprecated"),r.join(" ")}},lO=class extends ve{constructor(){super(38,"emptySelectionClipboard",!0,{description:h(325,null)})}compute(e,t,i){return i&&e.emptySelectionClipboard}},cO=class extends je{constructor(){const e={cursorMoveOnType:!0,seedSearchStringFromSelection:"always",autoFindInSelection:"never",globalFindClipboard:!1,addExtraSpaceOnTop:!0,loop:!0,history:"workspace",replaceHistory:"workspace"};super(43,"find",e,{"editor.find.cursorMoveOnType":{type:"boolean",default:e.cursorMoveOnType,description:h(326,null)},"editor.find.seedSearchStringFromSelection":{type:"string",enum:["never","always","selection"],default:e.seedSearchStringFromSelection,enumDescriptions:[h(327,null),h(328,null),h(329,null)],description:h(330,null)},"editor.find.autoFindInSelection":{type:"string",enum:["never","always","multiline"],default:e.autoFindInSelection,enumDescriptions:[h(331,null),h(332,null),h(333,null)],description:h(334,null)},"editor.find.globalFindClipboard":{type:"boolean",default:e.globalFindClipboard,description:h(335,null),included:Hi},"editor.find.addExtraSpaceOnTop":{type:"boolean",default:e.addExtraSpaceOnTop,description:h(336,null)},"editor.find.loop":{type:"boolean",default:e.loop,description:h(337,null)},"editor.find.history":{type:"string",enum:["never","workspace"],default:"workspace",enumDescriptions:[h(338,null),h(339,null)],description:h(340,null)},"editor.find.replaceHistory":{type:"string",enum:["never","workspace"],default:"workspace",enumDescriptions:[h(341,null),h(342,null)],description:h(343,null)}})}validate(e){if(!e||typeof e!="object")return this.defaultValue;const t=e;return{cursorMoveOnType:G(t.cursorMoveOnType,this.defaultValue.cursorMoveOnType),seedSearchStringFromSelection:typeof e.seedSearchStringFromSelection=="boolean"?e.seedSearchStringFromSelection?"always":"never":it(t.seedSearchStringFromSelection,this.defaultValue.seedSearchStringFromSelection,["never","always","selection"]),autoFindInSelection:typeof e.autoFindInSelection=="boolean"?e.autoFindInSelection?"always":"never":it(t.autoFindInSelection,this.defaultValue.autoFindInSelection,["never","always","multiline"]),globalFindClipboard:G(t.globalFindClipboard,this.defaultValue.globalFindClipboard),addExtraSpaceOnTop:G(t.addExtraSpaceOnTop,this.defaultValue.addExtraSpaceOnTop),loop:G(t.loop,this.defaultValue.loop),history:it(t.history,this.defaultValue.history,["never","workspace"]),replaceHistory:it(t.replaceHistory,this.defaultValue.replaceHistory,["never","workspace"])}}},uO=class Ja extends je{static{this.OFF='"liga" off, "calt" off'}static{this.ON='"liga" on, "calt" on'}constructor(){super(53,"fontLigatures",Ja.OFF,{anyOf:[{type:"boolean",description:h(344,null)},{type:"string",description:h(345,null)}],description:h(346,null),default:!1})}validate(t){return typeof t>"u"?this.defaultValue:typeof t=="string"?t==="false"||t.length===0?Ja.OFF:t==="true"?Ja.ON:t:t?Ja.ON:Ja.OFF}},dO=class Xa extends je{static{this.OFF="normal"}static{this.TRANSLATE="translate"}constructor(){super(56,"fontVariations",Xa.OFF,{anyOf:[{type:"boolean",description:h(347,null)},{type:"string",description:h(348,null)}],description:h(349,null),default:!1})}validate(t){return typeof t>"u"?this.defaultValue:typeof t=="string"?t==="false"?Xa.OFF:t==="true"?Xa.TRANSLATE:t:t?Xa.TRANSLATE:Xa.OFF}compute(t,i,r){return t.fontInfo.fontVariationSettings}},hO=class extends oo{constructor(){super(52)}compute(e,t,i){return e.fontInfo}},fO=class extends oo{constructor(){super(147)}compute(e,t,i){return e.inputMode==="overtype"?t.get(84):t.get(28)}},pO=class extends oo{constructor(){super(156)}compute(e,t){return e.editContextSupported&&t.get(37)}},gO=class extends Va{constructor(){super(54,"fontSize",mn.fontSize,{type:"number",minimum:6,maximum:100,default:mn.fontSize,description:h(350,null)})}validate(e){const t=$r.float(e,this.defaultValue);return t===0?mn.fontSize:$r.clamp(t,6,100)}compute(e,t,i){return e.fontInfo.fontSize}},mO=class Za extends je{static{this.SUGGESTION_VALUES=["normal","bold","100","200","300","400","500","600","700","800","900"]}static{this.MINIMUM_VALUE=1}static{this.MAXIMUM_VALUE=1e3}constructor(){super(55,"fontWeight",mn.fontWeight,{anyOf:[{type:"number",minimum:Za.MINIMUM_VALUE,maximum:Za.MAXIMUM_VALUE,errorMessage:h(351,null)},{type:"string",pattern:"^(normal|bold|1000|[1-9][0-9]{0,2})$"},{enum:Za.SUGGESTION_VALUES}],default:mn.fontWeight,description:h(352,null)})}validate(t){return t==="normal"||t==="bold"?t:String($e.clampedInt(t,mn.fontWeight,Za.MINIMUM_VALUE,Za.MAXIMUM_VALUE))}},vO=class extends je{constructor(){const e={multiple:"peek",multipleDefinitions:"peek",multipleTypeDefinitions:"peek",multipleDeclarations:"peek",multipleImplementations:"peek",multipleReferences:"peek",multipleTests:"peek",alternativeDefinitionCommand:"editor.action.goToReferences",alternativeTypeDefinitionCommand:"editor.action.goToReferences",alternativeDeclarationCommand:"editor.action.goToReferences",alternativeImplementationCommand:"",alternativeReferenceCommand:"",alternativeTestsCommand:""},t={type:"string",enum:["peek","gotoAndPeek","goto"],default:e.multiple,enumDescriptions:[h(353,null),h(354,null),h(355,null)]},i=["","editor.action.referenceSearch.trigger","editor.action.goToReferences","editor.action.peekImplementation","editor.action.goToImplementation","editor.action.peekTypeDefinition","editor.action.goToTypeDefinition","editor.action.peekDeclaration","editor.action.revealDeclaration","editor.action.peekDefinition","editor.action.revealDefinitionAside","editor.action.revealDefinition"];super(60,"gotoLocation",e,{"editor.gotoLocation.multiple":{deprecationMessage:h(356,null)},"editor.gotoLocation.multipleDefinitions":{description:h(357,null),...t},"editor.gotoLocation.multipleTypeDefinitions":{description:h(358,null),...t},"editor.gotoLocation.multipleDeclarations":{description:h(359,null),...t},"editor.gotoLocation.multipleImplementations":{description:h(360,null),...t},"editor.gotoLocation.multipleReferences":{description:h(361,null),...t},"editor.gotoLocation.alternativeDefinitionCommand":{type:"string",default:e.alternativeDefinitionCommand,enum:i,description:h(362,null)},"editor.gotoLocation.alternativeTypeDefinitionCommand":{type:"string",default:e.alternativeTypeDefinitionCommand,enum:i,description:h(363,null)},"editor.gotoLocation.alternativeDeclarationCommand":{type:"string",default:e.alternativeDeclarationCommand,enum:i,description:h(364,null)},"editor.gotoLocation.alternativeImplementationCommand":{type:"string",default:e.alternativeImplementationCommand,enum:i,description:h(365,null)},"editor.gotoLocation.alternativeReferenceCommand":{type:"string",default:e.alternativeReferenceCommand,enum:i,description:h(366,null)}})}validate(e){if(!e||typeof e!="object")return this.defaultValue;const t=e;return{multiple:it(t.multiple,this.defaultValue.multiple,["peek","gotoAndPeek","goto"]),multipleDefinitions:t.multipleDefinitions??it(t.multipleDefinitions,"peek",["peek","gotoAndPeek","goto"]),multipleTypeDefinitions:t.multipleTypeDefinitions??it(t.multipleTypeDefinitions,"peek",["peek","gotoAndPeek","goto"]),multipleDeclarations:t.multipleDeclarations??it(t.multipleDeclarations,"peek",["peek","gotoAndPeek","goto"]),multipleImplementations:t.multipleImplementations??it(t.multipleImplementations,"peek",["peek","gotoAndPeek","goto"]),multipleReferences:t.multipleReferences??it(t.multipleReferences,"peek",["peek","gotoAndPeek","goto"]),multipleTests:t.multipleTests??it(t.multipleTests,"peek",["peek","gotoAndPeek","goto"]),alternativeDefinitionCommand:wi.string(t.alternativeDefinitionCommand,this.defaultValue.alternativeDefinitionCommand),alternativeTypeDefinitionCommand:wi.string(t.alternativeTypeDefinitionCommand,this.defaultValue.alternativeTypeDefinitionCommand),alternativeDeclarationCommand:wi.string(t.alternativeDeclarationCommand,this.defaultValue.alternativeDeclarationCommand),alternativeImplementationCommand:wi.string(t.alternativeImplementationCommand,this.defaultValue.alternativeImplementationCommand),alternativeReferenceCommand:wi.string(t.alternativeReferenceCommand,this.defaultValue.alternativeReferenceCommand),alternativeTestsCommand:wi.string(t.alternativeTestsCommand,this.defaultValue.alternativeTestsCommand)}}},_O=class extends je{constructor(){const e={enabled:!0,delay:300,hidingDelay:300,sticky:!0,above:!0};super(62,"hover",e,{"editor.hover.enabled":{type:"boolean",default:e.enabled,description:h(367,null)},"editor.hover.delay":{type:"number",default:e.delay,minimum:0,maximum:1e4,description:h(368,null)},"editor.hover.sticky":{type:"boolean",default:e.sticky,description:h(369,null)},"editor.hover.hidingDelay":{type:"integer",minimum:0,default:e.hidingDelay,description:h(370,null)},"editor.hover.above":{type:"boolean",default:e.above,description:h(371,null)}})}validate(e){if(!e||typeof e!="object")return this.defaultValue;const t=e;return{enabled:G(t.enabled,this.defaultValue.enabled),delay:$e.clampedInt(t.delay,this.defaultValue.delay,0,1e4),sticky:G(t.sticky,this.defaultValue.sticky),hidingDelay:$e.clampedInt(t.hidingDelay,this.defaultValue.hidingDelay,0,6e5),above:G(t.above,this.defaultValue.above)}}},S5;(function(e){e[e.None=0]="None",e[e.Text=1]="Text",e[e.Blocks=2]="Blocks"})(S5||(S5={}));var wO=class zp extends oo{constructor(){super(151)}compute(t,i,r){return zp.computeLayout(i,{memory:t.memory,outerWidth:t.outerWidth,outerHeight:t.outerHeight,isDominatedByLongLines:t.isDominatedByLongLines,lineHeight:t.fontInfo.lineHeight,viewLineCount:t.viewLineCount,lineNumbersDigitCount:t.lineNumbersDigitCount,typicalHalfwidthCharacterWidth:t.fontInfo.typicalHalfwidthCharacterWidth,maxDigitWidth:t.fontInfo.maxDigitWidth,pixelRatio:t.pixelRatio,glyphMarginDecorationLaneCount:t.glyphMarginDecorationLaneCount})}static computeContainedMinimapLineCount(t){const i=t.height/t.lineHeight,r=Math.floor(t.paddingTop/t.lineHeight);let n=Math.floor(t.paddingBottom/t.lineHeight);t.scrollBeyondLastLine&&(n=Math.max(n,i-1));const s=(r+t.viewLineCount+n)/(t.pixelRatio*t.height),o=Math.floor(t.viewLineCount/s);return{typicalViewportLineCount:i,extraLinesBeforeFirstLine:r,extraLinesBeyondLastLine:n,desiredRatio:s,minimapLineCount:o}}static _computeMinimapLayout(t,i){const r=t.outerWidth,n=t.outerHeight,s=t.pixelRatio;if(!t.minimap.enabled)return{renderMinimap:0,minimapLeft:0,minimapWidth:0,minimapHeightIsEditorHeight:!1,minimapIsSampling:!1,minimapScale:1,minimapLineHeight:1,minimapCanvasInnerWidth:0,minimapCanvasInnerHeight:Math.floor(s*n),minimapCanvasOuterWidth:0,minimapCanvasOuterHeight:n};const o=i.stableMinimapLayoutInput,a=o&&t.outerHeight===o.outerHeight&&t.lineHeight===o.lineHeight&&t.typicalHalfwidthCharacterWidth===o.typicalHalfwidthCharacterWidth&&t.pixelRatio===o.pixelRatio&&t.scrollBeyondLastLine===o.scrollBeyondLastLine&&t.paddingTop===o.paddingTop&&t.paddingBottom===o.paddingBottom&&t.minimap.enabled===o.minimap.enabled&&t.minimap.side===o.minimap.side&&t.minimap.size===o.minimap.size&&t.minimap.showSlider===o.minimap.showSlider&&t.minimap.renderCharacters===o.minimap.renderCharacters&&t.minimap.maxColumn===o.minimap.maxColumn&&t.minimap.scale===o.minimap.scale&&t.verticalScrollbarWidth===o.verticalScrollbarWidth&&t.isViewportWrapping===o.isViewportWrapping,l=t.lineHeight,c=t.typicalHalfwidthCharacterWidth,u=t.scrollBeyondLastLine,d=t.minimap.renderCharacters;let f=s>=2?Math.round(t.minimap.scale*2):t.minimap.scale;const p=t.minimap.maxColumn,m=t.minimap.size,_=t.minimap.side,b=t.verticalScrollbarWidth,E=t.viewLineCount,C=t.remainingWidth,T=t.isViewportWrapping,j=d?2:3;let M=Math.floor(s*n);const B=M/s;let K=!1,Y=!1,X=j*f,ce=f/s,We=1;if(m==="fill"||m==="fit"){const{typicalViewportLineCount:Q,extraLinesBeforeFirstLine:ge,extraLinesBeyondLastLine:Pe,desiredRatio:we,minimapLineCount:Ge}=zp.computeContainedMinimapLineCount({viewLineCount:E,scrollBeyondLastLine:u,paddingTop:t.paddingTop,paddingBottom:t.paddingBottom,height:n,lineHeight:l,pixelRatio:s});if(E/Ge>1)K=!0,Y=!0,f=1,X=1,ce=f/s;else{let pt=!1,jt=f+1;if(m==="fit"){const ri=Math.ceil((ge+E+Pe)*X);T&&a&&C<=i.stableFitRemainingWidth?(pt=!0,jt=i.stableFitMaxMinimapScale):pt=ri>M}if(m==="fill"||pt){K=!0;const ri=f;X=Math.min(l*s,Math.max(1,Math.floor(1/we))),T&&a&&C<=i.stableFitRemainingWidth&&(jt=i.stableFitMaxMinimapScale),f=Math.min(jt,Math.max(1,Math.floor(X/j))),f>ri&&(We=Math.min(2,f/ri)),ce=f/s/We,M=Math.ceil(Math.max(Q,ge+E+Pe)*X),T?(i.stableMinimapLayoutInput=t,i.stableFitRemainingWidth=C,i.stableFitMaxMinimapScale=f):(i.stableMinimapLayoutInput=null,i.stableFitRemainingWidth=0)}}}const De=Math.floor(p*ce),gt=Math.min(De,Math.max(0,Math.floor((C-b-2)*ce/(c+ce)))+eO);let z=Math.floor(s*gt);const H=z/s;z=Math.floor(z*We);const J=d?1:2,q=_==="left"?0:r-gt-b;return{renderMinimap:J,minimapLeft:q,minimapWidth:gt,minimapHeightIsEditorHeight:K,minimapIsSampling:Y,minimapScale:f,minimapLineHeight:X,minimapCanvasInnerWidth:z,minimapCanvasInnerHeight:M,minimapCanvasOuterWidth:H,minimapCanvasOuterHeight:B}}static computeLayout(t,i){const r=i.outerWidth|0,n=i.outerHeight|0,s=i.lineHeight|0,o=i.lineNumbersDigitCount|0,a=i.typicalHalfwidthCharacterWidth,l=i.maxDigitWidth,c=i.pixelRatio,u=i.viewLineCount,d=t.get(142),f=d==="inherit"?t.get(141):d,p=f==="inherit"?t.get(137):f,m=t.get(140),_=i.isDominatedByLongLines,b=t.get(59),E=t.get(69).renderType!==0,C=t.get(70),T=t.get(110),j=t.get(88),M=t.get(74),B=t.get(108),K=B.verticalScrollbarSize,Y=B.verticalHasArrows,X=B.arrowSize,ce=B.horizontalScrollbarSize,We=t.get(45),De=t.get(115)!=="never";let gt=t.get(67);We&&De&&(gt+=16);let z=0;if(E){const Wr=Math.max(o,C);z=Math.round(Wr*l)}let H=0;b&&(H=s*i.glyphMarginDecorationLaneCount);let J=0,q=J+H,Q=q+z,ge=Q+gt;const Pe=r-H-z-gt;let we=!1,Ge=!1,Bt=-1;f==="inherit"&&_?(we=!0,Ge=!0):p==="on"||p==="bounded"?Ge=!0:p==="wordWrapColumn"&&(Bt=m);const pt=zp._computeMinimapLayout({outerWidth:r,outerHeight:n,lineHeight:s,typicalHalfwidthCharacterWidth:a,pixelRatio:c,scrollBeyondLastLine:T,paddingTop:j.top,paddingBottom:j.bottom,minimap:M,verticalScrollbarWidth:K,viewLineCount:u,remainingWidth:Pe,isViewportWrapping:Ge},i.memory||new tO);pt.renderMinimap!==0&&pt.minimapLeft===0&&(J+=pt.minimapWidth,q+=pt.minimapWidth,Q+=pt.minimapWidth,ge+=pt.minimapWidth);const jt=Pe-pt.minimapWidth,ri=Math.max(1,Math.floor((jt-K-2)/a)),Qe=Y?X:0;return Ge&&(Bt=Math.max(1,ri),p==="bounded"&&(Bt=Math.min(Bt,m))),{width:r,height:n,glyphMarginLeft:J,glyphMarginWidth:H,glyphMarginDecorationLaneCount:i.glyphMarginDecorationLaneCount,lineNumbersLeft:q,lineNumbersWidth:z,decorationsLeft:Q,decorationsWidth:gt,contentLeft:ge,contentWidth:jt,minimap:pt,viewportColumn:ri,isWordWrapMinified:we,isViewportWrapping:Ge,wrappingColumn:Bt,verticalScrollbarWidth:K,horizontalScrollbarHeight:ce,overviewRuler:{top:Qe,width:K,height:n-2*Qe,right:0}}}},yO=class extends je{constructor(){super(144,"wrappingStrategy","simple",{"editor.wrappingStrategy":{enumDescriptions:[h(372,null),h(373,null)],type:"string",enum:["simple","advanced"],default:"simple",description:h(374,null)}})}validate(e){return it(e,"simple",["simple","advanced"])}compute(e,t,i){return t.get(2)===2?"advanced":i}},gn;(function(e){e.Off="off",e.OnCode="onCode",e.On="on"})(gn||(gn={}));var bO=class extends je{constructor(){const e={enabled:gn.OnCode};super(66,"lightbulb",e,{"editor.lightbulb.enabled":{type:"string",enum:[gn.Off,gn.OnCode,gn.On],default:e.enabled,enumDescriptions:[h(375,null),h(376,null),h(377,null)],description:h(378,null)}})}validate(e){return!e||typeof e!="object"?this.defaultValue:{enabled:it(e.enabled,this.defaultValue.enabled,[gn.Off,gn.OnCode,gn.On])}}},xO=class extends je{constructor(){const e={enabled:!0,maxLineCount:5,defaultModel:"outlineModel",scrollWithEditor:!0};super(120,"stickyScroll",e,{"editor.stickyScroll.enabled":{type:"boolean",default:e.enabled,description:h(379,null)},"editor.stickyScroll.maxLineCount":{type:"number",default:e.maxLineCount,minimum:1,maximum:20,description:h(380,null)},"editor.stickyScroll.defaultModel":{type:"string",enum:["outlineModel","foldingProviderModel","indentationModel"],default:e.defaultModel,description:h(381,null)},"editor.stickyScroll.scrollWithEditor":{type:"boolean",default:e.scrollWithEditor,description:h(382,null)}})}validate(e){if(!e||typeof e!="object")return this.defaultValue;const t=e;return{enabled:G(t.enabled,this.defaultValue.enabled),maxLineCount:$e.clampedInt(t.maxLineCount,this.defaultValue.maxLineCount,1,20),defaultModel:it(t.defaultModel,this.defaultValue.defaultModel,["outlineModel","foldingProviderModel","indentationModel"]),scrollWithEditor:G(t.scrollWithEditor,this.defaultValue.scrollWithEditor)}}},SO=class extends je{constructor(){const e={enabled:"on",fontSize:0,fontFamily:"",padding:!1,maximumLength:43};super(146,"inlayHints",e,{"editor.inlayHints.enabled":{type:"string",default:e.enabled,description:h(383,null),enum:["on","onUnlessPressed","offUnlessPressed","off"],markdownEnumDescriptions:[h(384,null),h(385,null,Hi?"Ctrl+Option":"Ctrl+Alt"),h(386,null,Hi?"Ctrl+Option":"Ctrl+Alt"),h(387,null)]},"editor.inlayHints.fontSize":{type:"number",default:e.fontSize,markdownDescription:h(388,null,"`#editor.fontSize#`","`5`")},"editor.inlayHints.fontFamily":{type:"string",default:e.fontFamily,markdownDescription:h(389,null,"`#editor.fontFamily#`")},"editor.inlayHints.padding":{type:"boolean",default:e.padding,description:h(390,null)},"editor.inlayHints.maximumLength":{type:"number",default:e.maximumLength,markdownDescription:h(391,null)}})}validate(e){if(!e||typeof e!="object")return this.defaultValue;const t=e;return typeof t.enabled=="boolean"&&(t.enabled=t.enabled?"on":"off"),{enabled:it(t.enabled,this.defaultValue.enabled,["on","off","offUnlessPressed","onUnlessPressed"]),fontSize:$e.clampedInt(t.fontSize,this.defaultValue.fontSize,0,100),fontFamily:wi.string(t.fontFamily,this.defaultValue.fontFamily),padding:G(t.padding,this.defaultValue.padding),maximumLength:$e.clampedInt(t.maximumLength,this.defaultValue.maximumLength,0,Number.MAX_SAFE_INTEGER)}}},EO=class extends je{constructor(){super(67,"lineDecorationsWidth",10)}validate(e){return typeof e=="string"&&/^\d+(\.\d+)?ch$/.test(e)?-parseFloat(e.substring(0,e.length-2)):$e.clampedInt(e,this.defaultValue,0,1e3)}compute(e,t,i){return i<0?$e.clampedInt(-i*e.fontInfo.typicalHalfwidthCharacterWidth,this.defaultValue,0,1e3):i}},CO=class extends $r{constructor(){super(68,"lineHeight",mn.lineHeight,e=>$r.clamp(e,0,150),{markdownDescription:h(392,null)})}compute(e,t,i){return e.fontInfo.lineHeight}},DO=class extends je{constructor(){const e={enabled:!1,size:"proportional",side:"right",showSlider:"mouseover",autohide:!1,renderCharacters:!0,maxColumn:120,scale:1,showRegionSectionHeaders:!0,showMarkSectionHeaders:!0,markSectionHeaderRegex:"\\bMARK:\\s*(?<separator>-?)\\s*(?<label>.*)$",sectionHeaderFontSize:9,sectionHeaderLetterSpacing:1};super(74,"minimap",e,{"editor.minimap.enabled":{type:"boolean",default:e.enabled,description:h(393,null)},"editor.minimap.autohide":{type:"boolean",default:e.autohide,description:h(394,null)},"editor.minimap.size":{type:"string",enum:["proportional","fill","fit"],enumDescriptions:[h(395,null),h(396,null),h(397,null)],default:e.size,description:h(398,null)},"editor.minimap.side":{type:"string",enum:["left","right"],default:e.side,description:h(399,null)},"editor.minimap.showSlider":{type:"string",enum:["always","mouseover"],default:e.showSlider,description:h(400,null)},"editor.minimap.scale":{type:"number",default:e.scale,minimum:1,maximum:3,enum:[1,2,3],description:h(401,null)},"editor.minimap.renderCharacters":{type:"boolean",default:e.renderCharacters,description:h(402,null)},"editor.minimap.maxColumn":{type:"number",default:e.maxColumn,description:h(403,null)},"editor.minimap.showRegionSectionHeaders":{type:"boolean",default:e.showRegionSectionHeaders,description:h(404,null)},"editor.minimap.showMarkSectionHeaders":{type:"boolean",default:e.showMarkSectionHeaders,description:h(405,null)},"editor.minimap.markSectionHeaderRegex":{type:"string",default:e.markSectionHeaderRegex,description:h(406,null)},"editor.minimap.sectionHeaderFontSize":{type:"number",default:e.sectionHeaderFontSize,description:h(407,null)},"editor.minimap.sectionHeaderLetterSpacing":{type:"number",default:e.sectionHeaderLetterSpacing,description:h(408,null)}})}validate(e){if(!e||typeof e!="object")return this.defaultValue;const t=e;let i=this.defaultValue.markSectionHeaderRegex;const r=e.markSectionHeaderRegex;if(typeof r=="string")try{new RegExp(r,"d"),i=r}catch{}return{enabled:G(t.enabled,this.defaultValue.enabled),autohide:G(t.autohide,this.defaultValue.autohide),size:it(t.size,this.defaultValue.size,["proportional","fill","fit"]),side:it(t.side,this.defaultValue.side,["right","left"]),showSlider:it(t.showSlider,this.defaultValue.showSlider,["always","mouseover"]),renderCharacters:G(t.renderCharacters,this.defaultValue.renderCharacters),scale:$e.clampedInt(t.scale,1,1,3),maxColumn:$e.clampedInt(t.maxColumn,this.defaultValue.maxColumn,1,1e4),showRegionSectionHeaders:G(t.showRegionSectionHeaders,this.defaultValue.showRegionSectionHeaders),showMarkSectionHeaders:G(t.showMarkSectionHeaders,this.defaultValue.showMarkSectionHeaders),markSectionHeaderRegex:i,sectionHeaderFontSize:$r.clamp(t.sectionHeaderFontSize??this.defaultValue.sectionHeaderFontSize,4,32),sectionHeaderLetterSpacing:$r.clamp(t.sectionHeaderLetterSpacing??this.defaultValue.sectionHeaderLetterSpacing,0,5)}}};function IO(e){return e==="ctrlCmd"?Hi?"metaKey":"ctrlKey":"altKey"}var kO=class extends je{constructor(){super(88,"padding",{top:0,bottom:0},{"editor.padding.top":{type:"number",default:0,minimum:0,maximum:1e3,description:h(409,null)},"editor.padding.bottom":{type:"number",default:0,minimum:0,maximum:1e3,description:h(410,null)}})}validate(e){if(!e||typeof e!="object")return this.defaultValue;const t=e;return{top:$e.clampedInt(t.top,0,0,1e3),bottom:$e.clampedInt(t.bottom,0,0,1e3)}}},PO=class extends je{constructor(){const e={enabled:!0,cycle:!0};super(90,"parameterHints",e,{"editor.parameterHints.enabled":{type:"boolean",default:e.enabled,description:h(411,null)},"editor.parameterHints.cycle":{type:"boolean",default:e.cycle,description:h(412,null)}})}validate(e){if(!e||typeof e!="object")return this.defaultValue;const t=e;return{enabled:G(t.enabled,this.defaultValue.enabled),cycle:G(t.cycle,this.defaultValue.cycle)}}},TO=class extends oo{constructor(){super(149)}compute(e,t,i){return e.pixelRatio}},AO=class extends je{constructor(){super(92,"placeholder",void 0)}validate(e){return typeof e>"u"?this.defaultValue:typeof e=="string"?e:this.defaultValue}},RO=class extends je{constructor(){const e={other:"on",comments:"off",strings:"off"},t=[{type:"boolean"},{type:"string",enum:["on","inline","off"],enumDescriptions:[h(413,null),h(414,null),h(415,null)]}];super(94,"quickSuggestions",e,{type:"object",additionalProperties:!1,properties:{strings:{anyOf:t,default:e.strings,description:h(416,null)},comments:{anyOf:t,default:e.comments,description:h(417,null)},other:{anyOf:t,default:e.other,description:h(418,null)}},default:e,markdownDescription:h(419,null,"`#editor.suggestOnTriggerCharacters#`")}),this.defaultValue=e}validate(e){if(typeof e=="boolean"){const l=e?"on":"off";return{comments:l,strings:l,other:l}}if(!e||typeof e!="object")return this.defaultValue;const{other:t,comments:i,strings:r}=e,n=["on","inline","off"];let s,o,a;return typeof t=="boolean"?s=t?"on":"off":s=it(t,this.defaultValue.other,n),typeof i=="boolean"?o=i?"on":"off":o=it(i,this.defaultValue.comments,n),typeof r=="boolean"?a=r?"on":"off":a=it(r,this.defaultValue.strings,n),{other:s,comments:o,strings:a}}},E5;(function(e){e[e.Off=0]="Off",e[e.On=1]="On",e[e.Relative=2]="Relative",e[e.Interval=3]="Interval",e[e.Custom=4]="Custom"})(E5||(E5={}));var LO=class extends je{constructor(){super(69,"lineNumbers",{renderType:1,renderFn:null},{type:"string",enum:["off","on","relative","interval"],enumDescriptions:[h(420,null),h(421,null),h(422,null),h(423,null)],default:"on",description:h(424,null)})}validate(e){let t=this.defaultValue.renderType,i=this.defaultValue.renderFn;return typeof e<"u"&&(typeof e=="function"?(t=4,i=e):e==="interval"?t=3:e==="relative"?t=2:e==="on"?t=1:t=0),{renderType:t,renderFn:i}}},NO=class extends je{constructor(){const e=[],t={type:"number",description:h(425,null)};super(107,"rulers",e,{type:"array",items:{anyOf:[t,{type:["object"],properties:{column:t,color:{type:"string",description:h(426,null),format:"color-hex"}}}]},default:e,description:h(427,null)})}validate(e){if(Array.isArray(e)){const t=[];for(const i of e)if(typeof i=="number")t.push({column:$e.clampedInt(i,0,0,1e4),color:null});else if(i&&typeof i=="object"){const r=i;t.push({column:$e.clampedInt(r.column,0,0,1e4),color:r.color})}return t.sort((i,r)=>i.column-r.column),t}return this.defaultValue}},MO=class extends je{constructor(){super(97,"readOnlyMessage",void 0)}validate(e){return!e||typeof e!="object"?this.defaultValue:e}};function C5(e,t){if(typeof e!="string")return t;switch(e){case"hidden":return 2;case"visible":return 3;default:return 1}}var OO=class extends je{constructor(){const e={vertical:1,horizontal:1,arrowSize:11,useShadows:!0,verticalHasArrows:!1,horizontalHasArrows:!1,horizontalScrollbarSize:12,horizontalSliderSize:12,verticalScrollbarSize:14,verticalSliderSize:14,handleMouseWheel:!0,alwaysConsumeMouseWheel:!0,scrollByPage:!1,ignoreHorizontalScrollbarInContentHeight:!1};super(108,"scrollbar",e,{"editor.scrollbar.vertical":{type:"string",enum:["auto","visible","hidden"],enumDescriptions:[h(428,null),h(429,null),h(430,null)],default:"auto",description:h(431,null)},"editor.scrollbar.horizontal":{type:"string",enum:["auto","visible","hidden"],enumDescriptions:[h(432,null),h(433,null),h(434,null)],default:"auto",description:h(435,null)},"editor.scrollbar.verticalScrollbarSize":{type:"number",default:e.verticalScrollbarSize,description:h(436,null)},"editor.scrollbar.horizontalScrollbarSize":{type:"number",default:e.horizontalScrollbarSize,description:h(437,null)},"editor.scrollbar.scrollByPage":{type:"boolean",default:e.scrollByPage,description:h(438,null)},"editor.scrollbar.ignoreHorizontalScrollbarInContentHeight":{type:"boolean",default:e.ignoreHorizontalScrollbarInContentHeight,description:h(439,null)}})}validate(e){if(!e||typeof e!="object")return this.defaultValue;const t=e,i=$e.clampedInt(t.horizontalScrollbarSize,this.defaultValue.horizontalScrollbarSize,0,1e3),r=$e.clampedInt(t.verticalScrollbarSize,this.defaultValue.verticalScrollbarSize,0,1e3);return{arrowSize:$e.clampedInt(t.arrowSize,this.defaultValue.arrowSize,0,1e3),vertical:C5(t.vertical,this.defaultValue.vertical),horizontal:C5(t.horizontal,this.defaultValue.horizontal),useShadows:G(t.useShadows,this.defaultValue.useShadows),verticalHasArrows:G(t.verticalHasArrows,this.defaultValue.verticalHasArrows),horizontalHasArrows:G(t.horizontalHasArrows,this.defaultValue.horizontalHasArrows),handleMouseWheel:G(t.handleMouseWheel,this.defaultValue.handleMouseWheel),alwaysConsumeMouseWheel:G(t.alwaysConsumeMouseWheel,this.defaultValue.alwaysConsumeMouseWheel),horizontalScrollbarSize:i,horizontalSliderSize:$e.clampedInt(t.horizontalSliderSize,i,0,1e3),verticalScrollbarSize:r,verticalSliderSize:$e.clampedInt(t.verticalSliderSize,r,0,1e3),scrollByPage:G(t.scrollByPage,this.defaultValue.scrollByPage),ignoreHorizontalScrollbarInContentHeight:G(t.ignoreHorizontalScrollbarInContentHeight,this.defaultValue.ignoreHorizontalScrollbarInContentHeight)}}},mr="inUntrustedWorkspace",ao={allowedCharacters:"editor.unicodeHighlight.allowedCharacters",invisibleCharacters:"editor.unicodeHighlight.invisibleCharacters",nonBasicASCII:"editor.unicodeHighlight.nonBasicASCII",ambiguousCharacters:"editor.unicodeHighlight.ambiguousCharacters",includeComments:"editor.unicodeHighlight.includeComments",includeStrings:"editor.unicodeHighlight.includeStrings",allowedLocales:"editor.unicodeHighlight.allowedLocales"},FO=class extends je{constructor(){const e={nonBasicASCII:mr,invisibleCharacters:!0,ambiguousCharacters:!0,includeComments:mr,includeStrings:!0,allowedCharacters:{},allowedLocales:{_os:!0,_vscode:!0}};super(130,"unicodeHighlight",e,{[ao.nonBasicASCII]:{restricted:!0,type:["boolean","string"],enum:[!0,!1,mr],default:e.nonBasicASCII,description:h(440,null)},[ao.invisibleCharacters]:{restricted:!0,type:"boolean",default:e.invisibleCharacters,description:h(441,null)},[ao.ambiguousCharacters]:{restricted:!0,type:"boolean",default:e.ambiguousCharacters,description:h(442,null)},[ao.includeComments]:{restricted:!0,type:["boolean","string"],enum:[!0,!1,mr],default:e.includeComments,description:h(443,null)},[ao.includeStrings]:{restricted:!0,type:["boolean","string"],enum:[!0,!1,mr],default:e.includeStrings,description:h(444,null)},[ao.allowedCharacters]:{restricted:!0,type:"object",default:e.allowedCharacters,description:h(445,null),additionalProperties:{type:"boolean"}},[ao.allowedLocales]:{restricted:!0,type:"object",additionalProperties:{type:"boolean"},default:e.allowedLocales,description:h(446,null)}})}applyUpdate(e,t){let i=!1;t.allowedCharacters&&e&&(fi(e.allowedCharacters,t.allowedCharacters)||(e={...e,allowedCharacters:t.allowedCharacters},i=!0)),t.allowedLocales&&e&&(fi(e.allowedLocales,t.allowedLocales)||(e={...e,allowedLocales:t.allowedLocales},i=!0));const r=super.applyUpdate(e,t);return i?new sp(r.newValue,!0):r}validate(e){if(!e||typeof e!="object")return this.defaultValue;const t=e;return{nonBasicASCII:za(t.nonBasicASCII,mr,[!0,!1,mr]),invisibleCharacters:G(t.invisibleCharacters,this.defaultValue.invisibleCharacters),ambiguousCharacters:G(t.ambiguousCharacters,this.defaultValue.ambiguousCharacters),includeComments:za(t.includeComments,mr,[!0,!1,mr]),includeStrings:za(t.includeStrings,mr,[!0,!1,mr]),allowedCharacters:this.validateBooleanMap(e.allowedCharacters,this.defaultValue.allowedCharacters),allowedLocales:this.validateBooleanMap(e.allowedLocales,this.defaultValue.allowedLocales)}}validateBooleanMap(e,t){if(typeof e!="object"||!e)return t;const i={};for(const[r,n]of Object.entries(e))n===!0&&(i[r]=!0);return i}},$O=class extends je{constructor(){const e={enabled:!0,mode:"subwordSmart",showToolbar:"onHover",suppressSuggestions:!1,keepOnBlur:!1,fontFamily:"default",syntaxHighlightingEnabled:!0,edits:{enabled:!0,showCollapsed:!1,renderSideBySide:"auto",allowCodeShifting:"always",useMultiLineGhostText:!0}};super(64,"inlineSuggest",e,{"editor.inlineSuggest.enabled":{type:"boolean",default:e.enabled,description:h(447,null)},"editor.inlineSuggest.showToolbar":{type:"string",default:e.showToolbar,enum:["always","onHover","never"],enumDescriptions:[h(448,null),h(449,null),h(450,null)],description:h(451,null)},"editor.inlineSuggest.syntaxHighlightingEnabled":{type:"boolean",default:e.syntaxHighlightingEnabled,description:h(452,null)},"editor.inlineSuggest.suppressSuggestions":{type:"boolean",default:e.suppressSuggestions,description:h(453,null)},"editor.inlineSuggest.fontFamily":{type:"string",default:e.fontFamily,description:h(454,null)},"editor.inlineSuggest.edits.allowCodeShifting":{type:"string",default:e.edits.allowCodeShifting,description:h(455,null),enum:["always","horizontal","never"],tags:["nextEditSuggestions"]},"editor.inlineSuggest.edits.renderSideBySide":{type:"string",default:e.edits.renderSideBySide,description:h(456,null),enum:["auto","never"],enumDescriptions:[h(457,null),h(458,null)],tags:["nextEditSuggestions"]},"editor.inlineSuggest.edits.showCollapsed":{type:"boolean",default:e.edits.showCollapsed,description:h(459,null),tags:["nextEditSuggestions"]}})}validate(e){if(!e||typeof e!="object")return this.defaultValue;const t=e;return{enabled:G(t.enabled,this.defaultValue.enabled),mode:it(t.mode,this.defaultValue.mode,["prefix","subword","subwordSmart"]),showToolbar:it(t.showToolbar,this.defaultValue.showToolbar,["always","onHover","never"]),suppressSuggestions:G(t.suppressSuggestions,this.defaultValue.suppressSuggestions),keepOnBlur:G(t.keepOnBlur,this.defaultValue.keepOnBlur),fontFamily:wi.string(t.fontFamily,this.defaultValue.fontFamily),syntaxHighlightingEnabled:G(t.syntaxHighlightingEnabled,this.defaultValue.syntaxHighlightingEnabled),edits:{enabled:G(t.edits?.enabled,this.defaultValue.edits.enabled),showCollapsed:G(t.edits?.showCollapsed,this.defaultValue.edits.showCollapsed),allowCodeShifting:it(t.edits?.allowCodeShifting,this.defaultValue.edits.allowCodeShifting,["always","horizontal","never"]),renderSideBySide:it(t.edits?.renderSideBySide,this.defaultValue.edits.renderSideBySide,["never","auto"]),useMultiLineGhostText:G(t.edits?.useMultiLineGhostText,this.defaultValue.edits.useMultiLineGhostText)}}}},HO=class extends je{constructor(){const e={enabled:w5.bracketPairColorizationOptions.enabled,independentColorPoolPerBracketType:w5.bracketPairColorizationOptions.independentColorPoolPerBracketType};super(15,"bracketPairColorization",e,{"editor.bracketPairColorization.enabled":{type:"boolean",default:e.enabled,markdownDescription:h(460,null,"`#workbench.colorCustomizations#`")},"editor.bracketPairColorization.independentColorPoolPerBracketType":{type:"boolean",default:e.independentColorPoolPerBracketType,description:h(461,null)}})}validate(e){if(!e||typeof e!="object")return this.defaultValue;const t=e;return{enabled:G(t.enabled,this.defaultValue.enabled),independentColorPoolPerBracketType:G(t.independentColorPoolPerBracketType,this.defaultValue.independentColorPoolPerBracketType)}}},UO=class extends je{constructor(){const e={bracketPairs:!1,bracketPairsHorizontal:"active",highlightActiveBracketPair:!0,indentation:!0,highlightActiveIndentation:!0};super(16,"guides",e,{"editor.guides.bracketPairs":{type:["boolean","string"],enum:[!0,"active",!1],enumDescriptions:[h(462,null),h(463,null),h(464,null)],default:e.bracketPairs,description:h(465,null)},"editor.guides.bracketPairsHorizontal":{type:["boolean","string"],enum:[!0,"active",!1],enumDescriptions:[h(466,null),h(467,null),h(468,null)],default:e.bracketPairsHorizontal,description:h(469,null)},"editor.guides.highlightActiveBracketPair":{type:"boolean",default:e.highlightActiveBracketPair,description:h(470,null)},"editor.guides.indentation":{type:"boolean",default:e.indentation,description:h(471,null)},"editor.guides.highlightActiveIndentation":{type:["boolean","string"],enum:[!0,"always",!1],enumDescriptions:[h(472,null),h(473,null),h(474,null)],default:e.highlightActiveIndentation,description:h(475,null)}})}validate(e){if(!e||typeof e!="object")return this.defaultValue;const t=e;return{bracketPairs:za(t.bracketPairs,this.defaultValue.bracketPairs,[!0,!1,"active"]),bracketPairsHorizontal:za(t.bracketPairsHorizontal,this.defaultValue.bracketPairsHorizontal,[!0,!1,"active"]),highlightActiveBracketPair:G(t.highlightActiveBracketPair,this.defaultValue.highlightActiveBracketPair),indentation:G(t.indentation,this.defaultValue.indentation),highlightActiveIndentation:za(t.highlightActiveIndentation,this.defaultValue.highlightActiveIndentation,[!0,!1,"always"])}}};function za(e,t,i){const r=i.indexOf(e);return r===-1?t:i[r]}var BO=class extends je{constructor(){const e={insertMode:"insert",filterGraceful:!0,snippetsPreventQuickSuggestions:!1,localityBonus:!1,shareSuggestSelections:!1,selectionMode:"always",showIcons:!0,showStatusBar:!1,preview:!1,previewMode:"subwordSmart",showInlineDetails:!0,showMethods:!0,showFunctions:!0,showConstructors:!0,showDeprecated:!0,matchOnWordStartOnly:!0,showFields:!0,showVariables:!0,showClasses:!0,showStructs:!0,showInterfaces:!0,showModules:!0,showProperties:!0,showEvents:!0,showOperators:!0,showUnits:!0,showValues:!0,showConstants:!0,showEnums:!0,showEnumMembers:!0,showKeywords:!0,showWords:!0,showColors:!0,showFiles:!0,showReferences:!0,showFolders:!0,showTypeParameters:!0,showSnippets:!0,showUsers:!0,showIssues:!0};super(123,"suggest",e,{"editor.suggest.insertMode":{type:"string",enum:["insert","replace"],enumDescriptions:[h(476,null),h(477,null)],default:e.insertMode,description:h(478,null)},"editor.suggest.filterGraceful":{type:"boolean",default:e.filterGraceful,description:h(479,null)},"editor.suggest.localityBonus":{type:"boolean",default:e.localityBonus,description:h(480,null)},"editor.suggest.shareSuggestSelections":{type:"boolean",default:e.shareSuggestSelections,markdownDescription:h(481,null)},"editor.suggest.selectionMode":{type:"string",enum:["always","never","whenTriggerCharacter","whenQuickSuggestion"],enumDescriptions:[h(482,null),h(483,null),h(484,null),h(485,null)],default:e.selectionMode,markdownDescription:h(486,null,"`#editor.quickSuggestions#`","`#editor.suggestOnTriggerCharacters#`")},"editor.suggest.snippetsPreventQuickSuggestions":{type:"boolean",default:e.snippetsPreventQuickSuggestions,description:h(487,null)},"editor.suggest.showIcons":{type:"boolean",default:e.showIcons,description:h(488,null)},"editor.suggest.showStatusBar":{type:"boolean",default:e.showStatusBar,description:h(489,null)},"editor.suggest.preview":{type:"boolean",default:e.preview,description:h(490,null)},"editor.suggest.showInlineDetails":{type:"boolean",default:e.showInlineDetails,description:h(491,null)},"editor.suggest.maxVisibleSuggestions":{type:"number",deprecationMessage:h(492,null)},"editor.suggest.filteredTypes":{type:"object",deprecationMessage:h(493,null)},"editor.suggest.showMethods":{type:"boolean",default:!0,markdownDescription:h(494,null)},"editor.suggest.showFunctions":{type:"boolean",default:!0,markdownDescription:h(495,null)},"editor.suggest.showConstructors":{type:"boolean",default:!0,markdownDescription:h(496,null)},"editor.suggest.showDeprecated":{type:"boolean",default:!0,markdownDescription:h(497,null)},"editor.suggest.matchOnWordStartOnly":{type:"boolean",default:!0,markdownDescription:h(498,null)},"editor.suggest.showFields":{type:"boolean",default:!0,markdownDescription:h(499,null)},"editor.suggest.showVariables":{type:"boolean",default:!0,markdownDescription:h(500,null)},"editor.suggest.showClasses":{type:"boolean",default:!0,markdownDescription:h(501,null)},"editor.suggest.showStructs":{type:"boolean",default:!0,markdownDescription:h(502,null)},"editor.suggest.showInterfaces":{type:"boolean",default:!0,markdownDescription:h(503,null)},"editor.suggest.showModules":{type:"boolean",default:!0,markdownDescription:h(504,null)},"editor.suggest.showProperties":{type:"boolean",default:!0,markdownDescription:h(505,null)},"editor.suggest.showEvents":{type:"boolean",default:!0,markdownDescription:h(506,null)},"editor.suggest.showOperators":{type:"boolean",default:!0,markdownDescription:h(507,null)},"editor.suggest.showUnits":{type:"boolean",default:!0,markdownDescription:h(508,null)},"editor.suggest.showValues":{type:"boolean",default:!0,markdownDescription:h(509,null)},"editor.suggest.showConstants":{type:"boolean",default:!0,markdownDescription:h(510,null)},"editor.suggest.showEnums":{type:"boolean",default:!0,markdownDescription:h(511,null)},"editor.suggest.showEnumMembers":{type:"boolean",default:!0,markdownDescription:h(512,null)},"editor.suggest.showKeywords":{type:"boolean",default:!0,markdownDescription:h(513,null)},"editor.suggest.showWords":{type:"boolean",default:!0,markdownDescription:h(514,null)},"editor.suggest.showColors":{type:"boolean",default:!0,markdownDescription:h(515,null)},"editor.suggest.showFiles":{type:"boolean",default:!0,markdownDescription:h(516,null)},"editor.suggest.showReferences":{type:"boolean",default:!0,markdownDescription:h(517,null)},"editor.suggest.showCustomcolors":{type:"boolean",default:!0,markdownDescription:h(518,null)},"editor.suggest.showFolders":{type:"boolean",default:!0,markdownDescription:h(519,null)},"editor.suggest.showTypeParameters":{type:"boolean",default:!0,markdownDescription:h(520,null)},"editor.suggest.showSnippets":{type:"boolean",default:!0,markdownDescription:h(521,null)},"editor.suggest.showUsers":{type:"boolean",default:!0,markdownDescription:h(522,null)},"editor.suggest.showIssues":{type:"boolean",default:!0,markdownDescription:h(523,null)}})}validate(e){if(!e||typeof e!="object")return this.defaultValue;const t=e;return{insertMode:it(t.insertMode,this.defaultValue.insertMode,["insert","replace"]),filterGraceful:G(t.filterGraceful,this.defaultValue.filterGraceful),snippetsPreventQuickSuggestions:G(t.snippetsPreventQuickSuggestions,this.defaultValue.filterGraceful),localityBonus:G(t.localityBonus,this.defaultValue.localityBonus),shareSuggestSelections:G(t.shareSuggestSelections,this.defaultValue.shareSuggestSelections),selectionMode:it(t.selectionMode,this.defaultValue.selectionMode,["always","never","whenQuickSuggestion","whenTriggerCharacter"]),showIcons:G(t.showIcons,this.defaultValue.showIcons),showStatusBar:G(t.showStatusBar,this.defaultValue.showStatusBar),preview:G(t.preview,this.defaultValue.preview),previewMode:it(t.previewMode,this.defaultValue.previewMode,["prefix","subword","subwordSmart"]),showInlineDetails:G(t.showInlineDetails,this.defaultValue.showInlineDetails),showMethods:G(t.showMethods,this.defaultValue.showMethods),showFunctions:G(t.showFunctions,this.defaultValue.showFunctions),showConstructors:G(t.showConstructors,this.defaultValue.showConstructors),showDeprecated:G(t.showDeprecated,this.defaultValue.showDeprecated),matchOnWordStartOnly:G(t.matchOnWordStartOnly,this.defaultValue.matchOnWordStartOnly),showFields:G(t.showFields,this.defaultValue.showFields),showVariables:G(t.showVariables,this.defaultValue.showVariables),showClasses:G(t.showClasses,this.defaultValue.showClasses),showStructs:G(t.showStructs,this.defaultValue.showStructs),showInterfaces:G(t.showInterfaces,this.defaultValue.showInterfaces),showModules:G(t.showModules,this.defaultValue.showModules),showProperties:G(t.showProperties,this.defaultValue.showProperties),showEvents:G(t.showEvents,this.defaultValue.showEvents),showOperators:G(t.showOperators,this.defaultValue.showOperators),showUnits:G(t.showUnits,this.defaultValue.showUnits),showValues:G(t.showValues,this.defaultValue.showValues),showConstants:G(t.showConstants,this.defaultValue.showConstants),showEnums:G(t.showEnums,this.defaultValue.showEnums),showEnumMembers:G(t.showEnumMembers,this.defaultValue.showEnumMembers),showKeywords:G(t.showKeywords,this.defaultValue.showKeywords),showWords:G(t.showWords,this.defaultValue.showWords),showColors:G(t.showColors,this.defaultValue.showColors),showFiles:G(t.showFiles,this.defaultValue.showFiles),showReferences:G(t.showReferences,this.defaultValue.showReferences),showFolders:G(t.showFolders,this.defaultValue.showFolders),showTypeParameters:G(t.showTypeParameters,this.defaultValue.showTypeParameters),showSnippets:G(t.showSnippets,this.defaultValue.showSnippets),showUsers:G(t.showUsers,this.defaultValue.showUsers),showIssues:G(t.showIssues,this.defaultValue.showIssues)}}},WO=class extends je{constructor(){super(118,"smartSelect",{selectLeadingAndTrailingWhitespace:!0,selectSubwords:!0},{"editor.smartSelect.selectLeadingAndTrailingWhitespace":{description:h(524,null),default:!0,type:"boolean"},"editor.smartSelect.selectSubwords":{description:h(525,null),default:!0,type:"boolean"}})}validate(e){return!e||typeof e!="object"?this.defaultValue:{selectLeadingAndTrailingWhitespace:G(e.selectLeadingAndTrailingWhitespace,this.defaultValue.selectLeadingAndTrailingWhitespace),selectSubwords:G(e.selectSubwords,this.defaultValue.selectSubwords)}}},VO=class extends je{constructor(){const e=[];super(135,"wordSegmenterLocales",e,{anyOf:[{description:h(526,null),type:"string"},{description:h(527,null),type:"array",items:{type:"string"}}]})}validate(e){if(typeof e=="string"&&(e=[e]),Array.isArray(e)){const t=[];for(const i of e)if(typeof i=="string")try{Intl.Segmenter.supportedLocalesOf(i).length>0&&t.push(i)}catch{}return t}return this.defaultValue}},D5;(function(e){e[e.None=0]="None",e[e.Same=1]="Same",e[e.Indent=2]="Indent",e[e.DeepIndent=3]="DeepIndent"})(D5||(D5={}));var zO=class extends je{constructor(){super(143,"wrappingIndent",1,{"editor.wrappingIndent":{type:"string",enum:["none","same","indent","deepIndent"],enumDescriptions:[h(528,null),h(529,null),h(530,null),h(531,null)],description:h(532,null),default:"same"}})}validate(e){switch(e){case"none":return 0;case"same":return 1;case"indent":return 2;case"deepIndent":return 3}return 1}compute(e,t,i){return t.get(2)===2?0:i}},qO=class extends oo{constructor(){super(152)}compute(e,t,i){const r=t.get(151);return{isDominatedByLongLines:e.isDominatedByLongLines,isWordWrapMinified:r.isWordWrapMinified,isViewportWrapping:r.isViewportWrapping,wrappingColumn:r.wrappingColumn}}},jO=class extends je{constructor(){const e={enabled:!0,showDropSelector:"afterDrop"};super(36,"dropIntoEditor",e,{"editor.dropIntoEditor.enabled":{type:"boolean",default:e.enabled,markdownDescription:h(533,null)},"editor.dropIntoEditor.showDropSelector":{type:"string",markdownDescription:h(534,null),enum:["afterDrop","never"],enumDescriptions:[h(535,null),h(536,null)],default:"afterDrop"}})}validate(e){if(!e||typeof e!="object")return this.defaultValue;const t=e;return{enabled:G(t.enabled,this.defaultValue.enabled),showDropSelector:it(t.showDropSelector,this.defaultValue.showDropSelector,["afterDrop","never"])}}},GO=class extends je{constructor(){const e={enabled:!0,showPasteSelector:"afterPaste"};super(89,"pasteAs",e,{"editor.pasteAs.enabled":{type:"boolean",default:e.enabled,markdownDescription:h(537,null)},"editor.pasteAs.showPasteSelector":{type:"string",markdownDescription:h(538,null),enum:["afterPaste","never"],enumDescriptions:[h(539,null),h(540,null)],default:"afterPaste"}})}validate(e){if(!e||typeof e!="object")return this.defaultValue;const t=e;return{enabled:G(t.enabled,this.defaultValue.enabled),showPasteSelector:it(t.showPasteSelector,this.defaultValue.showPasteSelector,["afterPaste","never"])}}},QO="Consolas, 'Courier New', monospace",JO="Menlo, Monaco, 'Courier New', monospace",XO="'Droid Sans Mono', 'monospace', monospace",mn={fontFamily:Hi?JO:Gr?XO:QO,fontWeight:"normal",fontSize:Hi?12:14,lineHeight:0,letterSpacing:0},ZO=[];function A(e){return ZO[e.id]=e,e}var I5;(function(e){e[e.acceptSuggestionOnCommitCharacter=0]="acceptSuggestionOnCommitCharacter",e[e.acceptSuggestionOnEnter=1]="acceptSuggestionOnEnter",e[e.accessibilitySupport=2]="accessibilitySupport",e[e.accessibilityPageSize=3]="accessibilityPageSize",e[e.ariaLabel=4]="ariaLabel",e[e.ariaRequired=5]="ariaRequired",e[e.autoClosingBrackets=6]="autoClosingBrackets",e[e.autoClosingComments=7]="autoClosingComments",e[e.screenReaderAnnounceInlineSuggestion=8]="screenReaderAnnounceInlineSuggestion",e[e.autoClosingDelete=9]="autoClosingDelete",e[e.autoClosingOvertype=10]="autoClosingOvertype",e[e.autoClosingQuotes=11]="autoClosingQuotes",e[e.autoIndent=12]="autoIndent",e[e.automaticLayout=13]="automaticLayout",e[e.autoSurround=14]="autoSurround",e[e.bracketPairColorization=15]="bracketPairColorization",e[e.guides=16]="guides",e[e.codeLens=17]="codeLens",e[e.codeLensFontFamily=18]="codeLensFontFamily",e[e.codeLensFontSize=19]="codeLensFontSize",e[e.colorDecorators=20]="colorDecorators",e[e.colorDecoratorsLimit=21]="colorDecoratorsLimit",e[e.columnSelection=22]="columnSelection",e[e.comments=23]="comments",e[e.contextmenu=24]="contextmenu",e[e.copyWithSyntaxHighlighting=25]="copyWithSyntaxHighlighting",e[e.cursorBlinking=26]="cursorBlinking",e[e.cursorSmoothCaretAnimation=27]="cursorSmoothCaretAnimation",e[e.cursorStyle=28]="cursorStyle",e[e.cursorSurroundingLines=29]="cursorSurroundingLines",e[e.cursorSurroundingLinesStyle=30]="cursorSurroundingLinesStyle",e[e.cursorWidth=31]="cursorWidth",e[e.disableLayerHinting=32]="disableLayerHinting",e[e.disableMonospaceOptimizations=33]="disableMonospaceOptimizations",e[e.domReadOnly=34]="domReadOnly",e[e.dragAndDrop=35]="dragAndDrop",e[e.dropIntoEditor=36]="dropIntoEditor",e[e.experimentalEditContextEnabled=37]="experimentalEditContextEnabled",e[e.emptySelectionClipboard=38]="emptySelectionClipboard",e[e.experimentalGpuAcceleration=39]="experimentalGpuAcceleration",e[e.experimentalWhitespaceRendering=40]="experimentalWhitespaceRendering",e[e.extraEditorClassName=41]="extraEditorClassName",e[e.fastScrollSensitivity=42]="fastScrollSensitivity",e[e.find=43]="find",e[e.fixedOverflowWidgets=44]="fixedOverflowWidgets",e[e.folding=45]="folding",e[e.foldingStrategy=46]="foldingStrategy",e[e.foldingHighlight=47]="foldingHighlight",e[e.foldingImportsByDefault=48]="foldingImportsByDefault",e[e.foldingMaximumRegions=49]="foldingMaximumRegions",e[e.unfoldOnClickAfterEndOfLine=50]="unfoldOnClickAfterEndOfLine",e[e.fontFamily=51]="fontFamily",e[e.fontInfo=52]="fontInfo",e[e.fontLigatures=53]="fontLigatures",e[e.fontSize=54]="fontSize",e[e.fontWeight=55]="fontWeight",e[e.fontVariations=56]="fontVariations",e[e.formatOnPaste=57]="formatOnPaste",e[e.formatOnType=58]="formatOnType",e[e.glyphMargin=59]="glyphMargin",e[e.gotoLocation=60]="gotoLocation",e[e.hideCursorInOverviewRuler=61]="hideCursorInOverviewRuler",e[e.hover=62]="hover",e[e.inDiffEditor=63]="inDiffEditor",e[e.inlineSuggest=64]="inlineSuggest",e[e.letterSpacing=65]="letterSpacing",e[e.lightbulb=66]="lightbulb",e[e.lineDecorationsWidth=67]="lineDecorationsWidth",e[e.lineHeight=68]="lineHeight",e[e.lineNumbers=69]="lineNumbers",e[e.lineNumbersMinChars=70]="lineNumbersMinChars",e[e.linkedEditing=71]="linkedEditing",e[e.links=72]="links",e[e.matchBrackets=73]="matchBrackets",e[e.minimap=74]="minimap",e[e.mouseStyle=75]="mouseStyle",e[e.mouseWheelScrollSensitivity=76]="mouseWheelScrollSensitivity",e[e.mouseWheelZoom=77]="mouseWheelZoom",e[e.multiCursorMergeOverlapping=78]="multiCursorMergeOverlapping",e[e.multiCursorModifier=79]="multiCursorModifier",e[e.multiCursorPaste=80]="multiCursorPaste",e[e.multiCursorLimit=81]="multiCursorLimit",e[e.occurrencesHighlight=82]="occurrencesHighlight",e[e.occurrencesHighlightDelay=83]="occurrencesHighlightDelay",e[e.overtypeCursorStyle=84]="overtypeCursorStyle",e[e.overtypeOnPaste=85]="overtypeOnPaste",e[e.overviewRulerBorder=86]="overviewRulerBorder",e[e.overviewRulerLanes=87]="overviewRulerLanes",e[e.padding=88]="padding",e[e.pasteAs=89]="pasteAs",e[e.parameterHints=90]="parameterHints",e[e.peekWidgetDefaultFocus=91]="peekWidgetDefaultFocus",e[e.placeholder=92]="placeholder",e[e.definitionLinkOpensInPeek=93]="definitionLinkOpensInPeek",e[e.quickSuggestions=94]="quickSuggestions",e[e.quickSuggestionsDelay=95]="quickSuggestionsDelay",e[e.readOnly=96]="readOnly",e[e.readOnlyMessage=97]="readOnlyMessage",e[e.renameOnType=98]="renameOnType",e[e.renderControlCharacters=99]="renderControlCharacters",e[e.renderFinalNewline=100]="renderFinalNewline",e[e.renderLineHighlight=101]="renderLineHighlight",e[e.renderLineHighlightOnlyWhenFocus=102]="renderLineHighlightOnlyWhenFocus",e[e.renderValidationDecorations=103]="renderValidationDecorations",e[e.renderWhitespace=104]="renderWhitespace",e[e.revealHorizontalRightPadding=105]="revealHorizontalRightPadding",e[e.roundedSelection=106]="roundedSelection",e[e.rulers=107]="rulers",e[e.scrollbar=108]="scrollbar",e[e.scrollBeyondLastColumn=109]="scrollBeyondLastColumn",e[e.scrollBeyondLastLine=110]="scrollBeyondLastLine",e[e.scrollPredominantAxis=111]="scrollPredominantAxis",e[e.selectionClipboard=112]="selectionClipboard",e[e.selectionHighlight=113]="selectionHighlight",e[e.selectOnLineNumbers=114]="selectOnLineNumbers",e[e.showFoldingControls=115]="showFoldingControls",e[e.showUnused=116]="showUnused",e[e.snippetSuggestions=117]="snippetSuggestions",e[e.smartSelect=118]="smartSelect",e[e.smoothScrolling=119]="smoothScrolling",e[e.stickyScroll=120]="stickyScroll",e[e.stickyTabStops=121]="stickyTabStops",e[e.stopRenderingLineAfter=122]="stopRenderingLineAfter",e[e.suggest=123]="suggest",e[e.suggestFontSize=124]="suggestFontSize",e[e.suggestLineHeight=125]="suggestLineHeight",e[e.suggestOnTriggerCharacters=126]="suggestOnTriggerCharacters",e[e.suggestSelection=127]="suggestSelection",e[e.tabCompletion=128]="tabCompletion",e[e.tabIndex=129]="tabIndex",e[e.unicodeHighlighting=130]="unicodeHighlighting",e[e.unusualLineTerminators=131]="unusualLineTerminators",e[e.useShadowDOM=132]="useShadowDOM",e[e.useTabStops=133]="useTabStops",e[e.wordBreak=134]="wordBreak",e[e.wordSegmenterLocales=135]="wordSegmenterLocales",e[e.wordSeparators=136]="wordSeparators",e[e.wordWrap=137]="wordWrap",e[e.wordWrapBreakAfterCharacters=138]="wordWrapBreakAfterCharacters",e[e.wordWrapBreakBeforeCharacters=139]="wordWrapBreakBeforeCharacters",e[e.wordWrapColumn=140]="wordWrapColumn",e[e.wordWrapOverride1=141]="wordWrapOverride1",e[e.wordWrapOverride2=142]="wordWrapOverride2",e[e.wrappingIndent=143]="wrappingIndent",e[e.wrappingStrategy=144]="wrappingStrategy",e[e.showDeprecated=145]="showDeprecated",e[e.inlayHints=146]="inlayHints",e[e.effectiveCursorStyle=147]="effectiveCursorStyle",e[e.editorClassName=148]="editorClassName",e[e.pixelRatio=149]="pixelRatio",e[e.tabFocusMode=150]="tabFocusMode",e[e.layoutInfo=151]="layoutInfo",e[e.wrappingInfo=152]="wrappingInfo",e[e.defaultColorDecorators=153]="defaultColorDecorators",e[e.colorDecoratorsActivatedOn=154]="colorDecoratorsActivatedOn",e[e.inlineCompletionsAccessibilityVerbose=155]="inlineCompletionsAccessibilityVerbose",e[e.effectiveExperimentalEditContextEnabled=156]="effectiveExperimentalEditContextEnabled"})(I5||(I5={}));var rj={acceptSuggestionOnCommitCharacter:A(new ve(0,"acceptSuggestionOnCommitCharacter",!0,{markdownDescription:h(541,null)})),acceptSuggestionOnEnter:A(new Ye(1,"acceptSuggestionOnEnter","on",["on","smart","off"],{markdownEnumDescriptions:["",h(542,null),""],markdownDescription:h(543,null)})),accessibilitySupport:A(new nO),accessibilityPageSize:A(new $e(3,"accessibilityPageSize",500,1,1073741824,{description:h(544,null),tags:["accessibility"]})),ariaLabel:A(new wi(4,"ariaLabel",h(545,null))),ariaRequired:A(new ve(5,"ariaRequired",!1,void 0)),screenReaderAnnounceInlineSuggestion:A(new ve(8,"screenReaderAnnounceInlineSuggestion",!0,{description:h(546,null),tags:["accessibility"]})),autoClosingBrackets:A(new Ye(6,"autoClosingBrackets","languageDefined",["always","languageDefined","beforeWhitespace","never"],{enumDescriptions:["",h(547,null),h(548,null),""],description:h(549,null)})),autoClosingComments:A(new Ye(7,"autoClosingComments","languageDefined",["always","languageDefined","beforeWhitespace","never"],{enumDescriptions:["",h(550,null),h(551,null),""],description:h(552,null)})),autoClosingDelete:A(new Ye(9,"autoClosingDelete","auto",["always","auto","never"],{enumDescriptions:["",h(553,null),""],description:h(554,null)})),autoClosingOvertype:A(new Ye(10,"autoClosingOvertype","auto",["always","auto","never"],{enumDescriptions:["",h(555,null),""],description:h(556,null)})),autoClosingQuotes:A(new Ye(11,"autoClosingQuotes","languageDefined",["always","languageDefined","beforeWhitespace","never"],{enumDescriptions:["",h(557,null),h(558,null),""],description:h(559,null)})),autoIndent:A(new eu(12,"autoIndent",4,"full",["none","keep","brackets","advanced","full"],rO,{enumDescriptions:[h(560,null),h(561,null),h(562,null),h(563,null),h(564,null)],description:h(565,null)})),automaticLayout:A(new ve(13,"automaticLayout",!1)),autoSurround:A(new Ye(14,"autoSurround","languageDefined",["languageDefined","quotes","brackets","never"],{enumDescriptions:[h(566,null),h(567,null),h(568,null),""],description:h(569,null)})),bracketPairColorization:A(new HO),bracketPairGuides:A(new UO),stickyTabStops:A(new ve(121,"stickyTabStops",!1,{description:h(570,null)})),codeLens:A(new ve(17,"codeLens",!0,{description:h(571,null)})),codeLensFontFamily:A(new wi(18,"codeLensFontFamily","",{description:h(572,null)})),codeLensFontSize:A(new $e(19,"codeLensFontSize",0,0,100,{type:"number",default:0,minimum:0,maximum:100,markdownDescription:h(573,null)})),colorDecorators:A(new ve(20,"colorDecorators",!0,{description:h(574,null)})),colorDecoratorActivatedOn:A(new Ye(154,"colorDecoratorsActivatedOn","clickAndHover",["clickAndHover","hover","click"],{enumDescriptions:[h(575,null),h(576,null),h(577,null)],description:h(578,null)})),colorDecoratorsLimit:A(new $e(21,"colorDecoratorsLimit",500,1,1e6,{markdownDescription:h(579,null)})),columnSelection:A(new ve(22,"columnSelection",!1,{description:h(580,null)})),comments:A(new sO),contextmenu:A(new ve(24,"contextmenu",!0)),copyWithSyntaxHighlighting:A(new ve(25,"copyWithSyntaxHighlighting",!0,{description:h(581,null)})),cursorBlinking:A(new eu(26,"cursorBlinking",1,"blink",["blink","smooth","phase","expand","solid"],oO,{description:h(582,null)})),cursorSmoothCaretAnimation:A(new Ye(27,"cursorSmoothCaretAnimation","off",["off","explicit","on"],{enumDescriptions:[h(583,null),h(584,null),h(585,null)],description:h(586,null)})),cursorStyle:A(new eu(28,"cursorStyle",gr.Line,"line",["line","block","underline","line-thin","block-outline","underline-thin"],x5,{description:h(587,null)})),overtypeCursorStyle:A(new eu(84,"overtypeCursorStyle",gr.Block,"block",["line","block","underline","line-thin","block-outline","underline-thin"],x5,{description:h(588,null)})),cursorSurroundingLines:A(new $e(29,"cursorSurroundingLines",0,0,1073741824,{description:h(589,null)})),cursorSurroundingLinesStyle:A(new Ye(30,"cursorSurroundingLinesStyle","default",["default","all"],{enumDescriptions:[h(590,null),h(591,null)],markdownDescription:h(592,null)})),cursorWidth:A(new $e(31,"cursorWidth",0,0,1073741824,{markdownDescription:h(593,null)})),disableLayerHinting:A(new ve(32,"disableLayerHinting",!1)),disableMonospaceOptimizations:A(new ve(33,"disableMonospaceOptimizations",!1)),domReadOnly:A(new ve(34,"domReadOnly",!1)),dragAndDrop:A(new ve(35,"dragAndDrop",!0,{description:h(594,null)})),emptySelectionClipboard:A(new lO),dropIntoEditor:A(new jO),experimentalEditContextEnabled:A(new ve(37,"experimentalEditContextEnabled",YM.quality!=="stable",{description:h(595,null),included:_g||Hy||Ry})),stickyScroll:A(new xO),experimentalGpuAcceleration:A(new Ye(39,"experimentalGpuAcceleration","off",["off","on"],{tags:["experimental"],enumDescriptions:[h(596,null),h(597,null)],description:h(598,null)})),experimentalWhitespaceRendering:A(new Ye(40,"experimentalWhitespaceRendering","svg",["svg","font","off"],{enumDescriptions:[h(599,null),h(600,null),h(601,null)],description:h(602,null)})),extraEditorClassName:A(new wi(41,"extraEditorClassName","")),fastScrollSensitivity:A(new $r(42,"fastScrollSensitivity",5,e=>e<=0?5:e,{markdownDescription:h(603,null)})),find:A(new cO),fixedOverflowWidgets:A(new ve(44,"fixedOverflowWidgets",!1)),folding:A(new ve(45,"folding",!0,{description:h(604,null)})),foldingStrategy:A(new Ye(46,"foldingStrategy","auto",["auto","indentation"],{enumDescriptions:[h(605,null),h(606,null)],description:h(607,null)})),foldingHighlight:A(new ve(47,"foldingHighlight",!0,{description:h(608,null)})),foldingImportsByDefault:A(new ve(48,"foldingImportsByDefault",!1,{description:h(609,null)})),foldingMaximumRegions:A(new $e(49,"foldingMaximumRegions",5e3,10,65e3,{description:h(610,null)})),unfoldOnClickAfterEndOfLine:A(new ve(50,"unfoldOnClickAfterEndOfLine",!1,{description:h(611,null)})),fontFamily:A(new wi(51,"fontFamily",mn.fontFamily,{description:h(612,null)})),fontInfo:A(new hO),fontLigatures2:A(new uO),fontSize:A(new gO),fontWeight:A(new mO),fontVariations:A(new dO),formatOnPaste:A(new ve(57,"formatOnPaste",!1,{description:h(613,null)})),formatOnType:A(new ve(58,"formatOnType",!1,{description:h(614,null)})),glyphMargin:A(new ve(59,"glyphMargin",!0,{description:h(615,null)})),gotoLocation:A(new vO),hideCursorInOverviewRuler:A(new ve(61,"hideCursorInOverviewRuler",!1,{description:h(616,null)})),hover:A(new _O),inDiffEditor:A(new ve(63,"inDiffEditor",!1)),letterSpacing:A(new $r(65,"letterSpacing",mn.letterSpacing,e=>$r.clamp(e,-5,20),{description:h(617,null)})),lightbulb:A(new bO),lineDecorationsWidth:A(new EO),lineHeight:A(new CO),lineNumbers:A(new LO),lineNumbersMinChars:A(new $e(70,"lineNumbersMinChars",5,1,300)),linkedEditing:A(new ve(71,"linkedEditing",!1,{description:h(618,null)})),links:A(new ve(72,"links",!0,{description:h(619,null)})),matchBrackets:A(new Ye(73,"matchBrackets","always",["always","near","never"],{description:h(620,null)})),minimap:A(new DO),mouseStyle:A(new Ye(75,"mouseStyle","text",["text","default","copy"])),mouseWheelScrollSensitivity:A(new $r(76,"mouseWheelScrollSensitivity",1,e=>e===0?1:e,{markdownDescription:h(621,null)})),mouseWheelZoom:A(new ve(77,"mouseWheelZoom",!1,{markdownDescription:h(Hi?622:623,null)})),multiCursorMergeOverlapping:A(new ve(78,"multiCursorMergeOverlapping",!0,{description:h(624,null)})),multiCursorModifier:A(new eu(79,"multiCursorModifier","altKey","alt",["ctrlCmd","alt"],IO,{markdownEnumDescriptions:[h(625,null),h(626,null)],markdownDescription:h(627,null)})),multiCursorPaste:A(new Ye(80,"multiCursorPaste","spread",["spread","full"],{markdownEnumDescriptions:[h(628,null),h(629,null)],markdownDescription:h(630,null)})),multiCursorLimit:A(new $e(81,"multiCursorLimit",1e4,1,1e5,{markdownDescription:h(631,null)})),occurrencesHighlight:A(new Ye(82,"occurrencesHighlight","singleFile",["off","singleFile","multiFile"],{markdownEnumDescriptions:[h(632,null),h(633,null),h(634,null)],markdownDescription:h(635,null)})),occurrencesHighlightDelay:A(new $e(83,"occurrencesHighlightDelay",0,0,2e3,{description:h(636,null),tags:["preview"]})),overtypeOnPaste:A(new ve(85,"overtypeOnPaste",!0,{description:h(637,null)})),overviewRulerBorder:A(new ve(86,"overviewRulerBorder",!0,{description:h(638,null)})),overviewRulerLanes:A(new $e(87,"overviewRulerLanes",3,0,3)),padding:A(new kO),pasteAs:A(new GO),parameterHints:A(new PO),peekWidgetDefaultFocus:A(new Ye(91,"peekWidgetDefaultFocus","tree",["tree","editor"],{enumDescriptions:[h(639,null),h(640,null)],description:h(641,null)})),placeholder:A(new AO),definitionLinkOpensInPeek:A(new ve(93,"definitionLinkOpensInPeek",!1,{description:h(642,null)})),quickSuggestions:A(new RO),quickSuggestionsDelay:A(new $e(95,"quickSuggestionsDelay",10,0,1073741824,{description:h(643,null)})),readOnly:A(new ve(96,"readOnly",!1)),readOnlyMessage:A(new MO),renameOnType:A(new ve(98,"renameOnType",!1,{description:h(644,null),markdownDeprecationMessage:h(645,null)})),renderControlCharacters:A(new ve(99,"renderControlCharacters",!0,{description:h(646,null),restricted:!0})),renderFinalNewline:A(new Ye(100,"renderFinalNewline",Gr?"dimmed":"on",["off","on","dimmed"],{description:h(647,null)})),renderLineHighlight:A(new Ye(101,"renderLineHighlight","line",["none","gutter","line","all"],{enumDescriptions:["","","",h(648,null)],description:h(649,null)})),renderLineHighlightOnlyWhenFocus:A(new ve(102,"renderLineHighlightOnlyWhenFocus",!1,{description:h(650,null)})),renderValidationDecorations:A(new Ye(103,"renderValidationDecorations","editable",["editable","on","off"])),renderWhitespace:A(new Ye(104,"renderWhitespace","selection",["none","boundary","selection","trailing","all"],{enumDescriptions:["",h(651,null),h(652,null),h(653,null),""],description:h(654,null)})),revealHorizontalRightPadding:A(new $e(105,"revealHorizontalRightPadding",15,0,1e3)),roundedSelection:A(new ve(106,"roundedSelection",!0,{description:h(655,null)})),rulers:A(new NO),scrollbar:A(new OO),scrollBeyondLastColumn:A(new $e(109,"scrollBeyondLastColumn",4,0,1073741824,{description:h(656,null)})),scrollBeyondLastLine:A(new ve(110,"scrollBeyondLastLine",!0,{description:h(657,null)})),scrollPredominantAxis:A(new ve(111,"scrollPredominantAxis",!0,{description:h(658,null)})),selectionClipboard:A(new ve(112,"selectionClipboard",!0,{description:h(659,null),included:Gr})),selectionHighlight:A(new ve(113,"selectionHighlight",!0,{description:h(660,null)})),selectOnLineNumbers:A(new ve(114,"selectOnLineNumbers",!0)),showFoldingControls:A(new Ye(115,"showFoldingControls","mouseover",["always","never","mouseover"],{enumDescriptions:[h(661,null),h(662,null),h(663,null)],description:h(664,null)})),showUnused:A(new ve(116,"showUnused",!0,{description:h(665,null)})),showDeprecated:A(new ve(145,"showDeprecated",!0,{description:h(666,null)})),inlayHints:A(new SO),snippetSuggestions:A(new Ye(117,"snippetSuggestions","inline",["top","bottom","inline","none"],{enumDescriptions:[h(667,null),h(668,null),h(669,null),h(670,null)],description:h(671,null)})),smartSelect:A(new WO),smoothScrolling:A(new ve(119,"smoothScrolling",!1,{description:h(672,null)})),stopRenderingLineAfter:A(new $e(122,"stopRenderingLineAfter",1e4,-1,1073741824)),suggest:A(new BO),inlineSuggest:A(new $O),inlineCompletionsAccessibilityVerbose:A(new ve(155,"inlineCompletionsAccessibilityVerbose",!1,{description:h(673,null)})),suggestFontSize:A(new $e(124,"suggestFontSize",0,0,1e3,{markdownDescription:h(674,null,"`0`","`#editor.fontSize#`")})),suggestLineHeight:A(new $e(125,"suggestLineHeight",0,0,1e3,{markdownDescription:h(675,null,"`0`","`#editor.lineHeight#`")})),suggestOnTriggerCharacters:A(new ve(126,"suggestOnTriggerCharacters",!0,{description:h(676,null)})),suggestSelection:A(new Ye(127,"suggestSelection","first",["first","recentlyUsed","recentlyUsedByPrefix"],{markdownEnumDescriptions:[h(677,null),h(678,null),h(679,null)],description:h(680,null)})),tabCompletion:A(new Ye(128,"tabCompletion","off",["on","off","onlySnippets"],{enumDescriptions:[h(681,null),h(682,null),h(683,null)],description:h(684,null)})),tabIndex:A(new $e(129,"tabIndex",0,-1,1073741824)),unicodeHighlight:A(new FO),unusualLineTerminators:A(new Ye(131,"unusualLineTerminators","prompt",["auto","off","prompt"],{enumDescriptions:[h(685,null),h(686,null),h(687,null)],description:h(688,null)})),useShadowDOM:A(new ve(132,"useShadowDOM",!0)),useTabStops:A(new ve(133,"useTabStops",!0,{description:h(689,null)})),wordBreak:A(new Ye(134,"wordBreak","normal",["normal","keepAll"],{markdownEnumDescriptions:[h(690,null),h(691,null)],description:h(692,null)})),wordSegmenterLocales:A(new VO),wordSeparators:A(new wi(136,"wordSeparators",PI,{description:h(693,null)})),wordWrap:A(new Ye(137,"wordWrap","off",["off","on","wordWrapColumn","bounded"],{markdownEnumDescriptions:[h(694,null),h(695,null),h(696,null),h(697,null)],description:h(698,null)})),wordWrapBreakAfterCharacters:A(new wi(138,"wordWrapBreakAfterCharacters"," 	})]?|/&.,;\xA2\xB0\u2032\u2033\u2030\u2103\u3001\u3002\uFF61\uFF64\uFFE0\uFF0C\uFF0E\uFF1A\uFF1B\uFF1F\uFF01\uFF05\u30FB\uFF65\u309D\u309E\u30FD\u30FE\u30FC\u30A1\u30A3\u30A5\u30A7\u30A9\u30C3\u30E3\u30E5\u30E7\u30EE\u30F5\u30F6\u3041\u3043\u3045\u3047\u3049\u3063\u3083\u3085\u3087\u308E\u3095\u3096\u31F0\u31F1\u31F2\u31F3\u31F4\u31F5\u31F6\u31F7\u31F8\u31F9\u31FA\u31FB\u31FC\u31FD\u31FE\u31FF\u3005\u303B\uFF67\uFF68\uFF69\uFF6A\uFF6B\uFF6C\uFF6D\uFF6E\uFF6F\uFF70\u201D\u3009\u300B\u300D\u300F\u3011\u3015\uFF09\uFF3D\uFF5D\uFF63")),wordWrapBreakBeforeCharacters:A(new wi(139,"wordWrapBreakBeforeCharacters","([{\u2018\u201C\u3008\u300A\u300C\u300E\u3010\u3014\uFF08\uFF3B\uFF5B\uFF62\xA3\xA5\uFF04\uFFE1\uFFE5+\uFF0B")),wordWrapColumn:A(new $e(140,"wordWrapColumn",80,1,1073741824,{markdownDescription:h(699,null)})),wordWrapOverride1:A(new Ye(141,"wordWrapOverride1","inherit",["off","on","inherit"])),wordWrapOverride2:A(new Ye(142,"wordWrapOverride2","inherit",["off","on","inherit"])),effectiveCursorStyle:A(new fO),editorClassName:A(new aO),defaultColorDecorators:A(new Ye(153,"defaultColorDecorators","auto",["auto","always","never"],{enumDescriptions:[h(700,null),h(701,null),h(702,null)],description:h(703,null)})),pixelRatio:A(new TO),tabFocusMode:A(new ve(150,"tabFocusMode",!1,{markdownDescription:h(704,null)})),layoutInfo:A(new wO),wrappingInfo:A(new qO),wrappingIndent:A(new zO),wrappingStrategy:A(new yO),effectiveExperimentalEditContextEnabled:A(new pO)};function k5(e,t,i,r,n,s){if(Array.isArray(e)){let o=0;for(const a of e){const l=k5(a,t,i,r,n,s);if(l===10)return l;l>o&&(o=l)}return o}else{if(typeof e=="string")return r?e==="*"?5:e===i?10:0:0;if(e){const{language:o,pattern:a,scheme:l,hasAccessToAllModels:c,notebookType:u}=e;if(!r&&!c)return 0;u&&n&&(t=n);let d=0;if(l)if(l===t.scheme)d=10;else if(l==="*")d=5;else return 0;if(o)if(o===i)d=10;else if(o==="*")d=Math.max(d,5);else return 0;if(u)if(u===s)d=10;else if(u==="*"&&s!==void 0)d=Math.max(d,5);else return 0;if(a){let f;if(typeof a=="string"?f=a:f={...a,base:ko(a.base)},f===t.fsPath||Rl(f,t.fsPath))d=10;else return 0}return d}else return 0}}function P5(e){return typeof e=="string"?!1:Array.isArray(e)?e.some(P5):!!e.notebookType}var I0;(function(e){e[e.None=0]="None",e[e.Indent=1]="Indent",e[e.IndentOutdent=2]="IndentOutdent",e[e.Outdent=3]="Outdent"})(I0||(I0={}));var nj=U("editSessionIdentityService"),k0;(function(e){e[e.Complete=100]="Complete",e[e.Partial=50]="Partial",e[e.None=0]="None"})(k0||(k0={}));var sj=new I("debugType",void 0,{type:"string",description:h(6660,null)}),oj=new I("debugConfigurationType",void 0,{type:"string",description:h(6661,null)}),aj=new I("debugState","inactive",{type:"string",description:h(6662,null)}),KO="debugUx",lj=new I(KO,"default",{type:"string",description:h(6663,null)}),cj=new I("hasDebugged",!1,{type:"boolean",description:h(6664,null)}),uj=new I("inDebugMode",!1,{type:"boolean",description:h(6665,null)}),dj=new I("inDebugRepl",!1,{type:"boolean",description:h(6666,null)}),hj=new I("breakpointWidgetVisible",!1,{type:"boolean",description:h(6667,null)}),fj=new I("inBreakpointWidget",!1,{type:"boolean",description:h(6668,null)}),pj=new I("breakpointsFocused",!0,{type:"boolean",description:h(6669,null)}),gj=new I("watchExpressionsFocused",!0,{type:"boolean",description:h(6670,null)}),mj=new I("watchExpressionsExist",!1,{type:"boolean",description:h(6671,null)}),vj=new I("variablesFocused",!0,{type:"boolean",description:h(6672,null)}),_j=new I("expressionSelected",!1,{type:"boolean",description:h(6673,null)}),wj=new I("breakpointInputFocused",!1,{type:"boolean",description:h(6674,null)}),yj=new I("callStackItemType",void 0,{type:"string",description:h(6675,null)}),bj=new I("callStackSessionIsAttach",!1,{type:"boolean",description:h(6676,null)}),xj=new I("callStackItemStopped",!1,{type:"boolean",description:h(6677,null)}),Sj=new I("callStackSessionHasOneThread",!1,{type:"boolean",description:h(6678,null)}),Ej=new I("callStackFocused",!0,{type:"boolean",description:h(6679,null)}),Cj=new I("watchItemType",void 0,{type:"string",description:h(6680,null)}),Dj=new I("canViewMemory",void 0,{type:"boolean",description:h(6681,null)}),Ij=new I("breakpointItemType",void 0,{type:"string",description:h(6682,null)}),kj=new I("breakpointItemBytes",void 0,{type:"boolean",description:h(6683,null)}),Pj=new I("breakpointHasModes",!1,{type:"boolean",description:h(6684,null)}),Tj=new I("breakpointSupportsCondition",!1,{type:"boolean",description:h(6685,null)}),Aj=new I("loadedScriptsSupported",!1,{type:"boolean",description:h(6686,null)}),Rj=new I("loadedScriptsItemType",void 0,{type:"string",description:h(6687,null)}),Lj=new I("focusedSessionIsAttach",!1,{type:"boolean",description:h(6688,null)}),Nj=new I("focusedSessionIsNoDebug",!1,{type:"boolean",description:h(6689,null)}),Mj=new I("stepBackSupported",!1,{type:"boolean",description:h(6690,null)}),Oj=new I("restartFrameSupported",!1,{type:"boolean",description:h(6691,null)}),Fj=new I("stackFrameSupportsRestart",!1,{type:"boolean",description:h(6692,null)}),$j=new I("jumpToCursorSupported",!1,{type:"boolean",description:h(6693,null)}),Hj=new I("stepIntoTargetsSupported",!1,{type:"boolean",description:h(6694,null)}),Uj=new I("breakpointsExist",!1,{type:"boolean",description:h(6695,null)}),Bj=new I("debuggersAvailable",!1,{type:"boolean",description:h(6696,null)}),Wj=new I("debugExtensionAvailable",!0,{type:"boolean",description:h(6697,null)}),Vj=new I("debugProtocolVariableMenuContext",void 0,{type:"string",description:h(6698,null)}),zj=new I("debugSetVariableSupported",!1,{type:"boolean",description:h(6699,null)}),qj=new I("debugSetDataBreakpointAddressSupported",!1,{type:"boolean",description:h(6700,null)}),jj=new I("debugSetExpressionSupported",!1,{type:"boolean",description:h(6701,null)}),Gj=new I("breakWhenValueChangesSupported",!1,{type:"boolean",description:h(6702,null)}),Qj=new I("breakWhenValueIsAccessedSupported",!1,{type:"boolean",description:h(6703,null)}),Jj=new I("breakWhenValueIsReadSupported",!1,{type:"boolean",description:h(6704,null)}),Xj=new I("terminateDebuggeeSupported",!1,{type:"boolean",description:h(6705,null)}),Zj=new I("suspendDebuggeeSupported",!1,{type:"boolean",description:h(6706,null)}),Kj=new I("variableEvaluateNamePresent",!1,{type:"boolean",description:h(6707,null)}),Yj=new I("variableIsReadonly",!1,{type:"boolean",description:h(6708,null)}),eG=new I("variableValue",!1,{type:"string",description:h(6709,null)}),tG=new I("variableType",!1,{type:"string",description:h(6710,null)}),iG=new I("variableInterfaces",!1,{type:"array",description:h(6711,null)}),rG=new I("variableName",!1,{type:"string",description:h(6712,null)}),nG=new I("variableLanguage",!1,{type:"string",description:h(6713,null)}),sG=new I("variableExtensionId",!1,{type:"string",description:h(6714,null)}),oG=new I("exceptionWidgetVisible",!1,{type:"boolean",description:h(6715,null)}),aG=new I("multiSessionRepl",!1,{type:"boolean",description:h(6716,null)}),lG=new I("multiSessionDebug",!1,{type:"boolean",description:h(6717,null)}),cG=new I("disassembleRequestSupported",!1,{type:"boolean",description:h(6718,null)}),uG=new I("disassemblyViewFocus",!1,{type:"boolean",description:h(6719,null)}),dG=new I("languageSupportsDisassembleRequest",!1,{type:"boolean",description:h(6720,null)}),hG=new I("focusedStackFrameHasInstructionReference",!1,{type:"boolean",description:h(6721,null)}),fG={enum:["neverOpen","openOnSessionStart","openOnFirstSessionStart"],default:"openOnFirstSessionStart",description:h(6723,null)},T5;(function(e){e[e.Inactive=0]="Inactive",e[e.Initializing=1]="Initializing",e[e.Stopped=2]="Stopped",e[e.Running=3]="Running"})(T5||(T5={}));var A5;(function(e){e[e.Valid=0]="Valid",e[e.Unreadable=1]="Unreadable",e[e.Error=2]="Error"})(A5||(A5={}));var R5;(function(e){e[e.Variable=0]="Variable",e[e.Address=1]="Address"})(R5||(R5={}));var ap;(function(e){e[e.Initial=1]="Initial",e[e.Dynamic=2]="Dynamic"})(ap||(ap={}));var L5;(function(e){e.UnverifiedBreakpoints="unverifiedBreakpoints"})(L5||(L5={}));var pG=U("debugService"),N5;(function(e){e[e.CONDITION=0]="CONDITION",e[e.HIT_COUNT=1]="HIT_COUNT",e[e.LOG_MESSAGE=2]="LOG_MESSAGE",e[e.TRIGGER_POINT=3]="TRIGGER_POINT"})(N5||(N5={}));var M5;(function(e){e[e.Command=0]="Command",e[e.Tree=1]="Tree"})(M5||(M5={}));var O5;(function(e){e[e.None=0]="None",e[e.Collapsed=1]="Collapsed",e[e.Expanded=2]="Expanded"})(O5||(O5={}));var F5;(function(e){e.deserialize=t=>t,e.serialize=t=>t})(F5||(F5={}));var $5;(function(e){e.deserialize=t=>({id:t.id,name:t.name,iconPath:t.iconPath&&{light:y.revive(t.iconPath.light),dark:y.revive(t.iconPath.dark)},iconClass:t.iconClass,visualization:t.visualization}),e.serialize=t=>t})($5||($5={}));var YO=class{constructor(e){this._relatedInformationProviders=new Map,this._nextHandle=0,this._proxy=e.getProxy(W.MainThreadAiRelatedInformation)}async $provideAiRelatedInformation(e,t,i){if(this._relatedInformationProviders.size===0)throw new Error("No related information providers registered");const r=this._relatedInformationProviders.get(e);if(!r)throw new Error("related information provider not found");return await r.provideRelatedInformation(t,i)??[]}getRelatedInformation(e,t,i){return this._proxy.$getAiRelatedInformation(t,i)}registerRelatedInformationProvider(e,t,i){const r=this._nextHandle;return this._nextHandle++,this._relatedInformationProviders.set(r,i),this._proxy.$registerAiRelatedInformationProvider(r,t),new Ce(()=>{this._proxy.$unregisterAiRelatedInformationProvider(r),this._relatedInformationProviders.delete(r)})}},H5;(function(e){e[e.Full=1]="Full",e[e.Delta=2]="Delta"})(H5||(H5={}));function U5(e){for(let t=0,i=e.length;t<i;t+=4){const r=e[t+0],n=e[t+1],s=e[t+2],o=e[t+3];e[t+0]=o,e[t+1]=s,e[t+2]=n,e[t+3]=r}}function eF(e){const t=new Uint8Array(e.buffer,e.byteOffset,e.length*4);return $y()||U5(t),ae.wrap(t)}function tF(e){const t=e.buffer;if($y()||U5(t),t.byteOffset%4===0)return new Uint32Array(t.buffer,t.byteOffset,t.length/4);{const i=new Uint8Array(t.byteLength);return i.set(t),new Uint32Array(i.buffer,i.byteOffset,i.length/4)}}function P0(e){const t=new Uint32Array(iF(e));let i=0;if(t[i++]=e.id,e.type==="full")t[i++]=1,t[i++]=e.data.length,t.set(e.data,i),i+=e.data.length;else{t[i++]=2,t[i++]=e.deltas.length;for(const r of e.deltas)t[i++]=r.start,t[i++]=r.deleteCount,r.data?(t[i++]=r.data.length,t.set(r.data,i),i+=r.data.length):t[i++]=0}return eF(t)}function iF(e){let t=0;if(t+=2,e.type==="full")t+=1+e.data.length;else{t+=1,t+=3*e.deltas.length;for(const i of e.deltas)i.data&&(t+=i.data.length)}return t}function B5(e){const t=tF(e);let i=0;const r=t[i++];if(t[i++]===1){const a=t[i++],l=t.subarray(i,i+a);return i+=a,{id:r,type:"full",data:l}}const s=t[i++],o=[];for(let a=0;a<s;a++){const l=t[i++],c=t[i++],u=t[i++];let d;u>0&&(d=t.subarray(i,i+u),i+=u),o[a]={start:l,deleteCount:c,data:d}}return{id:r,type:"delta",deltas:o}}var rF=[new fe("vscode.executeDocumentHighlights","_executeDocumentHighlights","Execute document highlight provider.",[$.Uri,$.Position],new de("A promise that resolves to an array of DocumentHighlight-instances.",vr(ba.to))),new fe("vscode.executeDocumentSymbolProvider","_executeDocumentSymbolProvider","Execute document symbol provider.",[$.Uri],new de("A promise that resolves to an array of SymbolInformation and DocumentSymbol instances.",(e,t)=>{if(tg(e))return;class i extends jl{static to(n){const s=new i(n.name,Xi.to(n.kind),n.containerName||"",new Wi(t[0],F.to(n.range)));return s.detail=n.detail,s.range=s.location.range,s.selectionRange=F.to(n.selectionRange),s.children=n.children?n.children.map(i.to):[],s}}return e.map(i.to)})),new fe("vscode.executeFormatDocumentProvider","_executeFormatDocumentProvider","Execute document format provider.",[$.Uri,new $("options","Formatting options",e=>!0,e=>e)],new de("A promise that resolves to an array of TextEdits.",vr(Lt.to))),new fe("vscode.executeFormatRangeProvider","_executeFormatRangeProvider","Execute range format provider.",[$.Uri,$.Range,new $("options","Formatting options",e=>!0,e=>e)],new de("A promise that resolves to an array of TextEdits.",vr(Lt.to))),new fe("vscode.executeFormatOnTypeProvider","_executeFormatOnTypeProvider","Execute format on type provider.",[$.Uri,$.Position,new $("ch","Trigger character",e=>typeof e=="string",e=>e),new $("options","Formatting options",e=>!0,e=>e)],new de("A promise that resolves to an array of TextEdits.",vr(Lt.to))),new fe("vscode.executeDefinitionProvider","_executeDefinitionProvider","Execute all definition providers.",[$.Uri,$.Position],new de("A promise that resolves to an array of Location or LocationLink instances.",ts)),new fe("vscode.experimental.executeDefinitionProvider_recursive","_executeDefinitionProvider_recursive","Execute all definition providers.",[$.Uri,$.Position],new de("A promise that resolves to an array of Location or LocationLink instances.",ts)),new fe("vscode.executeTypeDefinitionProvider","_executeTypeDefinitionProvider","Execute all type definition providers.",[$.Uri,$.Position],new de("A promise that resolves to an array of Location or LocationLink instances.",ts)),new fe("vscode.experimental.executeTypeDefinitionProvider_recursive","_executeTypeDefinitionProvider_recursive","Execute all type definition providers.",[$.Uri,$.Position],new de("A promise that resolves to an array of Location or LocationLink instances.",ts)),new fe("vscode.executeDeclarationProvider","_executeDeclarationProvider","Execute all declaration providers.",[$.Uri,$.Position],new de("A promise that resolves to an array of Location or LocationLink instances.",ts)),new fe("vscode.experimental.executeDeclarationProvider_recursive","_executeDeclarationProvider_recursive","Execute all declaration providers.",[$.Uri,$.Position],new de("A promise that resolves to an array of Location or LocationLink instances.",ts)),new fe("vscode.executeImplementationProvider","_executeImplementationProvider","Execute all implementation providers.",[$.Uri,$.Position],new de("A promise that resolves to an array of Location or LocationLink instances.",ts)),new fe("vscode.experimental.executeImplementationProvider_recursive","_executeImplementationProvider_recursive","Execute all implementation providers.",[$.Uri,$.Position],new de("A promise that resolves to an array of Location or LocationLink instances.",ts)),new fe("vscode.executeReferenceProvider","_executeReferenceProvider","Execute all reference providers.",[$.Uri,$.Position],new de("A promise that resolves to an array of Location-instances.",vr(vi.to))),new fe("vscode.experimental.executeReferenceProvider","_executeReferenceProvider_recursive","Execute all reference providers.",[$.Uri,$.Position],new de("A promise that resolves to an array of Location-instances.",vr(vi.to))),new fe("vscode.executeHoverProvider","_executeHoverProvider","Execute all hover providers.",[$.Uri,$.Position],new de("A promise that resolves to an array of Hover-instances.",vr(Ec.to))),new fe("vscode.experimental.executeHoverProvider_recursive","_executeHoverProvider_recursive","Execute all hover providers.",[$.Uri,$.Position],new de("A promise that resolves to an array of Hover-instances.",vr(Ec.to))),new fe("vscode.executeSelectionRangeProvider","_executeSelectionRangeProvider","Execute selection range provider.",[$.Uri,new $("position","A position in a text document",e=>Array.isArray(e)&&e.every(t=>Ie.isPosition(t)),e=>e.map(Be.from))],new de("A promise that resolves to an array of ranges.",e=>e.map(t=>{let i;for(const r of t.reverse())i=new Xl(F.to(r),i);return i}))),new fe("vscode.executeWorkspaceSymbolProvider","_executeWorkspaceSymbolProvider","Execute all workspace symbol providers.",[$.String.with("query","Search string")],new de("A promise that resolves to an array of SymbolInformation-instances.",e=>e.map(Js.to))),new fe("vscode.prepareCallHierarchy","_executePrepareCallHierarchy","Prepare call hierarchy at a position inside a document",[$.Uri,$.Position],new de("A promise that resolves to an array of CallHierarchyItem-instances",e=>e.map(Xs.to))),new fe("vscode.provideIncomingCalls","_executeProvideIncomingCalls","Compute incoming calls for an item",[$.CallHierarchyItem],new de("A promise that resolves to an array of CallHierarchyIncomingCall-instances",e=>e.map(_1.to))),new fe("vscode.provideOutgoingCalls","_executeProvideOutgoingCalls","Compute outgoing calls for an item",[$.CallHierarchyItem],new de("A promise that resolves to an array of CallHierarchyOutgoingCall-instances",e=>e.map(w1.to))),new fe("vscode.prepareRename","_executePrepareRename","Execute the prepareRename of rename provider.",[$.Uri,$.Position],new de("A promise that resolves to a range and placeholder text.",e=>{if(e)return{range:F.to(e.range),placeholder:e.text}})),new fe("vscode.executeDocumentRenameProvider","_executeDocumentRenameProvider","Execute rename provider.",[$.Uri,$.Position,$.String.with("newName","The new symbol name")],new de("A promise that resolves to a WorkspaceEdit.",e=>{if(e){if(e.rejectReason)throw new Error(e.rejectReason);return Ri.to(e)}})),new fe("vscode.executeLinkProvider","_executeLinkProvider","Execute document link provider.",[$.Uri,$.Number.with("linkResolveCount","Number of links that should be resolved, only when links are unresolved.").optional()],new de("A promise that resolves to an array of DocumentLink-instances.",e=>e.map(Zs.to))),new fe("vscode.provideDocumentSemanticTokensLegend","_provideDocumentSemanticTokensLegend","Provide semantic tokens legend for a document",[$.Uri],new de("A promise that resolves to SemanticTokensLegend.",e=>{if(e)return new Mv(e.tokenTypes,e.tokenModifiers)})),new fe("vscode.provideDocumentSemanticTokens","_provideDocumentSemanticTokens","Provide semantic tokens for a document",[$.Uri],new de("A promise that resolves to SemanticTokens.",e=>{if(!e)return;const t=B5(e);if(t.type==="full")return new fa(t.data,void 0)})),new fe("vscode.provideDocumentRangeSemanticTokensLegend","_provideDocumentRangeSemanticTokensLegend","Provide semantic tokens legend for a document range",[$.Uri,$.Range.optional()],new de("A promise that resolves to SemanticTokensLegend.",e=>{if(e)return new Mv(e.tokenTypes,e.tokenModifiers)})),new fe("vscode.provideDocumentRangeSemanticTokens","_provideDocumentRangeSemanticTokens","Provide semantic tokens for a document range",[$.Uri,$.Range],new de("A promise that resolves to SemanticTokens.",e=>{if(!e)return;const t=B5(e);if(t.type==="full")return new fa(t.data,void 0)})),new fe("vscode.executeCompletionItemProvider","_executeCompletionItemProvider","Execute completion item provider.",[$.Uri,$.Position,$.String.with("triggerCharacter","Trigger completion when the user types the character, like `,` or `(`").optional(),$.Number.with("itemResolveCount","Number of completions to resolve (too large numbers slow down completions)").optional()],new de("A promise that resolves to a CompletionList-instance.",(e,t,i)=>{if(!e)return new ea([]);const r=e.suggestions.map(n=>E1.to(n,i));return new ea(r,e.incomplete)})),new fe("vscode.executeSignatureHelpProvider","_executeSignatureHelpProvider","Execute signature help provider.",[$.Uri,$.Position,$.String.with("triggerCharacter","Trigger signature help when the user types the character, like `,` or `(`").optional()],new de("A promise that resolves to SignatureHelp.",e=>{if(e)return Cc.to(e)})),new fe("vscode.executeCodeLensProvider","_executeCodeLensProvider","Execute code lens provider.",[$.Uri,$.Number.with("itemResolveCount","Number of lenses that should be resolved and returned. Will only return resolved lenses, will impact performance)").optional()],new de("A promise that resolves to an array of CodeLens-instances.",(e,t,i)=>vr(r=>new ah(F.to(r.range),r.command&&i.fromInternal(r.command)))(e))),new fe("vscode.executeCodeActionProvider","_executeCodeActionProvider","Execute code action provider.",[$.Uri,new $("rangeOrSelection","Range in a text document. Some refactoring provider requires Selection object.",e=>ye.isRange(e),e=>on.isSelection(e)?fr.from(e):F.from(e)),$.String.with("kind","Code action kind to return code actions for").optional(),$.Number.with("itemResolveCount","Number of code actions to resolve (too large numbers slow down code actions)").optional()],new de("A promise that resolves to an array of Command-instances.",(e,t,i)=>vr(r=>{if(r._isSynthetic){if(!r.command)throw new Error("Synthetic code actions must have a command");return i.fromInternal(r.command)}else{const n=new Jl(r.title,r.kind?new dt(r.kind):void 0);return r.edit&&(n.edit=Ri.to(r.edit)),r.command&&(n.command=i.fromInternal(r.command)),n.isPreferred=r.isPreferred,n}})(e))),new fe("vscode.executeDocumentColorProvider","_executeDocumentColorProvider","Execute document color provider.",[$.Uri],new de("A promise that resolves to an array of ColorInformation objects.",e=>e?e.map(t=>new fh(F.to(t.range),xa.to(t.color))):[])),new fe("vscode.executeColorPresentationProvider","_executeColorPresentationProvider","Execute color presentation provider.",[new $("color","The color to show and insert",e=>e instanceof oa,xa.from),new $("context","Context object with uri and range",e=>!0,e=>({uri:e.uri,range:F.from(e.range)}))],new de("A promise that resolves to an array of ColorPresentation objects.",e=>e?e.map(df.to):[])),new fe("vscode.executeInlayHintProvider","_executeInlayHintProvider","Execute inlay hints provider",[$.Uri,$.Range],new de("A promise that resolves to an array of Inlay objects",(e,t,i)=>e.map(C1.to.bind(void 0,i)))),new fe("vscode.executeFoldingRangeProvider","_executeFoldingRangeProvider","Execute folding range provider",[$.Uri],new de("A promise that resolves to an array of FoldingRange objects",(e,t)=>{if(e)return e.map(ff.to)})),new fe("vscode.resolveNotebookContentProviders","_resolveNotebookContentProvider","Resolve Notebook Content Providers",[],new de("A promise that resolves to an array of NotebookContentProvider static info objects.",vr(e=>({viewType:e.viewType,displayName:e.displayName,options:{transientOutputs:e.options.transientOutputs,transientCellMetadata:e.options.transientCellMetadata,transientDocumentMetadata:e.options.transientDocumentMetadata},filenamePattern:e.filenamePattern.map(t=>gf.to(t))})))),new fe("vscode.executeInlineValueProvider","_executeInlineValueProvider","Execute inline value provider",[$.Uri,$.Range,new $("context","An InlineValueContext",e=>e&&typeof e.frameId=="number"&&e.stoppedLocation instanceof ye,e=>sf.from(e))],new de("A promise that resolves to an array of InlineValue objects",e=>e.map(nf.to))),new fe("vscode.open","_workbench.open","Opens the provided resource in the editor. Can be a text or binary file, or an http(s) URL. If you need more control over the options for opening a text file, use vscode.window.showTextDocument instead.",[new $("uriOrString","Uri-instance or string (only http/https)",e=>y.isUri(e)||typeof e=="string"&&aT(e,V.http,V.https),e=>e),new $("columnOrOptions","Either the column in which to open or editor options, see vscode.TextDocumentShowOptions",e=>e===void 0||typeof e=="number"||typeof e=="object",e=>e&&(typeof e=="number"?[Rt.from(e),void 0]:[Rt.from(e.viewColumn),Dc.from(e)])).optional(),$.String.with("label","").optional()],de.Void),new fe("vscode.openWith","_workbench.openWith","Opens the provided resource with a specific editor.",[$.Uri.with("resource","Resource to open"),$.String.with("viewId","Custom editor view id. This should be the viewType string for custom editors or the notebookType string for notebooks. Use 'default' to use CodeBuddy's default text editor"),new $("columnOrOptions","Either the column in which to open or editor options, see vscode.TextDocumentShowOptions",e=>e===void 0||typeof e=="number"||typeof e=="object",e=>e&&(typeof e=="number"?[Rt.from(e),void 0]:[Rt.from(e.viewColumn),Dc.from(e)])).optional()],de.Void),new fe("vscode.diff","_workbench.diff","Opens the provided resources in the diff editor to compare their contents.",[$.Uri.with("left","Left-hand side resource of the diff editor"),$.Uri.with("right","Right-hand side resource of the diff editor"),$.String.with("title","Human readable title for the diff editor").optional(),new $("columnOrOptions","Either the column in which to open or editor options, see vscode.TextDocumentShowOptions",e=>e===void 0||typeof e=="object",e=>e&&[Rt.from(e.viewColumn),Dc.from(e)]).optional()],de.Void),new fe("vscode.changes","_workbench.changes","Opens a list of resources in the changes editor to compare their contents.",[$.String.with("title","Human readable title for the changes editor"),new $("resourceList","List of resources to compare",e=>{for(const t of e){if(t.length!==3)return!1;const[i,r,n]=t;if(!y.isUri(i)||!y.isUri(r)&&r!==void 0&&r!==null||!y.isUri(n)&&n!==void 0&&n!==null)return!1}return!0},e=>e)],de.Void),new fe("vscode.prepareTypeHierarchy","_executePrepareTypeHierarchy","Prepare type hierarchy at a position inside a document",[$.Uri,$.Position],new de("A promise that resolves to an array of TypeHierarchyItem-instances",e=>e.map(Ks.to))),new fe("vscode.provideSupertypes","_executeProvideSupertypes","Compute supertypes for an item",[$.TypeHierarchyItem],new de("A promise that resolves to an array of TypeHierarchyItem-instances",e=>e.map(Ks.to))),new fe("vscode.provideSubtypes","_executeProvideSubtypes","Compute subtypes for an item",[$.TypeHierarchyItem],new de("A promise that resolves to an array of TypeHierarchyItem-instances",e=>e.map(Ks.to))),new fe("vscode.revealTestInExplorer","_revealTestInExplorer","Reveals a test instance in the explorer",[$.TestItem],de.Void),new fe("vscode.startContinuousTestRun","testing.startContinuousRunFromExtension","Starts running the given tests with continuous run mode.",[$.TestProfile,$.Arr($.TestItem)],de.Void),new fe("vscode.stopContinuousTestRun","testing.stopContinuousRunFromExtension","Stops running the given tests with continuous run mode.",[$.Arr($.TestItem)],de.Void),new fe("vscode.experimental.editSession.continue","_workbench.editSessions.actions.continueEditSession","Continue the current edit session in a different workspace",[$.Uri.with("workspaceUri","The target workspace to continue the current edit session in")],de.Void),new fe("setContext","_setContext","Set a custom context key value that can be used in when clauses.",[$.String.with("name","The context key name"),new $("value","The context key value",()=>!0,e=>e)],de.Void),new fe("vscode.editorChat.start","inlineChat.start","Invoke a new editor chat session",[new $("Run arguments","",e=>!0,e=>{if(e)return{initialRange:e.initialRange?F.from(e.initialRange):void 0,initialSelection:on.isSelection(e.initialSelection)?fr.from(e.initialSelection):void 0,message:e.message,attachments:e.attachments,autoSend:e.autoSend,position:e.position?Be.from(e.position):void 0}})],de.Void)],nF=class{static register(e){rF.forEach(e.registerApiCommand,e),this._registerValidateWhenClausesCommand(e)}static _registerValidateWhenClausesCommand(e){e.registerCommand(!1,"_validateWhenClauses",n8)}};function vr(e){return t=>{if(Array.isArray(t))return t.map(e)}}function ts(e){if(!Array.isArray(e))return;const t=[];for(const i of e)PA(i)?t.push(Sc.to(i)):t.push(vi.to(i));return t}var T0=class{constructor(t,i){this._proxy=t.getProxy(W.MainThreadBulkEdits),this._versionInformationProvider={getTextDocumentVersion:r=>i.getDocument(r)?.version,getNotebookDocumentVersion:()=>{}}}applyWorkspaceEdit(t,i,r){const n=new ai(Ri.from(t,this._versionInformationProvider));return this._proxy.$tryApplyWorkspaceEdit(n,void 0,r?.isRefactoring??!1)}};T0=__decorate([__param(0,Ue)],T0);function sF(e){return!!e&&typeof e.sessionId=="string"&&e.$mid===19}var oF=class{constructor(e,t,i,r,n){this._extension=e,this._request=t,this._proxy=i,this._commandsConverter=r,this._sessionDisposables=n,this._stopWatch=us.create(!1),this._isClosed=!1}close(){this._isClosed=!0}get timings(){return{firstProgress:this._firstProgress,totalElapsed:this._stopWatch.elapsed()}}get apiObject(){if(!this._apiObject){let t=function(n){if(i._isClosed){const s=new Error("Response stream has been closed");throw Error.captureStackTrace(s,n),s}};var e=t;const i=this;this._stopWatch.reset();const r=(n,s)=>{if(typeof this._firstProgress>"u"&&(n.kind==="markdownContent"||n.kind==="markdownVuln")&&(this._firstProgress=this._stopWatch.elapsed()),s){const o=this._proxy.$handleProgressChunk(this._request.requestId,n),a={report:l=>{o?.then(c=>{c&&(mi.isMarkdownString(l.value)?this._proxy.$handleProgressChunk(this._request.requestId,Nc.from(l),c):this._proxy.$handleProgressChunk(this._request.requestId,eo.from(l),c))})}};Promise.all([o,s?.(a)]).then(([l,c])=>{l!==void 0&&this._proxy.$handleProgressChunk(this._request.requestId,H1.from(c),l)})}else this._proxy.$handleProgressChunk(this._request.requestId,n)};this._apiObject=Object.freeze({markdown(n){t(this.markdown);const s=new Bh(n),o=Ac.from(s);return r(o),this},markdownWithVulnerabilities(n,s){t(this.markdown),s&&N(i._extension,"chatParticipantAdditions");const o=new mc(n,s),a=wf.from(o);return r(a),this},codeblockUri(n,s){t(this.codeblockUri),N(i._extension,"chatParticipantAdditions");const o=new jh(n,s),a=_f.from(o);return r(a),this},filetree(n,s){t(this.filetree);const o=new Vh(n,s),a=Rc.from(o);return r(a),this},anchor(n,s){const o=new vc(n,s);return this.push(o)},button(n){t(this.anchor);const s=new qh(n),o=Mc.from(s,i._commandsConverter,i._sessionDisposables);return r(o),this},progress(n,s){t(this.progress);const o=new zh(n,s),a=s?bf.from(o):Lc.from(o);return r(a,s),this},warning(n){t(this.progress),N(i._extension,"chatParticipantAdditions");const s=new _c(n),o=Nc.from(s);return r(o),this},reference(n,s){return this.reference2(n,s)},reference2(n,s,o){if(t(this.reference),typeof n=="object"&&"variableName"in n&&N(i._extension,"chatParticipantAdditions"),typeof n=="object"&&"variableName"in n&&!n.value){const a=i._request.variables.variables.find(l=>l.name===n.variableName);if(a){let l;if(a.references?.length)l=a.references.map(c=>({kind:"reference",reference:{variableName:n.variableName,value:c.reference}}));else{const c=new Gs(n,s,o);l=[eo.from(c)]}return l.forEach(c=>r(c)),this}}else{const a=new Gs(n,s,o),l=eo.from(a);r(l)}return this},codeCitation(n,s,o){t(this.codeCitation),N(i._extension,"chatParticipantAdditions");const a=new Gh(n,s,o),l=Cf.from(a);r(l)},textEdit(n,s){t(this.textEdit),N(i._extension,"chatParticipantAdditions");const o=new wc(n,s);o.isDone=s===!0?!0:void 0;const a=xf.from(o);return r(a),this},notebookEdit(n,s){t(this.notebookEdit),N(i._extension,"chatParticipantAdditions");const o=new Jh(n,s),a=Ef.from(o);return r(a),this},confirmation(n,s,o,a){t(this.confirmation),N(i._extension,"chatParticipantAdditions");const l=new Wh(n,s,o,a),c=yf.from(l);return r(c),this},push(n){if(t(this.push),(n instanceof wc||n instanceof Jh||n instanceof mc||n instanceof _c||n instanceof Wh||n instanceof Gh||n instanceof Qh||n instanceof t1||n instanceof zh)&&N(i._extension,"chatParticipantAdditions"),n instanceof Gs)this.reference2(n.value,n.iconPath,n.options);else if(n instanceof zh){const s=n.task?bf.from(n):Lc.from(n);r(s,n.task)}else if(n instanceof vc){const s=Ra.from(n);if(n.resolve){N(i._extension,"chatParticipantAdditions"),s.resolveId=$t();const o=new ft;n.resolve(o.token).then(()=>{const a=Ra.from(n);i._proxy.$handleAnchorResolve(i._request.requestId,s.resolveId,a)}).then(()=>o.dispose(),()=>o.dispose()),i._sessionDisposables.add(ne(()=>o.dispose(!0)))}r(s)}else{const s=Df.from(n,i._commandsConverter,i._sessionDisposables);r(s)}return this}})}return this._apiObject}},aF=class yu extends se{static{this._idPool=0}static{this._participantDetectionProviderIdPool=0}static{this._relatedFilesProviderIdPool=0}constructor(t,i,r,n,s,o,a){super(),this._logService=i,this._commands=r,this._documents=n,this._languageModels=s,this._diagnostics=o,this._tools=a,this._agents=new Map,this._participantDetectionProviders=new Map,this._relatedFilesProviders=new Map,this._sessionDisposables=this._register(new Pu),this._completionDisposables=this._register(new Pu),this._inFlightRequests=new Set,this._onDidDisposeChatSession=this._register(new P),this.onDidDisposeChatSession=this._onDidDisposeChatSession.event,this._proxy=t.getProxy(W.MainThreadChatAgents2),r.registerArgumentProcessor({processArgument:l=>sF(l)?null:l})}transferActiveChat(t){this._proxy.$transferActiveChatSession(t)}createChatAgent(t,i,r){const n=yu._idPool++,s=new W5(t,i,this._proxy,n,r);return this._agents.set(n,s),this._proxy.$registerAgent(n,t.identifier,i,{},void 0),s.apiAgent}createDynamicChatAgent(t,i,r,n){const s=yu._idPool++,o=new W5(t,i,this._proxy,s,n);return this._agents.set(s,o),this._proxy.$registerAgent(s,t.identifier,i,{isSticky:!0},r),o.apiAgent}registerChatParticipantDetectionProvider(t,i){const r=yu._participantDetectionProviderIdPool++;return this._participantDetectionProviders.set(r,new lF(t,i)),this._proxy.$registerChatParticipantDetectionProvider(r),ne(()=>{this._participantDetectionProviders.delete(r),this._proxy.$unregisterChatParticipantDetectionProvider(r)})}registerRelatedFilesProvider(t,i,r){const n=yu._relatedFilesProviderIdPool++;return this._relatedFilesProviders.set(n,new cF(t,i)),this._proxy.$registerRelatedFilesProvider(n,r),ne(()=>{this._relatedFilesProviders.delete(n),this._proxy.$unregisterRelatedFilesProvider(n)})}async $provideRelatedFiles(t,i,r){const n=this._relatedFilesProviders.get(t);if(!n)return Promise.resolve([]);const s=U1.to(i);return await n.provider.provideRelatedFiles(s,r)??void 0}async $detectChatParticipant(t,i,r,n,s){const o=this._participantDetectionProviders.get(t);if(!o)return;const{request:a,location:l,history:c}=await this._createRequest(i,r,o.extension),u=await this.getModelForRequest(a,o.extension),d=If.to(a,l,u,this.getDiagnosticsWhenEnabled(o.extension),this.getToolsForRequest(o.extension,a),this.getTools2ForRequest(o.extension,a),o.extension);return o.provider.provideParticipantDetection(d,{history:c},{participants:n.participants,location:Oc.to(n.location)},s)}async _createRequest(t,i,r){const n=Pt(t),s=await this.prepareHistoryTurns(r,n.agentId,i);let o;if(n.locationData?.type===ii.Editor){const a=this._documents.getDocument(n.locationData.document);o=new M4(a,fr.to(n.locationData.selection),F.to(n.locationData.wholeRange))}else if(n.locationData?.type===ii.Notebook){const a=this._documents.getDocument(n.locationData.sessionInputUri);o=new O4(a)}else n.locationData?.type,ii.Terminal;return{request:n,location:o,history:s}}async getModelForRequest(t,i){let r;if(t.userSelectedModelId&&(r=await this._languageModels.getLanguageModelByIdentifier(i,t.userSelectedModelId)),!r&&(r=await this._languageModels.getDefaultLanguageModel(i),!r))throw new Error("Language model unavailable");return r}async $setRequestPaused(t,i,r){const n=this._agents.get(t);if(!n)return;const s=Jt.find(this._inFlightRequests,o=>o.requestId===i);s&&n.setChatRequestPauseState({request:s.extRequest,isPaused:r})}async $invokeAgent(t,i,r,n){const s=this._agents.get(t);if(!s)throw new Error(`[CHAT](${t}) CANNOT invoke agent because the agent is not registered`);let o,a;try{const{request:l,location:c,history:u}=await this._createRequest(i,r,s.extension);let d=this._sessionDisposables.get(l.sessionId);d||(d=new he,this._sessionDisposables.set(l.sessionId,d)),o=new oF(s.extension,l,this._proxy,this._commands.converter,d);const f=await this.getModelForRequest(l,s.extension),p=If.to(l,c,f,this.getDiagnosticsWhenEnabled(s.extension),this.getToolsForRequest(s.extension,l),this.getTools2ForRequest(s.extension,l),s.extension);a={requestId:i.requestId,extRequest:p},this._inFlightRequests.add(a);const m=s.invoke(p,{history:u},o.apiObject,n);return await Pb(Promise.resolve(m).then(_=>{if(_?.metadata)try{JSON.stringify(_.metadata)}catch(E){const C=`result.metadata MUST be JSON.stringify-able. Got error: ${E.message}`;return this._logService.error(`[${s.extension.identifier.value}] [@${s.id}] ${C}`,s.extension),{errorDetails:{message:C},timings:o?.timings,nextQuestion:_.nextQuestion}}let b;return _?.errorDetails&&(b={..._.errorDetails,responseIsIncomplete:!0}),(b?.responseIsRedacted||b?.isQuotaExceeded)&&N(s.extension,"chatParticipantPrivate"),{errorDetails:b,timings:o?.timings,metadata:_?.metadata,nextQuestion:_?.nextQuestion}}),n)}catch(l){this._logService.error(l,s.extension),l instanceof cn&&l.cause&&(l=l.cause);const c=l instanceof Error&&l.name==="ChatQuotaExceeded";return{errorDetails:{message:Lo(l),responseIsIncomplete:!0,isQuotaExceeded:c}}}finally{a&&this._inFlightRequests.delete(a),o?.close()}}getDiagnosticsWhenEnabled(t){return Ke(t,"chatReferenceDiagnostic")?this._diagnostics.getDiagnostics():[]}getTools2ForRequest(t,i){if(!i.userSelectedTools2)return new Map;const r=new Map;for(const n of this._tools.getTools(t))typeof i.userSelectedTools2[n.name]=="boolean"&&r.set(n.name,i.userSelectedTools2[n.name]);return r}getToolsForRequest(t,i){if(!yo(i.userSelectedTools))return;const r=new Set(i.userSelectedTools);return{tools:this._tools.getTools(t).filter(s=>r.has(s.name)),isExclusive:i.toolSelectionIsExclusive}}async prepareHistoryTurns(t,i,r){const n=[];for(const s of r.history){const o=La.to(s.result),a=i===s.request.agentId?o:{...o,metadata:void 0},l=s.request.variables.variables.filter(p=>p.kind!=="tool").map(p=>kf.to(p,this.getDiagnosticsWhenEnabled(t))),c=s.request.variables.variables.filter(p=>p.kind==="tool").map(Pf.to),u=Ke(t,"chatParticipantPrivate")?s.request.editedFileEvents:void 0,d=new i1(s.request.message,s.request.command,l,s.request.agentId,c,u);n.push(d);const f=xt(s.response.map(p=>Df.toContent(p,this._commands.converter)));n.push(new N4(f,a,s.request.agentId,s.request.command))}return n}$releaseSession(t){this._sessionDisposables.deleteAndDispose(t),this._onDidDisposeChatSession.fire(t)}async $provideFollowups(t,i,r,n,s){const o=this._agents.get(i);if(!o)return Promise.resolve([]);const a=Pt(t),l=await this.prepareHistoryTurns(o.extension,o.id,n),c=La.to(r);return(await o.provideFollowups(c,{history:l},s)).filter(u=>{const d=!u.participant||Jt.some(this._agents.values(),f=>f.id===u.participant&&Oe.equals(f.extension.identifier,o.extension.identifier));return d||this._logService.warn(`[@${o.id}] ChatFollowup refers to an unknown participant: ${u.participant}`),d}).map(u=>Pc.from(u,a))}$acceptFeedback(t,i,r){const n=this._agents.get(t);if(!n)return;const s=La.to(i);let o;switch(r.direction){case Hd.Down:o=gc.Unhelpful;break;case Hd.Up:o=gc.Helpful;break}const a={result:s,kind:o,unhelpfulReason:Ke(n.extension,"chatParticipantAdditions")?r.reason:void 0};n.acceptFeedback(Object.freeze(a))}$acceptAction(t,i,r){const n=this._agents.get(t);if(!n||r.action.kind==="vote")return;const s=W1.to(i,r,this._commands.converter);s&&n.acceptAction(Object.freeze(s))}async $invokeCompletionProvider(t,i,r){const n=this._agents.get(t);if(!n)return[];let s=this._completionDisposables.get(t);return s?s.clear():(s=new he,this._completionDisposables.set(t,s)),(await n.invokeCompletionProvider(i,r)).map(a=>B1.from(a,this._commands.converter,s))}async $provideChatTitle(t,i,r){const n=this._agents.get(t);if(!n)return;const s=await this.prepareHistoryTurns(n.extension,n.id,{history:i});return await n.provideTitle({history:s},r)}async $provideSampleQuestions(t,i,r){const n=this._agents.get(t);if(n)return(await n.provideSampleQuestions(Oc.to(i),r)).map(s=>Pc.from(s,void 0))}},lF=class{constructor(e,t){this.extension=e,this.provider=t}},cF=class{constructor(e,t){this.extension=e,this.provider=t}},W5=class{constructor(e,t,i,r,n){this.extension=e,this.id=t,this._proxy=i,this._handle=r,this._requestHandler=n,this._onDidReceiveFeedback=new P,this._onDidPerformAction=new P,this._pauseStateEmitter=new P}acceptFeedback(e){this._onDidReceiveFeedback.fire(e)}acceptAction(e){this._onDidPerformAction.fire(e)}setChatRequestPauseState(e){this._pauseStateEmitter.fire(e)}async invokeCompletionProvider(e,t){return this._agentVariableProvider?await this._agentVariableProvider.provider.provideCompletionItems(e,t)??[]:[]}async provideFollowups(e,t,i){if(!this._followupProvider)return[];const r=await this._followupProvider.provideFollowups(e,t,i);return r?r.filter(n=>!(n&&"commandId"in n)).filter(n=>!(n&&"message"in n)):[]}async provideTitle(e,t){if(this._titleProvider)return await this._titleProvider.provideChatTitle(e,t)??void 0}async provideSampleQuestions(e,t){if(!this._welcomeMessageProvider||!this._welcomeMessageProvider.provideSampleQuestions)return[];const i=await this._welcomeMessageProvider.provideSampleQuestions(e,t);return i||[]}get apiAgent(){let e=!1,t=!1;const i=()=>{e||t||(t=!0,queueMicrotask(()=>{this._proxy.$updateAgent(this._handle,{icon:this._iconPath?this._iconPath instanceof y?this._iconPath:"light"in this._iconPath?this._iconPath.light:void 0:void 0,iconDark:this._iconPath&&"dark"in this._iconPath?this._iconPath.dark:void 0,themeIcon:this._iconPath instanceof ci?this._iconPath:void 0,hasFollowups:this._followupProvider!==void 0,helpTextPrefix:!this._helpTextPrefix||typeof this._helpTextPrefix=="string"?this._helpTextPrefix:pe.from(this._helpTextPrefix),helpTextVariablesPrefix:!this._helpTextVariablesPrefix||typeof this._helpTextVariablesPrefix=="string"?this._helpTextVariablesPrefix:pe.from(this._helpTextVariablesPrefix),helpTextPostfix:!this._helpTextPostfix||typeof this._helpTextPostfix=="string"?this._helpTextPostfix:pe.from(this._helpTextPostfix),supportIssueReporting:this._supportIssueReporting,requester:this._requester,additionalWelcomeMessage:!this._additionalWelcomeMessage||typeof this._additionalWelcomeMessage=="string"?this._additionalWelcomeMessage:pe.from(this._additionalWelcomeMessage)}),t=!1}))},r=this;return{get id(){return r.id},get iconPath(){return r._iconPath},set iconPath(n){r._iconPath=n,i()},get requestHandler(){return r._requestHandler},set requestHandler(n){ly(typeof n=="function","Invalid request handler"),r._requestHandler=n},get followupProvider(){return r._followupProvider},set followupProvider(n){r._followupProvider=n,i()},get helpTextPrefix(){return N(r.extension,"defaultChatParticipant"),r._helpTextPrefix},set helpTextPrefix(n){N(r.extension,"defaultChatParticipant"),r._helpTextPrefix=n,i()},get helpTextVariablesPrefix(){return N(r.extension,"defaultChatParticipant"),r._helpTextVariablesPrefix},set helpTextVariablesPrefix(n){N(r.extension,"defaultChatParticipant"),r._helpTextVariablesPrefix=n,i()},get helpTextPostfix(){return N(r.extension,"defaultChatParticipant"),r._helpTextPostfix},set helpTextPostfix(n){N(r.extension,"defaultChatParticipant"),r._helpTextPostfix=n,i()},get supportIssueReporting(){return N(r.extension,"chatParticipantPrivate"),r._supportIssueReporting},set supportIssueReporting(n){N(r.extension,"chatParticipantPrivate"),r._supportIssueReporting=n,i()},get onDidReceiveFeedback(){return r._onDidReceiveFeedback.event},set participantVariableProvider(n){if(N(r.extension,"chatParticipantAdditions"),r._agentVariableProvider=n,n){if(!n.triggerCharacters.length)throw new Error("triggerCharacters are required");r._proxy.$registerAgentCompletionsProvider(r._handle,r.id,n.triggerCharacters)}else r._proxy.$unregisterAgentCompletionsProvider(r._handle,r.id)},get participantVariableProvider(){return N(r.extension,"chatParticipantAdditions"),r._agentVariableProvider},set welcomeMessageProvider(n){N(r.extension,"defaultChatParticipant"),r._welcomeMessageProvider=n,i()},get welcomeMessageProvider(){return N(r.extension,"defaultChatParticipant"),r._welcomeMessageProvider},set additionalWelcomeMessage(n){N(r.extension,"defaultChatParticipant"),r._additionalWelcomeMessage=n,i()},get additionalWelcomeMessage(){return N(r.extension,"defaultChatParticipant"),r._additionalWelcomeMessage},set titleProvider(n){N(r.extension,"defaultChatParticipant"),r._titleProvider=n,i()},get titleProvider(){return N(r.extension,"defaultChatParticipant"),r._titleProvider},get onDidChangePauseState(){return N(r.extension,"chatParticipantAdditions"),r._pauseStateEmitter.event},onDidPerformAction:Ke(this.extension,"chatParticipantAdditions")?this._onDidPerformAction.event:void 0,set requester(n){r._requester=n,i()},get requester(){return r._requester},dispose(){e=!0,r._followupProvider=void 0,r._onDidReceiveFeedback.dispose(),r._proxy.$unregisterAgent(r._handle)}}}invoke(e,t,i,r){return this._requestHandler(e,t,i,r)}},uF=class{constructor(e){this._items=new Map,this._proxy=e.getProxy(W.MainThreadChatStatus)}createChatStatusItem(e,t){const i=dF(e.identifier,t);if(this._items.has(i))throw new Error(`Chat status item '${t}' already exists`);const r={id:i,title:"",description:"",detail:""};let n=!1,s=!1;const o=()=>{if(n)throw new Error("Chat status item is disposed");s&&this._proxy.$setEntry(t,r)},a=Object.freeze({id:t,get title(){return r.title},set title(l){r.title=l,o()},get description(){return r.description},set description(l){r.description=l,o()},get detail(){return r.detail},set detail(l){r.detail=l,o()},show:()=>{s=!0,o()},hide:()=>{s=!1,this._proxy.$disposeEntry(t)},dispose:()=>{n=!0,this._proxy.$disposeEntry(t),this._items.delete(i)}});return this._items.set(i,a),a}};function dF(e,t){return`${Oe.toKey(e)}.${t}`}var hF=class{constructor(e){const t=e.getProxy(W.MainThreadClipboard);this.value=Object.freeze({readText(){return t.$readText()},writeText(i){return t.$writeText(i)}})}},V5="vscode-cdn.net",fF=`vscode-resource.${V5}`,A0=`'self' https://*.${V5}`;function tu(e,t){return e.scheme===V.http||e.scheme===V.https?e:(t&&t.authority&&t.isRemote&&e.scheme===V.file&&(e=y.from({scheme:V.vscodeRemote,authority:t.authority,path:e.path})),y.from({scheme:V.https,authority:`${e.scheme}+${pF(e.authority)}.${fF}`,path:e.path,fragment:e.fragment,query:e.query}))}function pF(e){return e.replace(/./g,t=>{const i=t.charCodeAt(0);return i>=97&&i<=122||i>=65&&i<=90||i>=48&&i<=57?t:"-"+i.toString(16).padStart(4,"0")})}var gF=class{constructor(e,t,i){this._proxy=e,this._editors=t,this._remoteInfo=i,this._handlePool=0,this._disposables=new he,this._insets=new Map,this._disposables.add(t.onDidChangeVisibleTextEditors(()=>{const r=t.getVisibleTextEditors();for(const n of this._insets.values())r.indexOf(n.editor)<0&&n.inset.dispose()}))}dispose(){this._insets.forEach(e=>e.inset.dispose()),this._disposables.dispose()}createWebviewEditorInset(e,t,i,r,n){let s;for(const f of this._editors.getVisibleTextEditors(!0))if(f.value===e){s=f;break}if(!s)throw new Error("not a visible editor");const o=this,a=this._handlePool++,l=new P,c=new P,u=new class{constructor(){this._html="",this._options=Object.create(null)}asWebviewUri(f){return tu(f,o._remoteInfo)}get cspSource(){return A0}set options(f){this._options=f,o._proxy.$setOptions(a,f)}get options(){return this._options}set html(f){this._html=f,o._proxy.$setHtml(a,f)}get html(){return this._html}get onDidReceiveMessage(){return l.event}postMessage(f){return o._proxy.$postMessage(a,f)}},d=new class{constructor(){this.editor=e,this.line=t,this.height=i,this.webview=u,this.onDidDispose=c.event}dispose(){o._insets.has(a)&&(o._insets.delete(a),o._proxy.$disposeEditorInset(a),c.fire(),c.dispose(),l.dispose())}};return this._proxy.$createEditorInset(a,s.id,s.value.document.uri,t+1,i,r||{},n.identifier,n.extensionLocation),this._insets.set(a,{editor:e,inset:d,onDidReceiveMessage:l}),d}$onDidDispose(e){const t=this._insets.get(e);t&&t.inset.dispose()}$onDidReceiveMessage(e,t){this._insets.get(e)?.onDidReceiveMessage.fire(t)}},mF=class h7{static{this._providerHandlePool=0}constructor(t){this.providers=new Map,this._proxy=t.getProxy(W.MainThreadCodeMapper)}async $mapCode(t,i,r){const n=this.providers.get(t);if(!n)throw new Error(`Received request to map code for unknown provider handle ${t}`);const s={textEdit:(l,c)=>{c=Fi(c),this._proxy.$handleProgress(i.requestId,{uri:l,edits:c.map(Lt.from)})},notebookEdit:(l,c)=>{c=Fi(c),this._proxy.$handleProgress(i.requestId,{uri:l,edits:c.map(Sf.from)})}},o={location:i.location,chatRequestId:i.chatRequestId,chatRequestModel:i.chatRequestModel,chatSessionId:i.chatSessionId,codeBlocks:i.codeBlocks.map(l=>({code:l.code,resource:y.revive(l.resource),markdownBeforeBlock:l.markdownBeforeBlock}))};return await n.provideMappedEdits(o,s,r)??null}registerMappedEditsProvider(t,i){const r=h7._providerHandlePool++;return this._proxy.$registerCodeMapperProvider(r,t.displayName??t.name),this.providers.set(r,i),{dispose:()=>this._proxy.$unregisterCodeMapperProvider(r)}}};function z5(e){return(t,i,r)=>{let n=null,s=null;if(typeof r.value=="function"?(n="value",s=r.value):typeof r.get=="function"&&(n="get",s=r.get),!s||typeof i=="symbol")throw new Error("not supported");r[n]=e(s,i)}}function R0(e,t,i){return z5((r,n)=>{const s=`$debounce$${n}`,o=`$debounce$result$${n}`;return function(...a){this[o]||(this[o]=i?i():void 0),clearTimeout(this[s]),t&&(this[o]=t(this[o],...a),a=[this[o]]),this[s]=setTimeout(()=>{r.apply(this,a),this[o]=i?i():void 0},e)}})}function vF(e,t,i){return z5((r,n)=>{const s=`$throttle$timer$${n}`,o=`$throttle$result$${n}`,a=`$throttle$lastRun$${n}`,l=`$throttle$pending$${n}`;return function(...c){if(this[o]||(this[o]=i?i():void 0),(this[a]===null||this[a]===void 0)&&(this[a]=-Number.MAX_VALUE),t&&(this[o]=t(this[o],...c)),this[l])return;const u=this[a]+e;u<=Date.now()?(this[a]=Date.now(),r.apply(this,[this[o]]),this[o]=i?i():void 0):(this[l]=!0,this[s]=setTimeout(()=>{this[l]=!1,this[a]=Date.now(),r.apply(this,[this[o]]),this[o]=i?i():void 0},u-Date.now()))}})}function _F(e,t,i){const r=e.getProxy(W.MainThreadComments);class n{static{this.handlePool=0}constructor(){this._commentControllers=new Map,this._commentControllersByExtension=new Xr,t.registerArgumentProcessor({processArgument:m=>{if(m&&m.$mid===6){const _=this._commentControllers.get(m.handle);return _?_.value:m}else if(m&&m.$mid===7){const _=m,b=this._commentControllers.get(_.commentControlHandle);if(!b)return _;const E=b.getCommentThread(_.commentThreadHandle);return E?E.value:_}else if(m&&(m.$mid===9||m.$mid===8)){const _=this._commentControllers.get(m.thread.commentControlHandle);if(!_)return m;const b=_.getCommentThread(m.thread.commentThreadHandle);return b?m.$mid===8?b.value:{thread:b.value,text:m.text}:m}else if(m&&m.$mid===10){const _=this._commentControllers.get(m.thread.commentControlHandle);if(!_)return m;const b=_.getCommentThread(m.thread.commentThreadHandle);if(!b)return m;const E=m.commentUniqueId,C=b.getCommentByUniqueId(E);return C||m}else if(m&&m.$mid===11){const _=this._commentControllers.get(m.thread.commentControlHandle);if(!_)return m;const b=_.getCommentThread(m.thread.commentThreadHandle);if(!b)return m;const E=m.text,C=m.commentUniqueId,T=b.getCommentByUniqueId(C);return T?(typeof T.body=="string"?T.body=E:T.body=new mi(E),T):m}return m}})}createCommentController(m,_,b){const E=n.handlePool++,C=new o(m,E,_,b);this._commentControllers.set(C.handle,C);const T=this._commentControllersByExtension.get(m.identifier)||[];return T.push(C),this._commentControllersByExtension.set(m.identifier,T),C.value}async $createCommentThreadTemplate(m,_,b,E){const C=this._commentControllers.get(m);C&&C.$createCommentThreadTemplate(_,b,E)}async $setActiveComment(m,_){const b=this._commentControllers.get(m);b&&b.$setActiveComment(_??void 0)}async $updateCommentThreadTemplate(m,_,b){const E=this._commentControllers.get(m);E&&E.$updateCommentThreadTemplate(_,b)}$deleteCommentThread(m,_){this._commentControllers.get(m)?.$deleteCommentThread(_)}async $updateCommentThread(m,_,b){this._commentControllers.get(m)?.$updateCommentThread(_,b)}async $provideCommentingRanges(m,_,b){const E=this._commentControllers.get(m);if(!E||!E.commentingRangeProvider)return Promise.resolve(void 0);const C=await i.ensureDocumentData(y.revive(_));return Kt(async()=>{const T=await E.commentingRangeProvider?.provideCommentingRanges(C.document,b);let j;return Array.isArray(T)?j={ranges:T,fileComments:!1}:T?j={ranges:T.ranges||[],fileComments:T.enableFileComments||!1}:j=T??void 0,j}).then(T=>{let j;return T&&(j={ranges:T.ranges.map(M=>F.from(M)),fileComments:T.fileComments}),j})}$toggleReaction(m,_,b,E,C){const T=this._commentControllers.get(m);return!T||!T.reactionHandler?Promise.resolve(void 0):Kt(()=>{const j=T.getCommentThread(_);if(j){const M=j.getCommentByUniqueId(E.uniqueIdInThread);if(T!==void 0&&M&&T.reactionHandler)return T.reactionHandler(M,c(C))}return Promise.resolve(void 0)})}}class s{static{this._handlePool=0}set threadId(m){this._id=m}get threadId(){return this._id}get id(){return this._id}get resource(){return this._uri}get uri(){return this._uri}set range(m){(m===void 0!=(this._range===void 0)||!m||!this._range||!m.isEqual(this._range))&&(this._range=m,this.modifications.range=m,this._onDidUpdateCommentThread.fire())}get range(){return this._range}set canReply(m){this._canReply!==m&&(this._canReply=m,this.modifications.canReply=m,this._onDidUpdateCommentThread.fire())}get canReply(){return this._canReply}get label(){return this._label}set label(m){this._label=m,this.modifications.label=m,this._onDidUpdateCommentThread.fire()}get contextValue(){return this._contextValue}set contextValue(m){this._contextValue=m,this.modifications.contextValue=m,this._onDidUpdateCommentThread.fire()}get comments(){return this._comments}set comments(m){this._comments=m,this.modifications.comments=m,this._onDidUpdateCommentThread.fire()}get collapsibleState(){return this._collapseState}set collapsibleState(m){this._collapseState!==m&&(this._collapseState=m,this.modifications.collapsibleState=m,this._onDidUpdateCommentThread.fire())}get state(){return this._state}set state(m){this._state=m,typeof m=="object"?(N(this.extensionDescription,"commentThreadApplicability"),this.modifications.state=m.resolved,this.modifications.applicability=m.applicability):this.modifications.state=m,this._onDidUpdateCommentThread.fire()}get isDisposed(){return this._isDiposed}constructor(m,_,b,E,C,T,j,M,B){this._commentControllerHandle=_,this._id=b,this._uri=E,this._range=C,this._comments=T,this.extensionDescription=j,this._isTemplate=M,this.handle=s._handlePool++,this.commentHandle=0,this.modifications=Object.create(null),this._onDidUpdateCommentThread=new P,this.onDidUpdateCommentThread=this._onDidUpdateCommentThread.event,this._canReply=!0,this._commentsMap=new Map,this._acceptInputDisposables=new Cn,this._acceptInputDisposables.value=new he,this._id===void 0&&(this._id=`${m}.${this.handle}`),r.$createCommentThread(_,this.handle,this._id,this._uri,F.from(this._range),this._comments.map(Y=>a(this,Y,this._commentsMap,this.extensionDescription)),j.identifier,this._isTemplate,B),this._localDisposables=[],this._isDiposed=!1,this._localDisposables.push(this.onDidUpdateCommentThread(()=>{this.eventuallyUpdateCommentThread()})),this._localDisposables.push({dispose:()=>{r.$deleteCommentThread(_,this.handle)}});const K=this;this.value={get uri(){return K.uri},get range(){return K.range},set range(Y){K.range=Y},get comments(){return K.comments},set comments(Y){K.comments=Y},get collapsibleState(){return K.collapsibleState},set collapsibleState(Y){K.collapsibleState=Y},get canReply(){return K.canReply},set canReply(Y){K.canReply=Y},get contextValue(){return K.contextValue},set contextValue(Y){K.contextValue=Y},get label(){return K.label},set label(Y){K.label=Y},get state(){return K.state},set state(Y){K.state=Y},reveal:(Y,X)=>K.reveal(Y,X),hide:()=>K.hide(),dispose:()=>{K.dispose()}}}updateIsTemplate(){this._isTemplate&&(this._isTemplate=!1,this.modifications.isTemplate=!1)}eventuallyUpdateCommentThread(){if(this._isDiposed)return;this.updateIsTemplate(),this._acceptInputDisposables.value||(this._acceptInputDisposables.value=new he);const m=b=>Object.prototype.hasOwnProperty.call(this.modifications,b),_={};m("range")&&(_.range=F.from(this._range)),m("label")&&(_.label=this.label),m("contextValue")&&(_.contextValue=this.contextValue??null),m("comments")&&(_.comments=this._comments.map(b=>a(this,b,this._commentsMap,this.extensionDescription))),m("collapsibleState")&&(_.collapseState=u(this._collapseState)),m("canReply")&&(_.canReply=this.canReply),m("state")&&(_.state=d(this._state)),m("applicability")&&(_.applicability=f(this._state)),m("isTemplate")&&(_.isTemplate=this._isTemplate),this.modifications={},r.$updateCommentThread(this._commentControllerHandle,this.handle,this._id,this._uri,_)}getCommentByUniqueId(m){for(const _ of this._commentsMap){const b=_[0],E=_[1];if(m===E)return b}}async reveal(m,_){N(this.extensionDescription,"commentReveal");let b;m&&m.body!==void 0?b=m:_=_??m;let E=b?this._commentsMap.get(b):void 0;E??=this._commentsMap.get(this._comments[0]);let C=!0,T=!1;return _?.focus===uc.Reply?(T=!0,C=!1):_?.focus===uc.Comment&&(C=!1),r.$revealCommentThread(this._commentControllerHandle,this.handle,E,{preserveFocus:C,focusReply:T})}async hide(){return r.$hideCommentThread(this._commentControllerHandle,this.handle)}dispose(){this._isDiposed=!0,this._acceptInputDisposables.dispose(),this._localDisposables.forEach(m=>m.dispose())}}__decorate([R0(100)],s.prototype,"eventuallyUpdateCommentThread",null);class o{get id(){return this._id}get label(){return this._label}get handle(){return this._handle}get commentingRangeProvider(){return this._commentingRangeProvider}set commentingRangeProvider(m){this._commentingRangeProvider=m,m?.resourceHints&&N(this._extension,"commentingRangeHint"),r.$updateCommentingRanges(this.handle,m?.resourceHints)}get reactionHandler(){return this._reactionHandler}set reactionHandler(m){this._reactionHandler=m,r.$updateCommentControllerFeatures(this.handle,{reactionHandler:!!m})}get options(){return this._options}set options(m){this._options=m,r.$updateCommentControllerFeatures(this.handle,{options:this._options})}get activeComment(){return N(this._extension,"activeComment"),this._activeComment}get activeCommentThread(){return N(this._extension,"activeComment"),this._activeThread?.value}constructor(m,_,b,E){this._extension=m,this._handle=_,this._id=b,this._label=E,this._threads=new Map,r.$registerCommentController(this.handle,b,E,this._extension.identifier.value);const C=this;this.value=Object.freeze({id:C.id,label:C.label,get options(){return C.options},set options(T){C.options=T},get commentingRangeProvider(){return C.commentingRangeProvider},set commentingRangeProvider(T){C.commentingRangeProvider=T},get reactionHandler(){return C.reactionHandler},set reactionHandler(T){C.reactionHandler=T},get activeCommentThread(){return C.activeCommentThread},createCommentThread(T,j,M){return C.createCommentThread(T,j,M).value},dispose:()=>{C.dispose()}}),this._localDisposables=[],this._localDisposables.push({dispose:()=>{r.$unregisterCommentController(this.handle)}})}createCommentThread(m,_,b){const E=new s(this.id,this.handle,void 0,m,_,b,this._extension,!1);return this._threads.set(E.handle,E),E}$setActiveComment(m){if(!m){this._activeComment=void 0,this._activeThread=void 0;return}const _=this._threads.get(m.commentThreadHandle);_&&(this._activeComment=m.uniqueIdInThread?_.getCommentByUniqueId(m.uniqueIdInThread):void 0,this._activeThread=_)}$createCommentThreadTemplate(m,_,b){const E=new s(this.id,this.handle,void 0,y.revive(m),F.to(_),[],this._extension,!0,b);return E.collapsibleState=Uo.Expanded,this._threads.set(E.handle,E),E}$updateCommentThreadTemplate(m,_){const b=this._threads.get(m);b&&(b.range=F.to(_))}$updateCommentThread(m,_){const b=this._threads.get(m);if(!b)return;(C=>Object.prototype.hasOwnProperty.call(_,C))("collapseState")&&(b.collapsibleState=u(_.collapseState))}$deleteCommentThread(m){this._threads.get(m)?.dispose(),this._threads.delete(m)}getCommentThread(m){return this._threads.get(m)}dispose(){this._threads.forEach(m=>{m.dispose()}),this._localDisposables.forEach(m=>m.dispose())}}function a(p,m,_,b){let E=_.get(m);return E||(E=++p.commentHandle,_.set(m,E)),m.state!==void 0&&N(b,"commentsDraftState"),m.reactions?.some(C=>C.reactors!==void 0)&&N(b,"commentReactor"),{mode:m.mode,contextValue:m.contextValue,uniqueIdInThread:E,body:typeof m.body=="string"?m.body:pe.from(m.body),userName:m.author.name,userIconPath:m.author.iconPath,label:m.label,commentReactions:m.reactions?m.reactions.map(C=>l(C)):void 0,state:m.state,timestamp:m.timestamp?.toJSON()}}function l(p){return{label:p.label,iconPath:p.iconPath?tf(p.iconPath):void 0,count:p.count,hasReacted:p.authorHasReacted,reactors:p.reactors&&p.reactors.length>0&&typeof p.reactors[0]!="string"?p.reactors.map(m=>m.name):p.reactors}}function c(p){return{label:p.label||"",count:p.count||0,iconPath:p.iconPath?y.revive(p.iconPath):"",authorHasReacted:p.hasReacted||!1,reactors:p.reactors?.map(m=>({name:m}))}}function u(p){if(p!==void 0)switch(p){case ac.Expanded:return Uo.Expanded;case ac.Collapsed:return Uo.Collapsed}return Uo.Collapsed}function d(p){let m;if(typeof p=="object"?m=p.resolved:m=p,m!==void 0)switch(m){case lc.Unresolved:return Pl.Unresolved;case lc.Resolved:return Pl.Resolved}return Pl.Unresolved}function f(p){let m;if(typeof p=="object"&&(m=p.applicability),m!==void 0)switch(m){case cc.Current:return Tl.Current;case cc.Outdated:return Tl.Outdated}return Tl.Current}return new n}var lp={},Le={exports:lp};(function(e,t){if(typeof lp=="object"&&typeof Le=="object")Le.exports=t();else if(typeof define=="function"&&define.amd)define([],t);else{var i=t();for(var r in i)(typeof lp=="object"?lp:e)[r]=i[r]}})(typeof self<"u"?self:void 0,function(){return function(e){var t={};function i(r){if(t[r])return t[r].exports;var n=t[r]={i:r,l:!1,exports:{}};return e[r].call(n.exports,n,n.exports,i),n.l=!0,n.exports}return i.m=e,i.c=t,i.d=function(r,n,s){i.o(r,n)||Object.defineProperty(r,n,{enumerable:!0,get:s})},i.r=function(r){typeof Symbol<"u"&&Symbol.toStringTag&&Object.defineProperty(r,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(r,"__esModule",{value:!0})},i.t=function(r,n){if(1&n&&(r=i(r)),8&n||4&n&&typeof r=="object"&&r&&r.__esModule)return r;var s=Object.create(null);if(i.r(s),Object.defineProperty(s,"default",{enumerable:!0,value:r}),2&n&&typeof r!="string")for(var o in r)i.d(s,o,function(a){return r[a]}.bind(null,o));return s},i.n=function(r){var n=r&&r.__esModule?function(){return r.default}:function(){return r};return i.d(n,"a",n),n},i.o=function(r,n){return Object.prototype.hasOwnProperty.call(r,n)},i.p="",i(i.s=0)}([function(e,t,i){(function(r){var n;t=e.exports=Ve,n=typeof r=="object"&&r.env&&r.env.NODE_DEBUG&&/\bsemver\b/i.test(r.env.NODE_DEBUG)?function(){var D=Array.prototype.slice.call(arguments,0);D.unshift("SEMVER"),console.log.apply(console,D)}:function(){},t.SEMVER_SPEC_VERSION="2.0.0";var s=256,o=Number.MAX_SAFE_INTEGER||9007199254740991,a=t.re=[],l=t.src=[],c=0,u=c++;l[u]="0|[1-9]\\d*";var d=c++;l[d]="[0-9]+";var f=c++;l[f]="\\d*[a-zA-Z-][a-zA-Z0-9-]*";var p=c++;l[p]="("+l[u]+")\\.("+l[u]+")\\.("+l[u]+")";var m=c++;l[m]="("+l[d]+")\\.("+l[d]+")\\.("+l[d]+")";var _=c++;l[_]="(?:"+l[u]+"|"+l[f]+")";var b=c++;l[b]="(?:"+l[d]+"|"+l[f]+")";var E=c++;l[E]="(?:-("+l[_]+"(?:\\."+l[_]+")*))";var C=c++;l[C]="(?:-?("+l[b]+"(?:\\."+l[b]+")*))";var T=c++;l[T]="[0-9A-Za-z-]+";var j=c++;l[j]="(?:\\+("+l[T]+"(?:\\."+l[T]+")*))";var M=c++,B="v?"+l[p]+l[E]+"?"+l[j]+"?";l[M]="^"+B+"$";var K="[v=\\s]*"+l[m]+l[C]+"?"+l[j]+"?",Y=c++;l[Y]="^"+K+"$";var X=c++;l[X]="((?:<|>)?=?)";var ce=c++;l[ce]=l[d]+"|x|X|\\*";var We=c++;l[We]=l[u]+"|x|X|\\*";var De=c++;l[De]="[v=\\s]*("+l[We]+")(?:\\.("+l[We]+")(?:\\.("+l[We]+")(?:"+l[E]+")?"+l[j]+"?)?)?";var gt=c++;l[gt]="[v=\\s]*("+l[ce]+")(?:\\.("+l[ce]+")(?:\\.("+l[ce]+")(?:"+l[C]+")?"+l[j]+"?)?)?";var z=c++;l[z]="^"+l[X]+"\\s*"+l[De]+"$";var H=c++;l[H]="^"+l[X]+"\\s*"+l[gt]+"$";var J=c++;l[J]="(?:^|[^\\d])(\\d{1,16})(?:\\.(\\d{1,16}))?(?:\\.(\\d{1,16}))?(?:$|[^\\d])";var q=c++;l[q]="(?:~>?)";var Q=c++;l[Q]="(\\s*)"+l[q]+"\\s+",a[Q]=new RegExp(l[Q],"g");var ge=c++;l[ge]="^"+l[q]+l[De]+"$";var Pe=c++;l[Pe]="^"+l[q]+l[gt]+"$";var we=c++;l[we]="(?:\\^)";var Ge=c++;l[Ge]="(\\s*)"+l[we]+"\\s+",a[Ge]=new RegExp(l[Ge],"g");var Bt=c++;l[Bt]="^"+l[we]+l[De]+"$";var pt=c++;l[pt]="^"+l[we]+l[gt]+"$";var jt=c++;l[jt]="^"+l[X]+"\\s*("+K+")$|^$";var ri=c++;l[ri]="^"+l[X]+"\\s*("+B+")$|^$";var Qe=c++;l[Qe]="(\\s*)"+l[X]+"\\s*("+K+"|"+l[De]+")",a[Qe]=new RegExp(l[Qe],"g");var Wr=c++;l[Wr]="^\\s*("+l[De]+")\\s+-\\s+("+l[De]+")\\s*$";var go=c++;l[go]="^\\s*("+l[gt]+")\\s+-\\s+("+l[gt]+")\\s*$";var Sn=c++;l[Sn]="(<|>)?=?\\s*\\*";for(var zi=0;zi<35;zi++)n(zi,l[zi]),a[zi]||(a[zi]=new RegExp(l[zi]));function xe(D,L){if(D instanceof Ve)return D;if(typeof D!="string"||D.length>s||!(L?a[Y]:a[M]).test(D))return null;try{return new Ve(D,L)}catch{return null}}function Ve(D,L){if(D instanceof Ve){if(D.loose===L)return D;D=D.version}else if(typeof D!="string")throw new TypeError("Invalid Version: "+D);if(D.length>s)throw new TypeError("version is longer than "+s+" characters");if(!(this instanceof Ve))return new Ve(D,L);n("SemVer",D,L),this.loose=L;var O=D.trim().match(L?a[Y]:a[M]);if(!O)throw new TypeError("Invalid Version: "+D);if(this.raw=D,this.major=+O[1],this.minor=+O[2],this.patch=+O[3],this.major>o||this.major<0)throw new TypeError("Invalid major version");if(this.minor>o||this.minor<0)throw new TypeError("Invalid minor version");if(this.patch>o||this.patch<0)throw new TypeError("Invalid patch version");O[4]?this.prerelease=O[4].split(".").map(function(oe){if(/^[0-9]+$/.test(oe)){var me=+oe;if(me>=0&&me<o)return me}return oe}):this.prerelease=[],this.build=O[5]?O[5].split("."):[],this.format()}t.parse=xe,t.valid=function(D,L){var O=xe(D,L);return O?O.version:null},t.clean=function(D,L){var O=xe(D.trim().replace(/^[=v]+/,""),L);return O?O.version:null},t.SemVer=Ve,Ve.prototype.format=function(){return this.version=this.major+"."+this.minor+"."+this.patch,this.prerelease.length&&(this.version+="-"+this.prerelease.join(".")),this.version},Ve.prototype.toString=function(){return this.version},Ve.prototype.compare=function(D){return n("SemVer.compare",this.version,this.loose,D),D instanceof Ve||(D=new Ve(D,this.loose)),this.compareMain(D)||this.comparePre(D)},Ve.prototype.compareMain=function(D){return D instanceof Ve||(D=new Ve(D,this.loose)),xi(this.major,D.major)||xi(this.minor,D.minor)||xi(this.patch,D.patch)},Ve.prototype.comparePre=function(D){if(D instanceof Ve||(D=new Ve(D,this.loose)),this.prerelease.length&&!D.prerelease.length)return-1;if(!this.prerelease.length&&D.prerelease.length)return 1;if(!this.prerelease.length&&!D.prerelease.length)return 0;var L=0;do{var O=this.prerelease[L],oe=D.prerelease[L];if(n("prerelease compare",L,O,oe),O===void 0&&oe===void 0)return 0;if(oe===void 0)return 1;if(O===void 0)return-1;if(O!==oe)return xi(O,oe)}while(++L)},Ve.prototype.inc=function(D,L){switch(D){case"premajor":this.prerelease.length=0,this.patch=0,this.minor=0,this.major++,this.inc("pre",L);break;case"preminor":this.prerelease.length=0,this.patch=0,this.minor++,this.inc("pre",L);break;case"prepatch":this.prerelease.length=0,this.inc("patch",L),this.inc("pre",L);break;case"prerelease":this.prerelease.length===0&&this.inc("patch",L),this.inc("pre",L);break;case"major":this.minor===0&&this.patch===0&&this.prerelease.length!==0||this.major++,this.minor=0,this.patch=0,this.prerelease=[];break;case"minor":this.patch===0&&this.prerelease.length!==0||this.minor++,this.patch=0,this.prerelease=[];break;case"patch":this.prerelease.length===0&&this.patch++,this.prerelease=[];break;case"pre":if(this.prerelease.length===0)this.prerelease=[0];else{for(var O=this.prerelease.length;--O>=0;)typeof this.prerelease[O]=="number"&&(this.prerelease[O]++,O=-2);O===-1&&this.prerelease.push(0)}L&&(this.prerelease[0]===L?isNaN(this.prerelease[1])&&(this.prerelease=[L,0]):this.prerelease=[L,0]);break;default:throw new Error("invalid increment argument: "+D)}return this.format(),this.raw=this.version,this},t.inc=function(D,L,O,oe){typeof O=="string"&&(oe=O,O=void 0);try{return new Ve(D,O).inc(L,oe).version}catch{return null}},t.diff=function(D,L){if(Ka(D,L))return null;var O=xe(D),oe=xe(L);if(O.prerelease.length||oe.prerelease.length){for(var me in O)if((me==="major"||me==="minor"||me==="patch")&&O[me]!==oe[me])return"pre"+me;return"prerelease"}for(var me in O)if((me==="major"||me==="minor"||me==="patch")&&O[me]!==oe[me])return me},t.compareIdentifiers=xi;var Su=/^[0-9]+$/;function xi(D,L){var O=Su.test(D),oe=Su.test(L);return O&&oe&&(D=+D,L=+L),O&&!oe?-1:oe&&!O?1:D<L?-1:D>L?1:0}function ui(D,L,O){return new Ve(D,O).compare(new Ve(L,O))}function ns(D,L,O){return ui(D,L,O)>0}function mo(D,L,O){return ui(D,L,O)<0}function Ka(D,L,O){return ui(D,L,O)===0}function Eu(D,L,O){return ui(D,L,O)!==0}function vo(D,L,O){return ui(D,L,O)>=0}function Ya(D,L,O){return ui(D,L,O)<=0}function ss(D,L,O,oe){var me;switch(L){case"===":typeof D=="object"&&(D=D.version),typeof O=="object"&&(O=O.version),me=D===O;break;case"!==":typeof D=="object"&&(D=D.version),typeof O=="object"&&(O=O.version),me=D!==O;break;case"":case"=":case"==":me=Ka(D,O,oe);break;case"!=":me=Eu(D,O,oe);break;case">":me=ns(D,O,oe);break;case">=":me=vo(D,O,oe);break;case"<":me=mo(D,O,oe);break;case"<=":me=Ya(D,O,oe);break;default:throw new TypeError("Invalid operator: "+L)}return me}function Si(D,L){if(D instanceof Si){if(D.loose===L)return D;D=D.value}if(!(this instanceof Si))return new Si(D,L);n("comparator",D,L),this.loose=L,this.parse(D),this.semver===Vr?this.value="":this.value=this.operator+this.semver.version,n("comp",this)}t.rcompareIdentifiers=function(D,L){return xi(L,D)},t.major=function(D,L){return new Ve(D,L).major},t.minor=function(D,L){return new Ve(D,L).minor},t.patch=function(D,L){return new Ve(D,L).patch},t.compare=ui,t.compareLoose=function(D,L){return ui(D,L,!0)},t.rcompare=function(D,L,O){return ui(L,D,O)},t.sort=function(D,L){return D.sort(function(O,oe){return t.compare(O,oe,L)})},t.rsort=function(D,L){return D.sort(function(O,oe){return t.rcompare(O,oe,L)})},t.gt=ns,t.lt=mo,t.eq=Ka,t.neq=Eu,t.gte=vo,t.lte=Ya,t.cmp=ss,t.Comparator=Si;var Vr={};function ht(D,L){if(D instanceof ht)return D.loose===L?D:new ht(D.raw,L);if(D instanceof Si)return new ht(D.value,L);if(!(this instanceof ht))return new ht(D,L);if(this.loose=L,this.raw=D,this.set=D.split(/\s*\|\|\s*/).map(function(O){return this.parseRange(O.trim())},this).filter(function(O){return O.length}),!this.set.length)throw new TypeError("Invalid SemVer Range: "+D);this.format()}function ti(D){return!D||D.toLowerCase()==="x"||D==="*"}function Qp(D,L,O,oe,me,Tt,ze,Mt,vt,Gt,qi,_t,Wt){return((L=ti(O)?"":ti(oe)?">="+O+".0.0":ti(me)?">="+O+"."+oe+".0":">="+L)+" "+(Mt=ti(vt)?"":ti(Gt)?"<"+(+vt+1)+".0.0":ti(qi)?"<"+vt+"."+(+Gt+1)+".0":_t?"<="+vt+"."+Gt+"."+qi+"-"+_t:"<="+Mt)).trim()}function En(D,L){for(var O=0;O<D.length;O++)if(!D[O].test(L))return!1;if(L.prerelease.length){for(O=0;O<D.length;O++)if(n(D[O].semver),D[O].semver!==Vr&&D[O].semver.prerelease.length>0){var oe=D[O].semver;if(oe.major===L.major&&oe.minor===L.minor&&oe.patch===L.patch)return!0}return!1}return!0}function _o(D,L,O){try{L=new ht(L,O)}catch{return!1}return L.test(D)}function el(D,L,O,oe){var me,Tt,ze,Mt,vt;switch(D=new Ve(D,oe),L=new ht(L,oe),O){case">":me=ns,Tt=Ya,ze=mo,Mt=">",vt=">=";break;case"<":me=mo,Tt=vo,ze=ns,Mt="<",vt="<=";break;default:throw new TypeError('Must provide a hilo val of "<" or ">"')}if(_o(D,L,oe))return!1;for(var Gt=0;Gt<L.set.length;++Gt){var qi=L.set[Gt],_t=null,Wt=null;if(qi.forEach(function(ni){ni.semver===Vr&&(ni=new Si(">=0.0.0")),_t=_t||ni,Wt=Wt||ni,me(ni.semver,_t.semver,oe)?_t=ni:ze(ni.semver,Wt.semver,oe)&&(Wt=ni)}),_t.operator===Mt||_t.operator===vt||(!Wt.operator||Wt.operator===Mt)&&Tt(D,Wt.semver)||Wt.operator===vt&&ze(D,Wt.semver))return!1}return!0}Si.prototype.parse=function(D){var L=this.loose?a[jt]:a[ri],O=D.match(L);if(!O)throw new TypeError("Invalid comparator: "+D);this.operator=O[1],this.operator==="="&&(this.operator=""),O[2]?this.semver=new Ve(O[2],this.loose):this.semver=Vr},Si.prototype.toString=function(){return this.value},Si.prototype.test=function(D){return n("Comparator.test",D,this.loose),this.semver===Vr||(typeof D=="string"&&(D=new Ve(D,this.loose)),ss(D,this.operator,this.semver,this.loose))},Si.prototype.intersects=function(D,L){if(!(D instanceof Si))throw new TypeError("a Comparator is required");var O;if(this.operator==="")return O=new ht(D.value,L),_o(this.value,O,L);if(D.operator==="")return O=new ht(this.value,L),_o(D.semver,O,L);var oe=!(this.operator!==">="&&this.operator!==">"||D.operator!==">="&&D.operator!==">"),me=!(this.operator!=="<="&&this.operator!=="<"||D.operator!=="<="&&D.operator!=="<"),Tt=this.semver.version===D.semver.version,ze=!(this.operator!==">="&&this.operator!=="<="||D.operator!==">="&&D.operator!=="<="),Mt=ss(this.semver,"<",D.semver,L)&&(this.operator===">="||this.operator===">")&&(D.operator==="<="||D.operator==="<"),vt=ss(this.semver,">",D.semver,L)&&(this.operator==="<="||this.operator==="<")&&(D.operator===">="||D.operator===">");return oe||me||Tt&&ze||Mt||vt},t.Range=ht,ht.prototype.format=function(){return this.range=this.set.map(function(D){return D.join(" ").trim()}).join("||").trim(),this.range},ht.prototype.toString=function(){return this.range},ht.prototype.parseRange=function(D){var L=this.loose;D=D.trim(),n("range",D,L);var O=L?a[go]:a[Wr];D=D.replace(O,Qp),n("hyphen replace",D),D=D.replace(a[Qe],"$1$2$3"),n("comparator trim",D,a[Qe]),D=(D=(D=D.replace(a[Q],"$1~")).replace(a[Ge],"$1^")).split(/\s+/).join(" ");var oe=L?a[jt]:a[ri],me=D.split(" ").map(function(Tt){return function(ze,Mt){return n("comp",ze),ze=function(vt,Gt){return vt.trim().split(/\s+/).map(function(qi){return function(_t,Wt){n("caret",_t,Wt);var ni=Wt?a[pt]:a[Bt];return _t.replace(ni,function(Te,be,Ae,ot,at){var Ot;return n("caret",_t,Te,be,Ae,ot,at),ti(be)?Ot="":ti(Ae)?Ot=">="+be+".0.0 <"+(+be+1)+".0.0":ti(ot)?Ot=be==="0"?">="+be+"."+Ae+".0 <"+be+"."+(+Ae+1)+".0":">="+be+"."+Ae+".0 <"+(+be+1)+".0.0":at?(n("replaceCaret pr",at),at.charAt(0)!=="-"&&(at="-"+at),Ot=be==="0"?Ae==="0"?">="+be+"."+Ae+"."+ot+at+" <"+be+"."+Ae+"."+(+ot+1):">="+be+"."+Ae+"."+ot+at+" <"+be+"."+(+Ae+1)+".0":">="+be+"."+Ae+"."+ot+at+" <"+(+be+1)+".0.0"):(n("no pr"),Ot=be==="0"?Ae==="0"?">="+be+"."+Ae+"."+ot+" <"+be+"."+Ae+"."+(+ot+1):">="+be+"."+Ae+"."+ot+" <"+be+"."+(+Ae+1)+".0":">="+be+"."+Ae+"."+ot+" <"+(+be+1)+".0.0"),n("caret return",Ot),Ot})}(qi,Gt)}).join(" ")}(ze,Mt),n("caret",ze),ze=function(vt,Gt){return vt.trim().split(/\s+/).map(function(qi){return function(_t,Wt){var ni=Wt?a[Pe]:a[ge];return _t.replace(ni,function(Te,be,Ae,ot,at){var Ot;return n("tilde",_t,Te,be,Ae,ot,at),ti(be)?Ot="":ti(Ae)?Ot=">="+be+".0.0 <"+(+be+1)+".0.0":ti(ot)?Ot=">="+be+"."+Ae+".0 <"+be+"."+(+Ae+1)+".0":at?(n("replaceTilde pr",at),at.charAt(0)!=="-"&&(at="-"+at),Ot=">="+be+"."+Ae+"."+ot+at+" <"+be+"."+(+Ae+1)+".0"):Ot=">="+be+"."+Ae+"."+ot+" <"+be+"."+(+Ae+1)+".0",n("tilde return",Ot),Ot})}(qi,Gt)}).join(" ")}(ze,Mt),n("tildes",ze),ze=function(vt,Gt){return n("replaceXRanges",vt,Gt),vt.split(/\s+/).map(function(qi){return function(_t,Wt){_t=_t.trim();var ni=Wt?a[H]:a[z];return _t.replace(ni,function(Te,be,Ae,ot,at,Ot){n("xRange",_t,Te,be,Ae,ot,at,Ot);var Cu=ti(Ae),S=Cu||ti(ot),Ei=S||ti(at);return be==="="&&Ei&&(be=""),Cu?Te=be===">"||be==="<"?"<0.0.0":"*":be&&Ei?(S&&(ot=0),Ei&&(at=0),be===">"?(be=">=",S?(Ae=+Ae+1,ot=0,at=0):Ei&&(ot=+ot+1,at=0)):be==="<="&&(be="<",S?Ae=+Ae+1:ot=+ot+1),Te=be+Ae+"."+ot+"."+at):S?Te=">="+Ae+".0.0 <"+(+Ae+1)+".0.0":Ei&&(Te=">="+Ae+"."+ot+".0 <"+Ae+"."+(+ot+1)+".0"),n("xRange return",Te),Te})}(qi,Gt)}).join(" ")}(ze,Mt),n("xrange",ze),ze=function(vt,Gt){return n("replaceStars",vt,Gt),vt.trim().replace(a[Sn],"")}(ze,Mt),n("stars",ze),ze}(Tt,L)}).join(" ").split(/\s+/);return this.loose&&(me=me.filter(function(Tt){return!!Tt.match(oe)})),me=me.map(function(Tt){return new Si(Tt,L)})},ht.prototype.intersects=function(D,L){if(!(D instanceof ht))throw new TypeError("a Range is required");return this.set.some(function(O){return O.every(function(oe){return D.set.some(function(me){return me.every(function(Tt){return oe.intersects(Tt,L)})})})})},t.toComparators=function(D,L){return new ht(D,L).set.map(function(O){return O.map(function(oe){return oe.value}).join(" ").trim().split(" ")})},ht.prototype.test=function(D){if(!D)return!1;typeof D=="string"&&(D=new Ve(D,this.loose));for(var L=0;L<this.set.length;L++)if(En(this.set[L],D))return!0;return!1},t.satisfies=_o,t.maxSatisfying=function(D,L,O){var oe=null,me=null;try{var Tt=new ht(L,O)}catch{return null}return D.forEach(function(ze){Tt.test(ze)&&(oe&&me.compare(ze)!==-1||(me=new Ve(oe=ze,O)))}),oe},t.minSatisfying=function(D,L,O){var oe=null,me=null;try{var Tt=new ht(L,O)}catch{return null}return D.forEach(function(ze){Tt.test(ze)&&(oe&&me.compare(ze)!==1||(me=new Ve(oe=ze,O)))}),oe},t.validRange=function(D,L){try{return new ht(D,L).range||"*"}catch{return null}},t.ltr=function(D,L,O){return el(D,L,"<",O)},t.gtr=function(D,L,O){return el(D,L,">",O)},t.outside=el,t.prerelease=function(D,L){var O=xe(D,L);return O&&O.prerelease.length?O.prerelease:null},t.intersects=function(D,L,O){return D=new ht(D,O),L=new ht(L,O),D.intersects(L)},t.coerce=function(D){if(D instanceof Ve)return D;if(typeof D!="string")return null;var L=D.match(a[J]);return L==null?null:xe((L[1]||"0")+"."+(L[2]||"0")+"."+(L[3]||"0"))}}).call(this,i(1))},function(e,t){var i,r,n=e.exports={};function s(){throw new Error("setTimeout has not been defined")}function o(){throw new Error("clearTimeout has not been defined")}function a(b){if(i===setTimeout)return setTimeout(b,0);if((i===s||!i)&&setTimeout)return i=setTimeout,setTimeout(b,0);try{return i(b,0)}catch{try{return i.call(null,b,0)}catch{return i.call(this,b,0)}}}(function(){try{i=typeof setTimeout=="function"?setTimeout:s}catch{i=s}try{r=typeof clearTimeout=="function"?clearTimeout:o}catch{r=o}})();var l,c=[],u=!1,d=-1;function f(){u&&l&&(u=!1,l.length?c=l.concat(c):d=-1,c.length&&p())}function p(){if(!u){var b=a(f);u=!0;for(var E=c.length;E;){for(l=c,c=[];++d<E;)l&&l[d].run();d=-1,E=c.length}l=null,u=!1,function(C){if(r===clearTimeout)return clearTimeout(C);if((r===o||!r)&&clearTimeout)return r=clearTimeout,clearTimeout(C);try{r(C)}catch{try{return r.call(null,C)}catch{return r.call(this,C)}}}(b)}}function m(b,E){this.fun=b,this.array=E}function _(){}n.nextTick=function(b){var E=new Array(arguments.length-1);if(arguments.length>1)for(var C=1;C<arguments.length;C++)E[C-1]=arguments[C];c.push(new m(b,E)),c.length!==1||u||a(p)},m.prototype.run=function(){this.fun.apply(null,this.array)},n.title="browser",n.browser=!0,n.env={},n.argv=[],n.version="",n.versions={},n.on=_,n.addListener=_,n.once=_,n.off=_,n.removeListener=_,n.removeAllListeners=_,n.emit=_,n.prependListener=_,n.prependOnceListener=_,n.listeners=function(b){return[]},n.binding=function(b){throw new Error("process.binding is not supported")},n.cwd=function(){return"/"},n.chdir=function(b){throw new Error("process.chdir is not supported")},n.umask=function(){return 0}}])});var mG=Le.exports.SEMVER_SPEC_VERSION,vG=Le.exports.parse,_G=Le.exports.valid,wG=Le.exports.coerce,yG=Le.exports.clean,bG=Le.exports.inc,xG=Le.exports.major,SG=Le.exports.minor,EG=Le.exports.patch,CG=Le.exports.prerelease,DG=Le.exports.gt,IG=Le.exports.gte,kG=Le.exports.lt,PG=Le.exports.lte,TG=Le.exports.eq,AG=Le.exports.neq,RG=Le.exports.cmp,LG=Le.exports.compare,NG=Le.exports.rcompare,MG=Le.exports.compareIdentifiers,OG=Le.exports.rcompareIdentifiers,FG=Le.exports.compareBuild,$G=Le.exports.sort,HG=Le.exports.rsort,UG=Le.exports.diff,BG=Le.exports.validRange,WG=Le.exports.satisfies,VG=Le.exports.maxSatisfying,zG=Le.exports.minSatisfying,qG=Le.exports.minVersion,jG=Le.exports.gtr,GG=Le.exports.ltr,QG=Le.exports.outside,JG=Le.exports.intersects,XG=Le.exports.SemVer,ZG=Le.exports.Comparator,KG=Le.exports.Range,q5=/^(\^|>=)?((\d+)|x)\.((\d+)|x)\.((\d+)|x)(\-.*)?$/,wF=/^-(\d{4})(\d{2})(\d{2})$/;function yF(e){return e=e.trim(),e==="*"||q5.test(e)}function j5(e){if(!yF(e))return null;if(e=e.trim(),e==="*")return{hasCaret:!1,hasGreaterEquals:!1,majorBase:0,majorMustEqual:!1,minorBase:0,minorMustEqual:!1,patchBase:0,patchMustEqual:!1,preRelease:null};const t=e.match(q5);return t?{hasCaret:t[1]==="^",hasGreaterEquals:t[1]===">=",majorBase:t[2]==="x"?0:parseInt(t[2],10),majorMustEqual:t[2]!=="x",minorBase:t[4]==="x"?0:parseInt(t[4],10),minorMustEqual:t[4]!=="x",patchBase:t[6]==="x"?0:parseInt(t[6],10),patchMustEqual:t[6]!=="x",preRelease:t[8]||null}:null}function G5(e){if(!e)return null;const t=e.majorBase,i=e.majorMustEqual,r=e.minorBase;let n=e.minorMustEqual;const s=e.patchBase;let o=e.patchMustEqual;e.hasCaret&&(t===0||(n=!1),o=!1);let a=0;if(e.preRelease){const l=wF.exec(e.preRelease);if(l){const[,c,u,d]=l;a=Date.UTC(Number(c),Number(u)-1,Number(d))}}return{majorBase:t,majorMustEqual:i,minorBase:r,minorMustEqual:n,patchBase:s,patchMustEqual:o,isMinimum:e.hasGreaterEquals,notBefore:a}}var bF=class{constructor(){this.buffers=[]}add(e){let t=this.buffers.indexOf(e);return t<0&&(t=this.buffers.length,this.buffers.push(e)),t}};function xF(e,t){if(t.serializeBuffersForPostMessage){const i=new bF,n=JSON.stringify(e,(o,a)=>{if(a instanceof ArrayBuffer)return{$$vscode_array_buffer_reference$$:!0,index:i.add(a)};if(ArrayBuffer.isView(a)){const l=SF(a);if(l)return{$$vscode_array_buffer_reference$$:!0,index:i.add(a.buffer),view:{type:l,byteLength:a.byteLength,byteOffset:a.byteOffset}}}return a}),s=i.buffers.map(o=>{const a=new Uint8Array(o);return ae.wrap(a)});return{message:n,buffers:s}}else return{message:JSON.stringify(e),buffers:[]}}function SF(e){switch(e.constructor.name){case"Int8Array":return 1;case"Uint8Array":return 2;case"Uint8ClampedArray":return 3;case"Int16Array":return 4;case"Uint16Array":return 5;case"Int32Array":return 6;case"Uint32Array":return 7;case"Float32Array":return 8;case"Float64Array":return 9;case"BigInt64Array":return 10;case"BigUint64Array":return 11}}function EF(e,t){const i=t.map(s=>{const o=new ArrayBuffer(s.byteLength);return new Uint8Array(o).set(s.buffer),o}),r=t.length?(s,o)=>{if(o&&typeof o=="object"&&o.$$vscode_array_buffer_reference$$){const a=o,{index:l}=a,c=i[l];if(a.view)switch(a.view.type){case 1:return new Int8Array(c,a.view.byteOffset,a.view.byteLength/Int8Array.BYTES_PER_ELEMENT);case 2:return new Uint8Array(c,a.view.byteOffset,a.view.byteLength/Uint8Array.BYTES_PER_ELEMENT);case 3:return new Uint8ClampedArray(c,a.view.byteOffset,a.view.byteLength/Uint8ClampedArray.BYTES_PER_ELEMENT);case 4:return new Int16Array(c,a.view.byteOffset,a.view.byteLength/Int16Array.BYTES_PER_ELEMENT);case 5:return new Uint16Array(c,a.view.byteOffset,a.view.byteLength/Uint16Array.BYTES_PER_ELEMENT);case 6:return new Int32Array(c,a.view.byteOffset,a.view.byteLength/Int32Array.BYTES_PER_ELEMENT);case 7:return new Uint32Array(c,a.view.byteOffset,a.view.byteLength/Uint32Array.BYTES_PER_ELEMENT);case 8:return new Float32Array(c,a.view.byteOffset,a.view.byteLength/Float32Array.BYTES_PER_ELEMENT);case 9:return new Float64Array(c,a.view.byteOffset,a.view.byteLength/Float64Array.BYTES_PER_ELEMENT);case 10:return new BigInt64Array(c,a.view.byteOffset,a.view.byteLength/BigInt64Array.BYTES_PER_ELEMENT);case 11:return new BigUint64Array(c,a.view.byteOffset,a.view.byteLength/BigUint64Array.BYTES_PER_ELEMENT);default:throw new Error("Unknown array buffer view type")}return c}return o}:void 0;return{message:JSON.parse(e,r),arrayBuffers:i}}var CF=class{#e;#t;#i;#r;#s;#n;#a;#o;#l;#c;#u;#h;constructor(e,t,i,r,n,s,o){this.#a="",this.#l=!1,this.#c=!1,this._onMessageEmitter=new P,this.onDidReceiveMessage=this._onMessageEmitter.event,this.#d=new P,this._onDidDispose=this.#d.event,this.#e=e,this.#t=t,this.#o=i,this.#r=r,this.#s=n,this.#n=s,this.#u=qa(s),this.#h=DF(s),this.#i=o}#d;dispose(){this.#l=!0,this.#d.fire(),this.#d.dispose(),this._onMessageEmitter.dispose()}asWebviewUri(e){return this.#c=!0,tu(e,this.#r)}get cspSource(){const e=this.#n.extensionLocation;if(e.scheme===V.https||e.scheme===V.http){let t=e.toString();return t.endsWith("/")||(t+="/"),t+" "+A0}return A0}get html(){return this.assertNotDisposed(),this.#a}set html(e){this.assertNotDisposed(),this.#a!==e&&(this.#a=e,this.#h&&!this.#c&&/(["'])vscode-resource:([^\s'"]+?)(["'])/i.test(e)&&(this.#c=!0,this.#i.report("Webview vscode-resource: uris",this.#n,"Please migrate to use the 'webview.asWebviewUri' api instead: https://aka.ms/vscode-webview-use-aswebviewuri")),this.#t.$setHtml(this.#e,this.rewriteOldResourceUrlsIfNeeded(e)))}get options(){return this.assertNotDisposed(),this.#o}set options(e){this.assertNotDisposed(),fi(this.#o,e)||this.#t.$setOptions(this.#e,Q5(this.#n,this.#s,e)),this.#o=e}async postMessage(e){if(this.#l)return!1;const t=xF(e,{serializeBuffersForPostMessage:this.#u});return this.#t.$postMessage(this.#e,t.message,...t.buffers)}assertNotDisposed(){if(this.#l)throw new Error("Webview is disposed")}rewriteOldResourceUrlsIfNeeded(e){if(!this.#h)return e;const t=this.#n.extensionLocation?.scheme===V.vscodeRemote,i=this.#n.extensionLocation.scheme===V.vscodeRemote?this.#n.extensionLocation.authority:void 0;return e.replace(/(["'])(?:vscode-resource):(\/\/([^\s\/'"]+?)(?=\/))?([^\s'"]+?)(["'])/gi,(r,n,s,o,a,l)=>{const c=y.from({scheme:o||"file",path:decodeURIComponent(a)}),u=tu(c,{isRemote:t,authority:i}).toString();return`${n}${u}${l}`}).replace(/(["'])(?:vscode-webview-resource):(\/\/[^\s\/'"]+\/([^\s\/'"]+?)(?=\/))?([^\s'"]+?)(["'])/gi,(r,n,s,o,a,l)=>{const c=y.from({scheme:o||"file",path:decodeURIComponent(a)}),u=tu(c,{isRemote:t,authority:i}).toString();return`${n}${u}${l}`})}};function qa(e){try{const t=G5(j5(e.engines.vscode));return!!t&&t.majorBase>=1&&t.minorBase>=57}catch{return!1}}function DF(e){try{const t=G5(j5(e.engines.vscode));return t?t.majorBase<1||t.majorBase===1&&t.minorBase<60:!1}catch{return!1}}var IF=class extends se{constructor(e,t,i,r,n){super(),this.remoteInfo=t,this.workspace=i,this._logService=r,this._deprecationService=n,this._webviews=new Map,this._webviewProxy=e.getProxy(W.MainThreadWebviews)}dispose(){super.dispose();for(const e of this._webviews.values())e.dispose();this._webviews.clear()}$onMessage(e,t,i){const r=this.getWebview(e);if(r){const{message:n}=EF(t,i.value);r._onMessageEmitter.fire(n)}}$onMissingCsp(e,t){this._logService.warn(`${t} created a webview without a content security policy: https://aka.ms/vscode-webview-missing-csp`)}createNewWebview(e,t,i){const r=new CF(e,this._webviewProxy,kF(t),this.remoteInfo,this.workspace,i,this._deprecationService);this._webviews.set(e,r);const n=r._onDidDispose(()=>{n.dispose(),this.deleteWebview(e)});return r}deleteWebview(e){this._webviews.delete(e)}getWebview(e){return this._webviews.get(e)}};function cp(e){return{id:e.identifier,location:e.extensionLocation}}function Q5(e,t,i){return{enableCommandUris:i.enableCommandUris,enableScripts:i.enableScripts,enableForms:i.enableForms,portMapping:i.portMapping,localResourceRoots:i.localResourceRoots||PF(e,t)}}function kF(e){return{enableCommandUris:e.enableCommandUris,enableScripts:e.enableScripts,enableForms:e.enableForms,portMapping:e.portMapping,localResourceRoots:e.localResourceRoots?.map(t=>y.from(t))}}function PF(e,t){return[...(t?.getWorkspaceFolders()||[]).map(i=>i.uri),e.extensionLocation]}var _r=class f7{static{this.enableDebugLogging=!1}constructor(t){this.id=t,this._data=new Map,this._idPool=1}add(t){const i=this._idPool++;return this._data.set(i,t),this.logDebugInfo(),i}get(t,i){return this._data.has(t)?this._data.get(t)[i]:void 0}delete(t){this._data.delete(t),this.logDebugInfo()}logDebugInfo(){f7.enableDebugLogging&&console.log(`${this.id} cache size - ${this._data.size}`)}},TF=class{constructor(e,t){this.document=e,this._storagePath=t,this._backupCounter=1,this._edits=new _r("custom documents")}addEdit(e){return this._edits.add([e])}async undo(e,t){await this.getEdit(e).undo(),t||this.disposeBackup()}async redo(e,t){await this.getEdit(e).redo(),t||this.disposeBackup()}disposeEdits(e){for(const t of e)this._edits.delete(t)}getNewBackupUri(){if(!this._storagePath)throw new Error("Backup requires a valid storage path");const e=OF(this.document.uri)+this._backupCounter++;return Zt(this._storagePath,e)}updateBackup(e){this._backup?.delete(),this._backup=e}disposeBackup(){this._backup?.delete(),this._backup=void 0}getEdit(e){const t=this._edits.get(e,0);if(!t)throw new Error("No edit found");return t}},AF=class{constructor(){this._documents=new Map}get(e,t){return this._documents.get(this.key(e,t))}add(e,t,i){const r=this.key(e,t.uri);if(this._documents.has(r))throw new Error(`Document already exists for viewType:${e} resource:${t.uri}`);const n=new TF(t,i);return this._documents.set(r,n),n}delete(e,t){const i=this.key(e,t.uri);this._documents.delete(i)}key(e,t){return`${e}@@@${t}`}},J5;(function(e){e[e.Text=0]="Text",e[e.Custom=1]="Custom"})(J5||(J5={}));var RF=class{constructor(){this._providers=new Map}addTextProvider(e,t,i){return this.add(e,{type:0,extension:t,provider:i})}addCustomProvider(e,t,i){return this.add(e,{type:1,extension:t,provider:i})}get(e){return this._providers.get(e)}add(e,t){if(this._providers.has(e))throw new Error(`Provider for viewType:${e} already registered`);return this._providers.set(e,t),new Ce(()=>this._providers.delete(e))}},LF=class{constructor(e,t,i,r,n){this._extHostDocuments=t,this._extensionStoragePaths=i,this._extHostWebview=r,this._extHostWebviewPanels=n,this._editorProviders=new RF,this._documents=new AF,this._proxy=e.getProxy(W.MainThreadCustomEditors)}registerCustomEditorProvider(e,t,i,r){const n=new he;return NF(i)?(n.add(this._editorProviders.addTextProvider(t,e,i)),this._proxy.$registerTextEditorProvider(cp(e),t,r.webviewOptions||{},{supportsMove:!!i.moveCustomTextEditor},qa(e))):(n.add(this._editorProviders.addCustomProvider(t,e,i)),up(i)&&n.add(i.onDidChangeCustomDocument(s=>{const o=this.getCustomDocumentEntry(t,s.document.uri);if(MF(s)){const a=o.addEdit(s);this._proxy.$onDidEdit(s.document.uri,t,a,s.label)}else this._proxy.$onContentChange(s.document.uri,t)})),this._proxy.$registerCustomEditorProvider(cp(e),t,r.webviewOptions||{},!!r.supportsMultipleEditorsPerDocument,qa(e))),Ce.from(n,new Ce(()=>{this._proxy.$unregisterEditorProvider(t)}))}async $createCustomDocument(e,t,i,r,n){const s=this._editorProviders.get(t);if(!s)throw new Error(`No provider found for '${t}'`);if(s.type!==1)throw new Error(`Invalid provide type for '${t}'`);const o=y.revive(e),a=await s.provider.openCustomDocument(o,{backupId:i,untitledDocumentData:r?.buffer},n);let l;return up(s.provider)&&this._extensionStoragePaths&&(l=this._extensionStoragePaths.workspaceValue(s.extension)??this._extensionStoragePaths.globalValue(s.extension)),this._documents.add(t,a,l),{editable:up(s.provider)}}async $disposeCustomDocument(e,t){const i=this._editorProviders.get(t);if(!i)throw new Error(`No provider found for '${t}'`);if(i.type!==1)throw new Error(`Invalid provider type for '${t}'`);const r=y.revive(e),{document:n}=this.getCustomDocumentEntry(t,r);this._documents.delete(t,n),n.dispose()}async $resolveCustomEditor(e,t,i,r,n,s){const o=this._editorProviders.get(i);if(!o)throw new Error(`No provider found for '${i}'`);const a=Rt.to(n),l=this._extHostWebview.createNewWebview(t,r.contentOptions,o.extension),c=this._extHostWebviewPanels.createNewWebviewPanel(t,i,r.title,a,r.options,l,r.active),u=y.revive(e);switch(o.type){case 1:{const{document:d}=this.getCustomDocumentEntry(i,u);return o.provider.resolveCustomEditor(d,c,s)}case 0:{const d=this._extHostDocuments.getDocument(u);return o.provider.resolveCustomTextEditor(d,c,s)}default:throw new Error("Unknown webview provider type")}}$disposeEdits(e,t,i){this.getCustomDocumentEntry(t,e).disposeEdits(i)}async $onMoveCustomEditor(e,t,i){const r=this._editorProviders.get(i);if(!r)throw new Error(`No provider found for '${i}'`);if(!r.provider.moveCustomTextEditor)throw new Error(`Provider does not implement move '${i}'`);const n=this._extHostWebviewPanels.getWebviewPanel(e);if(!n)throw new Error("No webview found");const s=y.revive(t),o=this._extHostDocuments.getDocument(s);await r.provider.moveCustomTextEditor(o,n,Xe.None)}async $undo(e,t,i,r){return this.getCustomDocumentEntry(t,e).undo(i,r)}async $redo(e,t,i,r){return this.getCustomDocumentEntry(t,e).redo(i,r)}async $revert(e,t,i){const r=this.getCustomDocumentEntry(t,e);await this.getCustomEditorProvider(t).revertCustomDocument(r.document,i),r.disposeBackup()}async $onSave(e,t,i){const r=this.getCustomDocumentEntry(t,e);await this.getCustomEditorProvider(t).saveCustomDocument(r.document,i),r.disposeBackup()}async $onSaveAs(e,t,i,r){const n=this.getCustomDocumentEntry(t,e);return this.getCustomEditorProvider(t).saveCustomDocumentAs(n.document,y.revive(i),r)}async $backup(e,t,i){const r=this.getCustomDocumentEntry(t,e),s=await this.getCustomEditorProvider(t).backupCustomDocument(r.document,{destination:r.getNewBackupUri()},i);return r.updateBackup(s),s.id}getCustomDocumentEntry(e,t){const i=this._documents.get(e,y.revive(t));if(!i)throw new Error("No custom document found");return i}getCustomEditorProvider(e){const i=this._editorProviders.get(e)?.provider;if(!i||!up(i))throw new Error("Custom document is not editable");return i}};function up(e){return!!e.onDidChangeCustomDocument}function NF(e){return typeof e.resolveCustomTextEditor=="function"}function MF(e){return typeof e.undo=="function"&&typeof e.redo=="function"}function OF(e){const t=e.scheme===V.file||e.scheme===V.untitled?e.fsPath:e.toString();return ml(t)+""}var lo,X5=class p7{#e;#t;#i;constructor(t,i,r,n,s,o,a,l){this._name=t,this._owner=i,this._maxDiagnosticsTotal=r,this._maxDiagnosticsPerFile=n,this._modelVersionIdProvider=s,this._isDisposed=!1,this._maxDiagnosticsTotal=Math.max(n,r),this.#i=new Ft(c=>o.getComparisonKey(c)),this.#e=a,this.#t=l}dispose(){this._isDisposed||(this.#t.fire([...this.#i.keys()]),this.#e?.$clear(this._owner),this.#i.clear(),this._isDisposed=!0)}get name(){return this._checkDisposed(),this._name}set(t,i){if(!t){this.clear();return}this._checkDisposed();let r=[];if(y.isUri(t)){if(!i){this.delete(t);return}this.#i.set(t,i.slice()),r=[t]}else if(Array.isArray(t)){r=[];let o;t=[...t].sort(p7._compareIndexedTuplesByUri);for(const a of t){const[l,c]=a;if((!o||l.toString()!==o.toString())&&(o&&this.#i.get(o).length===0&&this.#i.delete(o),o=l,r.push(l),this.#i.set(l,[])),c)this.#i.get(l)?.push(...c);else{const u=this.#i.get(l);u&&(u.length=0)}}}if(this.#t.fire(r),!this.#e)return;const n=[];let s=0;for(const o of r){let a=[];const l=this.#i.get(o);if(l)if(l.length>this._maxDiagnosticsPerFile){a=[];const c=[ei.Error,ei.Warning,ei.Information,ei.Hint];e:for(let u=0;u<4;u++)for(const d of l)if(d.severity===c[u]&&a.push({...wa.from(d),modelVersionId:this._modelVersionIdProvider(o)})===this._maxDiagnosticsPerFile)break e;a.push({severity:pi.Info,message:h(2924,null,l.length-this._maxDiagnosticsPerFile),startLineNumber:a[a.length-1].startLineNumber,startColumn:a[a.length-1].startColumn,endLineNumber:a[a.length-1].endLineNumber,endColumn:a[a.length-1].endColumn})}else a=l.map(c=>({...wa.from(c),modelVersionId:this._modelVersionIdProvider(o)}));if(n.push([o,a]),s+=a.length,s>this._maxDiagnosticsTotal)break}this.#e.$changeMany(this._owner,n)}delete(t){this._checkDisposed(),this.#t.fire([t]),this.#i.delete(t),this.#e?.$changeMany(this._owner,[[t,void 0]])}clear(){this._checkDisposed(),this.#t.fire([...this.#i.keys()]),this.#i.clear(),this.#e?.$clear(this._owner)}forEach(t,i){this._checkDisposed();for(const[r,n]of this)t.call(i,r,n,this)}*[Symbol.iterator](){this._checkDisposed();for(const t of this.#i.keys())yield[t,this.get(t)]}get(t){this._checkDisposed();const i=this.#i.get(t);return Array.isArray(i)?Object.freeze(i.slice(0)):[]}has(t){return this._checkDisposed(),Array.isArray(this.#i.get(t))}_checkDisposed(){if(this._isDisposed)throw new Error("illegal state - object is disposed")}static _compareIndexedTuplesByUri(t,i){return t[0].toString()<i[0].toString()?-1:t[0].toString()>i[0].toString()?1:0}},L0=class{static{lo=this}static{this._idPool=0}static{this._maxDiagnosticsPerFile=1e3}static{this._maxDiagnosticsTotal=1.1*this._maxDiagnosticsPerFile}static _mapper(t){const i=new Ft;for(const r of t)i.set(r,r);return{uris:Object.freeze(Array.from(i.values()))}}constructor(t,i,r,n){this._logService=i,this._fileSystemInfoService=r,this._extHostDocumentsAndEditors=n,this._collections=new Map,this._onDidChangeDiagnostics=new J9({merge:s=>s.flat(),delay:50}),this.onDidChangeDiagnostics=ct.map(this._onDidChangeDiagnostics.event,lo._mapper),this._proxy=t.getProxy(W.MainThreadDiagnostics)}createDiagnosticCollection(t,i){const{_collections:r,_proxy:n,_onDidChangeDiagnostics:s,_logService:o,_fileSystemInfoService:a,_extHostDocumentsAndEditors:l}=this,c=new class{$changeMany(f,p){n.$changeMany(f,p),o.trace("[DiagnosticCollection] change many (extension, owner, uris)",t.value,f,p.length===0?"CLEARING":p)}$clear(f){n.$clear(f),o.trace("[DiagnosticCollection] remove all (extension, owner)",t.value,f)}dispose(){n.dispose()}};let u;if(!i)i="_generated_diagnostic_collection_name_#"+lo._idPool++,u=i;else if(!r.has(i))u=i;else{this._logService.warn(`DiagnosticCollection with name '${i}' does already exist.`);do u=i+lo._idPool++;while(r.has(u))}return new class extends X5{constructor(){super(i,u,lo._maxDiagnosticsTotal,lo._maxDiagnosticsPerFile,f=>l.getDocument(f)?.version,a.extUri,c,s),r.set(u,this)}dispose(){super.dispose(),r.delete(u)}}}getDiagnostics(t){if(t)return this._getDiagnostics(t);{const i=new Map,r=[];for(const n of this._collections.values())n.forEach((s,o)=>{let a=i.get(s.toString());typeof a>"u"&&(a=r.length,i.set(s.toString(),a),r.push([s,[]])),r[a][1]=r[a][1].concat(...o)});return r}}_getDiagnostics(t){let i=[];for(const r of this._collections.values())r.has(t)&&(i=i.concat(r.get(t)));return i}$acceptMarkersChange(t){if(!this._mirrorCollection){const i="_generated_mirror",r=new X5(i,i,Number.MAX_SAFE_INTEGER,Number.MAX_SAFE_INTEGER,n=>{},this._fileSystemInfoService.extUri,void 0,this._onDidChangeDiagnostics);this._collections.set(i,r),this._mirrorCollection=r}for(const[i,r]of t)this._mirrorCollection.set(y.revive(i),r.map(wa.to))}};L0=lo=__decorate([__param(1,qe),__param(2,Oo)],L0);var FF=class{constructor(e){this._proxy=e.getProxy(W.MainThreadDialogs)}showOpenDialog(e){return this._proxy.$showOpenDialog(e).then(t=>t?t.map(i=>y.revive(i)):void 0)}showSaveDialog(e){return this._proxy.$showSaveDialog(e).then(t=>t?y.revive(t):void 0)}},$F=class g7{static{this._handlePool=0}constructor(t,i,r){this._documentsAndEditors=i,this._logService=r,this._documentContentProviders=new Map,this._proxy=t.getProxy(W.MainThreadDocumentContentProviders)}registerTextDocumentContentProvider(t,i){if(Object.keys(V).indexOf(t)>=0)throw new Error(`scheme '${t}' already registered`);const r=g7._handlePool++;this._documentContentProviders.set(r,i),this._proxy.$registerTextContentProvider(r,t);let n;if(typeof i.onDidChange=="function"){let s;n=i.onDidChange(async o=>{if(o.scheme!==t){this._logService.warn(`Provider for scheme '${t}' is firing event for schema '${o.scheme}' which will be IGNORED`);return}if(!this._documentsAndEditors.getDocument(o))return;s&&await s;const a=this.$provideTextDocumentContent(r,o).then(async l=>{if(!l&&typeof l!="string")return;const c=this._documentsAndEditors.getDocument(o);if(!c)return;const u=lb(l);if(!c.equalLines(u))return this._proxy.$onVirtualDocumentChange(o,l)}).catch(Qt).finally(()=>{s===a&&(s=void 0)});s=a})}return new Ce(()=>{this._documentContentProviders.delete(r)&&this._proxy.$unregisterTextContentProvider(r),n&&(n.dispose(),n=void 0)})}$provideTextDocumentContent(t,i){const r=this._documentContentProviders.get(t);return r?Promise.resolve(r.provideTextDocumentContent(y.revive(i),Xe.None)):Promise.reject(new Error(`unsupported uri-scheme: ${i.scheme}`))}},HF=class{constructor(e,t,i,r={timeout:1500,errors:3}){this._logService=e,this._documents=t,this._mainThreadBulkEdits=i,this._thresholds=r,this._callbacks=new Dn,this._badListeners=new WeakMap}dispose(){this._callbacks.clear()}getOnWillSaveTextDocumentEvent(e){return(t,i,r)=>{const s={dispose:this._callbacks.push([t,i,e])};return Array.isArray(r)&&r.push(s),s}}async $participateInSave(e,t){const i=y.revive(e);let r=!1;const n=setTimeout(()=>r=!0,this._thresholds.timeout),s=[];try{for(const o of[...this._callbacks]){if(r)break;const a=this._documents.getDocument(i),l=await this._deliverEventAsyncAndBlameBadListeners(o,{document:a,reason:hf.to(t)});s.push(l)}}finally{clearTimeout(n)}return s}_deliverEventAsyncAndBlameBadListeners([e,t,i],r){const n=this._badListeners.get(e);return typeof n=="number"&&n>this._thresholds.errors?Promise.resolve(!1):this._deliverEventAsync(i,e,t,r).then(()=>!0,s=>{if(this._logService.error(`onWillSaveTextDocument-listener from extension '${i.identifier.value}' threw ERROR`),this._logService.error(s),!(s instanceof Error)||s.message!=="concurrent_edits"){const o=this._badListeners.get(e);this._badListeners.set(e,o?o+1:1),typeof o=="number"&&o>this._thresholds.errors&&this._logService.info(`onWillSaveTextDocument-listener from extension '${i.identifier.value}' will now be IGNORED because of timeouts and/or errors`)}return!1})}_deliverEventAsync(e,t,i,r){const n=[],s=Date.now(),{document:o,reason:a}=r,{version:l}=o,c=Object.freeze({document:o,reason:a,waitUntil(u){if(Object.isFrozen(n))throw Yp("waitUntil can not be called async");n.push(Promise.resolve(u))}});try{t.apply(i,[c])}catch(u){return Promise.reject(u)}return Object.freeze(n),new Promise((u,d)=>{const f=setTimeout(()=>d(new Error("timeout")),this._thresholds.timeout);return Promise.all(n).then(p=>{this._logService.debug(`onWillSaveTextDocument-listener from extension '${e.identifier.value}' finished after ${Date.now()-s}ms`),clearTimeout(f),u(p)}).catch(p=>{clearTimeout(f),d(p)})}).then(u=>{const d={edits:[]};for(const f of u)if(Array.isArray(f)&&f.every(p=>p instanceof Hn))for(const{newText:p,newEol:m,range:_}of f)d.edits.push({resource:o.uri,versionId:void 0,textEdit:{range:_&&F.from(_),text:p,eol:m&&Ea.from(m)}});if(d.edits.length!==0)return l===o.version?this._mainThreadBulkEdits.$tryApplyWorkspaceEdit(new ai(d)):Promise.reject(new Error("concurrent_edits"))})}},UF=class{constructor(e,t){this._onDidAddDocument=new P,this._onDidRemoveDocument=new P,this._onDidChangeDocument=new P,this._onDidSaveDocument=new P,this.onDidAddDocument=this._onDidAddDocument.event,this.onDidRemoveDocument=this._onDidRemoveDocument.event,this.onDidChangeDocument=this._onDidChangeDocument.event,this.onDidSaveDocument=this._onDidSaveDocument.event,this._toDispose=new he,this._documentLoader=new Map,this._proxy=e.getProxy(W.MainThreadDocuments),this._documentsAndEditors=t,this._documentsAndEditors.onDidRemoveDocuments(i=>{for(const r of i)this._onDidRemoveDocument.fire(r.document)},void 0,this._toDispose),this._documentsAndEditors.onDidAddDocuments(i=>{for(const r of i)this._onDidAddDocument.fire(r.document)},void 0,this._toDispose)}dispose(){this._toDispose.dispose()}getAllDocumentData(){return[...this._documentsAndEditors.allDocuments()]}getDocumentData(e){if(!e)return;const t=this._documentsAndEditors.getDocument(e);if(t)return t}getDocument(e){const t=this.getDocumentData(e);if(!t?.document)throw new Error(`Unable to retrieve document from URI '${e}'`);return t.document}ensureDocumentData(e,t){const i=this._documentsAndEditors.getDocument(e);if(i&&(!t?.encoding||i.document.encoding===t.encoding))return Promise.resolve(i);let r=this._documentLoader.get(e.toString());return r?t?.encoding&&(r=r.then(n=>n.document.encoding!==t.encoding?this.ensureDocumentData(e,t):n)):(r=this._proxy.$tryOpenDocument(e,t).then(n=>{this._documentLoader.delete(e.toString());const s=y.revive(n);return xo(this._documentsAndEditors.getDocument(s))},n=>(this._documentLoader.delete(e.toString()),Promise.reject(n))),this._documentLoader.set(e.toString(),r)),r}createDocumentData(e){return this._proxy.$tryCreateDocument(e).then(t=>y.revive(t))}$acceptModelLanguageChanged(e,t){const i=y.revive(e),r=this._documentsAndEditors.getDocument(i);if(!r)throw new Error("unknown document");this._onDidRemoveDocument.fire(r.document),r._acceptLanguageId(t),this._onDidAddDocument.fire(r.document)}$acceptModelSaved(e){const t=y.revive(e),i=this._documentsAndEditors.getDocument(t);if(!i)throw new Error("unknown document");this.$acceptDirtyStateChanged(e,!1),this._onDidSaveDocument.fire(i.document)}$acceptDirtyStateChanged(e,t){const i=y.revive(e),r=this._documentsAndEditors.getDocument(i);if(!r)throw new Error("unknown document");r._acceptIsDirty(t),this._onDidChangeDocument.fire({document:r.document,contentChanges:[],reason:void 0})}$acceptEncodingChanged(e,t){const i=y.revive(e),r=this._documentsAndEditors.getDocument(i);if(!r)throw new Error("unknown document");r._acceptEncoding(t),this._onDidChangeDocument.fire({document:r.document,contentChanges:[],reason:void 0})}$acceptModelChanged(e,t,i){const r=y.revive(e),n=this._documentsAndEditors.getDocument(r);if(!n)throw new Error("unknown document");n._acceptIsDirty(i),n.onEvents(t);let s;t.isUndoing?s=Yl.Undo:t.isRedoing&&(s=Yl.Redo),this._onDidChangeDocument.fire(wx({document:n.document,contentChanges:t.changes.map(o=>({range:F.to(o.range),rangeOffset:o.rangeOffset,rangeLength:o.rangeLength,text:o.text})),reason:s}))}setWordDefinitionFor(e,t){WN(e,t)}},BF=class{constructor(e){this._provider=new Map,this._onDidChange=new P,this.onDidChange=this._onDidChange.event,this._allKnownModels=new Set,this._handlePool=0,this._proxy=e.getProxy(W.MainThreadEmbeddings)}registerEmbeddingsProvider(e,t,i){if(this._allKnownModels.has(t))throw new Error("An embeddings provider for this model is already registered");const r=this._handlePool++;return this._proxy.$registerEmbeddingProvider(r,t),this._provider.set(r,{id:t,provider:i}),ne(()=>{this._allKnownModels.delete(t),this._proxy.$unregisterEmbeddingProvider(r),this._provider.delete(r)})}async computeEmbeddings(e,t,i){i??=Xe.None;let r=!1;typeof t=="string"&&(t=[t],r=!0);const n=await this._proxy.$computeEmbeddings(e,t,i);if(n.length!==t.length)throw new Error;if(r){if(n.length!==1)throw new Error;return n[0]}return n}async $provideEmbeddings(e,t,i){const r=this._provider.get(e);if(!r)return[];const n=await r.provider.provideEmbeddings(t,i);return n||[]}get embeddingsModels(){return Array.from(this._allKnownModels)}$acceptEmbeddingModels(e){this._allKnownModels=new Set(e),this._onDidChange.fire()}},WF=class{constructor(e){this._AiEmbeddingVectorProviders=new Map,this._nextHandle=0,this._proxy=e.getProxy(W.MainThreadAiEmbeddingVector)}async $provideAiEmbeddingVector(e,t,i){if(this._AiEmbeddingVectorProviders.size===0)throw new Error("No embedding vector providers registered");const r=this._AiEmbeddingVectorProviders.get(e);if(!r)throw new Error("Embedding vector provider not found");const n=await r.provideEmbeddingVector(t,i);if(!n)throw new Error("Embedding vector provider returned undefined");return n}registerEmbeddingVectorProvider(e,t,i){const r=this._nextHandle;return this._nextHandle++,this._AiEmbeddingVectorProviders.set(r,i),this._proxy.$registerAiEmbeddingVectorProvider(t,r),new Ce(()=>{this._proxy.$unregisterAiEmbeddingVectorProvider(r),this._AiEmbeddingVectorProviders.delete(r)})}},Z5;(function(e){e[e.Invalid=0]="Invalid",e[e.Start=1]="Start",e[e.H=2]="H",e[e.HT=3]="HT",e[e.HTT=4]="HTT",e[e.HTTP=5]="HTTP",e[e.F=6]="F",e[e.FI=7]="FI",e[e.FIL=8]="FIL",e[e.BeforeColon=9]="BeforeColon",e[e.AfterColon=10]="AfterColon",e[e.AlmostThere=11]="AlmostThere",e[e.End=12]="End",e[e.Accept=13]="Accept",e[e.LastKnownState=14]="LastKnownState"})(Z5||(Z5={}));var VF=class{constructor(e,t,i){const r=new Uint8Array(e*t);for(let n=0,s=e*t;n<s;n++)r[n]=i;this._data=r,this.rows=e,this.cols=t}get(e,t){return this._data[e*this.cols+t]}set(e,t,i){this._data[e*this.cols+t]=i}},K5=class{constructor(e){let t=0,i=0;for(let n=0,s=e.length;n<s;n++){const[o,a,l]=e[n];a>t&&(t=a),o>i&&(i=o),l>i&&(i=l)}t++,i++;const r=new VF(i,t,0);for(let n=0,s=e.length;n<s;n++){const[o,a,l]=e[n];r.set(o,a,l)}this._states=r,this._maxCharCode=t}nextState(e,t){return t<0||t>=this._maxCharCode?0:this._states.get(e,t)}},N0=null;function zF(){return N0===null&&(N0=new K5([[1,104,2],[1,72,2],[1,102,6],[1,70,6],[2,116,3],[2,84,3],[3,116,4],[3,84,4],[4,112,5],[4,80,5],[5,115,9],[5,83,9],[5,58,10],[6,105,7],[6,73,7],[7,108,8],[7,76,8],[8,101,9],[8,69,9],[9,58,10],[10,47,11],[11,47,12]])),N0}var Y5;(function(e){e[e.None=0]="None",e[e.ForceTermination=1]="ForceTermination",e[e.CannotEndIn=2]="CannotEndIn"})(Y5||(Y5={}));var iu=null;function qF(){if(iu===null){iu=new KD(0);const e=` 	<>'"\u3001\u3002\uFF61\uFF64\uFF0C\uFF0E\uFF1A\uFF1B\u2018\u3008\u300C\u300E\u3014\uFF08\uFF3B\uFF5B\uFF62\uFF63\uFF5D\uFF3D\uFF09\u3015\u300F\u300D\u3009\u2019\uFF40\uFF5E\u2026`;for(let i=0;i<e.length;i++)iu.set(e.charCodeAt(i),1);const t=".,;:";for(let i=0;i<t.length;i++)iu.set(t.charCodeAt(i),2)}return iu}var jF=class Uw{static _createLink(t,i,r,n,s){let o=s-1;do{const a=i.charCodeAt(o);if(t.get(a)!==2)break;o--}while(o>n);if(n>0){const a=i.charCodeAt(n-1),l=i.charCodeAt(o);(a===40&&l===41||a===91&&l===93||a===123&&l===125)&&o--}return{range:{startLineNumber:r,startColumn:n+1,endLineNumber:r,endColumn:o+2},url:i.substring(n,o+1)}}static computeLinks(t,i=zF()){const r=qF(),n=[];for(let s=1,o=t.getLineCount();s<=o;s++){const a=t.getLineContent(s),l=a.length;let c=0,u=0,d=0,f=1,p=!1,m=!1,_=!1,b=!1;for(;c<l;){let E=!1;const C=a.charCodeAt(c);if(f===13){let T;switch(C){case 40:p=!0,T=0;break;case 41:T=p?0:1;break;case 91:_=!0,m=!0,T=0;break;case 93:_=!1,T=m?0:1;break;case 123:b=!0,T=0;break;case 125:T=b?0:1;break;case 39:case 34:case 96:d===C?T=1:d===39||d===34||d===96?T=0:T=1;break;case 42:T=d===42?1:0;break;case 124:T=d===124?1:0;break;case 32:T=_?0:1;break;default:T=r.get(C)}T===1&&(n.push(Uw._createLink(r,a,s,u,c)),E=!0)}else if(f===12){let T;C===91?(m=!0,T=0):T=r.get(C),T===1?E=!0:f=13}else f=i.nextState(f,C),f===0&&(E=!0);E&&(f=1,p=!1,m=!1,b=!1,u=c+1,d=C),c++}f===13&&n.push(Uw._createLink(r,a,s,u,l))}return n}},GF=class{constructor(){this._schemes=[]}add(e){this._stateMachine=void 0,this._schemes.push(e)}delete(e){const t=this._schemes.indexOf(e);t>=0&&(this._schemes.splice(t,1),this._stateMachine=void 0)}_initStateMachine(){if(!this._stateMachine){const e=this._schemes.sort(),t=[];let i,r,n=14,s=14;for(const o of e){let a=i?UP(i,o):0;for(a===0?r=1:r=s;a<o.length;a++)a+1===o.length?(n=s,s=9):s+=1,t.push([r,o.toUpperCase().charCodeAt(a),s]),t.push([r,o.toLowerCase().charCodeAt(a),s]),r=s;i=o,s=n}t.push([9,58,10]),t.push([10,47,12]),this._stateMachine=new K5(t)}}provideDocumentLinks(e){this._initStateMachine();const t=[],i=jF.computeLinks({getLineContent(r){return e.lineAt(r-1).text},getLineCount(){return e.lineCount}},this._stateMachine);for(const r of i){const n=Zs.to(r);n.target&&t.push(n)}return t}},QF=class Bw{constructor(t,i){this._extHostLanguageFeatures=i,this._linkProvider=new GF,this._fsProvider=new Map,this._registeredSchemes=new Set,this._watches=new Map,this._handlePool=0,this._proxy=t.getProxy(W.MainThreadFileSystem)}dispose(){this._linkProviderRegistration?.dispose()}registerFileSystemProvider(t,i,r,n={}){if(Bw._validateFileSystemProvider(r),this._registeredSchemes.has(i))throw new Error(`a provider for the scheme '${i}' is already registered`);this._linkProviderRegistration||(this._linkProviderRegistration=this._extHostLanguageFeatures.registerDocumentLinkProvider(t,"*",this._linkProvider));const s=this._handlePool++;this._linkProvider.add(i),this._registeredSchemes.add(i),this._fsProvider.set(s,r);let o=2;n.isCaseSensitive&&(o+=1024),n.isReadonly&&(o+=2048),typeof r.copy=="function"&&(o+=8),typeof r.open=="function"&&typeof r.close=="function"&&typeof r.read=="function"&&typeof r.write=="function"&&(N(t,"fsChunks"),o+=4);let a;n.isReadonly&&Kr(n.isReadonly)&&n.isReadonly.value!==""&&(a={value:n.isReadonly.value,isTrusted:n.isReadonly.isTrusted,supportThemeIcons:n.isReadonly.supportThemeIcons,supportHtml:n.isReadonly.supportHtml,baseUri:n.isReadonly.baseUri,uris:n.isReadonly.uris}),this._proxy.$registerFileSystemProvider(s,i,o,a).catch(c=>{console.error(`FAILED to register filesystem provider of ${t.identifier.value}-extension for the scheme ${i}`),console.error(c)});const l=r.onDidChangeFile(c=>{const u=[];for(const d of c){const{uri:f,type:p}=d;if(f.scheme!==i)continue;let m;switch(p){case ha.Changed:m=0;break;case ha.Created:m=1;break;case ha.Deleted:m=2;break;default:throw new Error("Unknown FileChangeType")}u.push({resource:f,type:m})}this._proxy.$onFileSystemChange(s,u)});return ne(()=>{l.dispose(),this._linkProvider.delete(i),this._registeredSchemes.delete(i),this._fsProvider.delete(s),this._proxy.$unregisterProvider(s)})}static _validateFileSystemProvider(t){if(!t)throw new Error("MISSING provider");if(typeof t.watch!="function")throw new Error("Provider does NOT implement watch");if(typeof t.stat!="function")throw new Error("Provider does NOT implement stat");if(typeof t.readDirectory!="function")throw new Error("Provider does NOT implement readDirectory");if(typeof t.createDirectory!="function")throw new Error("Provider does NOT implement createDirectory");if(typeof t.readFile!="function")throw new Error("Provider does NOT implement readFile");if(typeof t.writeFile!="function")throw new Error("Provider does NOT implement writeFile");if(typeof t.delete!="function")throw new Error("Provider does NOT implement delete");if(typeof t.rename!="function")throw new Error("Provider does NOT implement rename")}static _asIStat(t){const{type:i,ctime:r,mtime:n,size:s,permissions:o}=t;return{type:i,ctime:r,mtime:n,size:s,permissions:o}}$stat(t,i){return Promise.resolve(this._getFsProvider(t).stat(y.revive(i))).then(r=>Bw._asIStat(r))}$readdir(t,i){return Promise.resolve(this._getFsProvider(t).readDirectory(y.revive(i)))}$readFile(t,i){return Promise.resolve(this._getFsProvider(t).readFile(y.revive(i))).then(r=>ae.wrap(r))}$writeFile(t,i,r,n){return Promise.resolve(this._getFsProvider(t).writeFile(y.revive(i),r.buffer,n))}$delete(t,i,r){return Promise.resolve(this._getFsProvider(t).delete(y.revive(i),r))}$rename(t,i,r,n){return Promise.resolve(this._getFsProvider(t).rename(y.revive(i),y.revive(r),n))}$copy(t,i,r,n){const s=this._getFsProvider(t);if(!s.copy)throw new Error('FileSystemProvider does not implement "copy"');return Promise.resolve(s.copy(y.revive(i),y.revive(r),n))}$mkdir(t,i){return Promise.resolve(this._getFsProvider(t).createDirectory(y.revive(i)))}$watch(t,i,r,n){const s=this._getFsProvider(t).watch(y.revive(r),n);this._watches.set(i,s)}$unwatch(t,i){const r=this._watches.get(i);r&&(r.dispose(),this._watches.delete(i))}$open(t,i,r){const n=this._getFsProvider(t);if(!n.open)throw new Error('FileSystemProvider does not implement "open"');return Promise.resolve(n.open(y.revive(i),r))}$close(t,i){const r=this._getFsProvider(t);if(!r.close)throw new Error('FileSystemProvider does not implement "close"');return Promise.resolve(r.close(i))}$read(t,i,r,n){const s=this._getFsProvider(t);if(!s.read)throw new Error('FileSystemProvider does not implement "read"');const o=ae.alloc(n);return Promise.resolve(s.read(i,r,o.buffer,0,n)).then(a=>o.slice(0,a))}$write(t,i,r,n){const s=this._getFsProvider(t);if(!s.write)throw new Error('FileSystemProvider does not implement "write"');return Promise.resolve(s.write(i,r,n.buffer,0,n.byteLength))}_getFsProvider(t){const i=this._fsProvider.get(t);if(!i){const r=new Error;throw r.name="ENOPRO",r.message="no provider",r}return i}},eQ=class m7 extends se{static{this.MAX_RESTARTS=5}constructor(t,i,r,n){super(),this.onFileChanges=t,this.onLogMessage=i,this.verboseLogging=r,this.options=n,this.watcherDisposables=this._register(new Cn),this.requests=void 0,this.restartCounter=0}init(){const t=new he;this.watcherDisposables.value=t,this.watcher=this.createWatcher(t),this.watcher.setVerboseLogging(this.verboseLogging),t.add(this.watcher.onDidChangeFile(i=>this.onFileChanges(i))),t.add(this.watcher.onDidLogMessage(i=>this.onLogMessage(i))),t.add(this.watcher.onDidError(i=>this.onError(i.error,i.request)))}onError(t,i){this.canRestart(t,i)?this.restartCounter<m7.MAX_RESTARTS&&this.requests?(this.error(`restarting watcher after unexpected error: ${t}`),this.restart(this.requests)):this.error(`gave up attempting to restart watcher after unexpected error: ${t}`):this.error(t)}canRestart(t,i){return!(!this.options.restartOnError||i||t.indexOf("No space left on device")!==-1||t.indexOf("EMFILE")!==-1)}restart(t){this.restartCounter++,this.init(),this.watch(t)}async watch(t){this.requests=t,await this.watcher?.watch(t)}async setVerboseLogging(t){this.verboseLogging=t,await this.watcher?.setVerboseLogging(t)}error(t){this.onLogMessage({type:"error",message:`[File Watcher (${this.options.type})] ${t}`})}trace(t){this.onLogMessage({type:"trace",message:`[File Watcher (${this.options.type})] ${t}`})}dispose(){return this.watcher=void 0,super.dispose()}};function JF(e,t){return typeof t=="string"&&!t.startsWith(ks)&&!Bu(t)?{base:e,pattern:t}:t}var XF=class{get ignoreCreateEvents(){return!!(this._config&1)}get ignoreChangeEvents(){return!!(this._config&2)}get ignoreDeleteEvents(){return!!(this._config&4)}constructor(e,t,i,r,n,s,o){this.session=Math.random(),this._onDidCreate=new P,this._onDidChange=new P,this._onDidDelete=new P,this._config=0,o.ignoreCreateEvents&&(this._config+=1),o.ignoreChangeEvents&&(this._config+=2),o.ignoreDeleteEvents&&(this._config+=4);const a=zo(s),l=typeof s=="string",c=!1,u=n(d=>{if(!(typeof d.session=="number"&&d.session!==this.session)&&!(c&&typeof d.session>"u")){if(!o.ignoreCreateEvents)for(const f of d.created){const p=y.revive(f);a(p.fsPath)&&(!l||i.getWorkspaceFolder(p))&&this._onDidCreate.fire(p)}if(!o.ignoreChangeEvents)for(const f of d.changed){const p=y.revive(f);a(p.fsPath)&&(!l||i.getWorkspaceFolder(p))&&this._onDidChange.fire(p)}if(!o.ignoreDeleteEvents)for(const f of d.deleted){const p=y.revive(f);a(p.fsPath)&&(!l||i.getWorkspaceFolder(p))&&this._onDidDelete.fire(p)}}});this._disposable=Ce.from(this.ensureWatching(e,i,t,r,s,o,!1),this._onDidCreate,this._onDidChange,this._onDidDelete,u)}ensureWatching(e,t,i,r,n,s,o){const a=Ce.from();if(typeof n=="string"||s.ignoreChangeEvents&&s.ignoreCreateEvents&&s.ignoreDeleteEvents)return a;const l=e.getProxy(W.MainThreadFileSystemEventService);let c=!1;(n.pattern.includes(ks)||n.pattern.includes(Lm))&&(c=!0);const u=[];let d,f;if(o)(s.ignoreChangeEvents||s.ignoreCreateEvents||s.ignoreDeleteEvents)&&(f=14,s.ignoreChangeEvents&&(f&=-3),s.ignoreCreateEvents&&(f&=-5),s.ignoreDeleteEvents&&(f&=-9));else if(c&&u.length===0){const p=t.getWorkspaceFolder(y.revive(n.baseUri)),m=i.getConfiguration("files",p).get("watcherExclude");if(m)for(const _ in m)_&&m[_]===!0&&u.push(_)}else if(!c){const p=t.getWorkspaceFolder(y.revive(n.baseUri));if(p){const m=i.getConfiguration("files",p).get("watcherExclude");if(m){for(const _ in m)if(_&&m[_]===!0){const b=`${Cg(_,"/")}/${ks}`;d||(d=[]),d.push(JF(p.uri.fsPath,b))}}if(!d||d.length===0)return a}}return l.$watch(r.identifier.value,this.session,n.baseUri,{recursive:c,excludes:u,includes:d,filter:f},!!o),Ce.from({dispose:()=>l.$unwatch(this.session)})}dispose(){this._disposable.dispose()}get onDidCreate(){return this._onDidCreate.event}get onDidChange(){return this._onDidChange.event}get onDidDelete(){return this._onDidDelete.event}},ZF=class{get created(){return this._created.value}get changed(){return this._changed.value}get deleted(){return this._deleted.value}constructor(e){this._events=e,this._created=new Ci(()=>this._events.created.map(y.revive)),this._changed=new Ci(()=>this._events.changed.map(y.revive)),this._deleted=new Ci(()=>this._events.deleted.map(y.revive)),this.session=this._events.session}},KF=class{constructor(e,t,i){this._mainContext=e,this._logService=t,this._extHostDocumentsAndEditors=i,this._onFileSystemEvent=new P,this._onDidRenameFile=new P,this._onDidCreateFile=new P,this._onDidDeleteFile=new P,this._onWillRenameFile=new nl,this._onWillCreateFile=new nl,this._onWillDeleteFile=new nl,this.onDidRenameFile=this._onDidRenameFile.event,this.onDidCreateFile=this._onDidCreateFile.event,this.onDidDeleteFile=this._onDidDeleteFile.event}createFileSystemWatcher(e,t,i,r,n){return new XF(this._mainContext,t,e,i,this._onFileSystemEvent.event,Li.from(r),n)}$onFileEvent(e){this._onFileSystemEvent.fire(new ZF(e))}$onDidRunFileOperation(e,t){switch(e){case 2:this._onDidRenameFile.fire(Object.freeze({files:t.map(i=>({oldUri:y.revive(i.source),newUri:y.revive(i.target)}))}));break;case 1:this._onDidDeleteFile.fire(Object.freeze({files:t.map(i=>y.revive(i.target))}));break;case 0:case 3:this._onDidCreateFile.fire(Object.freeze({files:t.map(i=>y.revive(i.target))}));break;default:}}getOnWillRenameFileEvent(e){return this._createWillExecuteEvent(e,this._onWillRenameFile)}getOnWillCreateFileEvent(e){return this._createWillExecuteEvent(e,this._onWillCreateFile)}getOnWillDeleteFileEvent(e){return this._createWillExecuteEvent(e,this._onWillDeleteFile)}_createWillExecuteEvent(e,t){return(i,r,n)=>{const s=function(a){i.call(r,a)};return s.extension=e,t.event(s,void 0,n)}}async $onWillRunFileOperation(e,t,i,r){switch(e){case 2:return await this._fireWillEvent(this._onWillRenameFile,{files:t.map(n=>({oldUri:y.revive(n.source),newUri:y.revive(n.target)}))},i,r);case 1:return await this._fireWillEvent(this._onWillDeleteFile,{files:t.map(n=>y.revive(n.target))},i,r);case 0:case 3:return await this._fireWillEvent(this._onWillCreateFile,{files:t.map(n=>y.revive(n.target))},i,r)}}async _fireWillEvent(e,t,i,r){const n=new Set,s=[];if(await e.fireAsync(t,r,async(a,l)=>{const c=Date.now(),u=await Promise.resolve(a);u instanceof Ns&&(s.push([l.extension,u]),n.add(l.extension.displayName??l.extension.identifier.value)),Date.now()-c>i&&this._logService.warn("SLOW file-participant",l.extension.identifier)}),r.isCancellationRequested||s.length===0)return;const o={edits:[]};for(const[,a]of s){const{edits:l}=Ri.from(a,{getTextDocumentVersion:c=>this._extHostDocumentsAndEditors.getDocument(c)?.version,getNotebookDocumentVersion:()=>{}});o.edits=o.edits.concat(l)}return{edit:o,extensionNames:Array.from(n)}}},YF=class{constructor(e,t,i,r,n){this._extHostNotebooks=t,this._textDocumentsAndEditors=i,this._commands=r;const s=new fe("interactive.open","_interactive.open","Open interactive window and return notebook editor and input URI",[new $("showOptions","Show Options",o=>!0,o=>o),new $("resource","Interactive resource Uri",o=>!0,o=>o),new $("controllerId","Notebook controller Id",o=>!0,o=>o),new $("title","Interactive editor title",o=>!0,o=>o)],new de("Notebook and input URI",o=>{if(n.debug("[ExtHostInteractive] open iw with notebook editor id",o.notebookEditorId),o.notebookEditorId!==void 0){const a=this._extHostNotebooks.getEditorById(o.notebookEditorId);return n.debug("[ExtHostInteractive] notebook editor found",a.id),{notebookUri:y.revive(o.notebookUri),inputUri:y.revive(o.inputUri),notebookEditor:a.apiEditor}}return n.debug("[ExtHostInteractive] notebook editor not found, uris for the interactive document",o.notebookUri,o.inputUri),{notebookUri:y.revive(o.notebookUri),inputUri:y.revive(o.inputUri)}}));this._commands.registerApiCommand(s)}$willAddInteractiveDocument(e,t,i,r){this._textDocumentsAndEditors.acceptDocumentsAndEditorsDelta({addedDocuments:[{EOL:t,lines:[""],languageId:i,uri:e,isDirty:!1,versionId:1,encoding:"utf8"}]})}$willRemoveInteractiveDocument(e,t){this._textDocumentsAndEditors.acceptDocumentsAndEditorsDelta({removedDocuments:[e]})}},e$=class{constructor(e){this._handlePool=0,this._proxy=e.getProxy(W.MainThreadLabelService)}$registerResourceLabelFormatter(e){const t=this._handlePool++;return this._proxy.$registerResourceLabelFormatter(t,e),ne(()=>{this._proxy.$unregisterResourceLabelFormatter(t)})}},ek;(function(e){e[e.LTR=0]="LTR",e[e.RTL=1]="RTL"})(ek||(ek={}));var t$=class er extends Fe{constructor(t,i,r,n){super(t,i,r,n),this.selectionStartLineNumber=t,this.selectionStartColumn=i,this.positionLineNumber=r,this.positionColumn=n}toString(){return"["+this.selectionStartLineNumber+","+this.selectionStartColumn+" -> "+this.positionLineNumber+","+this.positionColumn+"]"}equalsSelection(t){return er.selectionsEqual(this,t)}static selectionsEqual(t,i){return t.selectionStartLineNumber===i.selectionStartLineNumber&&t.selectionStartColumn===i.selectionStartColumn&&t.positionLineNumber===i.positionLineNumber&&t.positionColumn===i.positionColumn}getDirection(){return this.selectionStartLineNumber===this.startLineNumber&&this.selectionStartColumn===this.startColumn?0:1}setEndPosition(t,i){return this.getDirection()===0?new er(this.startLineNumber,this.startColumn,t,i):new er(t,i,this.startLineNumber,this.startColumn)}getPosition(){return new Bi(this.positionLineNumber,this.positionColumn)}getSelectionStart(){return new Bi(this.selectionStartLineNumber,this.selectionStartColumn)}setStartPosition(t,i){return this.getDirection()===0?new er(t,i,this.endLineNumber,this.endColumn):new er(this.endLineNumber,this.endColumn,t,i)}static fromPositions(t,i=t){return new er(t.lineNumber,t.column,i.lineNumber,i.column)}static fromRange(t,i){return i===0?new er(t.startLineNumber,t.startColumn,t.endLineNumber,t.endColumn):new er(t.endLineNumber,t.endColumn,t.startLineNumber,t.startColumn)}static liftSelection(t){return new er(t.selectionStartLineNumber,t.selectionStartColumn,t.positionLineNumber,t.positionColumn)}static selectionsArrEqual(t,i){if(t&&!i||!t&&i)return!1;if(!t&&!i)return!0;if(t.length!==i.length)return!1;for(let r=0,n=t.length;r<n;r++)if(!this.selectionsEqual(t[r],i[r]))return!1;return!0}static isISelection(t){return t&&typeof t.selectionStartLineNumber=="number"&&typeof t.selectionStartColumn=="number"&&typeof t.positionLineNumber=="number"&&typeof t.positionColumn=="number"}static createWithDirection(t,i,r,n,s){return s===0?new er(t,i,r,n):new er(r,n,t,i)}},tk=class v7{constructor(t,i){this._documents=t,this._provider=i}async provideDocumentSymbols(t,i){const r=this._documents.getDocument(t),n=await this._provider.provideDocumentSymbols(r,i);if(!tg(n))return n[0]instanceof Gl?n.map(v1.from):v7._asDocumentSymbolTree(n)}static _asDocumentSymbolTree(t){t=t.slice(0).sort((n,s)=>{let o=n.location.range.start.compareTo(s.location.range.start);return o===0&&(o=s.location.range.end.compareTo(n.location.range.end)),o});const i=[],r=[];for(const n of t){const s={name:n.name||"!!MISSING: name!!",kind:Xi.from(n.kind),tags:n.tags?.map(un.from)||[],detail:"",containerName:n.containerName,range:F.from(n.location.range),selectionRange:F.from(n.location.range),children:[]};for(;;){if(r.length===0){r.push(s),i.push(s);break}const o=r[r.length-1];if(Fe.containsRange(o.range,s.range)&&!Fe.equalsRange(o.range,s.range)){o.children?.push(s),r.push(s);break}r.pop()}}return i}},dp=class{constructor(e,t,i,r,n,s){this._documents=e,this._commands=t,this._provider=i,this._extension=r,this._extTelemetry=n,this._logService=s,this._cache=new _r("CodeLens"),this._disposables=new Map}async provideCodeLenses(e,t){const i=this._documents.getDocument(e),r=await this._provider.provideCodeLenses(i,t);if(!r||t.isCancellationRequested)return;const n=this._cache.add(r),s=new he;this._disposables.set(n,s);const o={cacheId:n,lenses:[]};for(let a=0;a<r.length;a++){if(!ye.isRange(r[a].range)){console.warn("INVALID code lens, range is not defined",this._extension.identifier.value);continue}o.lenses.push({cacheId:[n,a],range:F.from(r[a].range),command:this._commands.toInternal(r[a].command,s)})}return o}async resolveCodeLens(e,t){const i=e.cacheId&&this._cache.get(...e.cacheId);if(!i)return;let r;if(typeof this._provider.resolveCodeLens!="function"||i.isResolved?r=i:r=await this._provider.resolveCodeLens(i,t),r||(r=i),t.isCancellationRequested)return;const n=e.cacheId&&this._disposables.get(e.cacheId[0]);if(n){if(!r.command){const s=new Error("INVALID code lens resolved, lacks command: "+this._extension.identifier.value);this._extTelemetry.onExtensionError(this._extension.identifier,s),this._logService.error(s);return}return e.command=this._commands.toInternal(r.command,n),e}}releaseCodeLenses(e){this._disposables.get(e)?.dispose(),this._disposables.delete(e),this._cache.delete(e)}};function hp(e){return Array.isArray(e)?e.map(Sc.from):e?[Sc.from(e)]:[]}var ik=class{constructor(e,t){this._documents=e,this._provider=t}async provideDefinition(e,t,i){const r=this._documents.getDocument(e),n=Be.to(t),s=await this._provider.provideDefinition(r,n,i);return hp(s)}},rk=class{constructor(e,t){this._documents=e,this._provider=t}async provideDeclaration(e,t,i){const r=this._documents.getDocument(e),n=Be.to(t),s=await this._provider.provideDeclaration(r,n,i);return hp(s)}},nk=class{constructor(e,t){this._documents=e,this._provider=t}async provideImplementation(e,t,i){const r=this._documents.getDocument(e),n=Be.to(t),s=await this._provider.provideImplementation(r,n,i);return hp(s)}},sk=class{constructor(e,t){this._documents=e,this._provider=t}async provideTypeDefinition(e,t,i){const r=this._documents.getDocument(e),n=Be.to(t),s=await this._provider.provideTypeDefinition(r,n,i);return hp(s)}},M0=class _7{static{this.HOVER_MAP_MAX_SIZE=10}constructor(t,i){this._documents=t,this._provider=i,this._hoverCounter=0,this._hoverMap=new Map}async provideHover(t,i,r,n){const s=this._documents.getDocument(t),o=Be.to(i);let a;if(r&&r.verbosityRequest){const d=r.verbosityRequest.previousHover.id,f=this._hoverMap.get(d);if(!f)throw new Error(`Hover with id ${d} not found`);const p={verbosityDelta:r.verbosityRequest.verbosityDelta,previousHover:f};a=await this._provider.provideHover(s,o,n,p)}else a=await this._provider.provideHover(s,o,n);if(!a||tg(a.contents))return;a.range||(a.range=s.getWordRangeAtPosition(o)),a.range||(a.range=new ye(o,o));const l=Ec.from(a),c=this._hoverCounter;if(this._hoverMap.size===_7.HOVER_MAP_MAX_SIZE){const d=Math.min(...this._hoverMap.keys());this._hoverMap.delete(d)}return this._hoverMap.set(c,a),this._hoverCounter+=1,{...l,id:c}}releaseHover(t){this._hoverMap.delete(t)}},ok=class{constructor(e,t){this._documents=e,this._provider=t}async provideEvaluatableExpression(e,t,i){const r=this._documents.getDocument(e),n=Be.to(t),s=await this._provider.provideEvaluatableExpression(r,n,i);if(s)return y1.from(s)}},ak=class{constructor(e,t){this._documents=e,this._provider=t}async provideInlineValues(e,t,i,r){const n=this._documents.getDocument(e),s=await this._provider.provideInlineValues(n,F.to(t),sf.to(i),r);if(Array.isArray(s))return s.map(o=>nf.from(o))}},lk=class{constructor(e,t){this._documents=e,this._provider=t}async provideDocumentHighlights(e,t,i){const r=this._documents.getDocument(e),n=Be.to(t),s=await this._provider.provideDocumentHighlights(r,n,i);if(Array.isArray(s))return s.map(ba.from)}},ck=class{constructor(e,t,i){this._documents=e,this._provider=t,this._logService=i}async provideMultiDocumentHighlights(e,t,i,r){const n=this._documents.getDocument(e),s=i.map(l=>{try{return this._documents.getDocument(l)}catch(c){this._logService.error("Error: Unable to retrieve document from URI: "+l+". Error message: "+c);return}}).filter(l=>l!==void 0),o=Be.to(t),a=await this._provider.provideMultiDocumentHighlights(n,o,s,r);if(Array.isArray(a))return a.map(b1.from)}},uk=class{constructor(e,t){this._documents=e,this._provider=t}async provideLinkedEditingRanges(e,t,i){const r=this._documents.getDocument(e),n=Be.to(t),s=await this._provider.provideLinkedEditingRanges(r,n,i);if(s&&Array.isArray(s.ranges))return{ranges:xt(s.ranges.map(F.from)),wordPattern:s.wordPattern}}},dk=class{constructor(e,t){this._documents=e,this._provider=t}async provideReferences(e,t,i,r){const n=this._documents.getDocument(e),s=Be.to(t),o=await this._provider.provideReferences(n,s,i,r);if(Array.isArray(o))return o.map(vi.from)}},fp=class qp{static{this._maxCodeActionsPerFile=1e3}constructor(t,i,r,n,s,o,a){this._documents=t,this._commands=i,this._diagnostics=r,this._provider=n,this._logService=s,this._extension=o,this._apiDeprecation=a,this._cache=new _r("CodeAction"),this._disposables=new Map}async provideCodeActions(t,i,r,n){const s=this._documents.getDocument(t),o=t$.isISelection(i)?fr.to(i):F.to(i),a=[];for(const p of this._diagnostics.getDiagnostics(t))if(o.intersection(p.range)&&a.push(p)>qp._maxCodeActionsPerFile)break;const l={diagnostics:a,only:r.only?new dt(r.only):void 0,triggerKind:O1.to(r.trigger)},c=await this._provider.provideCodeActions(s,o,l,n);if(!yo(c)||n.isCancellationRequested)return;const u=this._cache.add(c),d=new he;this._disposables.set(u,d);const f=[];for(let p=0;p<c.length;p++){const m=c[p];if(m)if(qp._isCommand(m)&&!(m instanceof Jl))this._apiDeprecation.report("CodeActionProvider.provideCodeActions - return commands",this._extension,"Return 'CodeAction' instances instead."),f.push({_isSynthetic:!0,title:m.title,command:this._commands.toInternal(m,d)});else{const _=m;l.only&&(_.kind?l.only.contains(_.kind)||this._logService.warn(`${this._extension.identifier.value} - Code actions of kind '${l.only.value}' requested but returned code action is of kind '${_.kind.value}'. Code action will be dropped. Please check 'CodeActionContext.only' to only return requested code actions.`):this._logService.warn(`${this._extension.identifier.value} - Code actions of kind '${l.only.value}' requested but returned code action does not have a 'kind'. Code action will be dropped. Please set 'CodeAction.kind'.`));const b=_.ranges??[];f.push({cacheId:[u,p],title:_.title,command:_.command&&this._commands.toInternal(_.command,d),diagnostics:_.diagnostics&&_.diagnostics.map(wa.from),edit:_.edit&&Ri.from(_.edit,void 0),kind:_.kind&&_.kind.value,isPreferred:_.isPreferred,isAI:Ke(this._extension,"codeActionAI")?_.isAI:!1,ranges:Ke(this._extension,"codeActionRanges")?xt(b.map(F.from)):void 0,disabled:_.disabled?.reason})}}return{cacheId:u,actions:f}}async resolveCodeAction(t,i){const[r,n]=t,s=this._cache.get(r,n);if(!s||qp._isCommand(s))return{};if(!this._provider.resolveCodeAction)return{};const o=await this._provider.resolveCodeAction(s,i)??s;let a;o.edit&&(a=Ri.from(o.edit,void 0));let l;if(o.command){const c=this._disposables.get(r);c&&(l=this._commands.toInternal(o.command,c))}return{edit:a,command:l}}releaseCodeActions(t){this._disposables.get(t)?.dispose(),this._disposables.delete(t),this._cache.delete(t)}static _isCommand(t){return typeof t.command=="string"&&typeof t.title=="string"}},ru=class{constructor(e,t,i,r,n){this._proxy=e,this._documents=t,this._provider=i,this._handle=r,this._extension=n,this._editsCache=new _r("DocumentPasteEdit.edits")}async prepareDocumentPaste(e,t,i,r){if(!this._provider.prepareDocumentPaste)return;this._cachedPrepare=void 0;const n=this._documents.getDocument(e),s=t.map(u=>F.to(u)),o=Ta.toDataTransfer(i,()=>{throw new t9});if(await this._provider.prepareDocumentPaste(n,s,o,r),r.isCancellationRequested)return;const a=Array.from(o).filter(([,u])=>!(u instanceof _h)),l=new Map,c=await Promise.all(Array.from(a,async([u,d])=>{const f=$t();return l.set(f,d),[u,await Ys.from(u,d,f)]}));return this._cachedPrepare=l,{items:c}}async providePasteEdits(e,t,i,r,n,s){if(!this._provider.provideDocumentPasteEdits)return[];const o=this._documents.getDocument(t),a=i.map(f=>F.to(f)),l=r.items.map(([f,p])=>{const m=this._cachedPrepare?.get(p.id);return m?[f,m]:[f,Ys.to(f,p,async _=>(await this._proxy.$resolvePasteFileData(this._handle,e,_)).buffer)]}),c=new la(l),u=await this._provider.provideDocumentPasteEdits(o,a,c,{only:n.only?new Wn(n.only):void 0,triggerKind:n.triggerKind},s);if(!u||s.isCancellationRequested)return[];const d=this._editsCache.add(u);return u.map((f,p)=>({_cacheId:[d,p],title:f.title??h(2927,null,this._extension.displayName||this._extension.name),kind:f.kind,yieldTo:f.yieldTo?.map(m=>m.value),insertText:typeof f.insertText=="string"?f.insertText:{snippet:f.insertText.value},additionalEdit:f.additionalEdit?Ri.from(f.additionalEdit,void 0):void 0}))}async resolvePasteEdit(e,t){const[i,r]=e,n=this._editsCache.get(i,r);if(!n||!this._provider.resolveDocumentPasteEdit)return{};const s=await this._provider.resolveDocumentPasteEdit(n,t)??n;return{insertText:s.insertText,additionalEdit:s.additionalEdit?Ri.from(s.additionalEdit,void 0):void 0}}releasePasteEdits(e){this._editsCache.delete(e)}},hk=class{constructor(e,t){this._documents=e,this._provider=t}async provideDocumentFormattingEdits(e,t,i){const r=this._documents.getDocument(e),n=await this._provider.provideDocumentFormattingEdits(r,t,i);if(Array.isArray(n))return n.map(Lt.from)}},O0=class{constructor(e,t){this._documents=e,this._provider=t}async provideDocumentRangeFormattingEdits(e,t,i,r){const n=this._documents.getDocument(e),s=F.to(t),o=await this._provider.provideDocumentRangeFormattingEdits(n,s,i,r);if(Array.isArray(o))return o.map(Lt.from)}async provideDocumentRangesFormattingEdits(e,t,i,r){ly(typeof this._provider.provideDocumentRangesFormattingEdits=="function","INVALID invocation of `provideDocumentRangesFormattingEdits`");const n=this._documents.getDocument(e),s=t.map(F.to),o=await this._provider.provideDocumentRangesFormattingEdits(n,s,i,r);if(Array.isArray(o))return o.map(Lt.from)}},fk=class{constructor(e,t){this._documents=e,this._provider=t,this.autoFormatTriggerCharacters=[]}async provideOnTypeFormattingEdits(e,t,i,r,n){const s=this._documents.getDocument(e),o=Be.to(t),a=await this._provider.provideOnTypeFormattingEdits(s,o,i,r,n);if(Array.isArray(a))return a.map(Lt.from)}},pp=class{constructor(e,t){this._provider=e,this._logService=t,this._cache=new _r("WorkspaceSymbols")}async provideWorkspaceSymbols(e,t){const i=await this._provider.provideWorkspaceSymbols(e,t);if(!yo(i))return{symbols:[]};const r=this._cache.add(i),n={cacheId:r,symbols:[]};for(let s=0;s<i.length;s++){const o=i[s];if(!o||!o.name){this._logService.warn("INVALID SymbolInformation",o);continue}n.symbols.push({...Js.from(o),cacheId:[r,s]})}return n}async resolveWorkspaceSymbol(e,t){if(typeof this._provider.resolveWorkspaceSymbol!="function"||!e.cacheId)return e;const i=this._cache.get(...e.cacheId);if(i){const r=await this._provider.resolveWorkspaceSymbol(i,t);return r&&ys(e,Js.from(r),!0)}}releaseWorkspaceSymbols(e){this._cache.delete(e)}},gp=class Ww{static supportsResolving(t){return typeof t.prepareRename=="function"}constructor(t,i,r){this._documents=t,this._provider=i,this._logService=r}async provideRenameEdits(t,i,r,n){const s=this._documents.getDocument(t),o=Be.to(i);try{const a=await this._provider.provideRenameEdits(s,o,r,n);return a?Ri.from(a):void 0}catch(a){const l=Ww._asMessage(a);return l?{rejectReason:l,edits:void 0}:Promise.reject(a)}}async resolveRenameLocation(t,i,r){if(typeof this._provider.prepareRename!="function")return Promise.resolve(void 0);const n=this._documents.getDocument(t),s=Be.to(i);try{const o=await this._provider.prepareRename(n,s,r);let a,l;if(ye.isRange(o)?(a=o,l=n.getText(o)):St(o)&&(a=o.range,l=o.placeholder),!a||!l)return;if(a.start.line>s.line||a.end.line<s.line){this._logService.warn("INVALID rename location: position line must be within range start/end lines");return}return{range:F.from(a),text:l}}catch(o){const a=Ww._asMessage(o);return a?{rejectReason:a,range:void 0,text:void 0}:Promise.reject(o)}}static _asMessage(t){return typeof t=="string"?t:t instanceof Error&&typeof t.message=="string"?t.message:void 0}},F0=class Vw{static{this.languageTriggerKindToVSCodeTriggerKind={[pd.Invoke]:oc.Invoke,[pd.Automatic]:oc.Automatic}}constructor(t,i,r){this._documents=t,this._provider=i,this._logService=r}async supportsAutomaticNewSymbolNamesTriggerKind(){return this._provider.supportsAutomaticTriggerKind}async provideNewSymbolNames(t,i,r,n){const s=this._documents.getDocument(t),o=F.to(i);try{const a=Vw.languageTriggerKindToVSCodeTriggerKind[r],l=await this._provider.provideNewSymbolNames(s,o,a,n);return l?l.map(c=>typeof c=="string"?{newSymbolName:c}:{newSymbolName:c.newSymbolName,tags:c.tags}):void 0}catch(a){this._logService.error(Vw._asMessage(a)??JSON.stringify(a,null,"	"));return}}static _asMessage(t){return typeof t=="string"?t:t instanceof Error&&typeof t.message=="string"?t.message:void 0}},$0=class{constructor(e,t){this.resultId=e,this.tokens=t}},H0=class yr{constructor(t,i){this._documents=t,this._provider=i,this._nextResultId=1,this._previousResults=new Map}async provideDocumentSemanticTokens(t,i,r){const n=this._documents.getDocument(t),s=i!==0?this._previousResults.get(i):null;let o=typeof s?.resultId=="string"&&typeof this._provider.provideDocumentSemanticTokensEdits=="function"?await this._provider.provideDocumentSemanticTokensEdits(n,s.resultId,r):await this._provider.provideDocumentSemanticTokens(n,r);return s&&this._previousResults.delete(i),o?(o=yr._fixProvidedSemanticTokens(o),this._send(yr._convertToEdits(s,o),o)):null}async releaseDocumentSemanticColoring(t){this._previousResults.delete(t)}static _fixProvidedSemanticTokens(t){return yr._isSemanticTokens(t)?yr._isCorrectSemanticTokens(t)?t:new fa(new Uint32Array(t.data),t.resultId):yr._isSemanticTokensEdits(t)?yr._isCorrectSemanticTokensEdits(t)?t:new Dh(t.edits.map(i=>new y4(i.start,i.deleteCount,i.data?new Uint32Array(i.data):i.data)),t.resultId):t}static _isSemanticTokens(t){return t&&!!t.data}static _isCorrectSemanticTokens(t){return t.data instanceof Uint32Array}static _isSemanticTokensEdits(t){return t&&Array.isArray(t.edits)}static _isCorrectSemanticTokensEdits(t){for(const i of t.edits)if(!(i.data instanceof Uint32Array))return!1;return!0}static _convertToEdits(t,i){if(!yr._isSemanticTokens(i)||!t||!t.tokens)return i;const r=t.tokens,n=r.length,s=i.data,o=s.length;let a=0;const l=Math.min(n,o);for(;a<l&&r[a]===s[a];)a++;if(a===n&&a===o)return new Dh([],i.resultId);let c=0;const u=l-a;for(;c<u&&r[n-c-1]===s[o-c-1];)c++;return new Dh([{start:a,deleteCount:n-a-c,data:s.subarray(a,o-c)}],i.resultId)}_send(t,i){if(yr._isSemanticTokens(t)){const r=this._nextResultId++;return this._previousResults.set(r,new $0(t.resultId,t.data)),P0({id:r,type:"full",data:t.data})}if(yr._isSemanticTokensEdits(t)){const r=this._nextResultId++;return yr._isSemanticTokens(i)?this._previousResults.set(r,new $0(i.resultId,i.data)):this._previousResults.set(r,new $0(t.resultId)),P0({id:r,type:"delta",deltas:(t.edits||[]).map(n=>({start:n.start,deleteCount:n.deleteCount,data:n.data}))})}return null}},pk=class{constructor(e,t){this._documents=e,this._provider=t}async provideDocumentRangeSemanticTokens(e,t,i){const r=this._documents.getDocument(e),n=await this._provider.provideDocumentRangeSemanticTokens(r,F.to(t),i);return n?this._send(n):null}_send(e){return P0({id:0,type:"full",data:e.data})}},nu=class w7{static supportsResolving(t){return typeof t.resolveCompletionItem=="function"}constructor(t,i,r,n,s){this._documents=t,this._commands=i,this._provider=r,this._apiDeprecation=n,this._extension=s,this._cache=new _r("CompletionItem"),this._disposables=new Map}async provideCompletionItems(t,i,r,n){const s=this._documents.getDocument(t),o=Be.to(i),a=s.getWordRangeAtPosition(o)||new ye(o,o),l=a.with({end:o}),c=new us,u=await this._provider.provideCompletionItems(s,o,n,S1.to(r));if(!u||n.isCancellationRequested)return;const d=Array.isArray(u)?new ea(u):u,f=w7.supportsResolving(this._provider)?this._cache.add(d.items):this._cache.add([]),p=new he;this._disposables.set(f,p);const m=[],_={x:f,b:m,a:{replace:F.from(a),insert:F.from(l)},c:d.isIncomplete||void 0,d:c.elapsed()};for(let b=0;b<d.items.length;b++){const E=d.items[b],C=this._convertCompletionItem(E,[f,b],l,a);m.push(C)}return _}async resolveCompletionItem(t,i){if(typeof this._provider.resolveCompletionItem!="function")return;const r=this._cache.get(...t);if(!r)return;const n=this._convertCompletionItem(r,t),s=await this._provider.resolveCompletionItem(r,i);if(!s)return;const o=this._convertCompletionItem(s,t);return(n.h!==o.h||n.i!==o.i)&&this._apiDeprecation.report("CompletionItem.insertText",this._extension,"extension MAY NOT change 'insertText' of a CompletionItem during resolve"),(n.n!==o.n||n.o!==o.o||!fi(n.p,o.p))&&this._apiDeprecation.report("CompletionItem.command",this._extension,"extension MAY NOT change 'command' of a CompletionItem during resolve"),{...n,d:o.d,c:o.c,l:o.l,h:o.h,i:o.i,n:o.n,o:o.o,p:o.p}}releaseCompletionItems(t){this._disposables.get(t)?.dispose(),this._disposables.delete(t),this._cache.delete(t)}_convertCompletionItem(t,i,r,n){const s=this._disposables.get(i[0]);if(!s)throw Error("DisposableStore is missing...");const o=this._commands.toInternal(t.command,s),a={x:i,a:t.label,b:t.kind!==void 0?af.from(t.kind):void 0,m:t.tags&&t.tags.map(of.from),c:t.detail,d:typeof t.documentation>"u"?void 0:pe.fromStrict(t.documentation),e:t.sortText!==t.label?t.sortText:void 0,f:t.filterText!==t.label?t.filterText:void 0,g:t.preselect||void 0,i:t.keepWhitespace?1:0,k:t.commitCharacters?.join(""),l:t.additionalTextEdits&&t.additionalTextEdits.map(Lt.from),n:o?.$ident,o:o?.id,p:o?.$ident?void 0:o?.arguments};t.textEdit?(this._apiDeprecation.report("CompletionItem.textEdit",this._extension,"Use 'CompletionItem.insertText' and 'CompletionItem.range' instead."),a.h=t.textEdit.newText):typeof t.insertText=="string"?a.h=t.insertText:t.insertText instanceof Ms&&(a.h=t.insertText.value,a.i|=4);let l;return t.textEdit?l=t.textEdit.range:t.range&&(l=t.range),ye.isRange(l)?a.j=F.from(l):l&&(!r?.isEqual(l.inserting)||!n?.isEqual(l.replacing))&&(a.j={insert:F.from(l.inserting),replace:F.from(l.replacing)}),a}},is=class{constructor(e,t,i,r){this._extension=e,this._documents=t,this._provider=i,this._commands=r,this._references=new gk,this._isAdditionsProposedApiEnabled=Ke(this._extension,"inlineCompletionsAdditions"),this.languageTriggerKindToVSCodeTriggerKind={[hd.Automatic]:sc.Automatic,[hd.Explicit]:sc.Invoke}}get supportsHandleEvents(){return Ke(this._extension,"inlineCompletionsAdditions")&&(typeof this._provider.handleDidShowCompletionItem=="function"||typeof this._provider.handleDidPartiallyAcceptCompletionItem=="function"||typeof this._provider.handleDidRejectCompletionItem=="function"||typeof this._provider.handleEndOfLifetime=="function")}async provideInlineCompletions(e,t,i,r){const n=this._documents.getDocument(e),s=Be.to(t),o=await this._provider.provideInlineCompletionItems(n,s,{selectedCompletionInfo:i.selectedSuggestionInfo?{range:F.to(i.selectedSuggestionInfo.range),text:i.selectedSuggestionInfo.text}:void 0,triggerKind:this.languageTriggerKindToVSCodeTriggerKind[i.triggerKind],requestUuid:i.requestUuid},r);if(!o||r.isCancellationRequested)return;const a=Array.isArray(o)?o:o.items,l=this._isAdditionsProposedApiEnabled?Array.isArray(o)?[]:o.commands||[]:[],c=this._isAdditionsProposedApiEnabled&&!Array.isArray(o)?o.enableForwardStability:void 0;let u;return{pid:this._references.createReferenceId({dispose(){u?.dispose()},items:a}),items:a.map((f,p)=>{let m;f.command&&(u||(u=new he),m=this._commands.toInternal(f.command,u));let _;f.action&&(u||(u=new he),_=this._commands.toInternal(f.action,u));const b=f.insertText;return{insertText:typeof b=="string"?b:{snippet:b.value},filterText:f.filterText,range:f.range?F.from(f.range):void 0,showRange:this._isAdditionsProposedApiEnabled&&f.showRange?F.from(f.showRange):void 0,command:m,action:_,idx:p,completeBracketPairs:this._isAdditionsProposedApiEnabled?f.completeBracketPairs:!1,isInlineEdit:this._isAdditionsProposedApiEnabled?f.isInlineEdit:!1,showInlineEditMenu:this._isAdditionsProposedApiEnabled?f.showInlineEditMenu:!1,displayLocation:f.displayLocation&&this._isAdditionsProposedApiEnabled?{range:F.from(f.displayLocation.range),label:f.displayLocation.label}:void 0,warning:f.warning&&this._isAdditionsProposedApiEnabled?{message:pe.from(f.warning.message),icon:f.warning.icon?J1.fromThemeIcon(f.warning.icon):void 0}:void 0}}),commands:l.map(f=>(u||(u=new he),this._commands.toInternal(f,u))),suppressSuggestions:!1,enableForwardStability:c}}async provideInlineEditsForRange(e,t,i,r){if(!this._provider.provideInlineEditsForRange)return;N(this._extension,"inlineCompletionsAdditions");const n=this._documents.getDocument(e),s=F.to(t),o=await this._provider.provideInlineEditsForRange(n,s,{selectedCompletionInfo:i.selectedSuggestionInfo?{range:F.to(i.selectedSuggestionInfo.range),text:i.selectedSuggestionInfo.text}:void 0,triggerKind:this.languageTriggerKindToVSCodeTriggerKind[i.triggerKind],userPrompt:i.userPrompt,requestUuid:i.requestUuid},r);if(!o||r.isCancellationRequested)return;const a=Array.isArray(o)?o:o.items,l=this._isAdditionsProposedApiEnabled?Array.isArray(o)?[]:o.commands||[]:[],c=this._isAdditionsProposedApiEnabled&&!Array.isArray(o)?o.enableForwardStability:void 0;let u;return{pid:this._references.createReferenceId({dispose(){u?.dispose()},items:a}),items:a.map((f,p)=>{let m;f.command&&(u||(u=new he),m=this._commands.toInternal(f.command,u));let _;f.action&&(u||(u=new he),_=this._commands.toInternal(f.action,u));const b=f.insertText;return{insertText:typeof b=="string"?b:{snippet:b.value},filterText:f.filterText,range:f.range?F.from(f.range):void 0,command:m,action:_,idx:p,completeBracketPairs:this._isAdditionsProposedApiEnabled?f.completeBracketPairs:!1}}),commands:l.map(f=>(u||(u=new he),this._commands.toInternal(f,u))),suppressSuggestions:!1,enableForwardStability:c}}disposeCompletions(e){this._references.disposeReferenceId(e)?.dispose()}handleDidShowCompletionItem(e,t,i){const r=this._references.get(e)?.items[t];r&&this._provider.handleDidShowCompletionItem&&this._isAdditionsProposedApiEnabled&&this._provider.handleDidShowCompletionItem(r,i)}handlePartialAccept(e,t,i,r){const n=this._references.get(e)?.items[t];n&&this._provider.handleDidPartiallyAcceptCompletionItem&&this._isAdditionsProposedApiEnabled&&(this._provider.handleDidPartiallyAcceptCompletionItem(n,i),this._provider.handleDidPartiallyAcceptCompletionItem(n,q1.to(r)))}handleEndOfLifetime(e,t,i){const r=this._references.get(e)?.items[t];if(r&&this._provider.handleEndOfLifetime&&this._isAdditionsProposedApiEnabled){const n=G1.to(i,s=>this._references.get(s.pid)?.items[s.idx]);this._provider.handleEndOfLifetime(r,n)}}handleRejection(e,t){const i=this._references.get(e)?.items[t];i&&this._provider.handleDidRejectCompletionItem&&this._isAdditionsProposedApiEnabled&&this._provider.handleDidRejectCompletionItem(i)}},U0=class{async provideInlineEdits(e,t,i){const r=this._documents.getDocument(e),n=await this._provider.provideInlineEdit(r,{triggerKind:this.languageTriggerKindToVSCodeTriggerKind[t.triggerKind],requestUuid:t.requestUuid},i);if(!n||i.isCancellationRequested)return;let s;const o=this._references.createReferenceId({dispose(){s?.dispose()},item:n});let a;n.accepted&&(s||(s=new he),a=this._commands.toInternal(n.accepted,s));let l;n.rejected&&(s||(s=new he),l=this._commands.toInternal(n.rejected,s));let c;n.shown&&(s||(s=new he),c=this._commands.toInternal(n.shown,s));let u;return n.action&&(s||(s=new he),u=this._commands.toInternal(n.action,s)),s||(s=new he),{pid:o,text:n.text,range:F.from(n.range),showRange:F.from(n.showRange),accepted:a,rejected:l,shown:c,action:u,commands:n.commands?.map(f=>this._commands.toInternal(f,s))}}disposeEdit(e){this._references.disposeReferenceId(e)?.dispose()}constructor(e,t,i,r){this._documents=t,this._provider=i,this._commands=r,this._references=new gk,this.languageTriggerKindToVSCodeTriggerKind={[gd.Automatic]:yc.Automatic,[gd.Invoke]:yc.Invoke}}},gk=class{constructor(){this._references=new Map,this._idPool=1}createReferenceId(e){const t=this._idPool++;return this._references.set(t,e),t}disposeReferenceId(e){const t=this._references.get(e);return this._references.delete(e),t}get(e){return this._references.get(e)}},B0=class{constructor(e,t){this._documents=e,this._provider=t,this._cache=new _r("SignatureHelp")}async provideSignatureHelp(e,t,i,r){const n=this._documents.getDocument(e),s=Be.to(t),o=this.reviveContext(i),a=await this._provider.provideSignatureHelp(n,s,r,o);if(a){const l=this._cache.add([a]);return{...Cc.from(a),id:l}}}reviveContext(e){let t;if(e.activeSignatureHelp){const i=Cc.to(e.activeSignatureHelp),r=this._cache.get(e.activeSignatureHelp.id,0);r?(t=r,t.activeSignature=i.activeSignature,t.activeParameter=i.activeParameter):t=i}return{...e,activeSignatureHelp:t}}releaseSignatureHelp(e){this._cache.delete(e)}},mp=class{constructor(e,t,i,r,n){this._documents=e,this._commands=t,this._provider=i,this._logService=r,this._extension=n,this._cache=new _r("InlayHints"),this._disposables=new Map}async provideInlayHints(e,t,i){const r=this._documents.getDocument(e),n=F.to(t),s=await this._provider.provideInlayHints(r,n,i);if(!Array.isArray(s)||s.length===0){this._logService.trace(`[InlayHints] NO inlay hints from '${this._extension.identifier.value}' for range ${JSON.stringify(t)}`);return}if(i.isCancellationRequested)return;const o=this._cache.add(s);this._disposables.set(o,new he);const a={hints:[],cacheId:o};for(let l=0;l<s.length;l++)this._isValidInlayHint(s[l],n)&&a.hints.push(this._convertInlayHint(s[l],[o,l]));return this._logService.trace(`[InlayHints] ${a.hints.length} inlay hints from '${this._extension.identifier.value}' for range ${JSON.stringify(t)}`),a}async resolveInlayHint(e,t){if(typeof this._provider.resolveInlayHint!="function")return;const i=this._cache.get(...e);if(!i)return;const r=await this._provider.resolveInlayHint(i,t);if(r&&this._isValidInlayHint(r))return this._convertInlayHint(r,e)}releaseHints(e){this._disposables.get(e)?.dispose(),this._disposables.delete(e),this._cache.delete(e)}_isValidInlayHint(e,t){return e.label.length===0||Array.isArray(e.label)&&e.label.every(i=>i.value.length===0)?(console.log("INVALID inlay hint, empty label",e),!1):!(t&&!t.contains(e.position))}_convertInlayHint(e,t){const i=this._disposables.get(t[0]);if(!i)throw Error("DisposableStore is missing...");const r={label:"",cacheId:t,tooltip:pe.fromStrict(e.tooltip),position:Be.from(e.position),textEdits:e.textEdits&&e.textEdits.map(Lt.from),kind:e.kind&&uf.from(e.kind),paddingLeft:e.paddingLeft,paddingRight:e.paddingRight};if(typeof e.label=="string")r.label=e.label;else{const n=[];r.label=n;for(const s of e.label){if(!s.value){console.warn("INVALID inlay hint, empty label part",this._extension.identifier.value);continue}const o={label:s.value,tooltip:pe.fromStrict(s.tooltip)};Wi.isLocation(s.location)&&(o.location=vi.from(s.location)),s.command&&(o.command=this._commands.toInternal(s.command,i)),n.push(o)}}return r}},vp=class jp{constructor(t,i){this._documents=t,this._provider=i,this._cache=new _r("DocumentLink")}async provideLinks(t,i){const r=this._documents.getDocument(t),n=await this._provider.provideDocumentLinks(r,i);if(!(!Array.isArray(n)||n.length===0)&&!i.isCancellationRequested){if(typeof this._provider.resolveDocumentLink!="function")return{links:n.filter(jp._validateLink).map(Zs.from)};{const s=this._cache.add(n),o={links:[],cacheId:s};for(let a=0;a<n.length;a++){if(!jp._validateLink(n[a]))continue;const l=Zs.from(n[a]);l.cacheId=[s,a],o.links.push(l)}return o}}}static _validateLink(t){return t.target&&t.target.path.length>5e4?(console.warn("DROPPING link because it is too long"),!1):!0}async resolveLink(t,i){if(typeof this._provider.resolveDocumentLink!="function")return;const r=this._cache.get(...t);if(!r)return;const n=await this._provider.resolveDocumentLink(r,i);if(!(!n||!jp._validateLink(n)))return Zs.from(n)}releaseLinks(t){this._cache.delete(t)}},W0=class{constructor(e,t){this._documents=e,this._provider=t}async provideColors(e,t){const i=this._documents.getDocument(e),r=await this._provider.provideDocumentColors(i,t);return Array.isArray(r)?r.map(s=>({color:xa.from(s.color),range:F.from(s.range)})):[]}async provideColorPresentations(e,t,i){const r=this._documents.getDocument(e),n=F.to(t.range),s=xa.to(t.color),o=await this._provider.provideColorPresentations(s,{document:r,range:n},i);if(Array.isArray(o))return o.map(df.from)}},mk=class{constructor(e,t){this._documents=e,this._provider=t}async provideFoldingRanges(e,t,i){const r=this._documents.getDocument(e),n=await this._provider.provideFoldingRanges(r,t,i);if(Array.isArray(n))return n.map(ff.from)}},vk=class{constructor(e,t,i){this._documents=e,this._provider=t,this._logService=i}async provideSelectionRanges(e,t,i){const r=this._documents.getDocument(e),n=t.map(Be.to),s=await this._provider.provideSelectionRanges(r,n,i);if(!yo(s))return[];if(s.length!==n.length)return this._logService.warn("BAD selection ranges, provider must return ranges for each position"),[];const o=[];for(let a=0;a<n.length;a++){const l=[];o.push(l);let c=n[a],u=s[a];for(;;){if(!u.range.contains(c))throw new Error("INVALID selection range, must contain the previous range");if(l.push(I1.from(u)),!u.parent)break;c=u.range,u=u.parent}}return o}},su=class{constructor(e,t){this._documents=e,this._provider=t,this._idPool=new Qf(""),this._cache=new Map}async prepareSession(e,t,i){const r=this._documents.getDocument(e),n=Be.to(t),s=await this._provider.prepareCallHierarchy(r,n,i);if(!s)return;const o=this._idPool.nextId();return this._cache.set(o,new Map),Array.isArray(s)?s.map(a=>this._cacheAndConvertItem(o,a)):[this._cacheAndConvertItem(o,s)]}async provideCallsTo(e,t,i){const r=this._itemFromCache(e,t);if(!r)throw new Error("missing call hierarchy item");const n=await this._provider.provideCallHierarchyIncomingCalls(r,i);if(n)return n.map(s=>({from:this._cacheAndConvertItem(e,s.from),fromRanges:s.fromRanges.map(o=>F.from(o))}))}async provideCallsFrom(e,t,i){const r=this._itemFromCache(e,t);if(!r)throw new Error("missing call hierarchy item");const n=await this._provider.provideCallHierarchyOutgoingCalls(r,i);if(n)return n.map(s=>({to:this._cacheAndConvertItem(e,s.to),fromRanges:s.fromRanges.map(o=>F.from(o))}))}releaseSession(e){this._cache.delete(e)}_cacheAndConvertItem(e,t){const i=this._cache.get(e),r=Xs.from(t,e,i.size.toString(36));return i.set(r._itemId,t),r}_itemFromCache(e,t){return this._cache.get(e)?.get(t)}},ou=class{constructor(e,t){this._documents=e,this._provider=t,this._idPool=new Qf(""),this._cache=new Map}async prepareSession(e,t,i){const r=this._documents.getDocument(e),n=Be.to(t),s=await this._provider.prepareTypeHierarchy(r,n,i);if(!s)return;const o=this._idPool.nextId();return this._cache.set(o,new Map),Array.isArray(s)?s.map(a=>this._cacheAndConvertItem(o,a)):[this._cacheAndConvertItem(o,s)]}async provideSupertypes(e,t,i){const r=this._itemFromCache(e,t);if(!r)throw new Error("missing type hierarchy item");const n=await this._provider.provideTypeHierarchySupertypes(r,i);if(n)return n.map(s=>this._cacheAndConvertItem(e,s))}async provideSubtypes(e,t,i){const r=this._itemFromCache(e,t);if(!r)throw new Error("missing type hierarchy item");const n=await this._provider.provideTypeHierarchySubtypes(r,i);if(n)return n.map(s=>this._cacheAndConvertItem(e,s))}releaseSession(e){this._cache.delete(e)}_cacheAndConvertItem(e,t){const i=this._cache.get(e),r=Ks.from(t,e,i.size.toString(36));return i.set(r._itemId,t),r}_itemFromCache(e,t){return this._cache.get(e)?.get(t)}},_p=class{constructor(e,t,i,r,n){this._proxy=e,this._documents=t,this._provider=i,this._handle=r,this._extension=n,this._cache=new _r("DocumentDropEdit")}async provideDocumentOnDropEdits(e,t,i,r,n){const s=this._documents.getDocument(t),o=Be.to(i),a=Ta.toDataTransfer(r,async d=>(await this._proxy.$resolveDocumentOnDropFileData(this._handle,e,d)).buffer),l=await this._provider.provideDocumentDropEdits(s,o,a,n);if(!l)return;const c=Fi(l),u=this._cache.add(c);return c.map((d,f)=>({_cacheId:[u,f],title:d.title??h(2928,null,this._extension.displayName||this._extension.name),kind:d.kind?.value,yieldTo:d.yieldTo?.map(p=>p.value),insertText:typeof d.insertText=="string"?d.insertText:{snippet:d.insertText.value},additionalEdit:d.additionalEdit?Ri.from(d.additionalEdit,void 0):void 0}))}async resolveDropEdit(e,t){const[i,r]=e,n=this._cache.get(i,r);if(!n||!this._provider.resolveDocumentDropEdit)return{};const s=await this._provider.resolveDocumentDropEdit(n,t)??n;return{additionalEdit:s.additionalEdit?Ri.from(s.additionalEdit,void 0):void 0}}releaseDropEdits(e){this._cache.delete(e)}},au=class{constructor(e,t){this.adapter=e,this.extension=t}},i$=class Ut{static{this._handlePool=0}constructor(t,i,r,n,s,o,a,l){this._uriTransformer=i,this._documents=r,this._commands=n,this._diagnostics=s,this._logService=o,this._apiDeprecation=a,this._extensionTelemetry=l,this._adapter=new Map,this._proxy=t.getProxy(W.MainThreadLanguageFeatures)}_transformDocumentSelector(t,i){return _a.from(t,this._uriTransformer,i)}_createDisposable(t){return new Ce(()=>{this._adapter.delete(t),this._proxy.$unregister(t)})}_nextHandle(){return Ut._handlePool++}async _withAdapter(t,i,r,n,s,o=!1){const a=this._adapter.get(t);if(!a||!(a.adapter instanceof i))return n;const l=Date.now();o||this._logService.trace(`[${a.extension.identifier.value}] INVOKE provider '${r.toString().replace(/[\r\n]/g,"")}'`);const c=r(a.adapter,a.extension);return Promise.resolve(c).catch(u=>{br(u)||(this._logService.error(`[${a.extension.identifier.value}] provider FAILED`),this._logService.error(u),this._extensionTelemetry.onExtensionError(a.extension.identifier,u))}).finally(()=>{o||this._logService.trace(`[${a.extension.identifier.value}] provider DONE after ${Date.now()-l}ms`)}),Xe.isCancellationToken(s)?Ku(c,s):c}_addNewAdapter(t,i){const r=this._nextHandle();return this._adapter.set(r,new au(t,i)),r}static _extLabel(t){return t.displayName||t.name}static _extId(t){return t.identifier.value}registerDocumentSymbolProvider(t,i,r,n){const s=this._addNewAdapter(new tk(this._documents,r),t),o=n&&n.label||Ut._extLabel(t);return this._proxy.$registerDocumentSymbolProvider(s,this._transformDocumentSelector(i,t),o),this._createDisposable(s)}$provideDocumentSymbols(t,i,r){return this._withAdapter(t,tk,n=>n.provideDocumentSymbols(y.revive(i),r),void 0,r)}registerCodeLensProvider(t,i,r){const n=this._nextHandle(),s=typeof r.onDidChangeCodeLenses=="function"?this._nextHandle():void 0;this._adapter.set(n,new au(new dp(this._documents,this._commands.converter,r,t,this._extensionTelemetry,this._logService),t)),this._proxy.$registerCodeLensSupport(n,this._transformDocumentSelector(i,t),s);let o=this._createDisposable(n);if(s!==void 0){const a=r.onDidChangeCodeLenses(l=>this._proxy.$emitCodeLensEvent(s));o=Ce.from(o,a)}return o}$provideCodeLenses(t,i,r){return this._withAdapter(t,dp,n=>n.provideCodeLenses(y.revive(i),r),void 0,r,i.scheme==="output")}$resolveCodeLens(t,i,r){return this._withAdapter(t,dp,n=>n.resolveCodeLens(i,r),void 0,void 0,!0)}$releaseCodeLenses(t,i){this._withAdapter(t,dp,r=>Promise.resolve(r.releaseCodeLenses(i)),void 0,void 0,!0)}registerDefinitionProvider(t,i,r){const n=this._addNewAdapter(new ik(this._documents,r),t);return this._proxy.$registerDefinitionSupport(n,this._transformDocumentSelector(i,t)),this._createDisposable(n)}$provideDefinition(t,i,r,n){return this._withAdapter(t,ik,s=>s.provideDefinition(y.revive(i),r,n),[],n)}registerDeclarationProvider(t,i,r){const n=this._addNewAdapter(new rk(this._documents,r),t);return this._proxy.$registerDeclarationSupport(n,this._transformDocumentSelector(i,t)),this._createDisposable(n)}$provideDeclaration(t,i,r,n){return this._withAdapter(t,rk,s=>s.provideDeclaration(y.revive(i),r,n),[],n)}registerImplementationProvider(t,i,r){const n=this._addNewAdapter(new nk(this._documents,r),t);return this._proxy.$registerImplementationSupport(n,this._transformDocumentSelector(i,t)),this._createDisposable(n)}$provideImplementation(t,i,r,n){return this._withAdapter(t,nk,s=>s.provideImplementation(y.revive(i),r,n),[],n)}registerTypeDefinitionProvider(t,i,r){const n=this._addNewAdapter(new sk(this._documents,r),t);return this._proxy.$registerTypeDefinitionSupport(n,this._transformDocumentSelector(i,t)),this._createDisposable(n)}$provideTypeDefinition(t,i,r,n){return this._withAdapter(t,sk,s=>s.provideTypeDefinition(y.revive(i),r,n),[],n)}registerHoverProvider(t,i,r,n){const s=this._addNewAdapter(new M0(this._documents,r),t);return this._proxy.$registerHoverProvider(s,this._transformDocumentSelector(i,t)),this._createDisposable(s)}$provideHover(t,i,r,n,s){return this._withAdapter(t,M0,o=>o.provideHover(y.revive(i),r,n,s),void 0,s)}$releaseHover(t,i){this._withAdapter(t,M0,r=>Promise.resolve(r.releaseHover(i)),void 0,void 0)}registerEvaluatableExpressionProvider(t,i,r,n){const s=this._addNewAdapter(new ok(this._documents,r),t);return this._proxy.$registerEvaluatableExpressionProvider(s,this._transformDocumentSelector(i,t)),this._createDisposable(s)}$provideEvaluatableExpression(t,i,r,n){return this._withAdapter(t,ok,s=>s.provideEvaluatableExpression(y.revive(i),r,n),void 0,n)}registerInlineValuesProvider(t,i,r,n){const s=typeof r.onDidChangeInlineValues=="function"?this._nextHandle():void 0,o=this._addNewAdapter(new ak(this._documents,r),t);this._proxy.$registerInlineValuesProvider(o,this._transformDocumentSelector(i,t),s);let a=this._createDisposable(o);if(s!==void 0){const l=r.onDidChangeInlineValues(c=>this._proxy.$emitInlineValuesEvent(s));a=Ce.from(a,l)}return a}$provideInlineValues(t,i,r,n,s){return this._withAdapter(t,ak,o=>o.provideInlineValues(y.revive(i),r,n,s),void 0,s)}registerDocumentHighlightProvider(t,i,r){const n=this._addNewAdapter(new lk(this._documents,r),t);return this._proxy.$registerDocumentHighlightProvider(n,this._transformDocumentSelector(i,t)),this._createDisposable(n)}registerMultiDocumentHighlightProvider(t,i,r){const n=this._addNewAdapter(new ck(this._documents,r,this._logService),t);return this._proxy.$registerMultiDocumentHighlightProvider(n,this._transformDocumentSelector(i,t)),this._createDisposable(n)}$provideDocumentHighlights(t,i,r,n){return this._withAdapter(t,lk,s=>s.provideDocumentHighlights(y.revive(i),r,n),void 0,n)}$provideMultiDocumentHighlights(t,i,r,n,s){return this._withAdapter(t,ck,o=>o.provideMultiDocumentHighlights(y.revive(i),r,n.map(a=>y.revive(a)),s),void 0,s)}registerLinkedEditingRangeProvider(t,i,r){const n=this._addNewAdapter(new uk(this._documents,r),t);return this._proxy.$registerLinkedEditingRangeProvider(n,this._transformDocumentSelector(i,t)),this._createDisposable(n)}$provideLinkedEditingRanges(t,i,r,n){return this._withAdapter(t,uk,async s=>{const o=await s.provideLinkedEditingRanges(y.revive(i),r,n);if(o)return{ranges:o.ranges,wordPattern:o.wordPattern?Ut._serializeRegExp(o.wordPattern):void 0}},void 0,n)}registerReferenceProvider(t,i,r){const n=this._addNewAdapter(new dk(this._documents,r),t);return this._proxy.$registerReferenceSupport(n,this._transformDocumentSelector(i,t)),this._createDisposable(n)}$provideReferences(t,i,r,n,s){return this._withAdapter(t,dk,o=>o.provideReferences(y.revive(i),r,n,s),void 0,s)}registerCodeActionProvider(t,i,r,n){const s=new he,o=this._addNewAdapter(new fp(this._documents,this._commands.converter,this._diagnostics,r,this._logService,t,this._apiDeprecation),t);return this._proxy.$registerCodeActionSupport(o,this._transformDocumentSelector(i,t),{providedKinds:n?.providedCodeActionKinds?.map(a=>a.value),documentation:n?.documentation?.map(a=>({kind:a.kind.value,command:this._commands.converter.toInternal(a.command,s)}))},Ut._extLabel(t),Ut._extId(t),!!r.resolveCodeAction),s.add(this._createDisposable(o)),s}$provideCodeActions(t,i,r,n,s){return this._withAdapter(t,fp,o=>o.provideCodeActions(y.revive(i),r,n,s),void 0,s)}$resolveCodeAction(t,i,r){return this._withAdapter(t,fp,n=>n.resolveCodeAction(i,r),{},void 0)}$releaseCodeActions(t,i){this._withAdapter(t,fp,r=>Promise.resolve(r.releaseCodeActions(i)),void 0,void 0)}registerDocumentFormattingEditProvider(t,i,r){const n=this._addNewAdapter(new hk(this._documents,r),t);return this._proxy.$registerDocumentFormattingSupport(n,this._transformDocumentSelector(i,t),t.identifier,t.displayName||t.name),this._createDisposable(n)}$provideDocumentFormattingEdits(t,i,r,n){return this._withAdapter(t,hk,s=>s.provideDocumentFormattingEdits(y.revive(i),r,n),void 0,n)}registerDocumentRangeFormattingEditProvider(t,i,r){const n=typeof r.provideDocumentRangesFormattingEdits=="function",s=this._addNewAdapter(new O0(this._documents,r),t);return this._proxy.$registerRangeFormattingSupport(s,this._transformDocumentSelector(i,t),t.identifier,t.displayName||t.name,n),this._createDisposable(s)}$provideDocumentRangeFormattingEdits(t,i,r,n,s){return this._withAdapter(t,O0,o=>o.provideDocumentRangeFormattingEdits(y.revive(i),r,n,s),void 0,s)}$provideDocumentRangesFormattingEdits(t,i,r,n,s){return this._withAdapter(t,O0,o=>o.provideDocumentRangesFormattingEdits(y.revive(i),r,n,s),void 0,s)}registerOnTypeFormattingEditProvider(t,i,r,n){const s=this._addNewAdapter(new fk(this._documents,r),t);return this._proxy.$registerOnTypeFormattingSupport(s,this._transformDocumentSelector(i,t),n,t.identifier),this._createDisposable(s)}$provideOnTypeFormattingEdits(t,i,r,n,s,o){return this._withAdapter(t,fk,a=>a.provideOnTypeFormattingEdits(y.revive(i),r,n,s,o),void 0,o)}registerWorkspaceSymbolProvider(t,i){const r=this._addNewAdapter(new pp(i,this._logService),t);return this._proxy.$registerNavigateTypeSupport(r,typeof i.resolveWorkspaceSymbol=="function"),this._createDisposable(r)}$provideWorkspaceSymbols(t,i,r){return this._withAdapter(t,pp,n=>n.provideWorkspaceSymbols(i,r),{symbols:[]},r)}$resolveWorkspaceSymbol(t,i,r){return this._withAdapter(t,pp,n=>n.resolveWorkspaceSymbol(i,r),void 0,void 0)}$releaseWorkspaceSymbols(t,i){this._withAdapter(t,pp,r=>r.releaseWorkspaceSymbols(i),void 0,void 0)}registerRenameProvider(t,i,r){const n=this._addNewAdapter(new gp(this._documents,r,this._logService),t);return this._proxy.$registerRenameSupport(n,this._transformDocumentSelector(i,t),gp.supportsResolving(r)),this._createDisposable(n)}$provideRenameEdits(t,i,r,n,s){return this._withAdapter(t,gp,o=>o.provideRenameEdits(y.revive(i),r,n,s),void 0,s)}$resolveRenameLocation(t,i,r,n){return this._withAdapter(t,gp,s=>s.resolveRenameLocation(y.revive(i),r,n),void 0,n)}registerNewSymbolNamesProvider(t,i,r){const n=this._addNewAdapter(new F0(this._documents,r,this._logService),t);return this._proxy.$registerNewSymbolNamesProvider(n,this._transformDocumentSelector(i,t)),this._createDisposable(n)}$supportsAutomaticNewSymbolNamesTriggerKind(t){return this._withAdapter(t,F0,i=>i.supportsAutomaticNewSymbolNamesTriggerKind(),!1,void 0)}$provideNewSymbolNames(t,i,r,n,s){return this._withAdapter(t,F0,o=>o.provideNewSymbolNames(y.revive(i),r,n,s),void 0,s)}registerDocumentSemanticTokensProvider(t,i,r,n){const s=this._addNewAdapter(new H0(this._documents,r),t),o=typeof r.onDidChangeSemanticTokens=="function"?this._nextHandle():void 0;this._proxy.$registerDocumentSemanticTokensProvider(s,this._transformDocumentSelector(i,t),n,o);let a=this._createDisposable(s);if(o){const l=r.onDidChangeSemanticTokens(c=>this._proxy.$emitDocumentSemanticTokensEvent(o));a=Ce.from(a,l)}return a}$provideDocumentSemanticTokens(t,i,r,n){return this._withAdapter(t,H0,s=>s.provideDocumentSemanticTokens(y.revive(i),r,n),null,n)}$releaseDocumentSemanticTokens(t,i){this._withAdapter(t,H0,r=>r.releaseDocumentSemanticColoring(i),void 0,void 0)}registerDocumentRangeSemanticTokensProvider(t,i,r,n){const s=this._addNewAdapter(new pk(this._documents,r),t);return this._proxy.$registerDocumentRangeSemanticTokensProvider(s,this._transformDocumentSelector(i,t),n),this._createDisposable(s)}$provideDocumentRangeSemanticTokens(t,i,r,n){return this._withAdapter(t,pk,s=>s.provideDocumentRangeSemanticTokens(y.revive(i),r,n),null,n)}registerCompletionItemProvider(t,i,r,n){const s=this._addNewAdapter(new nu(this._documents,this._commands.converter,r,this._apiDeprecation,t),t);return this._proxy.$registerCompletionsProvider(s,this._transformDocumentSelector(i,t),n,nu.supportsResolving(r),t.identifier),this._createDisposable(s)}$provideCompletionItems(t,i,r,n,s){return this._withAdapter(t,nu,o=>o.provideCompletionItems(y.revive(i),r,n,s),void 0,s)}$resolveCompletionItem(t,i,r){return this._withAdapter(t,nu,n=>n.resolveCompletionItem(i,r),void 0,r)}$releaseCompletionItems(t,i){this._withAdapter(t,nu,r=>r.releaseCompletionItems(i),void 0,void 0)}registerInlineCompletionsProvider(t,i,r,n){const s=typeof r.onDidChange=="function"&&Ke(t,"inlineCompletionsAdditions")?this._nextHandle():void 0,o=new is(t,this._documents,r,this._commands.converter),a=this._addNewAdapter(o,t);let l=this._createDisposable(a);if(s!==void 0){const c=r.onDidChange(u=>this._proxy.$emitInlineCompletionsChange(s));l=Ce.from(l,c)}return this._proxy.$registerInlineCompletionsSupport(a,this._transformDocumentSelector(i,t),o.supportsHandleEvents,Oe.toKey(t.identifier.value),n?.yieldTo?.map(c=>Oe.toKey(c))||[],n?.displayName,n?.debounceDelayMs,s),l}$provideInlineCompletions(t,i,r,n,s){return this._withAdapter(t,is,o=>o.provideInlineCompletions(y.revive(i),r,n,s),void 0,s)}$provideInlineEditsForRange(t,i,r,n,s){return this._withAdapter(t,is,o=>o.provideInlineEditsForRange(y.revive(i),r,n,s),void 0,s)}$handleInlineCompletionDidShow(t,i,r,n){this._withAdapter(t,is,async s=>{s.handleDidShowCompletionItem(i,r,n)},void 0,void 0)}$handleInlineCompletionPartialAccept(t,i,r,n,s){this._withAdapter(t,is,async o=>{o.handlePartialAccept(i,r,n,s)},void 0,void 0)}$handleInlineCompletionEndOfLifetime(t,i,r,n){this._withAdapter(t,is,async s=>{s.handleEndOfLifetime(i,r,n)},void 0,void 0)}$handleInlineCompletionRejection(t,i,r){this._withAdapter(t,is,async n=>{n.handleRejection(i,r)},void 0,void 0)}$freeInlineCompletionsList(t,i){this._withAdapter(t,is,async r=>{r.disposeCompletions(i)},void 0,void 0)}registerInlineEditProvider(t,i,r){const n=new U0(t,this._documents,r,this._commands.converter),s=this._addNewAdapter(n,t);return this._proxy.$registerInlineEditProvider(s,this._transformDocumentSelector(i,t),t.identifier,r.displayName||t.name),this._createDisposable(s)}$provideInlineEdit(t,i,r,n){return this._withAdapter(t,U0,s=>s.provideInlineEdits(y.revive(i),r,n),void 0,n)}$freeInlineEdit(t,i){this._withAdapter(t,U0,async r=>{r.disposeEdit(i)},void 0,void 0)}registerSignatureHelpProvider(t,i,r,n){const s=Array.isArray(n)?{triggerCharacters:n,retriggerCharacters:[]}:n,o=this._addNewAdapter(new B0(this._documents,r),t);return this._proxy.$registerSignatureHelpProvider(o,this._transformDocumentSelector(i,t),s),this._createDisposable(o)}$provideSignatureHelp(t,i,r,n,s){return this._withAdapter(t,B0,o=>o.provideSignatureHelp(y.revive(i),r,n,s),void 0,s)}$releaseSignatureHelp(t,i){this._withAdapter(t,B0,r=>r.releaseSignatureHelp(i),void 0,void 0)}registerInlayHintsProvider(t,i,r){const n=typeof r.onDidChangeInlayHints=="function"?this._nextHandle():void 0,s=this._addNewAdapter(new mp(this._documents,this._commands.converter,r,this._logService,t),t);this._proxy.$registerInlayHintsProvider(s,this._transformDocumentSelector(i,t),typeof r.resolveInlayHint=="function",n,Ut._extLabel(t));let o=this._createDisposable(s);if(n!==void 0){const a=r.onDidChangeInlayHints(l=>this._proxy.$emitInlayHintsEvent(n));o=Ce.from(o,a)}return o}$provideInlayHints(t,i,r,n){return this._withAdapter(t,mp,s=>s.provideInlayHints(y.revive(i),r,n),void 0,n)}$resolveInlayHint(t,i,r){return this._withAdapter(t,mp,n=>n.resolveInlayHint(i,r),void 0,r)}$releaseInlayHints(t,i){this._withAdapter(t,mp,r=>r.releaseHints(i),void 0,void 0)}registerDocumentLinkProvider(t,i,r){const n=this._addNewAdapter(new vp(this._documents,r),t);return this._proxy.$registerDocumentLinkProvider(n,this._transformDocumentSelector(i,t),typeof r.resolveDocumentLink=="function"),this._createDisposable(n)}$provideDocumentLinks(t,i,r){return this._withAdapter(t,vp,n=>n.provideLinks(y.revive(i),r),void 0,r,i.scheme==="output")}$resolveDocumentLink(t,i,r){return this._withAdapter(t,vp,n=>n.resolveLink(i,r),void 0,void 0,!0)}$releaseDocumentLinks(t,i){this._withAdapter(t,vp,r=>r.releaseLinks(i),void 0,void 0,!0)}registerColorProvider(t,i,r){const n=this._addNewAdapter(new W0(this._documents,r),t);return this._proxy.$registerDocumentColorProvider(n,this._transformDocumentSelector(i,t)),this._createDisposable(n)}$provideDocumentColors(t,i,r){return this._withAdapter(t,W0,n=>n.provideColors(y.revive(i),r),[],r)}$provideColorPresentations(t,i,r,n){return this._withAdapter(t,W0,s=>s.provideColorPresentations(y.revive(i),r,n),void 0,n)}registerFoldingRangeProvider(t,i,r){const n=this._nextHandle(),s=typeof r.onDidChangeFoldingRanges=="function"?this._nextHandle():void 0;this._adapter.set(n,new au(new mk(this._documents,r),t)),this._proxy.$registerFoldingRangeProvider(n,this._transformDocumentSelector(i,t),t.identifier,s);let o=this._createDisposable(n);if(s!==void 0){const a=r.onDidChangeFoldingRanges(()=>this._proxy.$emitFoldingRangeEvent(s));o=Ce.from(o,a)}return o}$provideFoldingRanges(t,i,r,n){return this._withAdapter(t,mk,s=>s.provideFoldingRanges(y.revive(i),r,n),void 0,n)}registerSelectionRangeProvider(t,i,r){const n=this._addNewAdapter(new vk(this._documents,r,this._logService),t);return this._proxy.$registerSelectionRangeProvider(n,this._transformDocumentSelector(i,t)),this._createDisposable(n)}$provideSelectionRanges(t,i,r,n){return this._withAdapter(t,vk,s=>s.provideSelectionRanges(y.revive(i),r,n),[],n)}registerCallHierarchyProvider(t,i,r){const n=this._addNewAdapter(new su(this._documents,r),t);return this._proxy.$registerCallHierarchyProvider(n,this._transformDocumentSelector(i,t)),this._createDisposable(n)}$prepareCallHierarchy(t,i,r,n){return this._withAdapter(t,su,s=>Promise.resolve(s.prepareSession(y.revive(i),r,n)),void 0,n)}$provideCallHierarchyIncomingCalls(t,i,r,n){return this._withAdapter(t,su,s=>s.provideCallsTo(i,r,n),void 0,n)}$provideCallHierarchyOutgoingCalls(t,i,r,n){return this._withAdapter(t,su,s=>s.provideCallsFrom(i,r,n),void 0,n)}$releaseCallHierarchy(t,i){this._withAdapter(t,su,r=>Promise.resolve(r.releaseSession(i)),void 0,void 0)}registerTypeHierarchyProvider(t,i,r){const n=this._addNewAdapter(new ou(this._documents,r),t);return this._proxy.$registerTypeHierarchyProvider(n,this._transformDocumentSelector(i,t)),this._createDisposable(n)}$prepareTypeHierarchy(t,i,r,n){return this._withAdapter(t,ou,s=>Promise.resolve(s.prepareSession(y.revive(i),r,n)),void 0,n)}$provideTypeHierarchySupertypes(t,i,r,n){return this._withAdapter(t,ou,s=>s.provideSupertypes(i,r,n),void 0,n)}$provideTypeHierarchySubtypes(t,i,r,n){return this._withAdapter(t,ou,s=>s.provideSubtypes(i,r,n),void 0,n)}$releaseTypeHierarchy(t,i){this._withAdapter(t,ou,r=>Promise.resolve(r.releaseSession(i)),void 0,void 0)}registerDocumentOnDropEditProvider(t,i,r,n){const s=this._nextHandle();return this._adapter.set(s,new au(new _p(this._proxy,this._documents,r,s,t),t)),this._proxy.$registerDocumentOnDropEditProvider(s,this._transformDocumentSelector(i,t),n?{supportsResolve:!!r.resolveDocumentDropEdit,dropMimeTypes:n.dropMimeTypes,providedDropKinds:n.providedDropEditKinds?.map(o=>o.value)}:void 0),this._createDisposable(s)}$provideDocumentOnDropEdits(t,i,r,n,s,o){return this._withAdapter(t,_p,a=>Promise.resolve(a.provideDocumentOnDropEdits(i,y.revive(r),n,s,o)),void 0,void 0)}$resolveDropEdit(t,i,r){return this._withAdapter(t,_p,n=>n.resolveDropEdit(i,r),{},void 0)}$releaseDocumentOnDropEdits(t,i){this._withAdapter(t,_p,r=>Promise.resolve(r.releaseDropEdits(i)),void 0,void 0)}registerDocumentPasteEditProvider(t,i,r,n){const s=this._nextHandle();return this._adapter.set(s,new au(new ru(this._proxy,this._documents,r,s,t),t)),this._proxy.$registerPasteEditProvider(s,this._transformDocumentSelector(i,t),{supportsCopy:!!r.prepareDocumentPaste,supportsPaste:!!r.provideDocumentPasteEdits,supportsResolve:!!r.resolveDocumentPasteEdit,providedPasteEditKinds:n.providedPasteEditKinds?.map(o=>o.value),copyMimeTypes:n.copyMimeTypes,pasteMimeTypes:n.pasteMimeTypes}),this._createDisposable(s)}$prepareDocumentPaste(t,i,r,n,s){return this._withAdapter(t,ru,o=>o.prepareDocumentPaste(y.revive(i),r,n,s),void 0,s)}$providePasteEdits(t,i,r,n,s,o,a){return this._withAdapter(t,ru,l=>l.providePasteEdits(i,y.revive(r),n,s,o,a),void 0,a)}$resolvePasteEdit(t,i,r){return this._withAdapter(t,ru,n=>n.resolvePasteEdit(i,r),{},void 0)}$releasePasteEdits(t,i){this._withAdapter(t,ru,r=>Promise.resolve(r.releasePasteEdits(i)),void 0,void 0)}static _serializeRegExp(t){return{pattern:t.source,flags:t.flags}}static _serializeIndentationRule(t){return{decreaseIndentPattern:Ut._serializeRegExp(t.decreaseIndentPattern),increaseIndentPattern:Ut._serializeRegExp(t.increaseIndentPattern),indentNextLinePattern:t.indentNextLinePattern?Ut._serializeRegExp(t.indentNextLinePattern):void 0,unIndentedLinePattern:t.unIndentedLinePattern?Ut._serializeRegExp(t.unIndentedLinePattern):void 0}}static _serializeOnEnterRule(t){return{beforeText:Ut._serializeRegExp(t.beforeText),afterText:t.afterText?Ut._serializeRegExp(t.afterText):void 0,previousLineText:t.previousLineText?Ut._serializeRegExp(t.previousLineText):void 0,action:t.action}}static _serializeOnEnterRules(t){return t.map(Ut._serializeOnEnterRule)}static _serializeAutoClosingPair(t){return{open:t.open,close:t.close,notIn:t.notIn?t.notIn.map(i=>sa.toString(i)):void 0}}static _serializeAutoClosingPairs(t){return t.map(Ut._serializeAutoClosingPair)}setLanguageConfiguration(t,i,r){const{wordPattern:n}=r;if(n&&ab(n))throw new Error(`Invalid language configuration: wordPattern '${n}' is not allowed to match the empty string.`);n?this._documents.setWordDefinitionFor(i,n):this._documents.setWordDefinitionFor(i,void 0),r.__electricCharacterSupport&&this._apiDeprecation.report("LanguageConfiguration.__electricCharacterSupport",t,"Do not use."),r.__characterPairSupport&&this._apiDeprecation.report("LanguageConfiguration.__characterPairSupport",t,"Do not use.");const s=this._nextHandle(),o={comments:r.comments,brackets:r.brackets,wordPattern:r.wordPattern?Ut._serializeRegExp(r.wordPattern):void 0,indentationRules:r.indentationRules?Ut._serializeIndentationRule(r.indentationRules):void 0,onEnterRules:r.onEnterRules?Ut._serializeOnEnterRules(r.onEnterRules):void 0,__electricCharacterSupport:r.__electricCharacterSupport,__characterPairSupport:r.__characterPairSupport,autoClosingPairs:r.autoClosingPairs?Ut._serializeAutoClosingPairs(r.autoClosingPairs):void 0};return this._proxy.$setLanguageConfiguration(s,i,o),this._createDisposable(s)}$setWordDefinitions(t){for(const i of t)this._documents.setWordDefinitionFor(i.languageId,new RegExp(i.regexSource,i.regexFlags))}},_k;(function(e){function t(i){switch(i.type){case"extension":return`extension:${i.extensionId.value}`;case"mcp":return`mcp:${i.collectionId}:${i.definitionId}`;case"internal":return"internal"}}e.toKey=t})(_k||(_k={}));function r$(e){return typeof e=="object"&&typeof e.sessionId=="string"}var n$=U("ILanguageModelToolsService"),s$=U("notebookService"),o$=U("codeMapperService"),wk="vscode_editFile",V0="vscode_editFile_internal",yk={id:V0,displayName:"",modelDescription:"",source:{type:"internal"}},z0=class{constructor(t,i,r){this.chatService=t,this.codeMapperService=i,this.notebookService=r}async invoke(t,i,r,n){if(!t.context)throw new Error("toolInvocationToken is required for this tool");const s=t.parameters,o=y.revive(s.uri),a=Sd.parse(o)?.notebook||o,l=this.chatService.getSession(t.context?.sessionId),c=l.getRequests().at(-1);c.response?.response.getMarkdown().length&&l.acceptResponseProgress(c,{kind:"undoStop",id:$t()}),l.acceptResponseProgress(c,{kind:"markdownContent",content:new $o("\n````\n")}),l.acceptResponseProgress(c,{kind:"codeblockUri",uri:a,isEdit:!0}),l.acceptResponseProgress(c,{kind:"markdownContent",content:new $o("\n````\n")}),this.notebookService.hasSupportedNotebooks(a)&&this.notebookService.getNotebookTextModel(a)?l.acceptResponseProgress(c,{kind:"notebookEdit",edits:[],uri:a}):l.acceptResponseProgress(c,{kind:"textEdit",edits:[],uri:a});const u=l.editingSession;if(!u)throw new Error("This tool must be called from within an editing session");const d=await this.codeMapperService.mapCode({codeBlocks:[{code:s.code,resource:a,markdownBeforeBlock:s.explanation}],location:"tool",chatRequestId:t.chatRequestId,chatRequestModel:t.modelId,chatSessionId:t.context.sessionId},{textEdit:(p,m)=>{l.acceptResponseProgress(c,{kind:"textEdit",uri:p,edits:m})},notebookEdit(p,m){l.acceptResponseProgress(c,{kind:"notebookEdit",uri:p,edits:m})}},n);if(this.notebookService.hasSupportedNotebooks(a)&&this.notebookService.getNotebookTextModel(a)?l.acceptResponseProgress(c,{kind:"notebookEdit",uri:a,edits:[],done:!0}):l.acceptResponseProgress(c,{kind:"textEdit",uri:a,edits:[],done:!0}),d?.errorMessage)throw new Error(d.errorMessage);let f;return await new Promise(p=>{let m=!1;f=Am(_=>{const E=u.entries.read(_)?.find(C=>C.modifiedURI.toString()===a.toString());E&&(E.isCurrentlyBeingModifiedBy.read(_)?m=!0:m&&p(!0))})}).finally(()=>{f.dispose()}),{content:[{kind:"text",value:"The file was edited successfully"}]}}async prepareToolInvocation(t,i){return{presentation:"hidden"}}};z0=__decorate([__param(0,PR),__param(1,o$),__param(2,s$)],z0);var bk=class extends se{static{this.ID="chat.builtinTools"}constructor(t,i){super();const r=i.createInstance(z0);this._register(t.registerToolData(yk)),this._register(t.registerToolImplementation(yk.id,r))}};bk=__decorate([__param(0,n$),__param(1,gl)],bk);var a$="vscode_fetchWebPage_internal",xk=U("commandService"),q0=new class{constructor(){this._commands=new Map,this._onDidRegisterCommand=new P,this.onDidRegisterCommand=this._onDidRegisterCommand.event}registerCommand(e,t){if(!e)throw new Error("invalid command");if(typeof e=="string"){if(!t)throw new Error("invalid command");return this.registerCommand({id:e,handler:t})}if(e.metadata&&Array.isArray(e.metadata.args)){const o=[];for(const l of e.metadata.args)o.push(l.constraint);const a=e.handler;e.handler=function(l,...c){return y9(c,o),a(l,...c)}}const{id:i}=e;let r=this._commands.get(i);r||(r=new Dn,this._commands.set(i,r));const n=r.unshift(e),s=ne(()=>{n(),this._commands.get(i)?.isEmpty()&&this._commands.delete(i)});return this._onDidRegisterCommand.fire(i),lg(s)}registerCommandAlias(e,t){return q0.registerCommand(e,(i,...r)=>i.get(xk).executeCommand(t,...r))}getCommand(e){const t=this._commands.get(e);if(!(!t||t.isEmpty()))return Jt.first(t)}getCommands(){const e=new Map;for(const t of this._commands.keys()){const i=this.getCommand(t);i&&e.set(t,i)}return e}};q0.registerCommand("noop",()=>{});var Sk;(function(e){e[e.CtrlCmd=2048]="CtrlCmd",e[e.Shift=1024]="Shift",e[e.Alt=512]="Alt",e[e.WinCtrl=256]="WinCtrl",e[e.KeyCode=255]="KeyCode"})(Sk||(Sk={}));function Ek(e,t){if(typeof e=="number"){if(e===0)return null;const i=(e&65535)>>>0,r=(e&4294901760)>>>16;return r!==0?new yp([wp(i,t),wp(r,t)]):new yp([wp(i,t)])}else{const i=[];for(let r=0;r<e.length;r++)i.push(wp(e[r],t));return new yp(i)}}function wp(e,t){const i=!!(e&2048),r=!!(e&256),n=t===2?r:i,s=!!(e&1024),o=!!(e&512),a=t===2?i:r,l=e&255;return new l$(n,s,o,a,l)}var l$=class y7{constructor(t,i,r,n,s){this.ctrlKey=t,this.shiftKey=i,this.altKey=r,this.metaKey=n,this.keyCode=s}equals(t){return t instanceof y7&&this.ctrlKey===t.ctrlKey&&this.shiftKey===t.shiftKey&&this.altKey===t.altKey&&this.metaKey===t.metaKey&&this.keyCode===t.keyCode}getHashCode(){const t=this.ctrlKey?"1":"0",i=this.shiftKey?"1":"0",r=this.altKey?"1":"0",n=this.metaKey?"1":"0";return`K${t}${i}${r}${n}${this.keyCode}`}isModifierKey(){return this.keyCode===0||this.keyCode===5||this.keyCode===57||this.keyCode===6||this.keyCode===4}toKeybinding(){return new yp([this])}isDuplicateModifierCase(){return this.ctrlKey&&this.keyCode===5||this.shiftKey&&this.keyCode===4||this.altKey&&this.keyCode===6||this.metaKey&&this.keyCode===57}},yp=class{constructor(e){if(e.length===0)throw Se("chords");this.chords=e}getHashCode(){let e="";for(let t=0,i=this.chords.length;t<i;t++)t!==0&&(e+=";"),e+=this.chords[t].getHashCode();return e}equals(e){if(e===null||this.chords.length!==e.chords.length)return!1;for(let t=0;t<this.chords.length;t++)if(!this.chords[t].equals(e.chords[t]))return!1;return!0}},Ck;(function(e){e[e.EditorCore=0]="EditorCore",e[e.EditorContrib=100]="EditorContrib",e[e.WorkbenchContrib=200]="WorkbenchContrib",e[e.BuiltinExtension=300]="BuiltinExtension",e[e.ExternalExtension=400]="ExternalExtension"})(Ck||(Ck={}));var c$=class b7{constructor(){this._coreKeybindings=new Dn,this._extensionKeybindings=[],this._cachedMergedKeybindings=null}static bindToCurrentPlatform(t){if(cl===1){if(t&&t.win)return t.win}else if(cl===2){if(t&&t.mac)return t.mac}else if(t&&t.linux)return t.linux;return t}registerKeybindingRule(t){const i=b7.bindToCurrentPlatform(t),r=new he;if(i&&i.primary){const n=Ek(i.primary,cl);n&&r.add(this._registerDefaultKeybinding(n,t.id,t.args,t.weight,0,t.when))}if(i&&Array.isArray(i.secondary))for(let n=0,s=i.secondary.length;n<s;n++){const o=i.secondary[n],a=Ek(o,cl);a&&r.add(this._registerDefaultKeybinding(a,t.id,t.args,t.weight,-n-1,t.when))}return r}setExtensionKeybindings(t){const i=[];let r=0;for(const n of t)n.keybinding&&(i[r++]={keybinding:n.keybinding,command:n.id,commandArgs:n.args,when:n.when,weight1:n.weight,weight2:0,extensionId:n.extensionId||null,isBuiltinExtension:n.isBuiltinExtension||!1});this._extensionKeybindings=i,this._cachedMergedKeybindings=null}registerCommandAndKeybindingRule(t){return cg(this.registerKeybindingRule(t),q0.registerCommand(t))}_registerDefaultKeybinding(t,i,r,n,s,o){const a=this._coreKeybindings.push({keybinding:t,command:i,commandArgs:r,when:o,weight1:n,weight2:s,extensionId:null,isBuiltinExtension:!1});return this._cachedMergedKeybindings=null,ne(()=>{a(),this._cachedMergedKeybindings=null})}getDefaultKeybindings(){return this._cachedMergedKeybindings||(this._cachedMergedKeybindings=Array.from(this._coreKeybindings).concat(this._extensionKeybindings),this._cachedMergedKeybindings.sort(h$)),this._cachedMergedKeybindings.slice(0)}},u$=new c$,d$={EditorModes:"platform.keybindingsRegistry"};Ht.add(d$.EditorModes,u$);function h$(e,t){if(e.weight1!==t.weight1)return e.weight1-t.weight1;if(e.command&&t.command){if(e.command<t.command)return-1;if(e.command>t.command)return 1}return e.weight2-t.weight2}var bp;function f$(e){return e.command!==void 0}var xp=class k{static{this._instances=new Map}static{this.CommandPalette=new k("CommandPalette")}static{this.DebugBreakpointsContext=new k("DebugBreakpointsContext")}static{this.DebugCallStackContext=new k("DebugCallStackContext")}static{this.DebugConsoleContext=new k("DebugConsoleContext")}static{this.DebugVariablesContext=new k("DebugVariablesContext")}static{this.NotebookVariablesContext=new k("NotebookVariablesContext")}static{this.DebugHoverContext=new k("DebugHoverContext")}static{this.DebugWatchContext=new k("DebugWatchContext")}static{this.DebugToolBar=new k("DebugToolBar")}static{this.DebugToolBarStop=new k("DebugToolBarStop")}static{this.DebugDisassemblyContext=new k("DebugDisassemblyContext")}static{this.DebugCallStackToolbar=new k("DebugCallStackToolbar")}static{this.DebugCreateConfiguration=new k("DebugCreateConfiguration")}static{this.EditorContext=new k("EditorContext")}static{this.SimpleEditorContext=new k("SimpleEditorContext")}static{this.EditorContent=new k("EditorContent")}static{this.EditorLineNumberContext=new k("EditorLineNumberContext")}static{this.EditorContextCopy=new k("EditorContextCopy")}static{this.EditorContextPeek=new k("EditorContextPeek")}static{this.EditorContextShare=new k("EditorContextShare")}static{this.EditorTitle=new k("EditorTitle")}static{this.EditorTitleRun=new k("EditorTitleRun")}static{this.EditorTitleContext=new k("EditorTitleContext")}static{this.EditorTitleContextShare=new k("EditorTitleContextShare")}static{this.EmptyEditorGroup=new k("EmptyEditorGroup")}static{this.EmptyEditorGroupContext=new k("EmptyEditorGroupContext")}static{this.EditorTabsBarContext=new k("EditorTabsBarContext")}static{this.EditorTabsBarShowTabsSubmenu=new k("EditorTabsBarShowTabsSubmenu")}static{this.EditorTabsBarShowTabsZenModeSubmenu=new k("EditorTabsBarShowTabsZenModeSubmenu")}static{this.EditorActionsPositionSubmenu=new k("EditorActionsPositionSubmenu")}static{this.ExplorerContext=new k("ExplorerContext")}static{this.ExplorerContextShare=new k("ExplorerContextShare")}static{this.ExtensionContext=new k("ExtensionContext")}static{this.ExtensionEditorContextMenu=new k("ExtensionEditorContextMenu")}static{this.GlobalActivity=new k("GlobalActivity")}static{this.CommandCenter=new k("CommandCenter")}static{this.CommandCenterCenter=new k("CommandCenterCenter")}static{this.LayoutControlMenuSubmenu=new k("LayoutControlMenuSubmenu")}static{this.LayoutControlMenu=new k("LayoutControlMenu")}static{this.MenubarMainMenu=new k("MenubarMainMenu")}static{this.MenubarAppearanceMenu=new k("MenubarAppearanceMenu")}static{this.MenubarDebugMenu=new k("MenubarDebugMenu")}static{this.MenubarEditMenu=new k("MenubarEditMenu")}static{this.MenubarCopy=new k("MenubarCopy")}static{this.MenubarFileMenu=new k("MenubarFileMenu")}static{this.MenubarGoMenu=new k("MenubarGoMenu")}static{this.MenubarHelpMenu=new k("MenubarHelpMenu")}static{this.MenubarLayoutMenu=new k("MenubarLayoutMenu")}static{this.MenubarNewBreakpointMenu=new k("MenubarNewBreakpointMenu")}static{this.PanelAlignmentMenu=new k("PanelAlignmentMenu")}static{this.PanelPositionMenu=new k("PanelPositionMenu")}static{this.ActivityBarPositionMenu=new k("ActivityBarPositionMenu")}static{this.MenubarPreferencesMenu=new k("MenubarPreferencesMenu")}static{this.MenubarRecentMenu=new k("MenubarRecentMenu")}static{this.MenubarSelectionMenu=new k("MenubarSelectionMenu")}static{this.MenubarShare=new k("MenubarShare")}static{this.MenubarSwitchEditorMenu=new k("MenubarSwitchEditorMenu")}static{this.MenubarSwitchGroupMenu=new k("MenubarSwitchGroupMenu")}static{this.MenubarTerminalMenu=new k("MenubarTerminalMenu")}static{this.MenubarTerminalSuggestStatusMenu=new k("MenubarTerminalSuggestStatusMenu")}static{this.MenubarViewMenu=new k("MenubarViewMenu")}static{this.MenubarHomeMenu=new k("MenubarHomeMenu")}static{this.OpenEditorsContext=new k("OpenEditorsContext")}static{this.OpenEditorsContextShare=new k("OpenEditorsContextShare")}static{this.ProblemsPanelContext=new k("ProblemsPanelContext")}static{this.SCMInputBox=new k("SCMInputBox")}static{this.SCMChangeContext=new k("SCMChangeContext")}static{this.SCMResourceContext=new k("SCMResourceContext")}static{this.SCMResourceContextShare=new k("SCMResourceContextShare")}static{this.SCMResourceFolderContext=new k("SCMResourceFolderContext")}static{this.SCMResourceGroupContext=new k("SCMResourceGroupContext")}static{this.SCMSourceControl=new k("SCMSourceControl")}static{this.SCMSourceControlInline=new k("SCMSourceControlInline")}static{this.SCMSourceControlTitle=new k("SCMSourceControlTitle")}static{this.SCMHistoryTitle=new k("SCMHistoryTitle")}static{this.SCMHistoryItemContext=new k("SCMHistoryItemContext")}static{this.SCMHistoryItemHover=new k("SCMHistoryItemHover")}static{this.SCMHistoryItemRefContext=new k("SCMHistoryItemRefContext")}static{this.SCMQuickDiffDecorations=new k("SCMQuickDiffDecorations")}static{this.SCMTitle=new k("SCMTitle")}static{this.SearchContext=new k("SearchContext")}static{this.SearchActionMenu=new k("SearchActionContext")}static{this.StatusBarWindowIndicatorMenu=new k("StatusBarWindowIndicatorMenu")}static{this.StatusBarRemoteIndicatorMenu=new k("StatusBarRemoteIndicatorMenu")}static{this.StickyScrollContext=new k("StickyScrollContext")}static{this.TestItem=new k("TestItem")}static{this.TestItemGutter=new k("TestItemGutter")}static{this.TestProfilesContext=new k("TestProfilesContext")}static{this.TestMessageContext=new k("TestMessageContext")}static{this.TestMessageContent=new k("TestMessageContent")}static{this.TestPeekElement=new k("TestPeekElement")}static{this.TestPeekTitle=new k("TestPeekTitle")}static{this.TestCallStack=new k("TestCallStack")}static{this.TestCoverageFilterItem=new k("TestCoverageFilterItem")}static{this.TouchBarContext=new k("TouchBarContext")}static{this.TitleBar=new k("TitleBar")}static{this.TitleBarContext=new k("TitleBarContext")}static{this.TitleBarTitleContext=new k("TitleBarTitleContext")}static{this.TunnelContext=new k("TunnelContext")}static{this.TunnelPrivacy=new k("TunnelPrivacy")}static{this.TunnelProtocol=new k("TunnelProtocol")}static{this.TunnelPortInline=new k("TunnelInline")}static{this.TunnelTitle=new k("TunnelTitle")}static{this.TunnelLocalAddressInline=new k("TunnelLocalAddressInline")}static{this.TunnelOriginInline=new k("TunnelOriginInline")}static{this.ViewItemContext=new k("ViewItemContext")}static{this.ViewContainerTitle=new k("ViewContainerTitle")}static{this.ViewContainerTitleContext=new k("ViewContainerTitleContext")}static{this.ViewTitle=new k("ViewTitle")}static{this.ViewTitleContext=new k("ViewTitleContext")}static{this.CommentEditorActions=new k("CommentEditorActions")}static{this.CommentThreadTitle=new k("CommentThreadTitle")}static{this.CommentThreadActions=new k("CommentThreadActions")}static{this.CommentThreadAdditionalActions=new k("CommentThreadAdditionalActions")}static{this.CommentThreadTitleContext=new k("CommentThreadTitleContext")}static{this.CommentThreadCommentContext=new k("CommentThreadCommentContext")}static{this.CommentTitle=new k("CommentTitle")}static{this.CommentActions=new k("CommentActions")}static{this.CommentsViewThreadActions=new k("CommentsViewThreadActions")}static{this.InteractiveToolbar=new k("InteractiveToolbar")}static{this.InteractiveCellTitle=new k("InteractiveCellTitle")}static{this.InteractiveCellDelete=new k("InteractiveCellDelete")}static{this.InteractiveCellExecute=new k("InteractiveCellExecute")}static{this.InteractiveInputExecute=new k("InteractiveInputExecute")}static{this.InteractiveInputConfig=new k("InteractiveInputConfig")}static{this.ReplInputExecute=new k("ReplInputExecute")}static{this.IssueReporter=new k("IssueReporter")}static{this.NotebookToolbar=new k("NotebookToolbar")}static{this.NotebookToolbarContext=new k("NotebookToolbarContext")}static{this.NotebookStickyScrollContext=new k("NotebookStickyScrollContext")}static{this.NotebookCellTitle=new k("NotebookCellTitle")}static{this.NotebookCellDelete=new k("NotebookCellDelete")}static{this.NotebookCellInsert=new k("NotebookCellInsert")}static{this.NotebookCellBetween=new k("NotebookCellBetween")}static{this.NotebookCellListTop=new k("NotebookCellTop")}static{this.NotebookCellExecute=new k("NotebookCellExecute")}static{this.NotebookCellExecuteGoTo=new k("NotebookCellExecuteGoTo")}static{this.NotebookCellExecutePrimary=new k("NotebookCellExecutePrimary")}static{this.NotebookDiffCellInputTitle=new k("NotebookDiffCellInputTitle")}static{this.NotebookDiffDocumentMetadata=new k("NotebookDiffDocumentMetadata")}static{this.NotebookDiffCellMetadataTitle=new k("NotebookDiffCellMetadataTitle")}static{this.NotebookDiffCellOutputsTitle=new k("NotebookDiffCellOutputsTitle")}static{this.NotebookOutputToolbar=new k("NotebookOutputToolbar")}static{this.NotebookOutlineFilter=new k("NotebookOutlineFilter")}static{this.NotebookOutlineActionMenu=new k("NotebookOutlineActionMenu")}static{this.NotebookEditorLayoutConfigure=new k("NotebookEditorLayoutConfigure")}static{this.NotebookKernelSource=new k("NotebookKernelSource")}static{this.BulkEditTitle=new k("BulkEditTitle")}static{this.BulkEditContext=new k("BulkEditContext")}static{this.TimelineItemContext=new k("TimelineItemContext")}static{this.TimelineTitle=new k("TimelineTitle")}static{this.TimelineTitleContext=new k("TimelineTitleContext")}static{this.TimelineFilterSubMenu=new k("TimelineFilterSubMenu")}static{this.AccountsContext=new k("AccountsContext")}static{this.SidebarTitle=new k("SidebarTitle")}static{this.PanelTitle=new k("PanelTitle")}static{this.AuxiliaryBarTitle=new k("AuxiliaryBarTitle")}static{this.AuxiliaryBarHeader=new k("AuxiliaryBarHeader")}static{this.TerminalInstanceContext=new k("TerminalInstanceContext")}static{this.TerminalEditorInstanceContext=new k("TerminalEditorInstanceContext")}static{this.TerminalNewDropdownContext=new k("TerminalNewDropdownContext")}static{this.TerminalTabContext=new k("TerminalTabContext")}static{this.TerminalTabEmptyAreaContext=new k("TerminalTabEmptyAreaContext")}static{this.TerminalStickyScrollContext=new k("TerminalStickyScrollContext")}static{this.WebviewContext=new k("WebviewContext")}static{this.InlineCompletionsActions=new k("InlineCompletionsActions")}static{this.InlineEditsActions=new k("InlineEditsActions")}static{this.NewFile=new k("NewFile")}static{this.MergeInput1Toolbar=new k("MergeToolbar1Toolbar")}static{this.MergeInput2Toolbar=new k("MergeToolbar2Toolbar")}static{this.MergeBaseToolbar=new k("MergeBaseToolbar")}static{this.MergeInputResultToolbar=new k("MergeToolbarResultToolbar")}static{this.InlineSuggestionToolbar=new k("InlineSuggestionToolbar")}static{this.InlineEditToolbar=new k("InlineEditToolbar")}static{this.ChatContext=new k("ChatContext")}static{this.ChatCodeBlock=new k("ChatCodeblock")}static{this.ChatCompareBlock=new k("ChatCompareBlock")}static{this.ChatMessageTitle=new k("ChatMessageTitle")}static{this.ChatMessageFooter=new k("ChatMessageFooter")}static{this.ChatExecute=new k("ChatExecute")}static{this.ChatExecuteSecondary=new k("ChatExecuteSecondary")}static{this.ChatInput=new k("ChatInput")}static{this.ChatInputSide=new k("ChatInputSide")}static{this.ChatModelPicker=new k("ChatModelPicker")}static{this.ChatEditingWidgetToolbar=new k("ChatEditingWidgetToolbar")}static{this.ChatEditingEditorContent=new k("ChatEditingEditorContent")}static{this.ChatEditingEditorHunk=new k("ChatEditingEditorHunk")}static{this.ChatEditingDeletedNotebookCell=new k("ChatEditingDeletedNotebookCell")}static{this.ChatInputAttachmentToolbar=new k("ChatInputAttachmentToolbar")}static{this.ChatEditingWidgetModifiedFilesToolbar=new k("ChatEditingWidgetModifiedFilesToolbar")}static{this.ChatInputResourceAttachmentContext=new k("ChatInputResourceAttachmentContext")}static{this.ChatInputSymbolAttachmentContext=new k("ChatInputSymbolAttachmentContext")}static{this.ChatInlineResourceAnchorContext=new k("ChatInlineResourceAnchorContext")}static{this.ChatInlineSymbolAnchorContext=new k("ChatInlineSymbolAnchorContext")}static{this.ChatEditingCodeBlockContext=new k("ChatEditingCodeBlockContext")}static{this.ChatTitleBarMenu=new k("ChatTitleBarMenu")}static{this.ChatAttachmentsContext=new k("ChatAttachmentsContext")}static{this.AccessibleView=new k("AccessibleView")}static{this.MultiDiffEditorFileToolbar=new k("MultiDiffEditorFileToolbar")}static{this.DiffEditorHunkToolbar=new k("DiffEditorHunkToolbar")}static{this.DiffEditorSelectionToolbar=new k("DiffEditorSelectionToolbar")}static for(t){return k._instances.get(t)??new k(t)}constructor(t){if(k._instances.has(t))throw new TypeError(`MenuId with identifier '${t}' already exists. Use MenuId.for(ident) or a unique identifier`);k._instances.set(t,this),this.id=t}},rQ=U("menuService"),lu=class zw{static{this._all=new Map}static for(t){let i=this._all.get(t);return i||(i=new zw(t),this._all.set(t,i)),i}static merge(t){const i=new Set;for(const r of t)r instanceof zw&&i.add(r.id);return i}constructor(t){this.id=t,this.has=i=>i===t}},nQ=new class{constructor(){this._commands=new Map,this._menuItems=new Map,this._onDidChangeMenu=new X9({merge:lu.merge}),this.onDidChangeMenu=this._onDidChangeMenu.event}addCommand(e){return this._commands.set(e.id,e),this._onDidChangeMenu.fire(lu.for(xp.CommandPalette)),lg(ne(()=>{this._commands.delete(e.id)&&this._onDidChangeMenu.fire(lu.for(xp.CommandPalette))}))}getCommand(e){return this._commands.get(e)}getCommands(){const e=new Map;return this._commands.forEach((t,i)=>e.set(i,t)),e}appendMenuItem(e,t){let i=this._menuItems.get(e);i||(i=new Dn,this._menuItems.set(e,i));const r=i.push(t);return this._onDidChangeMenu.fire(lu.for(e)),lg(ne(()=>{r(),this._onDidChangeMenu.fire(lu.for(e))}))}appendMenuItems(e){const t=new he;for(const{id:i,item:r}of e)t.add(this.appendMenuItem(i,r));return t}getMenuItems(e){let t;return this._menuItems.has(e)?t=[...this._menuItems.get(e)]:t=[],e===xp.CommandPalette&&this._appendImplicitItems(t),t}_appendImplicitItems(e){const t=new Set;for(const i of e)f$(i)&&(t.add(i.command.id),i.alt&&t.add(i.alt.id));this._commands.forEach((i,r)=>{t.has(r)||e.push({command:i})})}},Dk=bp=class{static label(t,i){return i?.renderShortTitle&&t.shortTitle?typeof t.shortTitle=="string"?t.shortTitle:t.shortTitle.value:typeof t.title=="string"?t.title:t.title.value}constructor(t,i,r,n,s,o,a){this.hideActions=n,this.menuKeybinding=s,this._commandService=a,this.id=t.id,this.label=bp.label(t,r),this.tooltip=(typeof t.tooltip=="string"?t.tooltip:t.tooltip?.value)??"",this.enabled=!t.precondition||o.contextMatchesRules(t.precondition),this.checked=void 0;let l;if(t.toggled){const c=t.toggled.condition?t.toggled:{condition:t.toggled};this.checked=o.contextMatchesRules(c.condition),this.checked&&c.tooltip&&(this.tooltip=typeof c.tooltip=="string"?c.tooltip:c.tooltip.value),this.checked&&kt.isThemeIcon(c.icon)&&(l=c.icon),this.checked&&c.title&&(this.label=typeof c.title=="string"?c.title:c.title.value)}l||(l=kt.isThemeIcon(t.icon)?t.icon:void 0),this.item=t,this.alt=i?new bp(i,void 0,r,n,void 0,o,a):void 0,this._options=r,this.class=l&&kt.asClassName(l)}run(...t){let i=[];return this._options?.arg&&(i=[...i,this._options.arg]),this._options?.shouldForwardArgs&&(i=[...i,...t]),this._commandService.executeCommand(this.id,...i)}};Dk=bp=__decorate([__param(5,Jg),__param(6,xk)],Dk);var oQ=Fu(7526,"Extensions"),Ik;(function(e){e[e.Installing=0]="Installing",e[e.Installed=1]="Installed",e[e.Uninstalling=2]="Uninstalling",e[e.Uninstalled=3]="Uninstalled"})(Ik||(Ik={}));var kk;(function(e){e.ReloadWindow="reloadWindow",e.RestartExtensions="restartExtensions",e.DownloadUpdate="downloadUpdate",e.ApplyUpdate="applyUpdate",e.QuitAndInstall="quitAndInstall"})(kk||(kk={}));var Pk=U("extensionsWorkbenchService"),Tk;(function(e){e.Readme="readme",e.Features="features",e.Changelog="changelog",e.Dependencies="dependencies",e.ExtensionPack="extensionPack"})(Tk||(Tk={}));var Ak=class extends se{constructor(t,i){super(),this.containers=t,this._register(i.onChange(this.update,this))}set extension(t){this.containers.forEach(i=>i.extension=t)}update(t){for(const i of this.containers)t&&i.extension?KR(i.extension.identifier,t.identifier)&&(i.extension.server&&t.server&&i.extension.server!==t.server?i.updateWhenCounterExtensionChanges&&i.update():i.extension=t):i.update()}};Ak=__decorate([__param(1,Pk)],Ak);var lQ=new I("hasOutdatedExtensions",!1),cQ=new I("hasGallery",!1),uQ=new I("extensionResultListFocused ",!0),dQ=new xp("extensionsSearchActionsMenu"),Rk="vscode_searchExtensions_internal",hQ={id:Rk,toolReferenceName:"extensions",canBeReferencedInPrompt:!0,icon:kt.fromId(re.extensions.id),supportsToolPicker:!0,displayName:h(7540,null),modelDescription:h(7541,null),source:{type:"internal"},inputSchema:{type:"object",properties:{category:{type:"string",description:"The category of extensions to search for",enum:zb},keywords:{type:"array",items:{type:"string"},description:"The keywords to search for"},ids:{type:"array",items:{type:"string"},description:"The ids of the extensions to search for"}}}},Lk=class{constructor(t){this.extensionWorkbenchService=t}async invoke(t,i,r,n){const s=t.parameters;if(!s.keywords?.length&&!s.category&&!s.ids?.length)return{content:[{kind:"text",value:h(7542,null)}]};const o=new Map,a=u=>{for(const d of u)d.deprecationInfo||d.isMalicious||o.set(d.identifier.id.toLowerCase(),{id:d.identifier.id,name:d.displayName,description:d.description,installed:d.state===1,installCount:d.installCount??0,rating:d.rating??0,categories:d.categories??[],tags:d.gallery?.tags??[]})},l=async u=>{const d=await this.extensionWorkbenchService.queryGallery({text:u,pageSize:10,sortBy:"InstallCount"},n);d.firstPage.length&&a(d.firstPage)};if(s.ids?.length){const u=await this.extensionWorkbenchService.getExtensions(s.ids.map(d=>({id:d})),n);a(u)}if(s.keywords?.length)for(const u of s.keywords??[])if(u==="featured")await l("featured");else{let d=s.category?`category:"${s.category}"`:"";d=u?`${d} ${u}`.trim():d,await l(d)}else await l(`category:"${s.category}"`);const c=Array.from(o.values());return{content:[{kind:"text",value:`Here are the list of extensions:
${JSON.stringify(c)}
. Important: Use the following format to display extensions to the user because there is a renderer available to parse these extensions in this format and display them with all details. So, do not describe about the extensions to the user.
\`\`\`vscode-extensions
extensionId1,extensionId2
\`\`\`
.`}],toolResultDetails:{input:JSON.stringify(s),output:[{type:"text",value:JSON.stringify(c.map(u=>u.id))}]}}}};Lk=__decorate([__param(0,Pk)],Lk);var Nk=class{constructor(e){this._data=e}update(e){this._data=e}get data(){return this._data}get apiObject(){if(!this._apiObject){const e=this;this._apiObject=Object.freeze({get name(){return e._data.id},get description(){return e._data.modelDescription},get inputSchema(){return e._data.inputSchema},get tags(){return e._data.tags??[]}})}return this._apiObject}},p$=class{constructor(e,t){this._languageModels=t,this._registeredTools=new Map,this._tokenCountFuncs=new Map,this._allTools=new Map,this._proxy=e.getProxy(W.MainThreadLanguageModelTools),this._proxy.$getTools().then(i=>{for(const r of i)this._allTools.set(r.id,new Nk(Pt(r)))})}async $countTokensForInvocation(e,t,i){const r=this._tokenCountFuncs.get(e);if(!r)throw new Error(`Tool invocation call ${e} not found`);return await r(t,i)}async invokeTool(e,t,i,r){const n=$t();i.tokenizationOptions&&this._tokenCountFuncs.set(n,i.tokenizationOptions.countTokens);try{if(i.toolInvocationToken&&!r$(i.toolInvocationToken))throw new Error("Invalid tool invocation token");if((t===V0||t===wk)&&!Ke(e,"chatParticipantPrivate"))throw new Error(`Invalid tool: ${t}`);const s=await this._proxy.$invokeTool({toolId:t,callId:n,parameters:i.input,tokenBudget:i.tokenizationOptions?.tokenBudget,context:i.toolInvocationToken,chatRequestId:Ke(e,"chatParticipantPrivate")?i.chatRequestId:void 0,chatInteractionId:Ke(e,"chatParticipantPrivate")?i.chatInteractionId:void 0},r),o=s instanceof ai?s.value:s;return Rf.to(Pt(o))}finally{this._tokenCountFuncs.delete(n)}}$onDidChangeTools(e){const t=new Set(this._registeredTools.keys());for(const i of e){t.delete(i.id);const r=this._allTools.get(i.id);r?r.update(i):this._allTools.set(i.id,new Nk(Pt(i)))}for(const i of t)this._allTools.delete(i)}getTools(e){return Array.from(this._allTools.values()).map(t=>t.apiObject).filter(t=>{switch(t.name){case V0:case wk:case a$:case Rk:return Ke(e,"chatParticipantPrivate");default:return!0}})}async $invokeTool(e,t){const i=this._registeredTools.get(e.toolId);if(!i)throw new Error(`Unknown tool ${e.toolId}`);const r={input:e.parameters,toolInvocationToken:e.context};Ke(i.extension,"chatParticipantPrivate")&&(r.chatRequestId=e.chatRequestId,r.chatInteractionId=e.chatInteractionId,r.chatSessionId=e.context?.sessionId,e.toolSpecificData?.kind==="terminal"&&(r.terminalCommand=e.toolSpecificData.command)),Ke(i.extension,"chatParticipantAdditions")&&e.modelId&&(r.model=await this.getModel(e.modelId,i.extension)),e.tokenBudget!==void 0&&(r.tokenizationOptions={tokenBudget:e.tokenBudget,countTokens:this._tokenCountFuncs.get(e.callId)||((o,a=Xe.None)=>this._proxy.$countTokensForInvocation(e.callId,o,a))});let n;Ke(i.extension,"toolProgress")&&(n={report:o=>{this._proxy.$acceptToolProgress(e.callId,{message:pe.fromStrict(o.message),increment:o.increment,total:100})}});const s=await Pb(Promise.resolve(i.tool.invoke(r,t,n)),t);if(!s)throw new xr;return Rf.from(s,i.extension)}async getModel(e,t){let i;if(e&&(i=await this._languageModels.getLanguageModelByIdentifier(t,e)),!i&&(i=await this._languageModels.getDefaultLanguageModel(t),!i))throw new Error("Language model unavailable");return i}async $prepareToolInvocation(e,t,i){const r=this._registeredTools.get(e);if(!r)throw new Error(`Unknown tool ${e}`);const n={input:t};if(Ke(r.extension,"chatParticipantPrivate")&&r.tool.prepareInvocation2){const s=await r.tool.prepareInvocation2(n,i);return s?{confirmationMessages:s.confirmationMessages?{title:s.confirmationMessages.title,message:typeof s.confirmationMessages.message=="string"?s.confirmationMessages.message:pe.from(s.confirmationMessages.message)}:void 0,toolSpecificData:{kind:"terminal",language:s.language,command:s.command}}:void 0}else if(r.tool.prepareInvocation){const s=await r.tool.prepareInvocation(n,i);return s?((s.pastTenseMessage||s.presentation)&&N(r.extension,"chatParticipantPrivate"),{confirmationMessages:s.confirmationMessages?{title:s.confirmationMessages.title,message:typeof s.confirmationMessages.message=="string"?s.confirmationMessages.message:pe.from(s.confirmationMessages.message)}:void 0,invocationMessage:pe.fromStrict(s.invocationMessage),pastTenseMessage:pe.fromStrict(s.pastTenseMessage),presentation:s.presentation}):void 0}}registerTool(e,t,i){return this._registeredTools.set(t,{extension:e,tool:i}),this._proxy.$registerTool(t),ne(()=>{this._registeredTools.delete(t),this._proxy.$unregisterTool(t)})}},g$=class{constructor(e,t,i,r){this._documents=t,this._commands=i,this._uriTransformer=r,this._languageIds=[],this._handlePool=0,this._ids=new Set,this._proxy=e.getProxy(W.MainThreadLanguages)}$acceptLanguageIds(e){this._languageIds=e}async getLanguages(){return this._languageIds.slice(0)}async changeLanguage(e,t){await this._proxy.$changeLanguage(e,t);const i=this._documents.getDocumentData(e);if(!i)throw new Error(`document '${e.toString()}' NOT found`);return i.document}async tokenAtPosition(e,t){const i=e.version,r=Be.from(t),n=await this._proxy.$tokensAtPosition(e.uri,r),s={type:zn.Other,range:e.getWordRangeAtPosition(t)??new ye(t.line,t.character,t.line,t.character)};if(!n)return s;const o={range:F.to(n.range),type:p1.to(n.type)};return!o.range.contains(t)||i!==e.version?s:o}createLanguageStatusItem(e,t,i){const r=this._handlePool++,n=this._proxy,s=this._ids,o=`${e.identifier.value}/${t}`;if(s.has(o))throw new Error(`LanguageStatusItem with id '${t}' ALREADY exists`);s.add(o);const a={selector:i,id:t,name:e.displayName??e.name,severity:Ko.Information,command:void 0,text:"",detail:"",busy:!1};let l;const c=new he,u=()=>{if(l?.dispose(),!s.has(o)){console.warn(`LanguageStatusItem (${t}) from ${e.identifier.value} has been disposed and CANNOT be updated anymore`);return}l=kT(()=>{c.clear(),this._proxy.$setLanguageStatus(r,{id:o,name:a.name??e.displayName??e.name,source:e.displayName??e.name,selector:_a.from(a.selector,this._uriTransformer),label:a.text,detail:a.detail??"",severity:a.severity===Ko.Error?bt.Error:a.severity===Ko.Warning?bt.Warning:bt.Info,command:a.command&&this._commands.toInternal(a.command,c),accessibilityInfo:a.accessibilityInformation,busy:a.busy})},0)},d={dispose(){c.dispose(),l?.dispose(),n.$removeLanguageStatus(r),s.delete(o)},get id(){return a.id},get name(){return a.name},set name(f){a.name=f,u()},get selector(){return a.selector},set selector(f){a.selector=f,u()},get text(){return a.text},set text(f){a.text=f,u()},set text2(f){N(e,"languageStatusText"),a.text=f,u()},get text2(){return N(e,"languageStatusText"),a.text},get detail(){return a.detail},set detail(f){a.detail=f,u()},get severity(){return a.severity},set severity(f){a.severity=f,u()},get accessibilityInformation(){return a.accessibilityInformation},set accessibilityInformation(f){a.accessibilityInformation=f,u()},get command(){return a.command},set command(f){a.command=f,u()},get busy(){return a.busy},set busy(f){a.busy=f,u()}};return u(),d}};function m$(e){return e&&e.title}var j0=class{constructor(t,i){this._logService=i,this._proxy=t.getProxy(W.MainThreadMessageService)}showMessage(t,i,r,n,s){const o={source:{identifier:t.identifier,label:t.displayName||t.name}};let a;typeof n=="string"||m$(n)?a=[n,...s]:(o.modal=n?.modal,o.useCustom=n?.useCustom,o.detail=n?.detail,a=s),o.useCustom&&N(t,"resolvers");const l=[];let c=!1;for(let u=0;u<a.length;u++){const d=a[u];if(typeof d=="string")l.push({title:d,handle:u,isCloseAffordance:!1});else if(typeof d=="object"){const{title:f,isCloseAffordance:p}=d;l.push({title:f,isCloseAffordance:!!p,handle:u}),p&&(c?this._logService.warn(`[${t.identifier}] Only one message item can have 'isCloseAffordance':`,d):c=!0)}else this._logService.warn(`[${t.identifier}] Invalid message item:`,d)}return this._proxy.$showMessage(i,r,o,l).then(u=>{if(typeof u=="number")return a[u]})}};j0=__decorate([__param(1,qe)],j0);var G0=class{constructor(e,t,i,r){this.start=e,this.deletedCount=t,this.deletedItems=i,this.items=r}asApiEvent(){return{range:new ln(this.start,this.start+this.deletedCount),addedCells:this.items.map(e=>e.apiCell),removedCells:this.deletedItems}}},Q0=class{static asModelAddData(e){return{EOL:e.eol,lines:e.source,languageId:e.language,uri:e.uri,isDirty:!1,versionId:1,encoding:"utf8"}}constructor(e,t,i){this.notebook=e,this._extHostDocument=t,this._cellData=i,this.handle=i.handle,this.uri=y.revive(i.uri),this.cellKind=i.cellKind,this._outputs=i.outputs.map(Qn.to),this._internalMetadata=i.internalMetadata??{},this._metadata=Object.freeze(i.metadata??{}),this._previousResult=Object.freeze(Ca.to(i.internalMetadata??{}))}get internalMetadata(){return this._internalMetadata}get apiCell(){if(!this._apiCell){const e=this,t=this._extHostDocument.getDocument(this.uri);if(!t)throw new Error(`MISSING extHostDocument for notebook cell: ${this.uri}`);const i={get index(){return e.notebook.getCellIndex(e)},notebook:e.notebook.apiNotebook,kind:Ic.to(this._cellData.cellKind),document:t.document,get mime(){return e._mime},set mime(r){e._mime=r},get outputs(){return e._outputs.slice(0)},get metadata(){return e._metadata},get executionSummary(){return e._previousResult}};this._apiCell=Object.freeze(i)}return this._apiCell}setOutputs(e){this._outputs=e.map(Qn.to)}setOutputItems(e,t,i){const r=i.map(Ia.to),n=this._outputs.find(s=>s.id===e);if(n&&(t||(n.items.length=0),n.items.push(...r),n.items.length>1&&n.items.every(s=>LE(s.mime)))){const s=new Map,o=[];n.items.forEach(a=>{let l;s.has(a.mime)?l=s.get(a.mime):(l=[],s.set(a.mime,l),o.push(a.mime)),l.push(a.data)}),n.items.length=0,o.forEach(a=>{const l=H3(s.get(a));n.items.push({mime:a,data:l.data.buffer})})}}setMetadata(e){this._metadata=Object.freeze(e)}setInternalMetadata(e){this._internalMetadata=e,this._previousResult=Object.freeze(Ca.to(e))}setMime(e){}},v$=class x7{static{this._handlePool=0}constructor(t,i,r,n,s){this._proxy=t,this._textDocumentsAndEditors=i,this._textDocuments=r,this.uri=n,this.handle=x7._handlePool++,this._cells=[],this._versionId=0,this._isDirty=!1,this._disposed=!1,this._notebookType=s.viewType,this._metadata=Object.freeze(s.metadata??Object.create(null)),this._spliceNotebookCells([[0,0,s.cells]],!0,void 0),this._versionId=s.versionId}dispose(){this._disposed=!0}get versionId(){return this._versionId}get apiNotebook(){if(!this._notebook){const t=this,i={get uri(){return t.uri},get version(){return t._versionId},get notebookType(){return t._notebookType},get isDirty(){return t._isDirty},get isUntitled(){return t.uri.scheme===V.untitled},get isClosed(){return t._disposed},get metadata(){return t._metadata},get cellCount(){return t._cells.length},cellAt(r){return r=t._validateIndex(r),t._cells[r].apiCell},getCells(r){return(r?t._getCells(r):t._cells).map(s=>s.apiCell)},save(){return t._save()},[Symbol.for("debug.description")](){return`NotebookDocument(${this.uri.toString()})`}};this._notebook=Object.freeze(i)}return this._notebook}acceptDocumentPropertiesChanged(t){t.metadata&&(this._metadata=Object.freeze({...this._metadata,...t.metadata}))}acceptDirty(t){this._isDirty=t}acceptModelChanged(t,i,r){this._versionId=t.versionId,this._isDirty=i,this.acceptDocumentPropertiesChanged({metadata:r});const n={notebook:this.apiNotebook,metadata:r,cellChanges:[],contentChanges:[]},s=[];for(const a of t.rawEvents)a.kind===ar.ModelChange?this._spliceNotebookCells(a.changes,!1,n.contentChanges):a.kind===ar.Move?this._moveCells(a.index,a.length,a.newIdx,n.contentChanges):a.kind===ar.Output?(this._setCellOutputs(a.index,a.outputs),s.push({cell:this._cells[a.index].apiCell,outputs:this._cells[a.index].apiCell.outputs})):a.kind===ar.OutputItem?(this._setCellOutputItems(a.index,a.outputId,a.append,a.outputItems),s.push({cell:this._cells[a.index].apiCell,outputs:this._cells[a.index].apiCell.outputs})):a.kind===ar.ChangeCellLanguage?(this._changeCellLanguage(a.index,a.language),s.push({cell:this._cells[a.index].apiCell,document:this._cells[a.index].apiCell.document})):a.kind===ar.ChangeCellContent?s.push({cell:this._cells[a.index].apiCell,document:this._cells[a.index].apiCell.document}):a.kind===ar.ChangeCellMime?this._changeCellMime(a.index,a.mime):a.kind===ar.ChangeCellMetadata?(this._changeCellMetadata(a.index,a.metadata),s.push({cell:this._cells[a.index].apiCell,metadata:this._cells[a.index].apiCell.metadata})):a.kind===ar.ChangeCellInternalMetadata&&(this._changeCellInternalMetadata(a.index,a.internalMetadata),s.push({cell:this._cells[a.index].apiCell,executionSummary:this._cells[a.index].apiCell.executionSummary}));const o=new Map;for(let a=0;a<s.length;a++){const l=s[a],c=o.get(l.cell);if(c===void 0){const u=n.cellChanges.push({document:void 0,executionSummary:void 0,metadata:void 0,outputs:void 0,...l});o.set(l.cell,u-1)}else n.cellChanges[c]={...n.cellChanges[c],...l}}return Object.freeze(n),Object.freeze(n.cellChanges),Object.freeze(n.contentChanges),n}_validateIndex(t){return t=t|0,t<0?0:t>=this._cells.length?this._cells.length-1:t}_validateRange(t){let i=t.start|0,r=t.end|0;return i<0&&(i=0),r>this._cells.length&&(r=this._cells.length),t.with({start:i,end:r})}_getCells(t){t=this._validateRange(t);const i=[];for(let r=t.start;r<t.end;r++)i.push(this._cells[r]);return i}async _save(){return this._disposed?Promise.reject(new Error("Notebook has been closed")):this._proxy.$trySaveNotebook(this.uri)}_spliceNotebookCells(t,i,r){if(this._disposed)return;const n=[],s=[],o=[];if(t.reverse().forEach(a=>{const c=a[2].map(f=>{const p=new Q0(this,this._textDocumentsAndEditors,f);return i||s.push(Q0.asModelAddData(f)),p}),u=new G0(a[0],a[1],[],c),d=this._cells.splice(a[0],a[1],...c);for(const f of d)o.push(f.uri),u.deletedItems.push(f.apiCell);n.push(u)}),this._textDocumentsAndEditors.acceptDocumentsAndEditorsDelta({addedDocuments:s,removedDocuments:o}),r)for(const a of n)r.push(a.asApiEvent())}_moveCells(t,i,r,n){const s=this._cells.splice(t,i);this._cells.splice(r,0,...s);const o=[new G0(t,i,s.map(a=>a.apiCell),[]),new G0(r,0,[],s)];for(const a of o)n.push(a.asApiEvent())}_setCellOutputs(t,i){this._cells[t].setOutputs(i)}_setCellOutputItems(t,i,r,n){this._cells[t].setOutputItems(i,r,n)}_changeCellLanguage(t,i){const r=this._cells[t];r.apiCell.document.languageId!==i&&this._textDocuments.$acceptModelLanguageChanged(r.uri,i)}_changeCellMime(t,i){const r=this._cells[t];r.apiCell.mime=i}_changeCellMetadata(t,i){this._cells[t].setMetadata(i)}_changeCellInternalMetadata(t,i){this._cells[t].setInternalMetadata(i)}getCellFromApiCell(t){return this._cells.find(i=>i.apiCell===t)}getCellFromIndex(t){return this._cells[t]}getCell(t){return this._cells.find(i=>i.handle===t)}getCellIndex(t){return this._cells.indexOf(t)}},J0=class S7{static{this.apiEditorsToExtHost=new WeakMap}constructor(t,i,r,n,s,o,a){this.id=t,this._proxy=i,this.notebookData=r,this._visibleRanges=n,this._selections=s,this._viewColumn=o,this.viewType=a,this._visible=!1}get apiEditor(){if(!this._editor){const t=this;this._editor={get notebook(){return t.notebookData.apiNotebook},get selection(){return t._selections[0]},set selection(i){this.selections=[i]},get selections(){return t._selections},set selections(i){if(!Array.isArray(i)||!i.every(ln.isNotebookRange))throw Se("selections");t._selections=i,t._trySetSelections(i)},get visibleRanges(){return t._visibleRanges},revealRange(i,r){t._proxy.$tryRevealRange(t.id,Or.from(i),r??Rh.Default)},get viewColumn(){return t._viewColumn},get replOptions(){if(t.viewType==="repl")return{appendIndex:this.notebook.cellCount-1}},[Symbol.for("debug.description")](){return`NotebookEditor(${this.notebook.uri.toString()})`}},S7.apiEditorsToExtHost.set(this._editor,this)}return this._editor}get visible(){return this._visible}_acceptVisibility(t){this._visible=t}_acceptVisibleRanges(t){this._visibleRanges=t}_acceptSelections(t){this._selections=t}_trySetSelections(t){this._proxy.$trySetSelections(this.id,t.map(Or.from))}_acceptViewColumn(t){this._viewColumn=t}},X0=class{constructor(e,t){this.piece=e,this.color=t,this.size_left=0,this.lf_left=0,this.parent=this,this.left=this,this.right=this}next(){if(this.right!==te)return Z0(this.right);let e=this;for(;e.parent!==te&&e.parent.left!==e;)e=e.parent;return e.parent===te?te:e.parent}prev(){if(this.left!==te)return Ok(this.left);let e=this;for(;e.parent!==te&&e.parent.right!==e;)e=e.parent;return e.parent===te?te:e.parent}detach(){this.parent=null,this.left=null,this.right=null}},Mk;(function(e){e[e.Black=0]="Black",e[e.Red=1]="Red"})(Mk||(Mk={}));var te=new X0(null,0);te.parent=te,te.left=te,te.right=te,te.color=0;function Z0(e){for(;e.left!==te;)e=e.left;return e}function Ok(e){for(;e.right!==te;)e=e.right;return e}function K0(e){return e===te?0:e.size_left+e.piece.length+K0(e.right)}function Y0(e){return e===te?0:e.lf_left+e.piece.lineFeedCnt+Y0(e.right)}function ew(){te.parent=te}function cu(e,t){const i=t.right;i.size_left+=t.size_left+(t.piece?t.piece.length:0),i.lf_left+=t.lf_left+(t.piece?t.piece.lineFeedCnt:0),t.right=i.left,i.left!==te&&(i.left.parent=t),i.parent=t.parent,t.parent===te?e.root=i:t.parent.left===t?t.parent.left=i:t.parent.right=i,i.left=t,t.parent=i}function uu(e,t){const i=t.left;t.left=i.right,i.right!==te&&(i.right.parent=t),i.parent=t.parent,t.size_left-=i.size_left+(i.piece?i.piece.length:0),t.lf_left-=i.lf_left+(i.piece?i.piece.lineFeedCnt:0),t.parent===te?e.root=i:t===t.parent.right?t.parent.right=i:t.parent.left=i,i.right=t,t.parent=i}function Sp(e,t){let i,r;if(t.left===te?(r=t,i=r.right):t.right===te?(r=t,i=r.left):(r=Z0(t.right),i=r.right),r===e.root){e.root=i,i.color=0,t.detach(),ew(),e.root.parent=te;return}const n=r.color===1;if(r===r.parent.left?r.parent.left=i:r.parent.right=i,r===t?(i.parent=r.parent,du(e,i)):(r.parent===t?i.parent=r:i.parent=r.parent,du(e,i),r.left=t.left,r.right=t.right,r.parent=t.parent,r.color=t.color,t===e.root?e.root=r:t===t.parent.left?t.parent.left=r:t.parent.right=r,r.left!==te&&(r.left.parent=r),r.right!==te&&(r.right.parent=r),r.size_left=t.size_left,r.lf_left=t.lf_left,du(e,r)),t.detach(),i.parent.left===i){const o=K0(i),a=Y0(i);if(o!==i.parent.size_left||a!==i.parent.lf_left){const l=o-i.parent.size_left,c=a-i.parent.lf_left;i.parent.size_left=o,i.parent.lf_left=a,vn(e,i.parent,l,c)}}if(du(e,i.parent),n){ew();return}let s;for(;i!==e.root&&i.color===0;)i===i.parent.left?(s=i.parent.right,s.color===1&&(s.color=0,i.parent.color=1,cu(e,i.parent),s=i.parent.right),s.left.color===0&&s.right.color===0?(s.color=1,i=i.parent):(s.right.color===0&&(s.left.color=0,s.color=1,uu(e,s),s=i.parent.right),s.color=i.parent.color,i.parent.color=0,s.right.color=0,cu(e,i.parent),i=e.root)):(s=i.parent.left,s.color===1&&(s.color=0,i.parent.color=1,uu(e,i.parent),s=i.parent.left),s.left.color===0&&s.right.color===0?(s.color=1,i=i.parent):(s.left.color===0&&(s.right.color=0,s.color=1,cu(e,s),s=i.parent.left),s.color=i.parent.color,i.parent.color=0,s.left.color=0,uu(e,i.parent),i=e.root));i.color=0,ew()}function Fk(e,t){for(du(e,t);t!==e.root&&t.parent.color===1;)if(t.parent===t.parent.parent.left){const i=t.parent.parent.right;i.color===1?(t.parent.color=0,i.color=0,t.parent.parent.color=1,t=t.parent.parent):(t===t.parent.right&&(t=t.parent,cu(e,t)),t.parent.color=0,t.parent.parent.color=1,uu(e,t.parent.parent))}else{const i=t.parent.parent.left;i.color===1?(t.parent.color=0,i.color=0,t.parent.parent.color=1,t=t.parent.parent):(t===t.parent.left&&(t=t.parent,uu(e,t)),t.parent.color=0,t.parent.parent.color=1,cu(e,t.parent.parent))}e.root.color=0}function vn(e,t,i,r){for(;t!==e.root&&t!==te;)t.parent.left===t&&(t.parent.size_left+=i,t.parent.lf_left+=r),t=t.parent}function du(e,t){let i=0,r=0;if(t!==e.root){for(;t!==e.root&&t===t.parent.right;)t=t.parent;if(t!==e.root)for(t=t.parent,i=K0(t.left)-t.size_left,r=Y0(t.left)-t.lf_left,t.size_left+=i,t.lf_left+=r;t!==e.root&&(i!==0||r!==0);)t.parent.left===t&&(t.parent.size_left+=i,t.parent.lf_left+=r),t=t.parent}}var _n=65535;function $k(e){let t;return e[e.length-1]<65536?t=new Uint16Array(e.length):t=new Uint32Array(e.length),t.set(e,0),t}var _$=class{constructor(e,t,i,r,n){this.lineStarts=e,this.cr=t,this.lf=i,this.crlf=r,this.isBasicASCII=n}};function wn(e,t=!0){const i=[0];let r=1;for(let n=0,s=e.length;n<s;n++){const o=e.charCodeAt(n);o===13?n+1<s&&e.charCodeAt(n+1)===10?(i[r++]=n+2,n++):i[r++]=n+1:o===10&&(i[r++]=n+1)}return t?$k(i):i}function w$(e,t){e.length=0,e[0]=0;let i=1,r=0,n=0,s=0,o=!0;for(let l=0,c=t.length;l<c;l++){const u=t.charCodeAt(l);u===13?l+1<c&&t.charCodeAt(l+1)===10?(s++,e[i++]=l+2,l++):(r++,e[i++]=l+1):u===10?(n++,e[i++]=l+1):o&&u!==9&&(u<32||u>126)&&(o=!1)}const a=new _$($k(e),r,n,s,o);return e.length=0,a}var yi=class{constructor(e,t,i,r,n){this.bufferIndex=e,this.start=t,this.end=i,this.lineFeedCnt=r,this.length=n}},co=class{constructor(e,t){this.buffer=e,this.lineStarts=t}},y$=class{constructor(e,t){this._pieces=[],this._tree=e,this._BOM=t,this._index=0,e.root!==te&&e.iterate(e.root,i=>(i!==te&&this._pieces.push(i.piece),!0))}read(){return this._pieces.length===0?this._index===0?(this._index++,this._BOM):null:this._index>this._pieces.length-1?null:this._index===0?this._BOM+this._tree.getPieceContent(this._pieces[this._index++]):this._tree.getPieceContent(this._pieces[this._index++])}},b$=class{constructor(e){this._limit=e,this._cache=[]}get(e){for(let t=this._cache.length-1;t>=0;t--){const i=this._cache[t];if(i.nodeStartOffset<=e&&i.nodeStartOffset+i.node.piece.length>=e)return i}return null}get2(e){for(let t=this._cache.length-1;t>=0;t--){const i=this._cache[t];if(i.nodeStartLineNumber&&i.nodeStartLineNumber<e&&i.nodeStartLineNumber+i.node.piece.lineFeedCnt>=e)return i}return null}set(e){this._cache.length>=this._limit&&this._cache.shift(),this._cache.push(e)}validate(e){let t=!1;const i=this._cache;for(let r=0;r<i.length;r++){const n=i[r];if(n.node.parent===null||n.nodeStartOffset>=e){i[r]=null,t=!0;continue}}if(t){const r=[];for(const n of i)n!==null&&r.push(n);this._cache=r}}},x$=class{constructor(e,t,i){this.create(e,t,i)}create(e,t,i){this._buffers=[new co("",[0])],this._lastChangeBufferPos={line:0,column:0},this.root=te,this._lineCnt=1,this._length=0,this._EOL=t,this._EOLLength=t.length,this._EOLNormalized=i;let r=null;for(let n=0,s=e.length;n<s;n++)if(e[n].buffer.length>0){e[n].lineStarts||(e[n].lineStarts=wn(e[n].buffer));const o=new yi(n+1,{line:0,column:0},{line:e[n].lineStarts.length-1,column:e[n].buffer.length-e[n].lineStarts[e[n].lineStarts.length-1]},e[n].lineStarts.length-1,e[n].buffer.length);this._buffers.push(e[n]),r=this.rbInsertRight(r,o)}this._searchCache=new b$(1),this._lastVisitedLine={lineNumber:0,value:""},this.computeBufferMetadata()}normalizeEOL(e){const t=_n,i=t-Math.floor(t/3),r=i*2;let n="",s=0;const o=[];if(this.iterate(this.root,a=>{const l=this.getNodeContent(a),c=l.length;if(s<=i||s+c<r)return n+=l,s+=c,!0;const u=n.replace(/\r\n|\r|\n/g,e);return o.push(new co(u,wn(u))),n=l,s=c,!0}),s>0){const a=n.replace(/\r\n|\r|\n/g,e);o.push(new co(a,wn(a)))}this.create(o,e,!0)}getEOL(){return this._EOL}setEOL(e){this._EOL=e,this._EOLLength=this._EOL.length,this.normalizeEOL(e)}createSnapshot(e){return new y$(this,e)}equal(e){if(this.getLength()!==e.getLength()||this.getLineCount()!==e.getLineCount())return!1;let t=0;return this.iterate(this.root,r=>{if(r===te)return!0;const n=this.getNodeContent(r),s=n.length,o=e.nodeAt(t),a=e.nodeAt(t+s),l=e.getValueInRange2(o,a);return t+=s,n===l})}getOffsetAt(e,t){let i=0,r=this.root;for(;r!==te;)if(r.left!==te&&r.lf_left+1>=e)r=r.left;else if(r.lf_left+r.piece.lineFeedCnt+1>=e){i+=r.size_left;const n=this.getAccumulatedValue(r,e-r.lf_left-2);return i+=n+t-1}else e-=r.lf_left+r.piece.lineFeedCnt,i+=r.size_left+r.piece.length,r=r.right;return i}getPositionAt(e){e=Math.floor(e),e=Math.max(0,e);let t=this.root,i=0;const r=e;for(;t!==te;)if(t.size_left!==0&&t.size_left>=e)t=t.left;else if(t.size_left+t.piece.length>=e){const n=this.getIndexOf(t,e-t.size_left);if(i+=t.lf_left+n.index,n.index===0){const s=this.getOffsetAt(i+1,1),o=r-s;return new Bi(i+1,o+1)}return new Bi(i+1,n.remainder+1)}else if(e-=t.size_left+t.piece.length,i+=t.lf_left+t.piece.lineFeedCnt,t.right===te){const n=this.getOffsetAt(i+1,1),s=r-e-n;return new Bi(i+1,s+1)}else t=t.right;return new Bi(1,1)}getValueInRange(e,t){if(e.startLineNumber===e.endLineNumber&&e.startColumn===e.endColumn)return"";const i=this.nodeAt2(e.startLineNumber,e.startColumn),r=this.nodeAt2(e.endLineNumber,e.endColumn),n=this.getValueInRange2(i,r);return t?t!==this._EOL||!this._EOLNormalized?n.replace(/\r\n|\r|\n/g,t):t===this.getEOL()&&this._EOLNormalized?n:n.replace(/\r\n|\r|\n/g,t):n}getValueInRange2(e,t){if(e.node===t.node){const o=e.node,a=this._buffers[o.piece.bufferIndex].buffer,l=this.offsetInBuffer(o.piece.bufferIndex,o.piece.start);return a.substring(l+e.remainder,l+t.remainder)}let i=e.node;const r=this._buffers[i.piece.bufferIndex].buffer,n=this.offsetInBuffer(i.piece.bufferIndex,i.piece.start);let s=r.substring(n+e.remainder,n+i.piece.length);for(i=i.next();i!==te;){const o=this._buffers[i.piece.bufferIndex].buffer,a=this.offsetInBuffer(i.piece.bufferIndex,i.piece.start);if(i===t.node){s+=o.substring(a,a+t.remainder);break}else s+=o.substr(a,i.piece.length);i=i.next()}return s}getLinesContent(){const e=[];let t=0,i="",r=!1;return this.iterate(this.root,n=>{if(n===te)return!0;const s=n.piece;let o=s.length;if(o===0)return!0;const a=this._buffers[s.bufferIndex].buffer,l=this._buffers[s.bufferIndex].lineStarts,c=s.start.line,u=s.end.line;let d=l[c]+s.start.column;if(r&&(a.charCodeAt(d)===10&&(d++,o--),e[t++]=i,i="",r=!1,o===0))return!0;if(c===u)return!this._EOLNormalized&&a.charCodeAt(d+o-1)===13?(r=!0,i+=a.substr(d,o-1)):i+=a.substr(d,o),!0;i+=this._EOLNormalized?a.substring(d,Math.max(d,l[c+1]-this._EOLLength)):a.substring(d,l[c+1]).replace(/(\r\n|\r|\n)$/,""),e[t++]=i;for(let f=c+1;f<u;f++)i=this._EOLNormalized?a.substring(l[f],l[f+1]-this._EOLLength):a.substring(l[f],l[f+1]).replace(/(\r\n|\r|\n)$/,""),e[t++]=i;return!this._EOLNormalized&&a.charCodeAt(l[u]+s.end.column-1)===13?(r=!0,s.end.column===0?t--:i=a.substr(l[u],s.end.column-1)):i=a.substr(l[u],s.end.column),!0}),r&&(e[t++]=i,i=""),e[t++]=i,e}getLength(){return this._length}getLineCount(){return this._lineCnt}getLineContent(e){return this._lastVisitedLine.lineNumber===e?this._lastVisitedLine.value:(this._lastVisitedLine.lineNumber=e,e===this._lineCnt?this._lastVisitedLine.value=this.getLineRawContent(e):this._EOLNormalized?this._lastVisitedLine.value=this.getLineRawContent(e,this._EOLLength):this._lastVisitedLine.value=this.getLineRawContent(e).replace(/(\r\n|\r|\n)$/,""),this._lastVisitedLine.value)}_getCharCode(e){if(e.remainder===e.node.piece.length){const t=e.node.next();if(!t)return 0;const i=this._buffers[t.piece.bufferIndex],r=this.offsetInBuffer(t.piece.bufferIndex,t.piece.start);return i.buffer.charCodeAt(r)}else{const t=this._buffers[e.node.piece.bufferIndex],r=this.offsetInBuffer(e.node.piece.bufferIndex,e.node.piece.start)+e.remainder;return t.buffer.charCodeAt(r)}}getLineCharCode(e,t){const i=this.nodeAt2(e,t+1);return this._getCharCode(i)}getLineLength(e){if(e===this.getLineCount()){const t=this.getOffsetAt(e,1);return this.getLength()-t}return this.getOffsetAt(e+1,1)-this.getOffsetAt(e,1)-this._EOLLength}getCharCode(e){const t=this.nodeAt(e);return this._getCharCode(t)}getNearestChunk(e){const t=this.nodeAt(e);if(t.remainder===t.node.piece.length){const i=t.node.next();if(!i||i===te)return"";const r=this._buffers[i.piece.bufferIndex],n=this.offsetInBuffer(i.piece.bufferIndex,i.piece.start);return r.buffer.substring(n,n+i.piece.length)}else{const i=this._buffers[t.node.piece.bufferIndex],r=this.offsetInBuffer(t.node.piece.bufferIndex,t.node.piece.start),n=r+t.remainder,s=r+t.node.piece.length;return i.buffer.substring(n,s)}}findMatchesInNode(e,t,i,r,n,s,o,a,l,c,u){const d=this._buffers[e.piece.bufferIndex],f=this.offsetInBuffer(e.piece.bufferIndex,e.piece.start),p=this.offsetInBuffer(e.piece.bufferIndex,n),m=this.offsetInBuffer(e.piece.bufferIndex,s);let _;const b={line:0,column:0};let E,C;t._wordSeparators?(E=d.buffer.substring(p,m),C=T=>T+p,t.reset(0)):(E=d.buffer,C=T=>T,t.reset(p));do if(_=t.next(E),_){if(C(_.index)>=m)return c;this.positionInBuffer(e,C(_.index)-f,b);const T=this.getLineFeedCnt(e.piece.bufferIndex,n,b),j=b.line===n.line?b.column-n.column+r:b.column+1,M=j+_[0].length;if(u[c++]=pI(new Fe(i+T,j,i+T,M),_,a),C(_.index)+_[0].length>=m||c>=l)return c}while(_);return c}findMatchesLineByLine(e,t,i,r){const n=[];let s=0;const o=new dN(t.wordSeparators,t.regex);let a=this.nodeAt2(e.startLineNumber,e.startColumn);if(a===null)return[];const l=this.nodeAt2(e.endLineNumber,e.endColumn);if(l===null)return[];let c=this.positionInBuffer(a.node,a.remainder);const u=this.positionInBuffer(l.node,l.remainder);if(a.node===l.node)return this.findMatchesInNode(a.node,o,e.startLineNumber,e.startColumn,c,u,t,i,r,s,n),n;let d=e.startLineNumber,f=a.node;for(;f!==l.node;){const m=this.getLineFeedCnt(f.piece.bufferIndex,c,f.piece.end);if(m>=1){const b=this._buffers[f.piece.bufferIndex].lineStarts,E=this.offsetInBuffer(f.piece.bufferIndex,f.piece.start),C=b[c.line+m],T=d===e.startLineNumber?e.startColumn:1;if(s=this.findMatchesInNode(f,o,d,T,c,this.positionInBuffer(f,C-E),t,i,r,s,n),s>=r)return n;d+=m}const _=d===e.startLineNumber?e.startColumn-1:0;if(d===e.endLineNumber){const b=this.getLineContent(d).substring(_,e.endColumn-1);return s=this._findMatchesInLine(t,o,b,e.endLineNumber,_,s,n,i,r),n}if(s=this._findMatchesInLine(t,o,this.getLineContent(d).substr(_),d,_,s,n,i,r),s>=r)return n;d++,a=this.nodeAt2(d,1),f=a.node,c=this.positionInBuffer(a.node,a.remainder)}if(d===e.endLineNumber){const m=d===e.startLineNumber?e.startColumn-1:0,_=this.getLineContent(d).substring(m,e.endColumn-1);return s=this._findMatchesInLine(t,o,_,e.endLineNumber,m,s,n,i,r),n}const p=d===e.startLineNumber?e.startColumn:1;return s=this.findMatchesInNode(l.node,o,d,p,c,u,t,i,r,s,n),n}_findMatchesInLine(e,t,i,r,n,s,o,a,l){const c=e.wordSeparators;if(!a&&e.simpleSearch){const d=e.simpleSearch,f=d.length,p=i.length;let m=-f;for(;(m=i.indexOf(d,m+f))!==-1;)if((!c||gI(c,i,p,m,f))&&(o[s++]=new F_(new Fe(r,m+1+n,r,m+1+f+n),null),s>=l))return s;return s}let u;t.reset(0);do if(u=t.next(i),u&&(o[s++]=pI(new Fe(r,u.index+1+n,r,u.index+1+u[0].length+n),u,a),s>=l))return s;while(u);return s}insert(e,t,i=!1){if(this._EOLNormalized=this._EOLNormalized&&i,this._lastVisitedLine.lineNumber=0,this._lastVisitedLine.value="",this.root!==te){const{node:r,remainder:n,nodeStartOffset:s}=this.nodeAt(e),o=r.piece,a=o.bufferIndex,l=this.positionInBuffer(r,n);if(r.piece.bufferIndex===0&&o.end.line===this._lastChangeBufferPos.line&&o.end.column===this._lastChangeBufferPos.column&&s+o.length===e&&t.length<_n){this.appendToNode(r,t),this.computeBufferMetadata();return}if(s===e)this.insertContentToNodeLeft(t,r),this._searchCache.validate(e);else if(s+r.piece.length>e){const c=[];let u=new yi(o.bufferIndex,l,o.end,this.getLineFeedCnt(o.bufferIndex,l,o.end),this.offsetInBuffer(a,o.end)-this.offsetInBuffer(a,l));if(this.shouldCheckCRLF()&&this.endWithCR(t)&&this.nodeCharCodeAt(r,n)===10){const m={line:u.start.line+1,column:0};u=new yi(u.bufferIndex,m,u.end,this.getLineFeedCnt(u.bufferIndex,m,u.end),u.length-1),t+=`
`}if(this.shouldCheckCRLF()&&this.startWithLF(t))if(this.nodeCharCodeAt(r,n-1)===13){const m=this.positionInBuffer(r,n-1);this.deleteNodeTail(r,m),t="\r"+t,r.piece.length===0&&c.push(r)}else this.deleteNodeTail(r,l);else this.deleteNodeTail(r,l);const d=this.createNewPieces(t);u.length>0&&this.rbInsertRight(r,u);let f=r;for(let p=0;p<d.length;p++)f=this.rbInsertRight(f,d[p]);this.deleteNodes(c)}else this.insertContentToNodeRight(t,r)}else{const r=this.createNewPieces(t);let n=this.rbInsertLeft(null,r[0]);for(let s=1;s<r.length;s++)n=this.rbInsertRight(n,r[s])}this.computeBufferMetadata()}delete(e,t){if(this._lastVisitedLine.lineNumber=0,this._lastVisitedLine.value="",t<=0||this.root===te)return;const i=this.nodeAt(e),r=this.nodeAt(e+t),n=i.node,s=r.node;if(n===s){const d=this.positionInBuffer(n,i.remainder),f=this.positionInBuffer(n,r.remainder);if(i.nodeStartOffset===e){if(t===n.piece.length){const p=n.next();Sp(this,n),this.validateCRLFWithPrevNode(p),this.computeBufferMetadata();return}this.deleteNodeHead(n,f),this._searchCache.validate(e),this.validateCRLFWithPrevNode(n),this.computeBufferMetadata();return}if(i.nodeStartOffset+n.piece.length===e+t){this.deleteNodeTail(n,d),this.validateCRLFWithNextNode(n),this.computeBufferMetadata();return}this.shrinkNode(n,d,f),this.computeBufferMetadata();return}const o=[],a=this.positionInBuffer(n,i.remainder);this.deleteNodeTail(n,a),this._searchCache.validate(e),n.piece.length===0&&o.push(n);const l=this.positionInBuffer(s,r.remainder);this.deleteNodeHead(s,l),s.piece.length===0&&o.push(s);const c=n.next();for(let d=c;d!==te&&d!==s;d=d.next())o.push(d);const u=n.piece.length===0?n.prev():n;this.deleteNodes(o),this.validateCRLFWithNextNode(u),this.computeBufferMetadata()}insertContentToNodeLeft(e,t){const i=[];if(this.shouldCheckCRLF()&&this.endWithCR(e)&&this.startWithLF(t)){const s=t.piece,o={line:s.start.line+1,column:0},a=new yi(s.bufferIndex,o,s.end,this.getLineFeedCnt(s.bufferIndex,o,s.end),s.length-1);t.piece=a,e+=`
`,vn(this,t,-1,-1),t.piece.length===0&&i.push(t)}const r=this.createNewPieces(e);let n=this.rbInsertLeft(t,r[r.length-1]);for(let s=r.length-2;s>=0;s--)n=this.rbInsertLeft(n,r[s]);this.validateCRLFWithPrevNode(n),this.deleteNodes(i)}insertContentToNodeRight(e,t){this.adjustCarriageReturnFromNext(e,t)&&(e+=`
`);const i=this.createNewPieces(e),r=this.rbInsertRight(t,i[0]);let n=r;for(let s=1;s<i.length;s++)n=this.rbInsertRight(n,i[s]);this.validateCRLFWithPrevNode(r)}positionInBuffer(e,t,i){const r=e.piece,n=e.piece.bufferIndex,s=this._buffers[n].lineStarts,a=s[r.start.line]+r.start.column+t;let l=r.start.line,c=r.end.line,u=0,d=0,f=0;for(;l<=c&&(u=l+(c-l)/2|0,f=s[u],u!==c);)if(d=s[u+1],a<f)c=u-1;else if(a>=d)l=u+1;else break;return i?(i.line=u,i.column=a-f,null):{line:u,column:a-f}}getLineFeedCnt(e,t,i){if(i.column===0)return i.line-t.line;const r=this._buffers[e].lineStarts;if(i.line===r.length-1)return i.line-t.line;const n=r[i.line+1],s=r[i.line]+i.column;if(n>s+1)return i.line-t.line;const o=s-1;return this._buffers[e].buffer.charCodeAt(o)===13?i.line-t.line+1:i.line-t.line}offsetInBuffer(e,t){return this._buffers[e].lineStarts[t.line]+t.column}deleteNodes(e){for(let t=0;t<e.length;t++)Sp(this,e[t])}createNewPieces(e){if(e.length>_n){const c=[];for(;e.length>_n;){const d=e.charCodeAt(_n-1);let f;d===13||d>=55296&&d<=56319?(f=e.substring(0,_n-1),e=e.substring(_n-1)):(f=e.substring(0,_n),e=e.substring(_n));const p=wn(f);c.push(new yi(this._buffers.length,{line:0,column:0},{line:p.length-1,column:f.length-p[p.length-1]},p.length-1,f.length)),this._buffers.push(new co(f,p))}const u=wn(e);return c.push(new yi(this._buffers.length,{line:0,column:0},{line:u.length-1,column:e.length-u[u.length-1]},u.length-1,e.length)),this._buffers.push(new co(e,u)),c}let t=this._buffers[0].buffer.length;const i=wn(e,!1);let r=this._lastChangeBufferPos;if(this._buffers[0].lineStarts[this._buffers[0].lineStarts.length-1]===t&&t!==0&&this.startWithLF(e)&&this.endWithCR(this._buffers[0].buffer)){this._lastChangeBufferPos={line:this._lastChangeBufferPos.line,column:this._lastChangeBufferPos.column+1},r=this._lastChangeBufferPos;for(let c=0;c<i.length;c++)i[c]+=t+1;this._buffers[0].lineStarts=this._buffers[0].lineStarts.concat(i.slice(1)),this._buffers[0].buffer+="_"+e,t+=1}else{if(t!==0)for(let c=0;c<i.length;c++)i[c]+=t;this._buffers[0].lineStarts=this._buffers[0].lineStarts.concat(i.slice(1)),this._buffers[0].buffer+=e}const n=this._buffers[0].buffer.length,s=this._buffers[0].lineStarts.length-1,o=n-this._buffers[0].lineStarts[s],a={line:s,column:o},l=new yi(0,r,a,this.getLineFeedCnt(0,r,a),n-t);return this._lastChangeBufferPos=a,[l]}getLinesRawContent(){return this.getContentOfSubTree(this.root)}getLineRawContent(e,t=0){let i=this.root,r="";const n=this._searchCache.get2(e);if(n){i=n.node;const s=this.getAccumulatedValue(i,e-n.nodeStartLineNumber-1),o=this._buffers[i.piece.bufferIndex].buffer,a=this.offsetInBuffer(i.piece.bufferIndex,i.piece.start);if(n.nodeStartLineNumber+i.piece.lineFeedCnt===e)r=o.substring(a+s,a+i.piece.length);else{const l=this.getAccumulatedValue(i,e-n.nodeStartLineNumber);return o.substring(a+s,a+l-t)}}else{let s=0;const o=e;for(;i!==te;)if(i.left!==te&&i.lf_left>=e-1)i=i.left;else if(i.lf_left+i.piece.lineFeedCnt>e-1){const a=this.getAccumulatedValue(i,e-i.lf_left-2),l=this.getAccumulatedValue(i,e-i.lf_left-1),c=this._buffers[i.piece.bufferIndex].buffer,u=this.offsetInBuffer(i.piece.bufferIndex,i.piece.start);return s+=i.size_left,this._searchCache.set({node:i,nodeStartOffset:s,nodeStartLineNumber:o-(e-1-i.lf_left)}),c.substring(u+a,u+l-t)}else if(i.lf_left+i.piece.lineFeedCnt===e-1){const a=this.getAccumulatedValue(i,e-i.lf_left-2),l=this._buffers[i.piece.bufferIndex].buffer,c=this.offsetInBuffer(i.piece.bufferIndex,i.piece.start);r=l.substring(c+a,c+i.piece.length);break}else e-=i.lf_left+i.piece.lineFeedCnt,s+=i.size_left+i.piece.length,i=i.right}for(i=i.next();i!==te;){const s=this._buffers[i.piece.bufferIndex].buffer;if(i.piece.lineFeedCnt>0){const o=this.getAccumulatedValue(i,0),a=this.offsetInBuffer(i.piece.bufferIndex,i.piece.start);return r+=s.substring(a,a+o-t),r}else{const o=this.offsetInBuffer(i.piece.bufferIndex,i.piece.start);r+=s.substr(o,i.piece.length)}i=i.next()}return r}computeBufferMetadata(){let e=this.root,t=1,i=0;for(;e!==te;)t+=e.lf_left+e.piece.lineFeedCnt,i+=e.size_left+e.piece.length,e=e.right;this._lineCnt=t,this._length=i,this._searchCache.validate(this._length)}getIndexOf(e,t){const i=e.piece,r=this.positionInBuffer(e,t),n=r.line-i.start.line;if(this.offsetInBuffer(i.bufferIndex,i.end)-this.offsetInBuffer(i.bufferIndex,i.start)===t){const s=this.getLineFeedCnt(e.piece.bufferIndex,i.start,r);if(s!==n)return{index:s,remainder:0}}return{index:n,remainder:r.column}}getAccumulatedValue(e,t){if(t<0)return 0;const i=e.piece,r=this._buffers[i.bufferIndex].lineStarts,n=i.start.line+t+1;return n>i.end.line?r[i.end.line]+i.end.column-r[i.start.line]-i.start.column:r[n]-r[i.start.line]-i.start.column}deleteNodeTail(e,t){const i=e.piece,r=i.lineFeedCnt,n=this.offsetInBuffer(i.bufferIndex,i.end),s=t,o=this.offsetInBuffer(i.bufferIndex,s),a=this.getLineFeedCnt(i.bufferIndex,i.start,s),l=a-r,c=o-n,u=i.length+c;e.piece=new yi(i.bufferIndex,i.start,s,a,u),vn(this,e,c,l)}deleteNodeHead(e,t){const i=e.piece,r=i.lineFeedCnt,n=this.offsetInBuffer(i.bufferIndex,i.start),s=t,o=this.getLineFeedCnt(i.bufferIndex,s,i.end),a=this.offsetInBuffer(i.bufferIndex,s),l=o-r,c=n-a,u=i.length+c;e.piece=new yi(i.bufferIndex,s,i.end,o,u),vn(this,e,c,l)}shrinkNode(e,t,i){const r=e.piece,n=r.start,s=r.end,o=r.length,a=r.lineFeedCnt,l=t,c=this.getLineFeedCnt(r.bufferIndex,r.start,l),u=this.offsetInBuffer(r.bufferIndex,t)-this.offsetInBuffer(r.bufferIndex,n);e.piece=new yi(r.bufferIndex,r.start,l,c,u),vn(this,e,u-o,c-a);const d=new yi(r.bufferIndex,i,s,this.getLineFeedCnt(r.bufferIndex,i,s),this.offsetInBuffer(r.bufferIndex,s)-this.offsetInBuffer(r.bufferIndex,i)),f=this.rbInsertRight(e,d);this.validateCRLFWithPrevNode(f)}appendToNode(e,t){this.adjustCarriageReturnFromNext(t,e)&&(t+=`
`);const i=this.shouldCheckCRLF()&&this.startWithLF(t)&&this.endWithCR(e),r=this._buffers[0].buffer.length;this._buffers[0].buffer+=t;const n=wn(t,!1);for(let f=0;f<n.length;f++)n[f]+=r;if(i){const f=this._buffers[0].lineStarts[this._buffers[0].lineStarts.length-2];this._buffers[0].lineStarts.pop(),this._lastChangeBufferPos={line:this._lastChangeBufferPos.line-1,column:r-f}}this._buffers[0].lineStarts=this._buffers[0].lineStarts.concat(n.slice(1));const s=this._buffers[0].lineStarts.length-1,o=this._buffers[0].buffer.length-this._buffers[0].lineStarts[s],a={line:s,column:o},l=e.piece.length+t.length,c=e.piece.lineFeedCnt,u=this.getLineFeedCnt(0,e.piece.start,a),d=u-c;e.piece=new yi(e.piece.bufferIndex,e.piece.start,a,u,l),this._lastChangeBufferPos=a,vn(this,e,t.length,d)}nodeAt(e){let t=this.root;const i=this._searchCache.get(e);if(i)return{node:i.node,nodeStartOffset:i.nodeStartOffset,remainder:e-i.nodeStartOffset};let r=0;for(;t!==te;)if(t.size_left>e)t=t.left;else if(t.size_left+t.piece.length>=e){r+=t.size_left;const n={node:t,remainder:e-t.size_left,nodeStartOffset:r};return this._searchCache.set(n),n}else e-=t.size_left+t.piece.length,r+=t.size_left+t.piece.length,t=t.right;return null}nodeAt2(e,t){let i=this.root,r=0;for(;i!==te;)if(i.left!==te&&i.lf_left>=e-1)i=i.left;else if(i.lf_left+i.piece.lineFeedCnt>e-1){const n=this.getAccumulatedValue(i,e-i.lf_left-2),s=this.getAccumulatedValue(i,e-i.lf_left-1);return r+=i.size_left,{node:i,remainder:Math.min(n+t-1,s),nodeStartOffset:r}}else if(i.lf_left+i.piece.lineFeedCnt===e-1){const n=this.getAccumulatedValue(i,e-i.lf_left-2);if(n+t-1<=i.piece.length)return{node:i,remainder:n+t-1,nodeStartOffset:r};t-=i.piece.length-n;break}else e-=i.lf_left+i.piece.lineFeedCnt,r+=i.size_left+i.piece.length,i=i.right;for(i=i.next();i!==te;){if(i.piece.lineFeedCnt>0){const n=this.getAccumulatedValue(i,0),s=this.offsetOfNode(i);return{node:i,remainder:Math.min(t-1,n),nodeStartOffset:s}}else if(i.piece.length>=t-1){const n=this.offsetOfNode(i);return{node:i,remainder:t-1,nodeStartOffset:n}}else t-=i.piece.length;i=i.next()}return null}nodeCharCodeAt(e,t){if(e.piece.lineFeedCnt<1)return-1;const i=this._buffers[e.piece.bufferIndex],r=this.offsetInBuffer(e.piece.bufferIndex,e.piece.start)+t;return i.buffer.charCodeAt(r)}offsetOfNode(e){if(!e)return 0;let t=e.size_left;for(;e!==this.root;)e.parent.right===e&&(t+=e.parent.size_left+e.parent.piece.length),e=e.parent;return t}shouldCheckCRLF(){return!(this._EOLNormalized&&this._EOL===`
`)}startWithLF(e){if(typeof e=="string")return e.charCodeAt(0)===10;if(e===te||e.piece.lineFeedCnt===0)return!1;const t=e.piece,i=this._buffers[t.bufferIndex].lineStarts,r=t.start.line,n=i[r]+t.start.column;return r===i.length-1||i[r+1]>n+1?!1:this._buffers[t.bufferIndex].buffer.charCodeAt(n)===10}endWithCR(e){return typeof e=="string"?e.charCodeAt(e.length-1)===13:e===te||e.piece.lineFeedCnt===0?!1:this.nodeCharCodeAt(e,e.piece.length-1)===13}validateCRLFWithPrevNode(e){if(this.shouldCheckCRLF()&&this.startWithLF(e)){const t=e.prev();this.endWithCR(t)&&this.fixCRLF(t,e)}}validateCRLFWithNextNode(e){if(this.shouldCheckCRLF()&&this.endWithCR(e)){const t=e.next();this.startWithLF(t)&&this.fixCRLF(e,t)}}fixCRLF(e,t){const i=[],r=this._buffers[e.piece.bufferIndex].lineStarts;let n;e.piece.end.column===0?n={line:e.piece.end.line-1,column:r[e.piece.end.line]-r[e.piece.end.line-1]-1}:n={line:e.piece.end.line,column:e.piece.end.column-1};const s=e.piece.length-1,o=e.piece.lineFeedCnt-1;e.piece=new yi(e.piece.bufferIndex,e.piece.start,n,o,s),vn(this,e,-1,-1),e.piece.length===0&&i.push(e);const a={line:t.piece.start.line+1,column:0},l=t.piece.length-1,c=this.getLineFeedCnt(t.piece.bufferIndex,a,t.piece.end);t.piece=new yi(t.piece.bufferIndex,a,t.piece.end,c,l),vn(this,t,-1,-1),t.piece.length===0&&i.push(t);const u=this.createNewPieces(`\r
`);this.rbInsertRight(e,u[0]);for(let d=0;d<i.length;d++)Sp(this,i[d])}adjustCarriageReturnFromNext(e,t){if(this.shouldCheckCRLF()&&this.endWithCR(e)){const i=t.next();if(this.startWithLF(i)){if(e+=`
`,i.piece.length===1)Sp(this,i);else{const r=i.piece,n={line:r.start.line+1,column:0},s=r.length-1,o=this.getLineFeedCnt(r.bufferIndex,n,r.end);i.piece=new yi(r.bufferIndex,n,r.end,o,s),vn(this,i,-1,-1)}return!0}}return!1}iterate(e,t){if(e===te)return t(te);const i=this.iterate(e.left,t);return i&&t(e)&&this.iterate(e.right,t)}getNodeContent(e){if(e===te)return"";const t=this._buffers[e.piece.bufferIndex],i=e.piece,r=this.offsetInBuffer(i.bufferIndex,i.start),n=this.offsetInBuffer(i.bufferIndex,i.end);return t.buffer.substring(r,n)}getPieceContent(e){const t=this._buffers[e.bufferIndex],i=this.offsetInBuffer(e.bufferIndex,e.start),r=this.offsetInBuffer(e.bufferIndex,e.end);return t.buffer.substring(i,r)}rbInsertRight(e,t){const i=new X0(t,1);if(i.left=te,i.right=te,i.parent=te,i.size_left=0,i.lf_left=0,this.root===te)this.root=i,i.color=0;else if(e.right===te)e.right=i,i.parent=e;else{const n=Z0(e.right);n.left=i,i.parent=n}return Fk(this,i),i}rbInsertLeft(e,t){const i=new X0(t,1);if(i.left=te,i.right=te,i.parent=te,i.size_left=0,i.lf_left=0,this.root===te)this.root=i,i.color=0;else if(e.left===te)e.left=i,i.parent=e;else{const r=Ok(e.left);r.right=i,i.parent=r}return Fk(this,i),i}getContentOfSubTree(e){let t="";return this.iterate(e,i=>(t+=this.getNodeContent(i),!0)),t}},Hk;(function(e){e[e.Unknown=0]="Unknown",e[e.Invalid=3]="Invalid",e[e.LF=1]="LF",e[e.CRLF=2]="CRLF"})(Hk||(Hk={}));function tw(e){let t=0,i=0,r=0,n=0;for(let s=0,o=e.length;s<o;s++){const a=e.charCodeAt(s);a===13?(t===0&&(i=s),t++,s+1<o&&e.charCodeAt(s+1)===10?(n|=2,s++):n|=3,r=s+1):a===10&&(n|=1,t===0&&(i=s),t++,r=s+1)}return t===0&&(i=e.length),[t,i,e.length-r,n]}var iw;function S$(){return iw||(iw=new TextDecoder("UTF-16LE")),iw}function E$(e,t,i){const r=new Uint16Array(e.buffer,t,i);return i>0&&(r[0]===65279||r[0]===65534)?C$(e,t,i):S$().decode(r)}function C$(e,t,i){const r=[];let n=0;for(let s=0;s<i;s++){const o=P9(e,t);t+=2,r[n++]=String.fromCharCode(o)}return r.join("")}function Ep(e){return e.replace(/\n/g,"\\n").replace(/\r/g,"\\r")}var D$=class Br{get oldLength(){return this.oldText.length}get oldEnd(){return this.oldPosition+this.oldText.length}get newLength(){return this.newText.length}get newEnd(){return this.newPosition+this.newText.length}constructor(t,i,r,n){this.oldPosition=t,this.oldText=i,this.newPosition=r,this.newText=n}toString(){return this.oldText.length===0?`(insert@${this.oldPosition} "${Ep(this.newText)}")`:this.newText.length===0?`(delete@${this.oldPosition} "${Ep(this.oldText)}")`:`(replace@${this.oldPosition} "${Ep(this.oldText)}" with "${Ep(this.newText)}")`}static _writeStringSize(t){return 4+2*t.length}static _writeString(t,i,r){const n=i.length;Ru(t,n,r),r+=4;for(let s=0;s<n;s++)T9(t,i.charCodeAt(s),r),r+=2;return r}static _readString(t,i){const r=Au(t,i);return i+=4,E$(t,i,r)}writeSize(){return 8+Br._writeStringSize(this.oldText)+Br._writeStringSize(this.newText)}write(t,i){return Ru(t,this.oldPosition,i),i+=4,Ru(t,this.newPosition,i),i+=4,i=Br._writeString(t,this.oldText,i),i=Br._writeString(t,this.newText,i),i}static read(t,i,r){const n=Au(t,i);i+=4;const s=Au(t,i);i+=4;const o=Br._readString(t,i);i+=Br._writeStringSize(o);const a=Br._readString(t,i);return i+=Br._writeStringSize(a),r.push(new Br(n,o,s,a)),i}},I$=class bu extends se{constructor(t,i,r,n,s,o,a){super(),this._onDidChangeContent=this._register(new P),this.onDidChangeContent=this._onDidChangeContent.event,this._BOM=i,this._mightContainNonBasicASCII=!o,this._mightContainRTL=n,this._mightContainUnusualLineTerminators=s,this._pieceTree=new x$(t,r,a)}equals(t){return!(t instanceof bu)||this._BOM!==t._BOM||this.getEOL()!==t.getEOL()?!1:this._pieceTree.equal(t._pieceTree)}mightContainRTL(){return this._mightContainRTL}mightContainUnusualLineTerminators(){return this._mightContainUnusualLineTerminators}resetMightContainUnusualLineTerminators(){this._mightContainUnusualLineTerminators=!1}mightContainNonBasicASCII(){return this._mightContainNonBasicASCII}getBOM(){return this._BOM}getEOL(){return this._pieceTree.getEOL()}createSnapshot(t){return this._pieceTree.createSnapshot(t?this._BOM:"")}getOffsetAt(t,i){return this._pieceTree.getOffsetAt(t,i)}getPositionAt(t){return this._pieceTree.getPositionAt(t)}getRangeAt(t,i){const r=t+i,n=this.getPositionAt(t),s=this.getPositionAt(r);return new Fe(n.lineNumber,n.column,s.lineNumber,s.column)}getValueInRange(t,i=0){if(t.isEmpty())return"";const r=this._getEndOfLine(i);return this._pieceTree.getValueInRange(t,r)}getValueLengthInRange(t,i=0){if(t.isEmpty())return 0;if(t.startLineNumber===t.endLineNumber)return t.endColumn-t.startColumn;const r=this.getOffsetAt(t.startLineNumber,t.startColumn),n=this.getOffsetAt(t.endLineNumber,t.endColumn);let s=0;const o=this._getEndOfLine(i),a=this.getEOL();if(o.length!==a.length){const l=o.length-a.length,c=t.endLineNumber-t.startLineNumber;s=l*c}return n-r+s}getCharacterCountInRange(t,i=0){if(this._mightContainNonBasicASCII){let r=0;const n=t.startLineNumber,s=t.endLineNumber;for(let o=n;o<=s;o++){const a=this.getLineContent(o),l=o===n?t.startColumn-1:0,c=o===s?t.endColumn-1:a.length;for(let u=l;u<c;u++)Qu(a.charCodeAt(u))?(r=r+1,u=u+1):r=r+1}return r+=this._getEndOfLine(i).length*(s-n),r}return this.getValueLengthInRange(t,i)}getNearestChunk(t){return this._pieceTree.getNearestChunk(t)}getLength(){return this._pieceTree.getLength()}getLineCount(){return this._pieceTree.getLineCount()}getLinesContent(){return this._pieceTree.getLinesContent()}getLineContent(t){return this._pieceTree.getLineContent(t)}getLineCharCode(t,i){return this._pieceTree.getLineCharCode(t,i)}getCharCode(t){return this._pieceTree.getCharCode(t)}getLineLength(t){return this._pieceTree.getLineLength(t)}getLineMinColumn(t){return 1}getLineMaxColumn(t){return this.getLineLength(t)+1}getLineFirstNonWhitespaceColumn(t){const i=Dg(this.getLineContent(t));return i===-1?0:i+1}getLineLastNonWhitespaceColumn(t){const i=HP(this.getLineContent(t));return i===-1?0:i+2}_getEndOfLine(t){switch(t){case 1:return`
`;case 2:return`\r
`;case 0:return this.getEOL();default:throw new Error("Unknown EOL preference")}}setEOL(t){this._pieceTree.setEOL(t)}applyEdits(t,i,r){let n=this._mightContainRTL,s=this._mightContainUnusualLineTerminators,o=this._mightContainNonBasicASCII,a=!0,l=[];for(let _=0;_<t.length;_++){const b=t[_];a&&b._isTracked&&(a=!1);const E=b.range;if(b.text){let B=!0;o||(B=!jP(b.text),o=B),!n&&B&&(n=hb(b.text)),!s&&B&&(s=fb(b.text))}let C="",T=0,j=0,M=0;if(b.text){let B;[T,j,M,B]=tw(b.text);const K=this.getEOL();B===0||B===(K===`\r
`?2:1)?C=b.text:C=b.text.replace(/\r\n|\r|\n/g,K)}l[_]={sortIndex:_,identifier:b.identifier||null,range:E,rangeOffset:this.getOffsetAt(E.startLineNumber,E.startColumn),rangeLength:this.getValueLengthInRange(E),text:C,eolCount:T,firstLineLength:j,lastLineLength:M,forceMoveMarkers:!!b.forceMoveMarkers,isAutoWhitespaceEdit:b.isAutoWhitespaceEdit||!1}}l.sort(bu._sortOpsAscending);let c=!1;for(let _=0,b=l.length-1;_<b;_++){const E=l[_].range.getEndPosition(),C=l[_+1].range.getStartPosition();if(C.isBeforeOrEqual(E)){if(C.isBefore(E))throw new Error("Overlapping ranges are not allowed!");c=!0}}a&&(l=this._reduceOperations(l));const u=r||i?bu._getInverseEditRanges(l):[],d=[];if(i)for(let _=0;_<l.length;_++){const b=l[_],E=u[_];if(b.isAutoWhitespaceEdit&&b.range.isEmpty())for(let C=E.startLineNumber;C<=E.endLineNumber;C++){let T="";C===E.startLineNumber&&(T=this.getLineContent(b.range.startLineNumber),Dg(T)!==-1)||d.push({lineNumber:C,oldContent:T})}}let f=null;if(r){let _=0;f=[];for(let b=0;b<l.length;b++){const E=l[b],C=u[b],T=this.getValueInRange(E.range),j=E.rangeOffset+_;_+=E.text.length-T.length,f[b]={sortIndex:E.sortIndex,identifier:E.identifier,range:C,text:T,textChange:new D$(E.rangeOffset,T,j,E.text)}}c||f.sort((b,E)=>b.sortIndex-E.sortIndex)}this._mightContainRTL=n,this._mightContainUnusualLineTerminators=s,this._mightContainNonBasicASCII=o;const p=this._doApplyEdits(l);let m=null;if(i&&d.length>0){d.sort((_,b)=>b.lineNumber-_.lineNumber),m=[];for(let _=0,b=d.length;_<b;_++){const E=d[_].lineNumber;if(_>0&&d[_-1].lineNumber===E)continue;const C=d[_].oldContent,T=this.getLineContent(E);T.length===0||T===C||Dg(T)!==-1||m.push(E)}}return this._onDidChangeContent.fire(),new lN(f,p,m)}_reduceOperations(t){return t.length<1e3?t:[this._toSingleEditOperation(t)]}_toSingleEditOperation(t){let i=!1;const r=t[0].range,n=t[t.length-1].range,s=new Fe(r.startLineNumber,r.startColumn,n.endLineNumber,n.endColumn);let o=r.startLineNumber,a=r.startColumn;const l=[];for(let p=0,m=t.length;p<m;p++){const _=t[p],b=_.range;i=i||_.forceMoveMarkers,l.push(this.getValueInRange(new Fe(o,a,b.startLineNumber,b.startColumn))),_.text.length>0&&l.push(_.text),o=b.endLineNumber,a=b.endColumn}const c=l.join(""),[u,d,f]=tw(c);return{sortIndex:0,identifier:t[0].identifier,range:s,rangeOffset:this.getOffsetAt(s.startLineNumber,s.startColumn),rangeLength:this.getValueLengthInRange(s,0),text:c,eolCount:u,firstLineLength:d,lastLineLength:f,forceMoveMarkers:i,isAutoWhitespaceEdit:!1}}_doApplyEdits(t){t.sort(bu._sortOpsDescending);const i=[];for(let r=0;r<t.length;r++){const n=t[r],s=n.range.startLineNumber,o=n.range.startColumn,a=n.range.endLineNumber,l=n.range.endColumn;if(s===a&&o===l&&n.text.length===0)continue;n.text?(this._pieceTree.delete(n.rangeOffset,n.rangeLength),this._pieceTree.insert(n.rangeOffset,n.text,!0)):this._pieceTree.delete(n.rangeOffset,n.rangeLength);const c=new Fe(s,o,a,l);i.push({range:c,rangeLength:n.rangeLength,text:n.text,rangeOffset:n.rangeOffset,forceMoveMarkers:n.forceMoveMarkers})}return i}findMatchesLineByLine(t,i,r,n){return this._pieceTree.findMatchesLineByLine(t,i,r,n)}getPieceTree(){return this._pieceTree}static _getInverseEditRange(t,i){const r=t.startLineNumber,n=t.startColumn,[s,o,a]=tw(i);let l;if(i.length>0){const c=s+1;c===1?l=new Fe(r,n,r,n+o):l=new Fe(r,n,r+c-1,a+1)}else l=new Fe(r,n,r,n);return l}static _getInverseEditRanges(t){const i=[];let r=0,n=0,s=null;for(let o=0,a=t.length;o<a;o++){const l=t[o];let c,u;s?s.range.endLineNumber===l.range.startLineNumber?(c=r,u=n+(l.range.startColumn-s.range.endColumn)):(c=r+(l.range.startLineNumber-s.range.endLineNumber),u=l.range.startColumn):(c=l.range.startLineNumber,u=l.range.startColumn);let d;if(l.text.length>0){const f=l.eolCount+1;f===1?d=new Fe(c,u,c,u+l.firstLineLength):d=new Fe(c,u,c+f-1,l.lastLineLength+1)}else d=new Fe(c,u,c,u);r=d.endLineNumber,n=d.endColumn,i.push(d),s=l}return i}static _sortOpsAscending(t,i){const r=Fe.compareRangesUsingEnds(t.range,i.range);return r===0?t.sortIndex-i.sortIndex:r}static _sortOpsDescending(t,i){const r=Fe.compareRangesUsingEnds(t.range,i.range);return r===0?i.sortIndex-t.sortIndex:-r}},k$=class{constructor(e,t,i,r,n,s,o,a,l){this._chunks=e,this._bom=t,this._cr=i,this._lf=r,this._crlf=n,this._containsRTL=s,this._containsUnusualLineTerminators=o,this._isBasicASCII=a,this._normalizeEOL=l}_getEOL(e){const t=this._cr+this._lf+this._crlf,i=this._cr+this._crlf;return t===0?e===1?`
`:`\r
`:i>t/2?`\r
`:`
`}create(e){const t=this._getEOL(e),i=this._chunks;if(this._normalizeEOL&&(t===`\r
`&&(this._cr>0||this._lf>0)||t===`
`&&(this._cr>0||this._crlf>0)))for(let n=0,s=i.length;n<s;n++){const o=i[n].buffer.replace(/\r\n|\r|\n/g,t),a=wn(o);i[n]=new co(o,a)}const r=new I$(i,this._bom,t,this._containsRTL,this._containsUnusualLineTerminators,this._isBasicASCII,this._normalizeEOL);return{textBuffer:r,disposable:r}}getFirstLineText(e){return this._chunks[0].buffer.substr(0,e).split(/\r\n|\r|\n/)[0]}},Uk=class{constructor(){this.chunks=[],this.BOM="",this._hasPreviousChar=!1,this._previousChar=0,this._tmpLineStarts=[],this.cr=0,this.lf=0,this.crlf=0,this.containsRTL=!1,this.containsUnusualLineTerminators=!1,this.isBasicASCII=!0}acceptChunk(e){if(e.length===0)return;this.chunks.length===0&&KP(e)&&(this.BOM=ZP,e=e.substr(1));const t=e.charCodeAt(e.length-1);t===13||t>=55296&&t<=56319?(this._acceptChunk1(e.substr(0,e.length-1),!1),this._hasPreviousChar=!0,this._previousChar=t):(this._acceptChunk1(e,!1),this._hasPreviousChar=!1,this._previousChar=t)}_acceptChunk1(e,t){!t&&e.length===0||(this._hasPreviousChar?this._acceptChunk2(String.fromCharCode(this._previousChar)+e):this._acceptChunk2(e))}_acceptChunk2(e){const t=w$(this._tmpLineStarts,e);this.chunks.push(new co(e,t.lineStarts)),this.cr+=t.cr,this.lf+=t.lf,this.crlf+=t.crlf,t.isBasicASCII||(this.isBasicASCII=!1,this.containsRTL||(this.containsRTL=hb(e)),this.containsUnusualLineTerminators||(this.containsUnusualLineTerminators=fb(e)))}finish(e=!0){return this._finish(),new k$(this.chunks,this.BOM,this.cr,this.lf,this.crlf,this.containsRTL,this.containsUnusualLineTerminators,this.isBasicASCII,e)}_finish(){if(this.chunks.length===0&&this._acceptChunk1("",!0),this._hasPreviousChar){this._hasPreviousChar=!1;const e=this.chunks[this.chunks.length-1];e.buffer+=String.fromCharCode(this._previousChar);const t=wn(e.buffer);e.lineStarts=t,this._previousChar===13&&this.cr++}}},P$=class extends se{constructor(e,t,i){super(),this._source=e,this._inputTextBuffer=t,this._outputs=i,this._outputTextBuffers=void 0}_getFullModelRange(e){const t=e.getLineCount();return new Fe(1,1,t,this._getLineMaxColumn(e,t))}_getLineMaxColumn(e,t){if(t<1||t>e.getLineCount())throw new Error("Illegal value for lineNumber");return e.getLineLength(t)+1}get inputTextBuffer(){if(!this._inputTextBuffer){const e=new Uk;e.acceptChunk(this._source);const t=e.finish(!0),{textBuffer:i,disposable:r}=t.create(1);this._inputTextBuffer=i,this._register(r)}return this._inputTextBuffer}get outputTextBuffers(){return this._outputTextBuffers||(this._outputTextBuffers=this._outputs.map(e=>{const t=new Uk;t.acceptChunk(e);const i=t.finish(!0),{textBuffer:r,disposable:n}=i.create(1);return this._register(n),r})),this._outputTextBuffers}findInInputs(e){const i=new hI(e,!1,!1,null).parseSearchRequest();if(!i)return[];const r=this._getFullModelRange(this.inputTextBuffer);return this.inputTextBuffer.findMatchesLineByLine(r,i,!0,5e3)}findInOutputs(e){const i=new hI(e,!1,!1,null).parseSearchRequest();return i?this.outputTextBuffers.map(r=>{const n=r.findMatchesLineByLine(this._getFullModelRange(r),i,!0,5e3);if(n.length!==0)return{textBuffer:r,matches:n}}).filter(r=>!!r):[]}};function Bk(e,t){let i=-1;const r=[];let n=[];return e.forEach(o=>{o.range.startLineNumber!==i&&n.length>0&&(r.push([...n]),n=[]),n.push(o),i=o.range.endLineNumber}),n.length>0&&r.push([...n]),r.map(o=>{const a=[],l=o[0].range.startLineNumber,c=o[o.length-1].range.endLineNumber;for(let u=l;u<=c;u++)a.push(t.getLineContent(u));return new q2(a.join(`
`)+`
`,o.map(u=>new Fe(u.range.startLineNumber-1,u.range.startColumn-1,u.range.endLineNumber-1,u.range.endColumn-1)))})}var gQ=Object.freeze({id:"application",order:100,title:h(4245,null),type:"object"}),T$=Object.freeze({id:"workbench",order:7,title:h(4246,null),type:"object"}),A$=Object.freeze({id:"security",scope:1,title:h(4247,null),type:"object",order:7}),mQ=Object.freeze({id:"problems",title:h(4248,null),type:"object",order:101}),R$=Object.freeze({id:"window",order:8,title:h(4249,null),type:"object"}),L$={ConfigurationMigration:"base.contributions.configuration.migration"},N$=class{constructor(){this.migrations=[],this._onDidRegisterConfigurationMigrations=new P,this.onDidRegisterConfigurationMigration=this._onDidRegisterConfigurationMigrations.event}registerConfigurationMigrations(e){this.migrations.push(...e)}},Cp=new N$;Ht.add(L$.ConfigurationMigration,Cp);var Wk=class extends se{static{this.ID="workbench.contrib.configurationMigration"}constructor(t,i){super(),this.configurationService=t,this.workspaceService=i,this._register(this.workspaceService.onDidChangeWorkspaceFolders(async r=>{for(const n of r.added)await this.migrateConfigurationsForFolder(n,Cp.migrations)})),this.migrateConfigurations(Cp.migrations),this._register(Cp.onDidRegisterConfigurationMigration(r=>this.migrateConfigurations(r)))}async migrateConfigurations(t){await this.migrateConfigurationsForFolder(void 0,t);for(const i of this.workspaceService.getWorkspace().folders)await this.migrateConfigurationsForFolder(i,t)}async migrateConfigurationsForFolder(t,i){await Promise.all([i.map(r=>this.migrateConfigurationsForFolderAndOverride(r,t?.uri))])}async migrateConfigurationsForFolderAndOverride(t,i){const r=this.configurationService.inspect(t.key,{resource:i}),n=this.workspaceService.getWorkbenchState()===3?[["user",2],["userLocal",3],["userRemote",4],["workspace",5],["workspaceFolder",6]]:[["user",2],["userLocal",3],["userRemote",4],["workspace",5]];for(const[s,o]of n){const a=r[s];if(!a)continue;const l=[];if(a.value!==void 0){const c=await this.runMigration(t,s,a.value,i,void 0);for(const u of c??[])l.push([u,[]])}for(const{identifiers:c,value:u}of a.overrides??[])if(u!==void 0){const d=await this.runMigration(t,s,u,i,c);for(const f of d??[])l.push([f,c])}l.length&&await Promise.allSettled(l.map(async([[c,u],d])=>this.configurationService.updateValue(c,u.value,{resource:i,overrideIdentifiers:d},o)))}}async runMigration(t,i,r,n,s){const o=l=>{const u=this.configurationService.inspect(l,{resource:n})[i];if(u)return s?u.overrides?.find(({identifiers:d})=>fi(d,s))?.value:u.value},a=await t.migrateFn(r,o);return Array.isArray(a)?a:[[t.key,a]]}};Wk=__decorate([__param(0,Cd),__param(1,Yg)],Wk);var Vk=class extends se{static{this.ID="workbench.contrib.dynamicWorkbenchSecurityConfiguration"}constructor(t){super(),this.remoteAgentService=t,this._ready=new Dr,this.ready=this._ready.p,this.create()}async create(){try{await this.doCreate()}finally{this._ready.complete()}}async doCreate(){if(!oi&&(await this.remoteAgentService.getEnvironment())?.os!==1)return;Ht.as(Ps.Configuration).registerConfiguration({...A$,properties:{"security.allowedUNCHosts":{type:"array",items:{type:"string",pattern:"^[^\\\\]+$",patternErrorMessage:h(4250,null)},default:[],markdownDescription:h(4251,null),scope:3},"security.restrictUNCAccess":{type:"boolean",default:!0,markdownDescription:h(4252,null),scope:3}}})}};Vk=__decorate([__param(0,vI)],Vk);var hu="window.newWindowProfile",zk=class extends se{static{this.ID="workbench.contrib.dynamicWindowConfiguration"}constructor(t,i){super(),this.userDataProfilesService=t,this.configurationService=i,this.registerNewWindowProfileConfiguration(),this._register(this.userDataProfilesService.onDidChangeProfiles(r=>this.registerNewWindowProfileConfiguration())),this.setNewWindowProfile(),this.checkAndResetNewWindowProfileConfig(),this._register(i.onDidChangeConfiguration(r=>{r.source!==7&&r.affectsConfiguration(hu)&&this.setNewWindowProfile()})),this._register(this.userDataProfilesService.onDidChangeProfiles(()=>this.checkAndResetNewWindowProfileConfig()))}registerNewWindowProfileConfiguration(){const t=Ht.as(Ps.Configuration),i={...R$,properties:{[hu]:{type:["string","null"],default:null,enum:[...this.userDataProfilesService.profiles.map(r=>r.name),null],enumItemLabels:[...this.userDataProfilesService.profiles.map(r=>""),h(4253,null)],description:h(4254,null),scope:1}}};this.configurationNode?t.updateConfigurations({add:[i],remove:[this.configurationNode]}):t.registerConfiguration(i),this.configurationNode=i}setNewWindowProfile(){const t=this.configurationService.getValue(hu);this.newWindowProfile=t?this.userDataProfilesService.profiles.find(i=>i.name===t):void 0}checkAndResetNewWindowProfileConfig(){const t=this.configurationService.getValue(hu);if(!t)return;const i=this.newWindowProfile?this.userDataProfilesService.profiles.find(r=>r.id===this.newWindowProfile.id):void 0;t!==i?.name&&this.configurationService.updateValue(hu,i?.name)}};zk=__decorate([__param(0,uR),__param(1,Cd)],zk);var yQ=U("editorResolverService"),M$=Ht.as(Ps.Configuration),O$={...T$,properties:{"workbench.editorAssociations":{type:"object",markdownDescription:h(13946,null),additionalProperties:{type:"string"}}}};M$.registerConfiguration(O$);var rw;(function(e){e.builtin="builtin",e.option="option",e.exclusive="exclusive",e.default="default"})(rw||(rw={}));var qk;(function(e){e[e.ABORT=1]="ABORT",e[e.NONE=2]="NONE"})(qk||(qk={}));function F$(e,t){if(new Set([V.extension,V.webviewPanel,V.vscodeWorkspaceTrust,V.vscodeSettings]).has(t.scheme))return!1;const n=typeof e=="string"&&e.indexOf(Ne.sep)>=0?`${t.scheme}:${t.path}`:nr(t);return Rl(typeof e=="string"?e.toLowerCase():e,n.toLowerCase())}var $$=class xu{static{this._notebookStatusBarItemProviderHandlePool=0}get activeNotebookEditor(){return this._activeNotebookEditor?.apiEditor}get visibleNotebookEditors(){return this._visibleNotebookEditors.map(t=>t.apiEditor)}constructor(t,i,r,n,s,o,a){this._textDocumentsAndEditors=r,this._textDocuments=n,this._extHostFileSystem=s,this._extHostSearch=o,this._logService=a,this._notebookStatusBarItemProviders=new Map,this._documents=new Ft,this._editors=new Map,this._onDidChangeActiveNotebookEditor=new P,this.onDidChangeActiveNotebookEditor=this._onDidChangeActiveNotebookEditor.event,this._visibleNotebookEditors=[],this._onDidOpenNotebookDocument=new P,this.onDidOpenNotebookDocument=this._onDidOpenNotebookDocument.event,this._onDidCloseNotebookDocument=new P,this.onDidCloseNotebookDocument=this._onDidCloseNotebookDocument.event,this._onDidChangeVisibleNotebookEditors=new P,this.onDidChangeVisibleNotebookEditors=this._onDidChangeVisibleNotebookEditors.event,this._statusBarCache=new _r("NotebookCellStatusBarCache"),this._handlePool=0,this._notebookSerializer=new Map,this._notebookProxy=t.getProxy(W.MainThreadNotebook),this._notebookDocumentsProxy=t.getProxy(W.MainThreadNotebookDocuments),this._notebookEditorsProxy=t.getProxy(W.MainThreadNotebookEditors),this._commandsConverter=i.converter,i.registerArgumentProcessor({processArgument:l=>{if(l&&l.$mid===13){const c=l.notebookEditor?.notebookUri,u=l.cell.handle,f=this._documents.get(c)?.getCell(u);if(f)return f.apiCell}if(l&&l.$mid===14){const c=l.uri,u=this._documents.get(c);if(u)return u.apiNotebook}return l}}),xu._registerApiCommands(i)}getEditorById(t){const i=this._editors.get(t);if(!i)throw new Error(`unknown text editor: ${t}. known editors: ${[...this._editors.keys()]} `);return i}getIdByEditor(t){for(const[i,r]of this._editors)if(r.apiEditor===t)return i}get notebookDocuments(){return[...this._documents.values()]}getNotebookDocument(t,i){const r=this._documents.get(t);if(!r&&!i)throw new Error(`NO notebook document for '${t}'`);return r}static _convertNotebookRegistrationData(t,i){if(!i)return;const r=i.filenamePattern.map(n=>gf.from(n)).filter(n=>n!==void 0);if(i.filenamePattern&&!r){console.warn(`Notebook content provider view options file name pattern is invalid ${i.filenamePattern}`);return}return{extension:t.identifier,providerDisplayName:t.displayName||t.name,displayName:i.displayName,filenamePattern:r,priority:i.exclusive?rw.exclusive:void 0}}registerNotebookCellStatusBarItemProvider(t,i,r){const n=xu._notebookStatusBarItemProviderHandlePool++,s=typeof r.onDidChangeCellStatusBarItems=="function"?xu._notebookStatusBarItemProviderHandlePool++:void 0;this._notebookStatusBarItemProviders.set(n,r),this._notebookProxy.$registerNotebookCellStatusBarItemProvider(n,s,i);let o;return s!==void 0&&(o=r.onDidChangeCellStatusBarItems(a=>this._notebookProxy.$emitCellStatusBarEvent(s))),new Ce(()=>{this._notebookStatusBarItemProviders.delete(n),this._notebookProxy.$unregisterNotebookCellStatusBarItemProvider(n,s),o?.dispose()})}async createNotebookDocument(t){const i=await this._notebookDocumentsProxy.$tryCreateNotebook({viewType:t.viewType,content:t.content&&Gn.from(t.content)});return y.revive(i)}async openNotebookDocument(t){const i=this._documents.get(t);if(i)return i.apiNotebook;const r=await this._notebookDocumentsProxy.$tryOpenNotebook(t),n=this._documents.get(y.revive(r));return xo(n?.apiNotebook)}async showNotebookDocument(t,i){let r;typeof i=="object"?r={position:Rt.from(i.viewColumn),preserveFocus:i.preserveFocus,selections:i.selections&&i.selections.map(Or.from),pinned:typeof i.preview=="boolean"?!i.preview:void 0,label:typeof i.asRepl=="string"?i.asRepl:typeof i.asRepl=="object"?i.asRepl.label:void 0}:r={preserveFocus:!1,pinned:!0};const n=i?.asRepl?"repl":t.notebookType,s=await this._notebookEditorsProxy.$tryShowNotebookDocument(t.uri,n,r),o=s&&this._editors.get(s)?.apiEditor;if(o)return o;throw s?new Error(`Could NOT open editor for "${t.uri.toString()}" because another editor opened in the meantime.`):new Error(`Could NOT open editor for "${t.uri.toString()}".`)}async $provideNotebookCellStatusBarItems(t,i,r,n){const s=this._notebookStatusBarItemProviders.get(t),o=y.revive(i),a=this._documents.get(o);if(!a||!s)return;const l=a.getCellFromIndex(r);if(!l)return;const c=await s.provideCellStatusBarItems(l.apiCell,n);if(!c)return;const u=new he,d=this._statusBarCache.add([u]),p=(Array.isArray(c)?c:[c]).map(m=>A1.from(m,this._commandsConverter,u));return{cacheId:d,items:p}}$releaseNotebookCellStatusBarItems(t){this._statusBarCache.delete(t)}registerNotebookSerializer(t,i,r,n,s){if(Gu(i))throw new Error("viewType cannot be empty or just whitespace");const o=this._handlePool++;return this._notebookSerializer.set(o,{viewType:i,serializer:r,options:n}),this._notebookProxy.$registerNotebookSerializer(o,{id:t.identifier,location:t.extensionLocation},i,L1.from(n),xu._convertNotebookRegistrationData(t,s)),ne(()=>{this._notebookProxy.$unregisterNotebookSerializer(o)})}async $dataToNotebook(t,i,r){const n=this._notebookSerializer.get(t);if(!n)throw new Error("NO serializer found");const s=await n.serializer.deserializeNotebook(i.buffer,r);return new ai(Gn.from(s))}async $notebookToData(t,i,r){const n=this._notebookSerializer.get(t);if(!n)throw new Error("NO serializer found");const s=await n.serializer.serializeNotebook(Gn.to(i.value),r);return ae.wrap(s)}async $saveNotebook(t,i,r,n,s){const o=y.revive(i),a=this._notebookSerializer.get(t);if(this.trace(`enter saveNotebook(versionId: ${r}, ${o.toString()})`),!a)throw new Error("NO serializer found");const l=this._documents.get(o);if(!l)throw new Error("Document NOT found");if(l.versionId!==r)throw new Error("Document version mismatch");if(!this._extHostFileSystem.value.isWritableFileSystem(o.scheme))throw new wm(h(2933,null,this._resourceForError(o)),6);const c={metadata:bx(l.apiNotebook.metadata,m=>!(a.options?.transientDocumentMetadata??{})[m]),cells:[]};for(const m of l.apiNotebook.getCells()){const _=new Ph(m.kind,m.document.getText(),m.document.languageId,m.mime,a.options?.transientOutputs?[]:[...m.outputs],m.metadata,m.executionSummary);_.metadata=bx(m.metadata,b=>!(a.options?.transientCellMetadata??{})[b]),c.cells.push(_)}if(await this._validateWriteFile(o,n),s.isCancellationRequested)throw new Error("canceled");const u=await a.serializer.serializeNotebook(c,s);if(s.isCancellationRequested)throw new Error("canceled");this.trace(`serialized versionId: ${r} ${o.toString()}`),await this._extHostFileSystem.value.writeFile(o,u),this.trace(`Finished write versionId: ${r} ${o.toString()}`);const d=this._extHostFileSystem.getFileSystemProviderExtUri(o.scheme),f=await this._extHostFileSystem.value.stat(o),p={name:d.basename(o),isFile:(f.type&Cs.File)!==0,isDirectory:(f.type&Cs.Directory)!==0,isSymbolicLink:(f.type&Cs.SymbolicLink)!==0,mtime:f.mtime,ctime:f.ctime,size:f.size,readonly:!!((f.permissions??0)&Bo.Readonly)||!this._extHostFileSystem.value.isWritableFileSystem(o.scheme),locked:!!((f.permissions??0)&Bo.Locked),etag:FS({mtime:f.mtime,size:f.size}),children:void 0};return this.trace(`exit saveNotebook(versionId: ${r}, ${o.toString()})`),p}async $searchInNotebooks(t,i,r,n,s){const o=this._notebookSerializer.get(t)?.serializer;if(!o)return{limitHit:!1,results:[]};const a=new ny;await(async(f,p,m)=>{await Promise.all(f.map(async _=>await Promise.all(_.filenamePatterns.map(b=>{const E={_reason:m._reason,folderQueries:m.folderQueries,includePattern:m.includePattern,excludePattern:m.excludePattern,maxResults:m.maxResults,type:1,filePattern:b};return this._extHostSearch.doInternalFileSearchWithCustomCallback(E,p,C=>{C.forEach(T=>{a.has(T)||n.some(M=>_.isFromSettings&&!M.isFromSettings?!1:M.filenamePatterns.some(B=>F$(B,T)))||a.add(T)})}).catch(C=>{if(C.code==="ENOENT")return console.warn("Could not find notebook search results, ignoring notebook results."),{limitHit:!1,messages:[]};throw C})}))))})(r,s,i);const c=new Ft;let u=!1;const d=Array.from(a).map(async f=>{const p=[];try{if(s.isCancellationRequested)return;if(i.maxResults&&[...c.values()].reduce((E,C)=>E+C.cellResults.length,0)>i.maxResults){u=!0;return}const m=[],_=this._documents.get(f);if(_)_.apiNotebook.getCells().forEach(C=>m.push({input:C.document.getText(),outputs:C.outputs.flatMap(T=>T.items.map(j=>j.data.toString()))}));else{const E=await this._extHostFileSystem.value.readFile(f),C=ae.fromString(E.toString()),T=await o.deserializeNotebook(C.buffer,s);if(s.isCancellationRequested)return;Gn.from(T).cells.forEach(M=>m.push({input:M.source,outputs:M.outputs.flatMap(B=>B.items.map(K=>K.valueBytes.toString()))}))}if(s.isCancellationRequested)return;m.forEach((E,C)=>{const T=i.contentPattern.pattern,j=new P$(E.input,void 0,E.outputs),M=j.findInInputs(T),B=j.findInOutputs(T),K=B.flatMap(Y=>Bk(Y.matches,Y.textBuffer)).map((Y,X)=>(Y.webviewIndex=X,Y));if(M.length>0||B.length>0){const Y={index:C,contentResults:Bk(M,j.inputTextBuffer),webviewResults:K};p.push(Y)}});const b={resource:f,cellResults:p};c.set(f,b);return}catch{return}});return await Promise.all(d),{limitHit:u,results:[...c.values()]}}async _validateWriteFile(t,i){const r=await this._extHostFileSystem.value.stat(t);if(typeof i?.mtime=="number"&&typeof i.etag=="string"&&i.etag!==LA&&typeof r.mtime=="number"&&typeof r.size=="number"&&i.mtime<r.mtime&&i.etag!==FS({mtime:i.mtime,size:r.size}))throw new wm(h(2934,null),3,i)}_resourceForError(t){return t.scheme===V.file?t.fsPath:t.toString()}_createExtHostEditor(t,i,r){if(this._editors.has(i))throw new Error(`editor with id ALREADY EXSIST: ${i}`);const n=new J0(i,this._notebookEditorsProxy,t,r.visibleRanges.map(Or.to),r.selections.map(Or.to),typeof r.viewColumn=="number"?Rt.to(r.viewColumn):void 0,r.viewType);this._editors.set(i,n)}$acceptDocumentAndEditorsDelta(t){if(t.value.removedDocuments)for(const r of t.value.removedDocuments){const n=y.revive(r),s=this._documents.get(n);s&&(s.dispose(),this._documents.delete(n),this._textDocumentsAndEditors.$acceptDocumentsAndEditorsDelta({removedDocuments:s.apiNotebook.getCells().map(o=>o.document.uri)}),this._onDidCloseNotebookDocument.fire(s.apiNotebook));for(const o of this._editors.values())o.notebookData.uri.toString()===n.toString()&&this._editors.delete(o.id)}if(t.value.addedDocuments){const r=[];for(const n of t.value.addedDocuments){const s=y.revive(n.uri);if(this._documents.has(s))throw new Error(`adding EXISTING notebook ${s} `);const o=new v$(this._notebookDocumentsProxy,this._textDocumentsAndEditors,this._textDocuments,s,n);r.push(...n.cells.map(a=>Q0.asModelAddData(a))),this._documents.get(s)?.dispose(),this._documents.set(s,o),this._textDocumentsAndEditors.$acceptDocumentsAndEditorsDelta({addedDocuments:r}),this._onDidOpenNotebookDocument.fire(o.apiNotebook)}}if(t.value.addedEditors)for(const r of t.value.addedEditors){if(this._editors.has(r.id))return;const n=y.revive(r.documentUri),s=this._documents.get(n);s&&this._createExtHostEditor(s,r.id,r)}const i=[];if(t.value.removedEditors)for(const r of t.value.removedEditors){const n=this._editors.get(r);n&&(this._editors.delete(r),this._activeNotebookEditor?.id===n.id&&(this._activeNotebookEditor=void 0),i.push(n))}if(t.value.visibleEditors){this._visibleNotebookEditors=t.value.visibleEditors.map(n=>this._editors.get(n)).filter(n=>!!n);const r=new Set;this._visibleNotebookEditors.forEach(n=>r.add(n.id));for(const n of this._editors.values()){const s=r.has(n.id);n._acceptVisibility(s)}this._visibleNotebookEditors=[...this._editors.values()].map(n=>n).filter(n=>n.visible),this._onDidChangeVisibleNotebookEditors.fire(this.visibleNotebookEditors)}t.value.newActiveEditor===null?this._activeNotebookEditor=void 0:t.value.newActiveEditor&&(this._editors.get(t.value.newActiveEditor)||console.error(`FAILED to find active notebook editor ${t.value.newActiveEditor}`),this._activeNotebookEditor=this._editors.get(t.value.newActiveEditor)),t.value.newActiveEditor!==void 0&&this._onDidChangeActiveNotebookEditor.fire(this._activeNotebookEditor?.apiEditor)}static _registerApiCommands(t){const i=$.String.with("notebookType","A notebook type"),r=new fe("vscode.executeDataToNotebook","_executeDataToNotebook","Invoke notebook serializer",[i,new $("data","Bytes to convert to data",s=>s instanceof Uint8Array,s=>ae.wrap(s))],new de("Notebook Data",s=>Gn.to(s.value))),n=new fe("vscode.executeNotebookToData","_executeNotebookToData","Invoke notebook serializer",[i,new $("NotebookData","Notebook data to convert to bytes",s=>!0,s=>new ai(Gn.from(s)))],new de("Bytes",s=>s.buffer));t.registerApiCommand(r),t.registerApiCommand(n)}trace(t){this._logService.trace(`[Extension Host Notebook] ${t}`)}},H$=class{constructor(e,t,i,r={timeout:1500,errors:3}){this._logService=e,this._notebooksAndEditors=t,this._mainThreadBulkEdits=i,this._thresholds=r,this._onWillSaveNotebookDocumentEvent=new nl}dispose(){}getOnWillSaveNotebookDocumentEvent(e){return(t,i,r)=>{const n=function(o){t.call(i,o)};return n.extension=e,this._onWillSaveNotebookDocumentEvent.event(n,void 0,r)}}async $participateInSave(e,t,i){const r=y.revive(e),n=this._notebooksAndEditors.getNotebookDocument(r);if(!n)throw new Error("Unable to resolve notebook document");const s=[];if(await this._onWillSaveNotebookDocumentEvent.fireAsync({notebook:n.apiNotebook,reason:hf.to(t)},i,async(a,l)=>{const c=Date.now(),u=await await Promise.resolve(a);Date.now()-c>this._thresholds.timeout&&this._logService.warn("onWillSaveNotebookDocument-listener from extension",l.extension.identifier),!i.isCancellationRequested&&u&&(u instanceof Ns?s.push(u):this._logService.warn("onWillSaveNotebookDocument-listener from extension",l.extension.identifier,"ignored due to invalid data"))}),i.isCancellationRequested)return!1;if(s.length===0)return!0;const o={edits:[]};for(const a of s){const{edits:l}=Ri.from(a);o.edits=o.edits.concat(l)}return this._mainThreadBulkEdits.$tryApplyWorkspaceEdit(new ai(o))}},U$=class{constructor(e){this._notebooksAndEditors=e,this._onDidSaveNotebookDocument=new P,this.onDidSaveNotebookDocument=this._onDidSaveNotebookDocument.event,this._onDidChangeNotebookDocument=new P,this.onDidChangeNotebookDocument=this._onDidChangeNotebookDocument.event}$acceptModelChanged(e,t,i,r){const s=this._notebooksAndEditors.getNotebookDocument(y.revive(e)).acceptModelChanged(t.value,i,r);this._onDidChangeNotebookDocument.fire(s)}$acceptDirtyStateChanged(e,t){this._notebooksAndEditors.getNotebookDocument(y.revive(e)).acceptDirty(t)}$acceptModelSaved(e){const t=this._notebooksAndEditors.getNotebookDocument(y.revive(e));this._onDidSaveNotebookDocument.fire(t.apiNotebook)}},nw=class{constructor(t,i){this._logService=t,this._notebooksAndEditors=i,this._onDidChangeNotebookEditorSelection=new P,this._onDidChangeNotebookEditorVisibleRanges=new P,this.onDidChangeNotebookEditorSelection=this._onDidChangeNotebookEditorSelection.event,this.onDidChangeNotebookEditorVisibleRanges=this._onDidChangeNotebookEditorVisibleRanges.event}$acceptEditorPropertiesChanged(t,i){this._logService.debug("ExtHostNotebook#$acceptEditorPropertiesChanged",t,i);const r=this._notebooksAndEditors.getEditorById(t);i.visibleRanges&&r._acceptVisibleRanges(i.visibleRanges.ranges.map(Or.to)),i.selections&&r._acceptSelections(i.selections.selections.map(Or.to)),i.visibleRanges&&this._onDidChangeNotebookEditorVisibleRanges.fire({notebookEditor:r.apiEditor,visibleRanges:r.apiEditor.visibleRanges}),i.selections&&this._onDidChangeNotebookEditorSelection.fire(Object.freeze({notebookEditor:r.apiEditor,selections:r.apiEditor.selections}))}$acceptEditorViewColumns(t){for(const i in t)this._notebooksAndEditors.getEditorById(i)._acceptViewColumn(Rt.to(t[i]))}};nw=__decorate([__param(0,qe)],nw);var ja;(function(e){e[e.Output=1]="Output",e[e.OutputItems=2]="OutputItems",e[e.ExecutionState=3]="ExecutionState"})(ja||(ja={}));var xQ=U("INotebookExecutionService"),B$=100,jk;(function(e){e[e.Disconnected=1]="Disconnected",e[e.Connected=2]="Connected",e[e.Initializing=3]="Initializing"})(jk||(jk={}));var SQ=U("INotebookKernelService"),EQ=U("INotebookKernelHistoryService"),sw=class{constructor(t,i,r,n,s){this._initData=i,this._extHostNotebook=r,this._commands=n,this._logService=s,this._activeExecutions=new Ft,this._activeNotebookExecutions=new Ft,this._kernelDetectionTask=new Map,this._kernelDetectionTaskHandlePool=0,this._kernelSourceActionProviders=new Map,this._kernelSourceActionProviderHandlePool=0,this._kernelData=new Map,this._handlePool=0,this._onDidChangeCellExecutionState=new P,this.onDidChangeNotebookCellExecutionState=this._onDidChangeCellExecutionState.event,this.id=0,this.variableStore={},this._proxy=t.getProxy(W.MainThreadNotebookKernels);const o=new fe("notebook.selectKernel","_notebook.selectKernel","Trigger kernel picker for specified notebook editor widget",[new $("options","Select kernel options",l=>!0,l=>{if(l&&"notebookEditor"in l&&"id"in l){const c=this._extHostNotebook.getIdByEditor(l.notebookEditor);return{id:l.id,extension:l.extension,notebookEditorId:c}}else if(l&&"notebookEditor"in l){const c=this._extHostNotebook.getIdByEditor(l.notebookEditor);if(c===void 0)throw new Error(`Cannot invoke 'notebook.selectKernel' for unrecognized notebook editor ${l.notebookEditor.notebook.uri.toString()}`);return"skipIfAlreadySelected"in l?{notebookEditorId:c,skipIfAlreadySelected:l.skipIfAlreadySelected}:{notebookEditorId:c}}return l})],de.Void),a=new fe("vscode.executeNotebookVariableProvider","_executeNotebookVariableProvider","Execute notebook variable provider",[$.Uri],new de("A promise that resolves to an array of variables",(l,c)=>l.map(u=>({variable:{name:u.name,value:u.value,expression:u.expression,type:u.type,language:u.language},hasNamedChildren:u.hasNamedChildren,indexedChildrenCount:u.indexedChildrenCount}))));this._commands.registerApiCommand(o),this._commands.registerApiCommand(a)}createNotebookController(t,i,r,n,s,o){for(const M of this._kernelData.values())if(M.controller.id===i&&Oe.equals(t.identifier,M.extensionId))throw new Error(`notebook controller with id '${i}' ALREADY exist`);const a=this._handlePool++,l=this;this._logService.trace(`NotebookController[${a}], CREATED by ${t.identifier.value}, ${i}`);const c=()=>console.warn(`NO execute handler from notebook controller '${p.id}' of extension: '${t.identifier}'`);let u=!1;const d=new P,f=new P,p={id:Dp(t.identifier,i),notebookType:r,extensionId:t.identifier,extensionLocation:t.extensionLocation,label:n||t.identifier.value,preloads:o?o.map(mf.from):[]};let m=s??c,_,b;this._proxy.$addKernel(a,p).catch(M=>{console.log(M),u=!0});let E=0;const C=()=>{if(u)return;const M=++E;Promise.resolve().then(()=>{M===E&&this._proxy.$updateKernel(a,p)})},T=new Ft,j={get id(){return i},get notebookType(){return p.notebookType},onDidChangeSelectedNotebooks:d.event,get label(){return p.label},set label(M){p.label=M??t.displayName??t.name,C()},get detail(){return p.detail??""},set detail(M){p.detail=M,C()},get description(){return p.description??""},set description(M){p.description=M,C()},get supportedLanguages(){return p.supportedLanguages},set supportedLanguages(M){p.supportedLanguages=M,C()},get supportsExecutionOrder(){return p.supportsExecutionOrder??!1},set supportsExecutionOrder(M){p.supportsExecutionOrder=M,C()},get rendererScripts(){return p.preloads?p.preloads.map(mf.to):[]},get executeHandler(){return m},set executeHandler(M){m=M??c},get interruptHandler(){return _},set interruptHandler(M){_=M,p.supportsInterrupt=!!M,C()},set variableProvider(M){N(t,"notebookVariableProvider"),b=M,p.hasVariableProvider=!!M,M?.onDidChangeVariables(B=>l._proxy.$variablesUpdated(B.uri)),C()},get variableProvider(){return b},createNotebookCellExecution(M){if(u)throw new Error("notebook controller is DISPOSED");if(!T.has(M.notebook.uri))throw l._logService.trace(`NotebookController[${a}] NOT associated to notebook, associated to THESE notebooks:`,Array.from(T.keys()).map(B=>B.toString())),new Error(`notebook controller is NOT associated to notebook: ${M.notebook.uri.toString()}`);return l._createNotebookCellExecution(M,Dp(t.identifier,this.id))},createNotebookExecution(M){if(N(t,"notebookExecution"),u)throw new Error("notebook controller is DISPOSED");if(!T.has(M.uri))throw l._logService.trace(`NotebookController[${a}] NOT associated to notebook, associated to THESE notebooks:`,Array.from(T.keys()).map(B=>B.toString())),new Error(`notebook controller is NOT associated to notebook: ${M.uri.toString()}`);return l._createNotebookExecution(M,Dp(t.identifier,this.id))},dispose:()=>{u||(this._logService.trace(`NotebookController[${a}], DISPOSED`),u=!0,this._kernelData.delete(a),d.dispose(),f.dispose(),this._proxy.$removeKernel(a))},updateNotebookAffinity(M,B){B===Lh.Hidden&&N(t,"notebookControllerAffinityHidden"),l._proxy.$updateNotebookPriority(a,M.uri,B)},onDidReceiveMessage:f.event,postMessage(M,B){return N(t,"notebookMessaging"),l._proxy.$postMessage(a,B&&l._extHostNotebook.getIdByEditor(B),M)},asWebviewUri(M){return N(t,"notebookMessaging"),tu(M,l._initData.remote)}};return this._kernelData.set(a,{extensionId:t.identifier,controller:j,onDidReceiveMessage:f,onDidChangeSelection:d,associatedNotebooks:T}),j}getIdByController(t){for(const[i,r]of this._kernelData)if(r.controller===t)return Dp(r.extensionId,t.id);return null}createNotebookControllerDetectionTask(t,i){const r=this._kernelDetectionTaskHandlePool++,n=this;this._logService.trace(`NotebookControllerDetectionTask[${r}], CREATED by ${t.identifier.value}`),this._proxy.$addKernelDetectionTask(r,i);const s={dispose:()=>{this._kernelDetectionTask.delete(r),n._proxy.$removeKernelDetectionTask(r)}};return this._kernelDetectionTask.set(r,s),s}registerKernelSourceActionProvider(t,i,r){const n=this._kernelSourceActionProviderHandlePool++,s=typeof r.onDidChangeNotebookKernelSourceActions=="function"?n:void 0,o=this;this._kernelSourceActionProviders.set(n,r),this._logService.trace(`NotebookKernelSourceActionProvider[${n}], CREATED by ${t.identifier.value}`),this._proxy.$addKernelSourceActionProvider(n,n,i);let a;return s!==void 0&&(a=r.onDidChangeNotebookKernelSourceActions(l=>this._proxy.$emitNotebookKernelSourceActionsChangeEvent(s))),{dispose:()=>{this._kernelSourceActionProviders.delete(n),o._proxy.$removeKernelSourceActionProvider(n,n),a?.dispose()}}}async $provideKernelSourceActions(t,i){const r=this._kernelSourceActionProviders.get(t);if(r){const n=new he;return(await r.provideNotebookKernelSourceActions(i)??[]).map(o=>R1.from(o,this._commands.converter,n))}return[]}$acceptNotebookAssociation(t,i,r){const n=this._kernelData.get(t);if(n){const s=this._extHostNotebook.getNotebookDocument(y.revive(i));r?n.associatedNotebooks.set(s.uri,!0):n.associatedNotebooks.delete(s.uri),this._logService.trace(`NotebookController[${t}] ASSOCIATE notebook`,s.uri.toString(),r),n.onDidChangeSelection.fire({selected:r,notebook:s.apiNotebook})}}async $executeCells(t,i,r){const n=this._kernelData.get(t);if(!n)return;const s=this._extHostNotebook.getNotebookDocument(y.revive(i)),o=[];for(const a of r){const l=s.getCell(a);l&&o.push(l.apiCell)}try{this._logService.trace(`NotebookController[${t}] EXECUTE cells`,s.uri.toString(),o.length),await n.controller.executeHandler.call(n.controller,o,s.apiNotebook,n.controller)}catch(a){this._logService.error(`NotebookController[${t}] execute cells FAILED`,a),console.error(a)}}async $cancelCells(t,i,r){const n=this._kernelData.get(t);if(!n)return;const s=this._extHostNotebook.getNotebookDocument(y.revive(i));if(n.controller.interruptHandler)await n.controller.interruptHandler.call(n.controller,s.apiNotebook);else for(const o of r){const a=s.getCell(o);a&&this._activeExecutions.get(a.uri)?.cancel()}if(n.controller.interruptHandler){const o=this._activeNotebookExecutions.get(s.uri);this._activeNotebookExecutions.delete(s.uri),r.length&&Array.isArray(o)&&o.length&&o.forEach(a=>a.dispose())}}async $provideVariables(t,i,r,n,s,o,a){const l=this._kernelData.get(t);if(!l)return;const c=this._extHostNotebook.getNotebookDocument(y.revive(r)),u=l.controller.variableProvider;if(!u)return;let d;if(n!==void 0){if(d=this.variableStore[n],!d)return}else this.variableStore={};const f=s==="named"?fc.Named:fc.Indexed,p=u.provideVariables(c.apiNotebook,d,f,o,a);let m=0;for await(const _ of p){if(a.isCancellationRequested)return;const b={id:this.id++,name:_.variable.name,value:_.variable.value,type:_.variable.type,interfaces:_.variable.interfaces,language:_.variable.language,expression:_.variable.expression,hasNamedChildren:_.hasNamedChildren,indexedChildrenCount:_.indexedChildrenCount,extensionId:l.extensionId.value};if(this.variableStore[b.id]=_.variable,this._proxy.$receiveVariable(i,b),m++>=B$)return}}$acceptKernelMessageFromRenderer(t,i,r){const n=this._kernelData.get(t);if(!n)return;const s=this._extHostNotebook.getEditorById(i);n.onDidReceiveMessage.fire(Object.freeze({editor:s.apiEditor,message:r}))}$cellExecutionChanged(t,i,r){const s=this._extHostNotebook.getNotebookDocument(y.revive(t)).getCell(i);if(s){const o=r?T1.to(r):ga.Idle;o!==void 0&&this._onDidChangeCellExecutionState.fire({cell:s.apiCell,state:o})}}_createNotebookCellExecution(t,i){if(t.index<0)throw new Error("CANNOT execute cell that has been REMOVED from notebook");const n=this._extHostNotebook.getNotebookDocument(t.notebook.uri).getCellFromApiCell(t);if(!n)throw new Error("invalid cell");if(this._activeExecutions.has(n.uri))throw new Error(`duplicate execution for ${n.uri}`);const s=new W$(i,n,this._proxy);this._activeExecutions.set(n.uri,s);const o=s.onDidChangeState(()=>{s.state===wr.Resolved&&(s.dispose(),o.dispose(),this._activeExecutions.delete(n.uri))});return s.asApiObject()}_createNotebookExecution(t,i){const r=this._extHostNotebook.getNotebookDocument(t.uri),n=t.getCells().find(a=>{const l=r.getCellFromApiCell(a);return l&&this._activeExecutions.has(l.uri)});if(n)throw new Error(`duplicate cell execution for ${n.document.uri}`);if(this._activeNotebookExecutions.has(r.uri))throw new Error(`duplicate notebook execution for ${r.uri}`);const s=new z$(i,r,this._proxy),o=s.onDidChangeState(()=>{s.state===yn.Resolved&&(s.dispose(),o.dispose(),this._activeNotebookExecutions.delete(r.uri))});return this._activeNotebookExecutions.set(r.uri,[s,o]),s.asApiObject()}};sw=__decorate([__param(4,qe)],sw);var wr;(function(e){e[e.Init=0]="Init",e[e.Started=1]="Started",e[e.Resolved=2]="Resolved"})(wr||(wr={}));var W$=class E7 extends se{static{this.HANDLE=0}get state(){return this._state}constructor(t,i,r){super(),this._cell=i,this._proxy=r,this._handle=E7.HANDLE++,this._onDidChangeState=new P,this.onDidChangeState=this._onDidChangeState.event,this._state=wr.Init,this._tokenSource=this._register(new ft),this._collector=new q$(10,n=>this.update(n)),this._executionOrder=i.internalMetadata.executionOrder,this._proxy.$createExecution(this._handle,t,this._cell.notebook.uri,this._cell.handle)}cancel(){this._tokenSource.cancel()}async updateSoon(t){await this._collector.addItem(t)}async update(t){const i=Array.isArray(t)?t:[t];return this._proxy.$updateExecution(this._handle,new ai(i))}verifyStateForOutput(){if(this._state===wr.Init)throw new Error("Must call start before modifying cell output");if(this._state===wr.Resolved)throw new Error("Cannot modify cell output after calling resolve")}cellIndexToHandle(t){let i=this._cell;if(t&&(i=this._cell.notebook.getCellFromApiCell(t)),!i)throw new Error("INVALID cell");return i.handle}validateAndConvertOutputs(t){return t.map(i=>{const r=Th.ensureUniqueMimeTypes(i.items,!0);return r===i.items?Qn.from(i):Qn.from({items:r,id:i.id,metadata:i.metadata})})}async updateOutputs(t,i,r){const n=this.cellIndexToHandle(i),s=this.validateAndConvertOutputs(Fi(t));return this.updateSoon({editType:ja.Output,cellHandle:n,append:r,outputs:s})}async updateOutputItems(t,i,r){return t=Th.ensureUniqueMimeTypes(Fi(t),!0),this.updateSoon({editType:ja.OutputItems,items:t.map(Ia.from),outputId:i.id,append:r})}asApiObject(){const t=this;return Object.freeze({get token(){return t._tokenSource.token},get cell(){return t._cell.apiCell},get executionOrder(){return t._executionOrder},set executionOrder(r){t._executionOrder=r,t.update([{editType:ja.ExecutionState,executionOrder:t._executionOrder}])},start(r){if(t._state===wr.Resolved||t._state===wr.Started)throw new Error("Cannot call start again");t._state=wr.Started,t._onDidChangeState.fire(),t.update({editType:ja.ExecutionState,runStartTime:r})},end(r,n,s){if(t._state===wr.Resolved)throw new Error("Cannot call resolve twice");t._state=wr.Resolved,t._onDidChangeState.fire(),t._collector.flush();const o=V$(s);t._proxy.$completeExecution(t._handle,new ai({runEndTime:n,lastRunSuccess:r,error:o}))},clearOutput(r){return t.verifyStateForOutput(),t.updateOutputs([],r,!1)},appendOutput(r,n){return t.verifyStateForOutput(),t.updateOutputs(r,n,!0)},replaceOutput(r,n){return t.verifyStateForOutput(),t.updateOutputs(r,n,!1)},appendOutputItems(r,n){return t.verifyStateForOutput(),t.updateOutputItems(r,n,!0)},replaceOutputItems(r,n){return t.verifyStateForOutput(),t.updateOutputItems(r,n,!1)}})}};function V$(e){const t=n=>n?{startLineNumber:n.start.line,startColumn:n.start.character,endLineNumber:n.end.line,endColumn:n.end.character}:void 0,i=n=>({uri:n.uri,position:n.position,label:n.label});return e?{name:e.name,message:e.message,stack:e.stack instanceof Array?e.stack.map(n=>i(n)):e.stack,location:t(e.location),uri:e.uri}:void 0}var yn;(function(e){e[e.Init=0]="Init",e[e.Started=1]="Started",e[e.Resolved=2]="Resolved"})(yn||(yn={}));var z$=class C7 extends se{static{this.HANDLE=0}get state(){return this._state}constructor(t,i,r){super(),this._notebook=i,this._proxy=r,this._handle=C7.HANDLE++,this._onDidChangeState=new P,this.onDidChangeState=this._onDidChangeState.event,this._state=yn.Init,this._tokenSource=this._register(new ft),this._proxy.$createNotebookExecution(this._handle,t,this._notebook.uri)}cancel(){this._tokenSource.cancel()}asApiObject(){return Object.freeze({start:()=>{if(this._state===yn.Resolved||this._state===yn.Started)throw new Error("Cannot call start again");this._state=yn.Started,this._onDidChangeState.fire(),this._proxy.$beginNotebookExecution(this._handle)},end:()=>{if(this._state===yn.Resolved)throw new Error("Cannot call resolve twice");this._state=yn.Resolved,this._onDidChangeState.fire(),this._proxy.$completeNotebookExecution(this._handle)}})}},q$=class{constructor(e,t){this.delay=e,this.callback=t,this.batch=[],this.startedTimer=Date.now()}addItem(e){return this.batch.push(e),this.currentDeferred||(this.currentDeferred=new Dr,this.startedTimer=Date.now(),sr(this.delay).then(()=>this.flush())),Date.now()-this.startedTimer>this.delay?this.flush():this.currentDeferred.p}flush(){if(this.batch.length===0||!this.currentDeferred)return Promise.resolve();const e=this.currentDeferred;this.currentDeferred=void 0;const t=this.batch;return this.batch=[],this.callback(t).finally(()=>e.complete())}};function Dp(e,t){return`${e.value}/${t}`}var j$=class{constructor(e,t){this._extHostNotebook=t,this._rendererMessageEmitters=new Map,this.proxy=e.getProxy(W.MainThreadNotebookRenderers)}$postRendererMessage(e,t,i){const r=this._extHostNotebook.getEditorById(e);this._rendererMessageEmitters.get(t)?.fire({editor:r.apiEditor,message:i})}createRendererMessaging(e,t){if(!e.contributes?.notebookRenderer?.some(r=>r.id===t))throw new Error(`Extensions may only call createRendererMessaging() for renderers they contribute (got ${t})`);return{onDidReceiveMessage:(r,n,s)=>this.getOrCreateEmitterFor(t).event(r,n,s),postMessage:(r,n)=>{J0.apiEditorsToExtHost.has(r)&&([r,n]=[n,r]);const s=n&&J0.apiEditorsToExtHost.get(n);return this.proxy.$postMessage(s?.id,t,r)}}}getOrCreateEmitterFor(e){let t=this._rendererMessageEmitters.get(e);return t||(t=new P({onDidRemoveLastListener:()=>{t?.dispose(),this._rendererMessageEmitters.delete(e)}}),this._rendererMessageEmitters.set(e,t),t)}},G$=class{constructor(e){this.handlers=new Map,this.proxy=e.getProxy(W.MainThreadProfileContentHandlers)}registerProfileContentHandler(e,t,i){if(N(e,"profileContentHandlers"),this.handlers.has(t))throw new Error(`Handler with id '${t}' already registered`);return this.handlers.set(t,i),this.proxy.$registerProfileContentHandler(t,i.name,i.description,e.identifier.value),ne(()=>{this.handlers.delete(t),this.proxy.$unregisterProfileContentHandler(t)})}async $saveProfile(e,t,i,r){const n=this.handlers.get(e);if(!n)throw new Error(`Unknown handler with id: ${e}`);return n.saveProfile(t,i,r)}async $readProfile(e,t,i){const r=this.handlers.get(e);if(!r)throw new Error(`Unknown handler with id: ${e}`);return r.readProfile(Me(t)?t:y.revive(t),i)}},Q$=class{constructor(e){this._handles=0,this._mapHandleToCancellationSource=new Map,this._proxy=e}async withProgress(e,t,i){const r=this._handles++,{title:n,location:s,cancellable:o}=t,a={label:e.displayName||e.name,id:e.identifier.value};return this._proxy.$startProgress(r,{location:k1.from(s),title:n,source:a,cancellable:o},e.isUnderDevelopment?void 0:e.identifier.value).catch(Qw),this._withProgress(r,i,!!o)}_withProgress(e,t,i){let r;i&&(r=new ft,this._mapHandleToCancellationSource.set(e,r));const n=o=>{this._proxy.$progressEnd(o),this._mapHandleToCancellationSource.delete(o),r?.dispose()};let s;try{s=t(new Gk(this._proxy,e),i&&r?r.token:Xe.None)}catch(o){throw n(e),o}return s.then(o=>n(e),o=>n(e)),s}$acceptProgressCanceled(e){const t=this._mapHandleToCancellationSource.get(e);t&&(t.cancel(),this._mapHandleToCancellationSource.delete(e))}};function J$(e,t){return e.message=t.message,typeof t.increment=="number"&&(typeof e.increment=="number"?e.increment+=t.increment:e.increment=t.increment),e}var Gk=class extends T_{constructor(e,t){super(i=>this.throttledReport(i)),this._proxy=e,this._handle=t}throttledReport(e){this._proxy.$progressReport(this._handle,e)}};__decorate([vF(100,(e,t)=>J$(e,t),()=>Object.create(null))],Gk.prototype,"throttledReport",null);var X$=class D7{static{this.handlePool=0}constructor(t,i){this.uriTransformer=i,this.providers=new Map,this.proxy=t.getProxy(W.MainThreadQuickDiff)}$provideOriginalResource(t,i,r){const n=y.revive(i),s=this.providers.get(t);return s?Kt(()=>s.provideOriginalResource(n,r)).then(o=>o||null):Promise.resolve(null)}registerQuickDiffProvider(t,i,r,n,s,o){const a=D7.handlePool++;this.providers.set(a,r);const l=Oe.toKey(t.identifier);return this.proxy.$registerQuickDiffProvider(a,_a.from(i,this.uriTransformer),`${l}.${n}`,s,o),{dispose:()=>{this.proxy.$unregisterQuickDiffProvider(a),this.providers.delete(a)}}}};function Z$(e,t,i){const r=e.getProxy(W.MainThreadQuickOpen);class n{constructor(p,m){this._sessions=new Map,this._instances=0,this._workspace=p,this._commands=m}showQuickPick(p,m,_,b=Xe.None){this._onDidSelectItem=void 0;const E=Promise.resolve(m),C=++this._instances,T=r.$show(C,{title:_?.title,placeHolder:_?.placeHolder,matchOnDescription:_?.matchOnDescription,matchOnDetail:_?.matchOnDetail,ignoreFocusLost:_?.ignoreFocusOut,canPickMany:_?.canPickMany},b),j={},M=T.then(()=>j);return Promise.race([M,E]).then(B=>{if(B===j)return;const K=Ke(p,"quickPickItemTooltip");return E.then(Y=>{const X=[];for(let ce=0;ce<Y.length;ce++){const We=Y[ce];if(typeof We=="string")X.push({label:We,handle:ce});else if(We.kind===hc.Separator)X.push({type:"separator",label:We.label});else{We.tooltip&&!K&&console.warn(`Extension '${p.identifier.value}' uses a tooltip which is proposed API that is only available when running out of dev or with the following command line switch: --enable-proposed-api ${p.identifier.value}`);const De=We.iconPath?c(We.iconPath):void 0;X.push({label:We.label,iconPath:De?.iconPath,iconClass:De?.iconClass,description:We.description,detail:We.detail,picked:We.picked,alwaysShow:We.alwaysShow,tooltip:K?pe.fromStrict(We.tooltip):void 0,handle:ce})}}return _&&typeof _.onDidSelectItem=="function"&&(this._onDidSelectItem=ce=>{_.onDidSelectItem(Y[ce])}),r.$setItems(C,X),T.then(ce=>{if(typeof ce=="number")return Y[ce];if(Array.isArray(ce))return ce.map(We=>Y[We])})})}).then(void 0,B=>{if(!br(B))return r.$setError(C,B),Promise.reject(B)})}$onItemSelected(p){this._onDidSelectItem?.(p)}showInput(p,m=Xe.None){return this._validateInput=p?.validateInput,r.$input(p,typeof this._validateInput=="function",m).then(void 0,_=>{if(!br(_))return Promise.reject(_)})}async $validateInput(p){if(!this._validateInput)return;const m=await this._validateInput(p);if(!m||typeof m=="string")return m;let _;switch(m.severity){case pa.Info:_=bt.Info;break;case pa.Warning:_=bt.Warning;break;case pa.Error:_=bt.Error;break;default:_=m.message?bt.Error:bt.Ignore;break}return{content:m.message,severity:_}}async showWorkspaceFolderPick(p,m=Xe.None){const _=await this._commands.executeCommand("_workbench.pickWorkspaceFolder",[p]);if(!_)return;const b=await this._workspace.getWorkspaceFolders2();if(b)return b.find(E=>E.uri.toString()===_.uri.toString())}createQuickPick(p){const m=new u(p,()=>this._sessions.delete(m._id));return this._sessions.set(m._id,m),m}createInputBox(p){const m=new d(p,()=>this._sessions.delete(m._id));return this._sessions.set(m._id,m),m}$onDidChangeValue(p,m){this._sessions.get(p)?._fireDidChangeValue(m)}$onDidAccept(p){this._sessions.get(p)?._fireDidAccept()}$onDidChangeActive(p,m){const _=this._sessions.get(p);_ instanceof u&&_._fireDidChangeActive(m)}$onDidChangeSelection(p,m){const _=this._sessions.get(p);_ instanceof u&&_._fireDidChangeSelection(m)}$onDidTriggerButton(p,m){this._sessions.get(p)?._fireDidTriggerButton(m)}$onDidTriggerItemButton(p,m,_){const b=this._sessions.get(p);b instanceof u&&b._fireDidTriggerItemButton(m,_)}$onDidHide(p){this._sessions.get(p)?._fireDidHide()}}class s{static{this._nextId=1}constructor(p,m){this._extension=p,this._onDidDispose=m,this._id=u._nextId++,this._visible=!1,this._expectingHide=!1,this._enabled=!0,this._busy=!1,this._ignoreFocusOut=!0,this._value="",this._valueSelection=void 0,this._buttons=[],this._handlesToButtons=new Map,this._onDidAcceptEmitter=new P,this._onDidChangeValueEmitter=new P,this._onDidTriggerButtonEmitter=new P,this._onDidHideEmitter=new P,this._pendingUpdate={id:this._id},this._disposed=!1,this._disposables=[this._onDidTriggerButtonEmitter,this._onDidHideEmitter,this._onDidAcceptEmitter,this._onDidChangeValueEmitter],this.onDidChangeValue=this._onDidChangeValueEmitter.event,this.onDidAccept=this._onDidAcceptEmitter.event,this.onDidTriggerButton=this._onDidTriggerButtonEmitter.event,this.onDidHide=this._onDidHideEmitter.event}get title(){return this._title}set title(p){this._title=p,this.update({title:p})}get step(){return this._steps}set step(p){this._steps=p,this.update({step:p})}get totalSteps(){return this._totalSteps}set totalSteps(p){this._totalSteps=p,this.update({totalSteps:p})}get enabled(){return this._enabled}set enabled(p){this._enabled=p,this.update({enabled:p})}get busy(){return this._busy}set busy(p){this._busy=p,this.update({busy:p})}get ignoreFocusOut(){return this._ignoreFocusOut}set ignoreFocusOut(p){this._ignoreFocusOut=p,this.update({ignoreFocusOut:p})}get value(){return this._value}set value(p){this._value=p,this.update({value:p})}get valueSelection(){return this._valueSelection}set valueSelection(p){this._valueSelection=p,this.update({valueSelection:p})}get placeholder(){return this._placeholder}set placeholder(p){this._placeholder=p,this.update({placeholder:p})}get buttons(){return this._buttons}set buttons(p){const m=Ke(this._extension,"quickInputButtonLocation");!m&&p.some(_=>_.location)&&console.warn(`Extension '${this._extension.identifier.value}' uses a button location which is proposed API that is only available when running out of dev or with the following command line switch: --enable-proposed-api ${this._extension.identifier.value}`),this._buttons=p.slice(),this._handlesToButtons.clear(),p.forEach((_,b)=>{const E=_===dc.Back?-1:b;this._handlesToButtons.set(E,_)}),this.update({buttons:p.map((_,b)=>({...c(_.iconPath),tooltip:_.tooltip,handle:_===dc.Back?-1:b,location:m?_.location:void 0}))})}show(){this._visible=!0,this._expectingHide=!0,this.update({visible:!0})}hide(){this._visible=!1,this.update({visible:!1})}_fireDidAccept(){this._onDidAcceptEmitter.fire()}_fireDidChangeValue(p){this._value=p,this._onDidChangeValueEmitter.fire(p)}_fireDidTriggerButton(p){const m=this._handlesToButtons.get(p);m&&this._onDidTriggerButtonEmitter.fire(m)}_fireDidHide(){this._expectingHide&&(this._expectingHide=this._visible,this._onDidHideEmitter.fire())}dispose(){this._disposed||(this._disposed=!0,this._fireDidHide(),this._disposables=zr(this._disposables),this._updateTimeout&&(clearTimeout(this._updateTimeout),this._updateTimeout=void 0),this._onDidDispose(),r.$dispose(this._id))}update(p){if(!this._disposed){for(const m of Object.keys(p)){const _=p[m];this._pendingUpdate[m]=_===void 0?null:_}"visible"in this._pendingUpdate?(this._updateTimeout&&(clearTimeout(this._updateTimeout),this._updateTimeout=void 0),this.dispatchUpdate()):this._visible&&!this._updateTimeout&&(this._updateTimeout=setTimeout(()=>{this._updateTimeout=void 0,this.dispatchUpdate()},0))}}dispatchUpdate(){r.$createOrUpdate(this._pendingUpdate),this._pendingUpdate={id:this._id}}}function o(f){if(f instanceof ci)return{id:f.id};const p=l(f),m=a(f);return{dark:typeof p=="string"?y.file(p):p,light:typeof m=="string"?y.file(m):m}}function a(f){return typeof f=="object"&&"light"in f?f.light:f}function l(f){return typeof f=="object"&&"dark"in f?f.dark:f}function c(f){const p=o(f);let m,_;return"id"in p?_=kt.asClassName(p):m=p,{iconPath:m,iconClass:_}}class u extends s{constructor(p,m){super(p,m),this._items=[],this._handlesToItems=new Map,this._itemsToHandles=new Map,this._canSelectMany=!1,this._matchOnDescription=!0,this._matchOnDetail=!0,this._sortByLabel=!0,this._keepScrollPosition=!1,this._activeItems=[],this._onDidChangeActiveEmitter=new P,this._selectedItems=[],this._onDidChangeSelectionEmitter=new P,this._onDidTriggerItemButtonEmitter=new P,this.onDidChangeActive=this._onDidChangeActiveEmitter.event,this.onDidChangeSelection=this._onDidChangeSelectionEmitter.event,this.onDidTriggerItemButton=this._onDidTriggerItemButtonEmitter.event,this._disposables.push(this._onDidChangeActiveEmitter,this._onDidChangeSelectionEmitter,this._onDidTriggerItemButtonEmitter),this.update({type:"quickPick"})}get items(){return this._items}set items(p){this._items=p.slice(),this._handlesToItems.clear(),this._itemsToHandles.clear(),p.forEach((b,E)=>{this._handlesToItems.set(E,b),this._itemsToHandles.set(b,E)});const m=Ke(this._extension,"quickPickItemTooltip"),_=[];for(let b=0;b<p.length;b++){const E=p[b];if(E.kind===hc.Separator)_.push({type:"separator",label:E.label});else{E.tooltip&&!m&&console.warn(`Extension '${this._extension.identifier.value}' uses a tooltip which is proposed API that is only available when running out of dev or with the following command line switch: --enable-proposed-api ${this._extension.identifier.value}`);const C=E.iconPath?c(E.iconPath):void 0;_.push({handle:b,label:E.label,iconPath:C?.iconPath,iconClass:C?.iconClass,description:E.description,detail:E.detail,picked:E.picked,alwaysShow:E.alwaysShow,tooltip:m?pe.fromStrict(E.tooltip):void 0,buttons:E.buttons?.map((T,j)=>({...c(T.iconPath),tooltip:T.tooltip,handle:j}))})}}this.update({items:_})}get canSelectMany(){return this._canSelectMany}set canSelectMany(p){this._canSelectMany=p,this.update({canSelectMany:p})}get matchOnDescription(){return this._matchOnDescription}set matchOnDescription(p){this._matchOnDescription=p,this.update({matchOnDescription:p})}get matchOnDetail(){return this._matchOnDetail}set matchOnDetail(p){this._matchOnDetail=p,this.update({matchOnDetail:p})}get sortByLabel(){return this._sortByLabel}set sortByLabel(p){this._sortByLabel=p,this.update({sortByLabel:p})}get keepScrollPosition(){return this._keepScrollPosition}set keepScrollPosition(p){this._keepScrollPosition=p,this.update({keepScrollPosition:p})}get activeItems(){return this._activeItems}set activeItems(p){this._activeItems=p.filter(m=>this._itemsToHandles.has(m)),this.update({activeItems:this._activeItems.map(m=>this._itemsToHandles.get(m))})}get selectedItems(){return this._selectedItems}set selectedItems(p){this._selectedItems=p.filter(m=>this._itemsToHandles.has(m)),this.update({selectedItems:this._selectedItems.map(m=>this._itemsToHandles.get(m))})}_fireDidChangeActive(p){const m=xt(p.map(_=>this._handlesToItems.get(_)));this._activeItems=m,this._onDidChangeActiveEmitter.fire(m)}_fireDidChangeSelection(p){const m=xt(p.map(_=>this._handlesToItems.get(_)));this._selectedItems=m,this._onDidChangeSelectionEmitter.fire(m)}_fireDidTriggerItemButton(p,m){const _=this._handlesToItems.get(p);if(!_||!_.buttons||!_.buttons.length)return;const b=_.buttons[m];b&&this._onDidTriggerItemButtonEmitter.fire({button:b,item:_})}}class d extends s{constructor(p,m){super(p,m),this._password=!1,this.update({type:"inputBox"})}get password(){return this._password}set password(p){this._password=p,this.update({password:p})}get prompt(){return this._prompt}set prompt(p){this._prompt=p,this.update({prompt:p})}get validationMessage(){return this._validationMessage}set validationMessage(p){this._validationMessage=p,p?typeof p=="string"?this.update({validationMessage:p,severity:bt.Error}):this.update({validationMessage:p.message,severity:p.severity??bt.Error}):this.update({validationMessage:void 0,severity:bt.Ignore})}}return new n(t,i)}var Qk=new Ci(()=>{const e=new Intl.Collator(void 0,{numeric:!0,sensitivity:"base"});return{collator:e,collatorIsNumeric:e.resolvedOptions().numeric}}),DQ=new Ci(()=>({collator:new Intl.Collator(void 0,{numeric:!0})})),IQ=new Ci(()=>({collator:new Intl.Collator(void 0,{numeric:!0,sensitivity:"accent"})}));function K$(e,t,i=!1){const r=e||"",n=t||"",s=Qk.value.collator.compare(r,n);return Qk.value.collatorIsNumeric&&s===0&&r!==n?r<n?-1:1:s}function Y$(e,t,i=!1){return i||(e=e&&e.toLowerCase(),t=t&&t.toLowerCase()),e===t?0:e<t?-1:1}function Ip(e,t,i=!1){const r=e.split(tr),n=t.split(tr),s=r.length-1,o=n.length-1;let a,l;for(let c=0;;c++){if(a=s===c,l=o===c,a&&l)return K$(r[c],n[c],i);if(a)return-1;if(l)return 1;const u=Y$(r[c],n[c],i);if(u!==0)return u}}var ow;function Jk(e){return e instanceof y}function eH(e,t){return e.scheme===V.file&&t.scheme===V.file&&Gr?e.toString()===t.toString():e.toString().toLowerCase()===t.toString().toLowerCase()}function aw(e){if(e)return typeof e.iconPath=="string"?y.file(e.iconPath):y.isUri(e.iconPath)||kt.isThemeIcon(e.iconPath)?e.iconPath:void 0}function uo(e){if(e){if(y.isUri(e))return e;if(kt.isThemeIcon(e))return e;{const t=e;return{light:t.light,dark:t.dark}}}else return}function tH(e){const t=uo(e.authorIcon),i=e.references?.map(r=>({...r,icon:uo(r.icon)}));return{...e,authorIcon:t,references:i}}function lw(e){return e?{...e,icon:uo(e.icon)}:void 0}function cw(e,t){if(!e.iconPath&&!t.iconPath)return 0;if(e.iconPath){if(!t.iconPath)return 1}else return-1;const i=typeof e.iconPath=="string"?e.iconPath:y.isUri(e.iconPath)?e.iconPath.fsPath:e.iconPath.id,r=typeof t.iconPath=="string"?t.iconPath:y.isUri(t.iconPath)?t.iconPath.fsPath:t.iconPath.id;return Ip(i,r)}function iH(e,t){let i=0;if(e.strikeThrough!==t.strikeThrough)return e.strikeThrough?1:-1;if(e.faded!==t.faded)return e.faded?1:-1;if(e.tooltip!==t.tooltip)return(e.tooltip||"").localeCompare(t.tooltip||"");if(i=cw(e,t),i!==0)return i;if(e.light&&t.light)i=cw(e.light,t.light);else{if(e.light)return 1;if(t.light)return-1}if(i!==0)return i;if(e.dark&&t.dark)i=cw(e.dark,t.dark);else{if(e.dark)return 1;if(t.dark)return-1}return i}function rH(e,t){if(e.command!==t.command)return e.command<t.command?-1:1;if(e.title!==t.title)return e.title<t.title?-1:1;if(e.tooltip!==t.tooltip){if(e.tooltip!==void 0&&t.tooltip!==void 0)return e.tooltip<t.tooltip?-1:1;if(e.tooltip!==void 0)return 1;if(t.tooltip!==void 0)return-1}if(e.arguments===t.arguments)return 0;if(e.arguments)if(t.arguments){if(e.arguments.length!==t.arguments.length)return e.arguments.length-t.arguments.length}else return 1;else return-1;for(let i=0;i<e.arguments.length;i++){const r=e.arguments[i],n=t.arguments[i];if(r!==n&&!(Jk(r)&&Jk(n)&&eH(r,n)))return r<n?-1:1}return 0}function Xk(e,t){let i=Ip(e.resourceUri.fsPath,t.resourceUri.fsPath,!0);if(i!==0)return i;if(e.command&&t.command)i=rH(e.command,t.command);else{if(e.command)return 1;if(t.command)return-1}if(i!==0)return i;if(e.decorations&&t.decorations)i=iH(e.decorations,t.decorations);else{if(e.decorations)return 1;if(t.decorations)return-1}if(i!==0)return i;if(e.multiFileDiffEditorModifiedUri&&t.multiFileDiffEditorModifiedUri)i=Ip(e.multiFileDiffEditorModifiedUri.fsPath,t.multiFileDiffEditorModifiedUri.fsPath,!0);else{if(e.multiFileDiffEditorModifiedUri)return 1;if(t.multiFileDiffEditorModifiedUri)return-1}if(i!==0)return i;if(e.multiDiffEditorOriginalUri&&t.multiDiffEditorOriginalUri)i=Ip(e.multiDiffEditorOriginalUri.fsPath,t.multiDiffEditorOriginalUri.fsPath,!0);else{if(e.multiDiffEditorOriginalUri)return 1;if(t.multiDiffEditorOriginalUri)return-1}return i}function nH(e,t){for(let i=0;i<e.length;i++)if(e[i]!==t[i])return!1;return!0}function sH(e,t){return e.command===t.command&&e.title===t.title&&e.tooltip===t.tooltip&&(e.arguments&&t.arguments?nH(e.arguments,t.arguments):e.arguments===t.arguments)}function oH(e,t){return Sr(e,t,sH)}var aH=class{#e;#t;get value(){return this._value}set value(e){e=e??"",this.#e.$setInputBoxValue(this._sourceControlHandle,e),this.updateValue(e)}get onDidChange(){return this._onDidChange.event}get placeholder(){return this._placeholder}set placeholder(e){this.#e.$setInputBoxPlaceholder(this._sourceControlHandle,e),this._placeholder=e}get validateInput(){return N(this._extension,"scmValidation"),this._validateInput}set validateInput(e){if(N(this._extension,"scmValidation"),e&&typeof e!="function")throw new Error(`[${this._extension.identifier.value}]: Invalid SCM input box validation function`);this._validateInput=e,this.#e.$setValidationProviderIsEnabled(this._sourceControlHandle,!!e)}get enabled(){return this._enabled}set enabled(e){e=!!e,this._enabled!==e&&(this._enabled=e,this.#e.$setInputBoxEnablement(this._sourceControlHandle,e))}get visible(){return this._visible}set visible(e){e=!!e,this._visible!==e&&(this._visible=e,this.#e.$setInputBoxVisibility(this._sourceControlHandle,e))}get document(){return N(this._extension,"scmTextDocument"),this.#t.getDocument(this._documentUri)}constructor(e,t,i,r,n){this._extension=e,this._sourceControlHandle=r,this._documentUri=n,this._value="",this._onDidChange=new P,this._placeholder="",this._enabled=!0,this._visible=!0,this.#t=t,this.#e=i}showValidationMessage(e,t){N(this._extension,"scmValidation"),this.#e.$showValidationMessage(this._sourceControlHandle,e,t)}$onInputBoxValueChange(e){this.updateValue(e)}updateValue(e){this._value=e,this._onDidChange.fire(e)}},lH=class I7{static{this._handlePool=0}get disposed(){return this._disposed}get id(){return this._id}get label(){return this._label}set label(t){this._label=t,this._proxy.$updateGroupLabel(this._sourceControlHandle,this.handle,t)}get contextValue(){return this._contextValue}set contextValue(t){this._contextValue=t,this._proxy.$updateGroup(this._sourceControlHandle,this.handle,this.features)}get hideWhenEmpty(){return this._hideWhenEmpty}set hideWhenEmpty(t){this._hideWhenEmpty=t,this._proxy.$updateGroup(this._sourceControlHandle,this.handle,this.features)}get features(){return{contextValue:this.contextValue,hideWhenEmpty:this.hideWhenEmpty}}get resourceStates(){return[...this._resourceStates]}set resourceStates(t){this._resourceStates=[...t],this._onDidUpdateResourceStates.fire()}constructor(t,i,r,n,s,o,a){this._proxy=t,this._commands=i,this._sourceControlHandle=r,this._id=n,this._label=s,this.multiDiffEditorEnableViewChanges=o,this._extension=a,this._resourceHandlePool=0,this._resourceStates=[],this._resourceStatesMap=new Map,this._resourceStatesCommandsMap=new Map,this._resourceStatesDisposablesMap=new Map,this._onDidUpdateResourceStates=new P,this.onDidUpdateResourceStates=this._onDidUpdateResourceStates.event,this._disposed=!1,this._onDidDispose=new P,this.onDidDispose=this._onDidDispose.event,this._handlesSnapshot=[],this._resourceSnapshot=[],this._contextValue=void 0,this._hideWhenEmpty=void 0,this.handle=I7._handlePool++}getResourceState(t){return this._resourceStatesMap.get(t)}$executeResourceCommand(t,i){const r=this._resourceStatesCommandsMap.get(t);return r?Kt(()=>this._commands.executeCommand(r.command,...r.arguments||[],i)):Promise.resolve(void 0)}_takeResourceStateSnapshot(){const t=[...this._resourceStates].sort(Xk),r=Zw(this._resourceSnapshot,t,Xk).map(o=>{const a=o.toInsert.map(l=>{const c=this._resourceHandlePool++;this._resourceStatesMap.set(c,l);const u=l.resourceUri;let d;if(l.command)if(l.command.command==="vscode.open"||l.command.command==="vscode.diff"||l.command.command==="vscode.changes"){const Y=new he;d=this._commands.converter.toInternal(l.command,Y),this._resourceStatesDisposablesMap.set(c,Y)}else this._resourceStatesCommandsMap.set(c,l.command);const f=Ke(this._extension,"scmMultiDiffEditor"),p=f?l.multiDiffEditorOriginalUri:void 0,m=f?l.multiFileDiffEditorModifiedUri:void 0,_=aw(l.decorations),b=l.decorations&&aw(l.decorations.light)||_,E=l.decorations&&aw(l.decorations.dark)||_,C=[b,E],T=l.decorations&&l.decorations.tooltip||"",j=l.decorations&&!!l.decorations.strikeThrough,M=l.decorations&&!!l.decorations.faded,B=l.contextValue||"";return{rawResource:[c,u,C,T,j,M,B,d,p,m],handle:c}});return{start:o.start,deleteCount:o.deleteCount,toInsert:a}}),n=r.map(({start:o,deleteCount:a,toInsert:l})=>[o,a,l.map(c=>c.rawResource)]),s=r.reverse();for(const{start:o,deleteCount:a,toInsert:l}of s){const c=l.map(d=>d.handle),u=this._handlesSnapshot.splice(o,a,...c);for(const d of u)this._resourceStatesMap.delete(d),this._resourceStatesCommandsMap.delete(d),this._resourceStatesDisposablesMap.get(d)?.dispose(),this._resourceStatesDisposablesMap.delete(d)}return this._resourceSnapshot=t,n}dispose(){this._disposed=!0,this._onDidDispose.fire()}},uw=class k7{static{this._handlePool=0}#e;get id(){return this._id}get label(){return this._label}get rootUri(){return this._rootUri}get inputBox(){return this._inputBox}get count(){return this._count}set count(t){this._count!==t&&(this._count=t,this.#e.$updateSourceControl(this.handle,{count:t}))}get quickDiffProvider(){return this._quickDiffProvider}set quickDiffProvider(t){this._quickDiffProvider=t;let i;Ke(this._extension,"quickDiffProvider")&&(i=t?.label),this.#e.$updateSourceControl(this.handle,{hasQuickDiffProvider:!!t,quickDiffLabel:i})}get secondaryQuickDiffProvider(){return N(this._extension,"quickDiffProvider"),this._secondaryQuickDiffProvider}set secondaryQuickDiffProvider(t){N(this._extension,"quickDiffProvider"),this._secondaryQuickDiffProvider=t;const i=t?.label;this.#e.$updateSourceControl(this.handle,{hasSecondaryQuickDiffProvider:!!t,secondaryQuickDiffLabel:i})}get historyProvider(){return N(this._extension,"scmHistoryProvider"),this._historyProvider}set historyProvider(t){N(this._extension,"scmHistoryProvider"),this._historyProvider=t,this._historyProviderDisposable.value=new he,this.#e.$updateSourceControl(this.handle,{hasHistoryProvider:!!t}),t&&(this._historyProviderDisposable.value.add(t.onDidChangeCurrentHistoryItemRefs(()=>{const i=lw(t?.currentHistoryItemRef),r=lw(t?.currentHistoryItemRemoteRef),n=lw(t?.currentHistoryItemBaseRef);this.#e.$onDidChangeHistoryProviderCurrentHistoryItemRefs(this.handle,i,r,n)})),this._historyProviderDisposable.value.add(t.onDidChangeHistoryItemRefs(i=>{if(i.added.length===0&&i.modified.length===0&&i.removed.length===0)return;const r=i.added.map(o=>({...o,icon:uo(o.icon)})),n=i.modified.map(o=>({...o,icon:uo(o.icon)})),s=i.removed.map(o=>({...o,icon:uo(o.icon)}));this.#e.$onDidChangeHistoryProviderHistoryItemRefs(this.handle,{added:r,modified:n,removed:s,silent:i.silent})})))}get commitTemplate(){return this._commitTemplate}set commitTemplate(t){t!==this._commitTemplate&&(this._commitTemplate=t,this.#e.$updateSourceControl(this.handle,{commitTemplate:t}))}get acceptInputCommand(){return this._acceptInputCommand}set acceptInputCommand(t){this._acceptInputDisposables.value=new he,this._acceptInputCommand=t;const i=this._commands.converter.toInternal(t,this._acceptInputDisposables.value);this.#e.$updateSourceControl(this.handle,{acceptInputCommand:i})}get actionButton(){return N(this._extension,"scmActionButton"),this._actionButton}set actionButton(t){if(N(this._extension,"scmActionButton"),Em(this._actionButton,t))return;this._actionButton=t,this._actionButtonDisposables.value=new he;const i=t!==void 0?{command:{...this._commands.converter.toInternal(t.command,this._actionButtonDisposables.value),shortTitle:t.command.shortTitle},secondaryCommands:t.secondaryCommands?.map(r=>r.map(n=>this._commands.converter.toInternal(n,this._actionButtonDisposables.value))),enabled:t.enabled}:void 0;this.#e.$updateSourceControl(this.handle,{actionButton:i??null})}get statusBarCommands(){return this._statusBarCommands}set statusBarCommands(t){if(this._statusBarCommands&&t&&oH(this._statusBarCommands,t))return;this._statusBarDisposables.value=new he,this._statusBarCommands=t;const i=(t||[]).map(r=>this._commands.converter.toInternal(r,this._statusBarDisposables.value));this.#e.$updateSourceControl(this.handle,{statusBarCommands:i})}get selected(){return this._selected}constructor(t,i,r,n,s,o,a){this._extension=t,this._commands=n,this._id=s,this._label=o,this._rootUri=a,this._groups=new Map,this._count=void 0,this._quickDiffProvider=void 0,this._secondaryQuickDiffProvider=void 0,this._historyProviderDisposable=new Cn,this._commitTemplate=void 0,this._acceptInputDisposables=new Cn,this._acceptInputCommand=void 0,this._actionButtonDisposables=new Cn,this._statusBarDisposables=new Cn,this._statusBarCommands=void 0,this._selected=!1,this._onDidChangeSelection=new P,this.onDidChangeSelection=this._onDidChangeSelection.event,this.handle=k7._handlePool++,this.createdResourceGroups=new Map,this.updatedResourceGroups=new Set,this.#e=r;const l=y.from({scheme:V.vscodeSourceControl,path:`${s}/scm${this.handle}/input`,query:a?`rootUri=${encodeURIComponent(a.toString())}`:void 0});this._inputBox=new aH(t,i,this.#e,this.handle,l),this.#e.$registerSourceControl(this.handle,s,o,a,l)}createResourceGroup(t,i,r){const n=Ke(this._extension,"scmMultiDiffEditor")&&r?.multiDiffEditorEnableViewChanges===!0,s=new lH(this.#e,this._commands,this.handle,t,i,n,this._extension),o=ct.once(s.onDidDispose)(()=>this.createdResourceGroups.delete(s));return this.createdResourceGroups.set(s,o),this.eventuallyAddResourceGroups(),s}eventuallyAddResourceGroups(){const t=[],i=[];for(const[r,n]of this.createdResourceGroups){n.dispose();const s=r.onDidUpdateResourceStates(()=>{this.updatedResourceGroups.add(r),this.eventuallyUpdateResourceStates()});ct.once(r.onDidDispose)(()=>{this.updatedResourceGroups.delete(r),s.dispose(),this._groups.delete(r.handle),this.#e.$unregisterGroup(this.handle,r.handle)}),t.push([r.handle,r.id,r.label,r.features,r.multiDiffEditorEnableViewChanges]);const o=r._takeResourceStateSnapshot();o.length>0&&i.push([r.handle,o]),this._groups.set(r.handle,r)}this.#e.$registerGroups(this.handle,t,i),this.createdResourceGroups.clear()}eventuallyUpdateResourceStates(){const t=[];this.updatedResourceGroups.forEach(i=>{const r=i._takeResourceStateSnapshot();r.length!==0&&t.push([i.handle,r])}),t.length>0&&this.#e.$spliceResourceStates(this.handle,t),this.updatedResourceGroups.clear()}getResourceGroup(t){return this._groups.get(t)}setSelectionState(t){this._selected=t,this._onDidChangeSelection.fire(t)}dispose(){this._acceptInputDisposables.dispose(),this._actionButtonDisposables.dispose(),this._statusBarDisposables.dispose(),this._groups.forEach(t=>t.dispose()),this.#e.$unregisterSourceControl(this.handle)}};__decorate([R0(100)],uw.prototype,"eventuallyAddResourceGroups",null),__decorate([R0(100)],uw.prototype,"eventuallyUpdateResourceStates",null);var dw=class{static{ow=this}static{this._handlePool=0}get onDidChangeActiveProvider(){return this._onDidChangeActiveProvider.event}constructor(t,i,r,n){this._commands=i,this._extHostDocuments=r,this.logService=n,this._sourceControls=new Map,this._sourceControlsByExtension=new Xr,this._onDidChangeActiveProvider=new P,this._proxy=t.getProxy(W.MainThreadSCM),this._telemetry=t.getProxy(W.MainThreadTelemetry),i.registerArgumentProcessor({processArgument:s=>{if(s&&s.$mid===3){const o=this._sourceControls.get(s.sourceControlHandle);if(!o)return s;const a=o.getResourceGroup(s.groupHandle);return a?a.getResourceState(s.handle):s}else if(s&&s.$mid===4){const o=this._sourceControls.get(s.sourceControlHandle);return o?o.getResourceGroup(s.groupHandle):s}else if(s&&s.$mid===5){const o=this._sourceControls.get(s.handle);return o||s}return s}})}createSourceControl(t,i,r,n){this.logService.trace("ExtHostSCM#createSourceControl",t.identifier.value,i,r,n),this._telemetry.$publicLog2("api/scm/createSourceControl",{extensionId:t.identifier.value});const s=ow._handlePool++,o=new uw(t,this._extHostDocuments,this._proxy,this._commands,i,r,n);this._sourceControls.set(s,o);const a=this._sourceControlsByExtension.get(t.identifier)||[];return a.push(o),this._sourceControlsByExtension.set(t.identifier,a),o}getLastInputBox(t){this.logService.trace("ExtHostSCM#getLastInputBox",t.identifier.value);const i=this._sourceControlsByExtension.get(t.identifier),r=i&&i[i.length-1];return r&&r.inputBox}$provideOriginalResource(t,i,r){const n=y.revive(i);this.logService.trace("ExtHostSCM#$provideOriginalResource",t,n.toString());const s=this._sourceControls.get(t);return!s||!s.quickDiffProvider||!s.quickDiffProvider.provideOriginalResource?Promise.resolve(null):Kt(()=>s.quickDiffProvider.provideOriginalResource(n,r)).then(o=>o||null)}$provideSecondaryOriginalResource(t,i,r){const n=y.revive(i);this.logService.trace("ExtHostSCM#$provideSecondaryOriginalResource",t,n.toString());const s=this._sourceControls.get(t);return!s||!s.secondaryQuickDiffProvider||!s.secondaryQuickDiffProvider.provideOriginalResource?Promise.resolve(null):Kt(()=>s.secondaryQuickDiffProvider.provideOriginalResource(n,r)).then(o=>o||null)}$onInputBoxValueChange(t,i){this.logService.trace("ExtHostSCM#$onInputBoxValueChange",t);const r=this._sourceControls.get(t);return r&&r.inputBox.$onInputBoxValueChange(i),Promise.resolve(void 0)}$executeResourceCommand(t,i,r,n){this.logService.trace("ExtHostSCM#$executeResourceCommand",t,i,r);const s=this._sourceControls.get(t);if(!s)return Promise.resolve(void 0);const o=s.getResourceGroup(i);return o?o.$executeResourceCommand(r,n):Promise.resolve(void 0)}$validateInput(t,i,r){this.logService.trace("ExtHostSCM#$validateInput",t);const n=this._sourceControls.get(t);return!n||!n.inputBox.validateInput?Promise.resolve(void 0):Kt(()=>n.inputBox.validateInput(i,r)).then(s=>{if(!s)return Promise.resolve(void 0);const o=pe.fromStrict(s.message);return o?Promise.resolve([o,s.type]):Promise.resolve(void 0)})}$setSelectedSourceControl(t){return this.logService.trace("ExtHostSCM#$setSelectedSourceControl",t),t!==void 0&&this._sourceControls.get(t)?.setSelectionState(!0),this._selectedSourceControlHandle!==void 0&&this._sourceControls.get(this._selectedSourceControlHandle)?.setSelectionState(!1),this._selectedSourceControlHandle=t,Promise.resolve(void 0)}async $resolveHistoryItemRefsCommonAncestor(t,i,r){try{return await this._sourceControls.get(t)?.historyProvider?.resolveHistoryItemRefsCommonAncestor(i,r)??void 0}catch(n){this.logService.error("ExtHostSCM#$resolveHistoryItemRefsCommonAncestor",n);return}}async $provideHistoryItemRefs(t,i,r){try{return(await this._sourceControls.get(t)?.historyProvider?.provideHistoryItemRefs(i,r))?.map(o=>({...o,icon:uo(o.icon)}))??void 0}catch(n){this.logService.error("ExtHostSCM#$provideHistoryItemRefs",n);return}}async $provideHistoryItems(t,i,r){try{return(await this._sourceControls.get(t)?.historyProvider?.provideHistoryItems(i,r))?.map(o=>tH(o))??void 0}catch(n){this.logService.error("ExtHostSCM#$provideHistoryItems",n);return}}async $provideHistoryItemChanges(t,i,r,n){try{return await this._sourceControls.get(t)?.historyProvider?.provideHistoryItemChanges(i,r,n)??void 0}catch(s){this.logService.error("ExtHostSCM#$provideHistoryItemChanges",s);return}}};dw=ow=__decorate([__param(3,qe)],dw);var cH=class P7{static{this.handlePool=0}constructor(t,i){this.uriTransformer=i,this.providers=new Map,this.proxy=t.getProxy(W.MainThreadShare)}async $provideShare(t,i,r){return await this.providers.get(t)?.provideShare({selection:F.to(i.selection),resourceUri:y.revive(i.resourceUri)},r)??void 0}registerShareProvider(t,i){const r=P7.handlePool++;return this.providers.set(r,i),this.proxy.$registerShareProvider(r,_a.from(t,this.uriTransformer),i.id,i.label,i.priority),{dispose:()=>{this.proxy.$unregisterShareProvider(r),this.providers.delete(r)}}}},uH=class T7{static{this.ID_POOL=1}constructor(t){this.providers=new Map,this.sessions=new Map,this.synthesizers=new Map,this.proxy=t.getProxy(W.MainThreadSpeech)}async $createSpeechToTextSession(t,i,r){const n=this.providers.get(t);if(!n)return;const s=new he,o=new ft;this.sessions.set(i,o);const a=await n.provideSpeechToTextSession(o.token,r?{language:r}:void 0);a&&(s.add(a.onDidChange(l=>{o.token.isCancellationRequested||this.proxy.$emitSpeechToTextEvent(i,l)})),s.add(o.token.onCancellationRequested(()=>s.dispose())))}async $cancelSpeechToTextSession(t){this.sessions.get(t)?.dispose(!0),this.sessions.delete(t)}async $createTextToSpeechSession(t,i,r){const n=this.providers.get(t);if(!n)return;const s=new he,o=new ft;this.sessions.set(i,o);const a=await n.provideTextToSpeechSession(o.token,r?{language:r}:void 0);a&&(this.synthesizers.set(i,a),s.add(a.onDidChange(l=>{o.token.isCancellationRequested||this.proxy.$emitTextToSpeechEvent(i,l)})),s.add(o.token.onCancellationRequested(()=>s.dispose())))}async $synthesizeSpeech(t,i){this.synthesizers.get(t)?.synthesize(i)}async $cancelTextToSpeechSession(t){this.sessions.get(t)?.dispose(!0),this.sessions.delete(t),this.synthesizers.delete(t)}async $createKeywordRecognitionSession(t,i){const r=this.providers.get(t);if(!r)return;const n=new he,s=new ft;this.sessions.set(i,s);const o=await r.provideKeywordRecognitionSession(s.token);o&&(n.add(o.onDidChange(a=>{s.token.isCancellationRequested||this.proxy.$emitKeywordRecognitionEvent(i,a)})),n.add(s.token.onCancellationRequested(()=>n.dispose())))}async $cancelKeywordRecognitionSession(t){this.sessions.get(t)?.dispose(!0),this.sessions.delete(t)}registerProvider(t,i,r){const n=T7.ID_POOL++;return this.providers.set(n,r),this.proxy.$registerProvider(n,i,{extension:t,displayName:t.value}),ne(()=>{this.proxy.$unregisterProvider(n),this.providers.delete(n)})}},dH=class Gp{static{this.ID_GEN=0}static{this.ALLOWED_BACKGROUND_COLORS=new Map([["statusBarItem.errorBackground",new ic("statusBarItem.errorForeground")],["statusBarItem.warningBackground",new ic("statusBarItem.warningForeground")]])}#e;#t;constructor(t,i,r,n,s,o=Un.Left,a,l){if(this._onDispose=l,this._disposed=!1,this._text="",this._staleCommandRegistrations=new he,this.#e=t,this.#t=i,s&&n){this._entryId=p2(n.identifier,s);const c=r.get(this._entryId);c&&(o=c.alignLeft?Un.Left:Un.Right,a=c.priority,this._visible=!0,this.name=c.name,this.text=c.text,this.tooltip=c.tooltip,this.command=c.command,this.accessibilityInformation=c.accessibilityInformation)}else this._entryId=String(Gp.ID_GEN++);this._extension=n,this._id=s,this._alignment=o,this._priority=this.validatePriority(a)}validatePriority(t){if(ls(t))return t===Number.POSITIVE_INFINITY?Number.MAX_VALUE:t===Number.NEGATIVE_INFINITY?-Number.MAX_VALUE:t}get id(){return this._id??this._extension.identifier.value}get entryId(){return this._entryId}get alignment(){return this._alignment}get priority(){return this._priority}get text(){return this._text}get name(){return this._name}get tooltip(){return this._tooltip}get tooltip2(){return this._extension&&N(this._extension,"statusBarItemTooltip"),this._tooltip2}get color(){return this._color}get backgroundColor(){return this._backgroundColor}get command(){return this._command?.fromApi}get accessibilityInformation(){return this._accessibilityInformation}set text(t){this._text=t,this.update()}set name(t){this._name=t,this.update()}set tooltip(t){this._tooltip=t,this.update()}set tooltip2(t){this._extension&&N(this._extension,"statusBarItemTooltip"),this._tooltip2=t,this.update()}set color(t){this._color=t,this.update()}set backgroundColor(t){t&&!Gp.ALLOWED_BACKGROUND_COLORS.has(t.id)&&(t=void 0),this._backgroundColor=t,this.update()}set command(t){this._command?.fromApi!==t&&(this._latestCommandRegistration&&this._staleCommandRegistrations.add(this._latestCommandRegistration),this._latestCommandRegistration=new he,typeof t=="string"?this._command={fromApi:t,internal:this.#t.toInternal({title:"",command:t},this._latestCommandRegistration)}:t?this._command={fromApi:t,internal:this.#t.toInternal(t,this._latestCommandRegistration)}:this._command=void 0,this.update())}set accessibilityInformation(t){this._accessibilityInformation=t,this.update()}show(){this._visible=!0,this.update()}hide(){clearTimeout(this._timeoutHandle),this._visible=!1,this.#e.$disposeEntry(this._entryId)}update(){this._disposed||!this._visible||(clearTimeout(this._timeoutHandle),this._timeoutHandle=setTimeout(()=>{this._timeoutHandle=void 0;let t;this._extension?this._id?t=`${this._extension.identifier.value}.${this._id}`:t=this._extension.identifier.value:t=this._id;let i;this._name?i=this._name:i=h(2935,null,this._extension.displayName||this._extension.name);let r=this._color;this._backgroundColor&&(r=Gp.ALLOWED_BACKGROUND_COLORS.get(this._backgroundColor.id));let n,s;typeof this._tooltip2=="function"?(n=pe.fromStrict(this._tooltip),s=!0):(n=pe.fromStrict(this._tooltip2??this._tooltip),s=!1),this.#e.$setEntry(this._entryId,t,this._extension?.identifier.value,i,this._text,n,s,this._command?.internal,r,this._backgroundColor,this._alignment===Un.Left,this._priority,this._accessibilityInformation),this._staleCommandRegistrations.clear()},0))}dispose(){this.hide(),this._onDispose?.(),this._disposed=!0}},hH=class{constructor(e){this._messages=[],this._item=e.createStatusBarEntry(void 0,"status.extensionMessage",Un.Left,Number.MIN_VALUE),this._item.name=h(2936,null)}dispose(){this._messages.length=0,this._item.dispose()}setMessage(e){const t={message:e};return this._messages.unshift(t),this._update(),new Ce(()=>{const i=this._messages.indexOf(t);i>=0&&(this._messages.splice(i,1),this._update())})}_update(){this._messages.length>0?(this._item.text=this._messages[0].message,this._item.show()):this._item.hide()}},fH=class{constructor(e,t){this._entries=new Map,this._existingItems=new Map,this._proxy=e.getProxy(W.MainThreadStatusBar),this._commands=t,this._statusMessage=new hH(this)}$acceptStaticEntries(e){for(const t of e)this._existingItems.set(t.entryId,t)}async $provideTooltip(e,t){const i=this._entries.get(e);if(!i)return;const r=typeof i.tooltip2=="function"?await i.tooltip2(t):i.tooltip2;return t.isCancellationRequested?void 0:pe.fromStrict(r)}createStatusBarEntry(e,t,i,r){const n=new dH(this._proxy,this._commands,this._existingItems,e,t,i,r,()=>this._entries.delete(n.entryId));return this._entries.set(n.entryId,n),n}setStatusBarMessage(e,t){const i=this._statusMessage.setMessage(e);let r;return typeof t=="number"?r=setTimeout(()=>i.dispose(),t):typeof t<"u"&&t.then(()=>i.dispose(),()=>i.dispose()),new Ce(()=>{i.dispose(),clearTimeout(r)})}},pH=class extends se{constructor(e,t){super(),this._extHostDocumentsAndEditors=t,this._onDidChangeTextEditorSelection=new P,this._onDidChangeTextEditorOptions=new P,this._onDidChangeTextEditorVisibleRanges=new P,this._onDidChangeTextEditorViewColumn=new P,this._onDidChangeTextEditorDiffInformation=new P,this._onDidChangeActiveTextEditor=new P,this._onDidChangeVisibleTextEditors=new P,this.onDidChangeTextEditorSelection=this._onDidChangeTextEditorSelection.event,this.onDidChangeTextEditorOptions=this._onDidChangeTextEditorOptions.event,this.onDidChangeTextEditorVisibleRanges=this._onDidChangeTextEditorVisibleRanges.event,this.onDidChangeTextEditorViewColumn=this._onDidChangeTextEditorViewColumn.event,this.onDidChangeTextEditorDiffInformation=this._onDidChangeTextEditorDiffInformation.event,this.onDidChangeActiveTextEditor=this._onDidChangeActiveTextEditor.event,this.onDidChangeVisibleTextEditors=this._onDidChangeVisibleTextEditors.event,this._proxy=e.getProxy(W.MainThreadTextEditors),this._register(this._extHostDocumentsAndEditors.onDidChangeVisibleTextEditors(i=>this._onDidChangeVisibleTextEditors.fire(i))),this._register(this._extHostDocumentsAndEditors.onDidChangeActiveTextEditor(i=>this._onDidChangeActiveTextEditor.fire(i)))}getActiveTextEditor(){return this._extHostDocumentsAndEditors.activeEditor()}getVisibleTextEditors(e){const t=this._extHostDocumentsAndEditors.allEditors();return e?t:t.map(i=>i.value)}async showTextDocument(e,t,i){let r;typeof t=="number"?r={position:Rt.from(t),preserveFocus:i}:typeof t=="object"?r={position:Rt.from(t.viewColumn),preserveFocus:t.preserveFocus,selection:typeof t.selection=="object"?F.from(t.selection):void 0,pinned:typeof t.preview=="boolean"?!t.preview:void 0}:r={preserveFocus:!1};const n=await this._proxy.$tryShowTextDocument(e.uri,r),s=n&&this._extHostDocumentsAndEditors.getEditor(n);if(s)return s.value;throw n?new Error(`Could NOT open editor for "${e.uri.toString()}" because another editor opened in the meantime.`):new Error(`Could NOT open editor for "${e.uri.toString()}".`)}createTextEditorDecorationType(e,t){return new jN(this._proxy,e,t).value}$acceptEditorPropertiesChanged(e,t){const i=this._extHostDocumentsAndEditors.getEditor(e);if(!i)throw new Error("unknown text editor");if(t.options&&i._acceptOptions(t.options),t.selections){const r=t.selections.selections.map(fr.to);i._acceptSelections(r)}if(t.visibleRanges){const r=xt(t.visibleRanges.map(F.to));i._acceptVisibleRanges(r)}if(t.options&&this._onDidChangeTextEditorOptions.fire({textEditor:i.value,options:{...t.options,lineNumbers:Sa.to(t.options.lineNumbers)}}),t.selections){const r=ra.fromValue(t.selections.source),n=t.selections.selections.map(fr.to);this._onDidChangeTextEditorSelection.fire({textEditor:i.value,selections:n,kind:r})}if(t.visibleRanges){const r=xt(t.visibleRanges.map(F.to));this._onDidChangeTextEditorVisibleRanges.fire({textEditor:i.value,visibleRanges:r})}}$acceptEditorPositionData(e){for(const t in e){const i=this._extHostDocumentsAndEditors.getEditor(t);if(!i)throw new Error("Unknown text editor");const r=Rt.to(e[t]);i.value.viewColumn!==r&&(i._acceptViewColumn(r),this._onDidChangeTextEditorViewColumn.fire({textEditor:i.value,viewColumn:r}))}}$acceptEditorDiffInformation(e,t){const i=this._extHostDocumentsAndEditors.getEditor(e);if(!i)throw new Error("unknown text editor");if(!t){i._acceptDiffInformation(void 0),this._onDidChangeTextEditorDiffInformation.fire({textEditor:i.value,diffInformation:void 0});return}const r=this,n=t.map(s=>{const o=y.revive(s.original),a=y.revive(s.modified),l=s.changes.map(c=>{const[u,d,f,p]=c;let m;return u===d?m=na.Addition:f===p?m=na.Deletion:m=na.Modification,{original:{startLineNumber:u,endLineNumberExclusive:d},modified:{startLineNumber:f,endLineNumberExclusive:p},kind:m}});return Object.freeze({documentVersion:s.documentVersion,original:o,modified:a,changes:l,get isStale(){return r._extHostDocumentsAndEditors.getDocument(a)?.version!==s.documentVersion}})});i._acceptDiffInformation(n),this._onDidChangeTextEditorDiffInformation.fire({textEditor:i.value,diffInformation:n})}getDiffInformation(e){return Promise.resolve(this._proxy.$getDiffInformation(e))}},hw=class{constructor(t){this._actual=new kh(Vn.Dark),this._onDidChangeActiveColorTheme=new P}get activeColorTheme(){return this._actual}$onColorThemeChange(t){let i;switch(t){case"light":i=Vn.Light;break;case"hcDark":i=Vn.HighContrast;break;case"hcLight":i=Vn.HighContrastLight;break;default:i=Vn.Dark}this._actual=new kh(i),this._onDidChangeActiveColorTheme.fire(this._actual)}get onDidChangeActiveColorTheme(){return this._onDidChangeActiveColorTheme.event}};hw=__decorate([__param(0,Ue)],hw);var TQ=U("IExtHostTimeline"),gH=class{constructor(e,t){this._providers=new Map,this._itemsBySourceAndUriMap=new Map,this._proxy=e.getProxy(W.MainThreadTimeline),t.registerArgumentProcessor({processArgument:(i,r)=>{if(i&&i.$mid===12)if(this._providers.get(i.source)&&r&&Ke(r,"timeline")){const n=i.uri===void 0?void 0:y.revive(i.uri);return this._itemsBySourceAndUriMap.get(i.source)?.get(Zk(n))?.get(i.handle)}else return;return i}})}async $getTimeline(e,t,i,r){return this._providers.get(e)?.provider.provideTimeline(y.revive(t),i,r)}registerTimelineProvider(e,t,i,r){const n=new he,s=this.convertTimelineItem(t.id,r,n).bind(this);let o;t.onDidChange&&(o=t.onDidChange(l=>this._proxy.$emitTimelineChangeEvent({uri:void 0,reset:!0,...l,id:t.id}),this));const a=this._itemsBySourceAndUriMap;return this.registerTimelineProviderCore({...t,scheme:e,onDidChange:void 0,async provideTimeline(l,c,u){c?.resetCache&&(n.clear(),a.get(t.id)?.clear());const d=await t.provideTimeline(l,c,u);if(d==null)return;const f=s(l,c);return{...d,source:t.id,items:d.items.map(f)}},dispose(){for(const l of a.values())l.get(t.id)?.clear();o?.dispose(),n.dispose()}},i)}convertTimelineItem(e,t,i){return(r,n)=>{let s;if(n?.cacheResults){let o=this._itemsBySourceAndUriMap.get(e);o===void 0&&(o=new Map,this._itemsBySourceAndUriMap.set(e,o));const a=Zk(r);s=o.get(a),s===void 0&&(s=new Map,o.set(a,s))}return o=>{const{iconPath:a,...l}=o,c=`${e}|${o.id??o.timestamp}`;s?.set(c,o);let u,d,f;o.iconPath&&(a instanceof ci?f={id:a.id,color:a.color}:y.isUri(a)?(u=a,d=a):{light:u,dark:d}=a);let p;return mi.isMarkdownString(l.tooltip)?p=pe.from(l.tooltip):Me(l.tooltip)?p=l.tooltip:mi.isMarkdownString(l.detail)?(console.warn("Using deprecated TimelineItem.detail, migrate to TimelineItem.tooltip"),p=pe.from(l.detail)):Me(l.detail)&&(console.warn("Using deprecated TimelineItem.detail, migrate to TimelineItem.tooltip"),p=l.detail),{...l,id:l.id??void 0,handle:c,source:e,command:o.command?t.toInternal(o.command,i):void 0,icon:u,iconDark:d,themeIcon:f,tooltip:p,accessibilityInformation:o.accessibilityInformation}}}}registerTimelineProviderCore(e,t){if(this._providers.get(e.id))throw new Error(`Timeline Provider ${e.id} already exists.`);return this._proxy.$registerTimelineProvider({id:e.id,label:e.label,scheme:e.scheme}),this._providers.set(e.id,{provider:e,extension:t}),ne(()=>{for(const r of this._itemsBySourceAndUriMap.values())r.get(e.id)?.clear();this._providers.delete(e.id),this._proxy.$unregisterTimelineProvider(e.id),e.dispose()})}};function Zk(e){return e?.toString()}var mH={IconContribution:"base.contributions.icons"},Kk;(function(e){function t(i,r){let n=i.defaults;for(;kt.isThemeIcon(n);){const s=Ga.getIcon(n.id);if(!s)return;n=s.defaults}return n}e.getDefinition=t})(Kk||(Kk={}));var Yk;(function(e){function t(r){return{weight:r.weight,style:r.style,src:r.src.map(n=>({format:n.format,location:n.location.toString()}))}}e.toJSONObject=t;function i(r){const n=s=>Me(s)?s:void 0;if(r&&Array.isArray(r.src)&&r.src.every(s=>Me(s.format)&&Me(s.location)))return{weight:n(r.weight),style:n(r.style),src:r.src.map(s=>({format:s.format,location:y.parse(s.location)}))}}e.fromJSONObject=i})(Yk||(Yk={}));var vH=/^([\w_-]+)$/,_H=h(2558,null),wH=class extends se{constructor(){super(),this._onDidChange=this._register(new P),this.onDidChange=this._onDidChange.event,this.iconSchema={definitions:{icons:{type:"object",properties:{fontId:{type:"string",description:h(2559,null),pattern:vH.source,patternErrorMessage:_H},fontCharacter:{type:"string",description:h(2560,null)}},additionalProperties:!1,defaultSnippets:[{body:{fontCharacter:"\\\\e030"}}]}},type:"object",properties:{}},this.iconReferenceSchema={type:"string",pattern:`^${kt.iconNameExpression}$`,enum:[],enumDescriptions:[]},this.iconsById={},this.iconFontsById={}}registerIcon(e,t,i,r){const n=this.iconsById[e];if(n){if(i&&!n.description){n.description=i,this.iconSchema.properties[e].markdownDescription=`${i} $(${e})`;const a=this.iconReferenceSchema.enum.indexOf(e);a!==-1&&(this.iconReferenceSchema.enumDescriptions[a]=i),this._onDidChange.fire()}return n}const s={id:e,description:i,defaults:t,deprecationMessage:r};this.iconsById[e]=s;const o={$ref:"#/definitions/icons"};return r&&(o.deprecationMessage=r),i&&(o.markdownDescription=`${i}: $(${e})`),this.iconSchema.properties[e]=o,this.iconReferenceSchema.enum.push(e),this.iconReferenceSchema.enumDescriptions.push(i||""),this._onDidChange.fire(),{id:e}}deregisterIcon(e){delete this.iconsById[e],delete this.iconSchema.properties[e];const t=this.iconReferenceSchema.enum.indexOf(e);t!==-1&&(this.iconReferenceSchema.enum.splice(t,1),this.iconReferenceSchema.enumDescriptions.splice(t,1)),this._onDidChange.fire()}getIcons(){return Object.keys(this.iconsById).map(e=>this.iconsById[e])}getIcon(e){return this.iconsById[e]}getIconSchema(){return this.iconSchema}getIconReferenceSchema(){return this.iconReferenceSchema}registerIconFont(e,t){const i=this.iconFontsById[e];return i||(this.iconFontsById[e]=t,this._onDidChange.fire(),t)}deregisterIconFont(e){delete this.iconFontsById[e]}getIconFont(e){return this.iconFontsById[e]}toString(){const e=(n,s)=>n.id.localeCompare(s.id),t=n=>{for(;kt.isThemeIcon(n.defaults);)n=this.iconsById[n.defaults.id];return`codicon codicon-${n?n.id:""}`},i=[];i.push("| preview     | identifier                        | default codicon ID                | description"),i.push("| ----------- | --------------------------------- | --------------------------------- | --------------------------------- |");const r=Object.keys(this.iconsById).map(n=>this.iconsById[n]);for(const n of r.filter(s=>!!s.description).sort(e))i.push(`|<i class="${t(n)}"></i>|${n.id}|${kt.isThemeIcon(n.defaults)?n.defaults.id:n.id}|${n.description||""}|`);i.push("| preview     | identifier                        "),i.push("| ----------- | --------------------------------- |");for(const n of r.filter(s=>!kt.isThemeIcon(s.defaults)).sort(e))i.push(`|<i class="${t(n)}"></i>|${n.id}|`);return i.join(`
`)}},Ga=new wH;Ht.add(mH.IconContribution,Ga);function kp(e,t,i,r){return Ga.registerIcon(e,t,i,r)}function yH(){const e=O8();for(const t in e){const i="\\"+e[t].toString(16);Ga.registerIcon(t,{fontCharacter:i})}}yH();var e6="vscode://schemas/icons",t6=Ht.as(Id.JSONContribution);t6.registerSchema(e6,Ga.getIconSchema());var i6=new Ao(()=>t6.notifySchemaChanged(e6),200);Ga.onDidChange(()=>{i6.isScheduled()||i6.schedule()});var AQ=kp("widget-close",re.close,h(2561,null)),RQ=kp("goto-previous-location",re.arrowUp,h(2562,null)),LQ=kp("goto-next-location",re.arrowDown,h(2563,null)),NQ=kt.modify(re.sync,"spin"),MQ=kt.modify(re.loading,"spin"),OQ=h(4495,null),FQ=kp("default-view-icon",re.window,h(4496,null)),Pp;(function(e){e.ViewContainersRegistry="workbench.registry.view.containers",e.ViewsRegistry="workbench.registry.view"})(Pp||(Pp={}));var r6;(function(e){e[e.Sidebar=0]="Sidebar",e[e.Panel=1]="Panel",e[e.AuxiliaryBar=2]="AuxiliaryBar"})(r6||(r6={}));var bH=class extends se{constructor(){super(...arguments),this._onDidRegister=this._register(new P),this.onDidRegister=this._onDidRegister.event,this._onDidDeregister=this._register(new P),this.onDidDeregister=this._onDidDeregister.event,this.viewContainers=new Map,this.defaultViewContainers=[]}get all(){return[...this.viewContainers.values()].flat()}registerViewContainer(e,t,i){const r=this.get(e.id);if(r)return r;const n=e;return n.openCommandActionDescriptor=i?.doNotRegisterOpenCommand?void 0:n.openCommandActionDescriptor??{id:n.id},d9(this.viewContainers,t,[]).push(n),i?.isDefault&&this.defaultViewContainers.push(n),this._onDidRegister.fire({viewContainer:n,viewContainerLocation:t}),n}deregisterViewContainer(e){for(const t of this.viewContainers.keys()){const i=this.viewContainers.get(t),r=i?.indexOf(e);if(r!==-1){i?.splice(r,1),i.length===0&&this.viewContainers.delete(t),this._onDidDeregister.fire({viewContainer:e,viewContainerLocation:t});return}}}get(e){return this.all.filter(t=>t.id===e)[0]}getViewContainers(e){return[...this.viewContainers.get(e)||[]]}getViewContainerLocation(e){return[...this.viewContainers.keys()].filter(t=>this.getViewContainers(t).filter(i=>i?.id===e.id).length>0)[0]}getDefaultViewContainer(e){return this.defaultViewContainers.find(t=>this.getViewContainerLocation(t)===e)}};Ht.add(Pp.ViewContainersRegistry,new bH);var Tp;(function(e){e.Open="2_open",e.Debug="4_debug",e.SCM="5_scm",e.More="9_more"})(Tp||(Tp={}));function xH(e,t){const i=e.group??Tp.More,r=t.group??Tp.More;return i!==r?i.localeCompare(r):(e.order??5)-(t.order??5)}var SH=class extends se{constructor(){super(...arguments),this._onViewsRegistered=this._register(new P),this.onViewsRegistered=this._onViewsRegistered.event,this._onViewsDeregistered=this._register(new P),this.onViewsDeregistered=this._onViewsDeregistered.event,this._onDidChangeContainer=this._register(new P),this.onDidChangeContainer=this._onDidChangeContainer.event,this._onDidChangeViewWelcomeContent=this._register(new P),this.onDidChangeViewWelcomeContent=this._onDidChangeViewWelcomeContent.event,this._viewContainers=[],this._views=new Map,this._viewWelcomeContents=new oy}registerViews(e,t){this.registerViews2([{views:e,viewContainer:t}])}registerViews2(e){e.forEach(({views:t,viewContainer:i})=>this.addViews(t,i)),this._onViewsRegistered.fire(e)}deregisterViews(e,t){const i=this.removeViews(e,t);i.length&&this._onViewsDeregistered.fire({views:i,viewContainer:t})}moveViews(e,t){for(const i of this._views.keys())if(i!==t){const r=this.removeViews(e,i);r.length&&(this.addViews(r,t),this._onDidChangeContainer.fire({views:r,from:i,to:t}))}}getViews(e){return this._views.get(e)||[]}getView(e){for(const t of this._viewContainers){const i=(this._views.get(t)||[]).filter(r=>r.id===e)[0];if(i)return i}return null}getViewContainer(e){for(const t of this._viewContainers)if((this._views.get(t)||[]).filter(r=>r.id===e)[0])return t;return null}registerViewWelcomeContent(e,t){return this._viewWelcomeContents.add(e,t),this._onDidChangeViewWelcomeContent.fire(e),ne(()=>{this._viewWelcomeContents.delete(e,t),this._onDidChangeViewWelcomeContent.fire(e)})}registerViewWelcomeContent2(e,t){const i=new Map;for(const[r,n]of t)this._viewWelcomeContents.add(e,n),i.set(r,ne(()=>{this._viewWelcomeContents.delete(e,n),this._onDidChangeViewWelcomeContent.fire(e)}));return this._onDidChangeViewWelcomeContent.fire(e),i}getViewWelcomeContent(e){const t=[];return this._viewWelcomeContents.forEach(e,i=>t.push(i)),t.sort(xH)}addViews(e,t){let i=this._views.get(t);i||(i=[],this._views.set(t,i),this._viewContainers.push(t));for(const r of e){if(this.getView(r.id)!==null)throw new Error(h(4497,null,r.id));i.push(r)}}removeViews(e,t){const i=this._views.get(t);if(!i)return[];const r=[],n=[];for(const s of i)e.includes(s)?r.push(s):n.push(s);return r.length&&(n.length?this._views.set(t,n):(this._views.delete(t),this._viewContainers.splice(this._viewContainers.indexOf(t),1))),r}};Ht.add(Pp.ViewsRegistry,new SH);var $Q=U("viewDescriptorService"),n6;(function(e){e[e.Default=0]="Default",e[e.Expand=1]="Expand"})(n6||(n6={}));var s6;(function(e){e[e.None=0]="None",e[e.Collapsed=1]="Collapsed",e[e.Expanded=2]="Expanded"})(s6||(s6={}));var bn=class extends Error{constructor(e){super(h(4498,null,e)),this.name="NoTreeViewError"}static is(e){return!!e&&e.name==="NoTreeViewError"}},EH=class{constructor(){this._dragOperations=new Map}removeDragOperationTransfer(e){if(e&&this._dragOperations.has(e)){const t=this._dragOperations.get(e);return this._dragOperations.delete(e),t}}addDragOperationTransfer(e,t){this._dragOperations.set(e,t)}};function o6(e,t){if(Me(e))return{label:e};if(e&&typeof e=="object"&&typeof e.label=="string"){let i;return Array.isArray(e.highlights)&&(i=e.highlights.filter(r=>r.length===2&&typeof r[0]=="number"&&typeof r[1]=="number"),i=i.length?i:void 0),{label:e.label,highlights:i}}}var CH=class extends se{constructor(e,t,i){super(),this._proxy=e,this.commands=t,this.logService=i,this.treeViews=new Map,this.treeDragAndDropService=new EH;function r(n){return n&&n.$treeViewId&&(n.$treeItemHandle||n.$selectedTreeItems||n.$focusedTreeItem)}t.registerArgumentProcessor({processArgument:n=>r(n)?this.convertArgument(n):Array.isArray(n)&&n.length>0?n.map(s=>r(s)?this.convertArgument(s):s):n})}registerTreeDataProvider(e,t,i){const r=this.createTreeView(e,{treeDataProvider:t},i);return{dispose:()=>r.dispose()}}createTreeView(e,t,i){if(!t||!t.treeDataProvider)throw new Error("Options with treeDataProvider is mandatory");const r=t.dragAndDropController?.dropMimeTypes??[],n=t.dragAndDropController?.dragMimeTypes??[],s=!!t.dragAndDropController?.handleDrag,o=!!t.dragAndDropController?.handleDrop,a=this.createExtHostTreeView(e,t,i),l={showCollapseAll:!!t.showCollapseAll,canSelectMany:!!t.canSelectMany,dropMimeTypes:r,dragMimeTypes:n,hasHandleDrag:s,hasHandleDrop:o,manuallyManageCheckboxes:!!t.manageCheckboxStateManually},c=this._proxy.$registerTreeViewDataProvider(e,l),u={get onDidCollapseElement(){return a.onDidCollapseElement},get onDidExpandElement(){return a.onDidExpandElement},get selection(){return a.selectedElements},get onDidChangeSelection(){return a.onDidChangeSelection},get activeItem(){return N(i,"treeViewActiveItem"),a.focusedElement},get onDidChangeActiveItem(){return N(i,"treeViewActiveItem"),a.onDidChangeActiveItem},get visible(){return a.visible},get onDidChangeVisibility(){return a.onDidChangeVisibility},get onDidChangeCheckboxState(){return a.onDidChangeCheckboxState},get message(){return a.message},set message(d){Kr(d)&&N(i,"treeViewMarkdownMessage"),a.message=d},get title(){return a.title},set title(d){a.title=d},get description(){return a.description},set description(d){a.description=d},get badge(){return a.badge},set badge(d){d!==void 0&&Iv.isViewBadge(d)?a.badge={value:Math.floor(Math.abs(d.value)),tooltip:d.tooltip}:d===void 0&&(a.badge=void 0)},reveal:(d,f)=>a.reveal(d,f),dispose:async()=>{await c,this.treeViews.delete(e),a.dispose()}};return this._register(u),u}async $getChildren(e,t){const i=this.treeViews.get(e);if(!i)return Promise.reject(new bn(e));if(!t){const n=await i.getChildren();return n?[[0,...n]]:void 0}const r=[];for(let n=0;n<t.length;n++){const s=t[n],o=await i.getChildren(s);o&&r.push([n,...o])}return r}async $handleDrop(e,t,i,r,n,s,o,a){const l=this.treeViews.get(e);if(!l)return Promise.reject(new bn(e));const c=Ta.toDataTransfer(i,async u=>(await this._proxy.$resolveDropFileData(e,t,u)).buffer);return o===e&&a&&await this.addAdditionalTransferItems(c,l,a,n,s),l.onDrop(c,r,n)}async addAdditionalTransferItems(e,t,i,r,n){const s=this.treeDragAndDropService.removeDragOperationTransfer(n);if(s)(await s)?.forEach((o,a)=>{o&&e.set(a,o)});else if(n&&t.handleDrag){const o=t.handleDrag(i,e,r);this.treeDragAndDropService.addDragOperationTransfer(n,o),await o}return e}async $handleDrag(e,t,i,r){const n=this.treeViews.get(e);if(!n)return Promise.reject(new bn(e));const s=await this.addAdditionalTransferItems(new la,n,t,r,i);if(!(!s||r.isCancellationRequested))return Ta.from(s)}async $hasResolve(e){const t=this.treeViews.get(e);if(!t)throw new bn(e);return t.hasResolve}$resolve(e,t,i){const r=this.treeViews.get(e);if(!r)throw new bn(e);return r.resolveTreeItem(t,i)}$setExpanded(e,t,i){const r=this.treeViews.get(e);if(!r)throw new bn(e);r.setExpanded(t,i)}$setSelectionAndFocus(e,t,i){const r=this.treeViews.get(e);if(!r)throw new bn(e);r.setSelectionAndFocus(t,i)}$setVisible(e,t){const i=this.treeViews.get(e);if(!i){if(!t)return;throw new bn(e)}i.setVisible(t)}$changeCheckboxState(e,t){const i=this.treeViews.get(e);if(!i)throw new bn(e);i.setCheckboxState(t)}createExtHostTreeView(e,t,i){const r=this._register(new DH(e,t,this._proxy,this.commands.converter,this.logService,i));return this.treeViews.set(e,r),r}convertArgument(e){const t=this.treeViews.get(e.$treeViewId);return t&&"$treeItemHandle"in e?t.getExtensionElement(e.$treeItemHandle):t&&"$focusedTreeItem"in e&&e.$focusedTreeItem?t.focusedElement:null}},DH=class qw extends se{static{this.LABEL_HANDLE_PREFIX="0"}static{this.ID_HANDLE_PREFIX="1"}get visible(){return this._visible}get selectedElements(){return this._selectedHandles.map(t=>this.getExtensionElement(t)).filter(t=>!Et(t))}get focusedElement(){return this._focusedHandle?this.getExtensionElement(this._focusedHandle):void 0}constructor(t,i,r,n,s,o){if(super(),this.viewId=t,this.proxy=r,this.commands=n,this.logService=s,this.extension=o,this.roots=void 0,this.elements=new Map,this.nodes=new Map,this._visible=!1,this._selectedHandles=[],this._focusedHandle=void 0,this._onDidExpandElement=this._register(new P),this.onDidExpandElement=this._onDidExpandElement.event,this._onDidCollapseElement=this._register(new P),this.onDidCollapseElement=this._onDidCollapseElement.event,this._onDidChangeSelection=this._register(new P),this.onDidChangeSelection=this._onDidChangeSelection.event,this._onDidChangeActiveItem=this._register(new P),this.onDidChangeActiveItem=this._onDidChangeActiveItem.event,this._onDidChangeVisibility=this._register(new P),this.onDidChangeVisibility=this._onDidChangeVisibility.event,this._onDidChangeCheckboxState=this._register(new P),this.onDidChangeCheckboxState=this._onDidChangeCheckboxState.event,this._onDidChangeData=this._register(new P),this.refreshPromise=Promise.resolve(),this.refreshQueue=Promise.resolve(),this._message="",this._title="",this._refreshCancellationSource=new ft,o.contributes&&o.contributes.views)for(const u in o.contributes.views)for(const d of o.contributes.views[u])d.id===t&&(this._title=d.name);this.dataProvider=i.treeDataProvider,this.dndController=i.dragAndDropController,this.dataProvider.onDidChangeTreeData&&this._register(this.dataProvider.onDidChangeTreeData(u=>{Array.isArray(u)&&u.length===0||this._onDidChangeData.fire({message:!1,element:u})}));let a,l;const c=ct.debounce(this._onDidChangeData.event,(u,d)=>(u||(u={message:!1,elements:[]}),d.element!==!1&&(a||(a=new Promise(f=>l=f),this.refreshPromise=this.refreshPromise.then(()=>a)),Array.isArray(d.element)?u.elements.push(...d.element):u.elements.push(d.element)),d.message&&(u.message=!0),u),200,!0);this._register(c(({message:u,elements:d})=>{d.length&&(this.refreshQueue=this.refreshQueue.then(()=>{const f=l;return a=null,this.refresh(d).then(()=>f())})),u&&this.proxy.$setMessage(this.viewId,pe.fromStrict(this._message)??"")}))}async getChildren(t){const i=t?this.getExtensionElement(t):void 0;if(t&&!i)return this.logService.error(`No tree item with id '${t}' found.`),Promise.resolve([]);let r=this.getChildrenNodes(t);return r||(r=await this.fetchChildrenNodes(i)),r?r.map(n=>n.item):void 0}getExtensionElement(t){return this.elements.get(t)}reveal(t,i){i=i||{select:!0,focus:!1};const r=Et(i.select)?!0:i.select,n=Et(i.focus)?!1:i.focus,s=Et(i.expand)?!1:i.expand;return typeof this.dataProvider.getParent!="function"?Promise.reject(new Error("Required registered TreeDataProvider to implement 'getParent' method to access 'reveal' method")):t?this.refreshPromise.then(()=>this.resolveUnknownParentChain(t)).then(o=>this.resolveTreeNode(t,o[o.length-1]).then(a=>this.proxy.$reveal(this.viewId,{item:a.item,parentChain:o.map(l=>l.item)},{select:r,focus:n,expand:s})),o=>this.logService.error(o)):this.proxy.$reveal(this.viewId,void 0,{select:r,focus:n,expand:s})}get message(){return this._message}set message(t){this._message=t,this._onDidChangeData.fire({message:!0,element:!1})}get title(){return this._title}set title(t){this._title=t,this.proxy.$setTitle(this.viewId,t,this._description)}get description(){return this._description}set description(t){this._description=t,this.proxy.$setTitle(this.viewId,this._title,t)}get badge(){return this._badge}set badge(t){this._badge?.value===t?.value&&this._badge?.tooltip===t?.tooltip||(this._badge=vf.from(t),this.proxy.$setBadge(this.viewId,t))}setExpanded(t,i){const r=this.getExtensionElement(t);r&&(i?this._onDidExpandElement.fire(Object.freeze({element:r})):this._onDidCollapseElement.fire(Object.freeze({element:r})))}setSelectionAndFocus(t,i){const r=!Sr(this._selectedHandles,t);this._selectedHandles=t;const n=this._focusedHandle!==i;this._focusedHandle=i,r&&this._onDidChangeSelection.fire(Object.freeze({selection:this.selectedElements})),n&&this._onDidChangeActiveItem.fire(Object.freeze({activeItem:this.focusedElement}))}setVisible(t){t!==this._visible&&(this._visible=t,this._onDidChangeVisibility.fire(Object.freeze({visible:this._visible})))}async setCheckboxState(t){const i=(await Promise.all(t.map(async r=>{const n=this.getExtensionElement(r.treeItemHandle);return n?{extensionItem:n,treeItem:await this.dataProvider.getTreeItem(n),newState:r.newState?Lr.Checked:Lr.Unchecked}:Promise.resolve(void 0)}))).filter(r=>r!==void 0);i.forEach(r=>{r.treeItem.checkboxState=r.newState?Lr.Checked:Lr.Unchecked}),this._onDidChangeCheckboxState.fire({items:i.map(r=>[r.extensionItem,r.newState])})}async handleDrag(t,i,r){const n=[];for(const s of t){const o=this.getExtensionElement(s);o&&n.push(o)}if(!(!this.dndController?.handleDrag||n.length===0))return await this.dndController.handleDrag(n,i,r),i}get hasHandleDrag(){return!!this.dndController?.handleDrag}async onDrop(t,i,r){const n=i?this.getExtensionElement(i):void 0;if(!(!n&&i||!this.dndController?.handleDrop))return Kt(()=>this.dndController?.handleDrop?this.dndController.handleDrop(n,t,r):void 0)}get hasResolve(){return!!this.dataProvider.resolveTreeItem}async resolveTreeItem(t,i){if(!this.dataProvider.resolveTreeItem)return;const r=this.elements.get(t);if(r){const n=this.nodes.get(r);if(n){const s=await this.dataProvider.resolveTreeItem(n.extensionItem,r,i)??n.extensionItem;return this.validateTreeItem(s),n.item.tooltip=this.getTooltip(s.tooltip),n.item.command=this.getCommand(n.disposableStore,s.command),n.item}}}resolveUnknownParentChain(t){return this.resolveParent(t).then(i=>i?this.resolveUnknownParentChain(i).then(r=>this.resolveTreeNode(i,r[r.length-1]).then(n=>(r.push(n),r))):Promise.resolve([]))}resolveParent(t){const i=this.nodes.get(t);return i?Promise.resolve(i.parent?this.elements.get(i.parent.item.handle):void 0):Kt(()=>this.dataProvider.getParent(t))}resolveTreeNode(t,i){const r=this.nodes.get(t);return r?Promise.resolve(r):Kt(()=>this.dataProvider.getTreeItem(t)).then(n=>this.createHandle(t,n,i,!0)).then(n=>this.getChildren(i?i.item.handle:void 0).then(()=>{const s=this.getExtensionElement(n);if(s){const o=this.nodes.get(s);if(o)return Promise.resolve(o)}throw new Error(`Cannot resolve tree item for element ${n} from extension ${this.extension.identifier.value}`)}))}getChildrenNodes(t){if(t){let i;if(typeof t=="string"){const r=this.getExtensionElement(t);i=r?this.nodes.get(r):void 0}else i=t;return i&&i.children||void 0}return this.roots}async fetchChildrenNodes(t){this.clearChildren(t);const i=new ft(this._refreshCancellationSource.token);try{const r=t?this.nodes.get(t):void 0,n=await this.dataProvider.getChildren(t);if(i.token.isCancellationRequested)return;const s=xt(n||[]),o=await Promise.all(xt(s).map(l=>this.dataProvider.getTreeItem(l)));if(i.token.isCancellationRequested)return;const a=o.map((l,c)=>l?this.createAndRegisterTreeNode(s[c],l,r):null);return xt(a)}finally{i.dispose()}}refresh(t){if(t.some(r=>!r))return this._refreshCancellationSource.dispose(!0),this._refreshCancellationSource=new ft,this.clearAll(),this.proxy.$refresh(this.viewId);{const r=this.getHandlesToRefresh(t);if(r.length)return this.refreshHandles(r)}return Promise.resolve(void 0)}getHandlesToRefresh(t){const i=new Set,r=t.map(s=>this.nodes.get(s));for(const s of r)if(s&&!i.has(s.item.handle)){let o=s;for(;o&&o.parent&&r.findIndex(a=>o&&o.parent&&a&&a.item.handle===o.parent.item.handle)===-1;){const a=this.elements.get(o.parent.item.handle);o=a?this.nodes.get(a):void 0}o&&!o.parent&&i.add(s.item.handle)}const n=[];return i.forEach(s=>{const o=this.elements.get(s);if(o){const a=this.nodes.get(o);a&&(!a.parent||!i.has(a.parent.item.handle))&&n.push(s)}}),n}refreshHandles(t){const i={};return Promise.all(t.map(r=>this.refreshNode(r).then(n=>{n&&(i[r]=n.item)}))).then(()=>Object.keys(i).length?this.proxy.$refresh(this.viewId,i):void 0)}refreshNode(t){const i=this.getExtensionElement(t);if(i){const r=this.nodes.get(i);if(r)return this.clearChildren(i),Kt(()=>this.dataProvider.getTreeItem(i)).then(n=>{if(n){const s=this.createTreeNode(i,n,r.parent);return this.updateNodeCache(i,s,r,r.parent),r.dispose(),s}return null})}return Promise.resolve(null)}createAndRegisterTreeNode(t,i,r){const n=this.createTreeNode(t,i,r);if(i.id&&this.elements.has(n.item.handle))throw new Error(h(2939,null,i.id));return this.addNodeToCache(t,n),this.addNodeToParentCache(n,r),n}getTooltip(t){return mi.isMarkdownString(t)?pe.from(t):t}getCommand(t,i){return i?{...this.commands.toInternal(i,t),originalId:i.command}:void 0}getCheckbox(t){if(t.checkboxState===void 0)return;let i,r,n;return typeof t.checkboxState=="number"?i=t.checkboxState:(i=t.checkboxState.state,r=t.checkboxState.tooltip,n=t.checkboxState.accessibilityInformation),{isChecked:i===Lr.Checked,tooltip:r,accessibilityInformation:n}}validateTreeItem(t){if(!mh.isTreeItem(t,this.extension))throw new Error(`Extension ${this.extension.identifier.value} has provided an invalid tree item.`)}createTreeNode(t,i,r){this.validateTreeItem(i);const n=this._register(new he),s=this.createHandle(t,i,r),o=this.getLightIconPath(i);return{item:{handle:s,parentHandle:r?r.item.handle:void 0,label:o6(i.label,this.extension),description:i.description,resourceUri:i.resourceUri,tooltip:this.getTooltip(i.tooltip),command:this.getCommand(n,i.command),contextValue:i.contextValue,icon:o,iconDark:this.getDarkIconPath(i)||o,themeIcon:this.getThemeIcon(i),collapsibleState:Et(i.collapsibleState)?Bs.None:i.collapsibleState,accessibilityInformation:i.accessibilityInformation,checkbox:this.getCheckbox(i)},extensionItem:i,parent:r,children:void 0,disposableStore:n,dispose(){n.dispose()}}}getThemeIcon(t){return t.iconPath instanceof ci?t.iconPath:void 0}createHandle(t,{id:i,label:r,resourceUri:n},s,o){if(i)return`${qw.ID_HANDLE_PREFIX}/${i}`;const a=o6(r,this.extension),l=s?s.item.handle:qw.LABEL_HANDLE_PREFIX;let c=a?a.label:n?nr(n):"";c=c.indexOf("/")!==-1?c.replace("/","//"):c;const u=this.nodes.has(t)?this.nodes.get(t).item.handle:void 0,d=this.getChildrenNodes(s)||[];let f,p=0;do{if(f=`${l}/${p}:${c}`,o||!this.elements.has(f)||u===f)break;p++}while(p<=d.length);return f}getLightIconPath(t){if(t.iconPath&&!(t.iconPath instanceof ci))return typeof t.iconPath=="string"||y.isUri(t.iconPath)?this.getIconPath(t.iconPath):this.getIconPath(t.iconPath.light)}getDarkIconPath(t){if(t.iconPath&&!(t.iconPath instanceof ci)&&t.iconPath.dark)return this.getIconPath(t.iconPath.dark)}getIconPath(t){return y.isUri(t)?t:y.file(t)}addNodeToCache(t,i){this.elements.set(i.item.handle,t),this.nodes.set(t,i)}updateNodeCache(t,i,r,n){this.elements.delete(i.item.handle),this.nodes.delete(t),i.item.handle!==r.item.handle&&this.elements.delete(r.item.handle),this.addNodeToCache(t,i);const s=this.getChildrenNodes(n)||[],o=s.filter(a=>a.item.handle===r.item.handle)[0];o&&s.splice(s.indexOf(o),1,i)}addNodeToParentCache(t,i){i?(i.children||(i.children=[]),i.children.push(t)):(this.roots||(this.roots=[]),this.roots.push(t))}clearChildren(t){if(t){const i=this.nodes.get(t);if(i){if(i.children)for(const r of i.children){const n=this.elements.get(r.item.handle);n&&this.clear(n)}i.children=void 0}}else this.clearAll()}clear(t){const i=this.nodes.get(t);if(i){if(i.children)for(const r of i.children){const n=this.elements.get(r.item.handle);n&&this.clear(n)}this.nodes.delete(t),this.elements.delete(i.item.handle),i.dispose()}}clearAll(){this.roots=void 0,this.elements.clear(),this.nodes.forEach(t=>t.dispose()),this.nodes.clear()}dispose(){super.dispose(),this._refreshCancellationSource.dispose(),this.clearAll(),this.proxy.$disposeTree(this.viewId)}},IH=class A7{static{this.supportedSchemes=new Set([V.http,V.https])}constructor(t){this._openers=new Map,this._proxy=t.getProxy(W.MainThreadUriOpeners)}registerExternalUriOpener(t,i,r,n){if(this._openers.has(i))throw new Error(`Opener with id '${i}' already registered`);const s=n.schemes.find(o=>!A7.supportedSchemes.has(o));if(s)throw new Error(`Scheme '${s}' is not supported. Only http and https are currently supported.`);return this._openers.set(i,r),this._proxy.$registerUriOpener(i,n.schemes,t,n.label),ne(()=>{this._openers.delete(i),this._proxy.$unregisterUriOpener(i)})}async $canOpenUri(t,i,r){const n=this._openers.get(t);if(!n)throw new Error(`Unknown opener with id: ${t}`);const s=y.revive(i);return n.canOpenExternalUri(s,r)}async $openUri(t,i,r){const n=this._openers.get(t);if(!n)throw new Error(`Unknown opener id: '${t}'`);return n.openExternalUri(y.revive(i.resolvedUri),{sourceUri:y.revive(i.sourceUri)},r)}},kH=class R7{static{this.HandlePool=0}constructor(t){this.handles=new vs,this.handlers=new Map,this._proxy=t.getProxy(W.MainThreadUrls)}registerUriHandler(t,i){const r=t.identifier;if(this.handles.has(r))throw new Error(`Protocol handler already registered for extension ${r}`);const n=R7.HandlePool++;return this.handles.add(r),this.handlers.set(n,i),this._proxy.$registerUriHandler(n,r,t.displayName||t.name),ne(()=>{this.handles.delete(r),this.handlers.delete(n),this._proxy.$unregisterUriHandler(n)})}$handleExternalUri(t,i){const r=this.handlers.get(t);if(!r)return Promise.resolve(void 0);try{r.handleUri(y.revive(i))}catch(n){Qt(n)}return Promise.resolve(void 0)}async createAppUri(t){return y.revive(await this._proxy.$createAppUri(t))}},PH=class extends se{#e;#t;#i;#r;#s;#n;#a;#o;#l;#c;#u;#h;#d;constructor(e,t,i,r){super(),this.#o=void 0,this.#l=!0,this.#u=!1,this.#h=this._register(new P),this.onDidDispose=this.#h.event,this.#d=this._register(new P),this.onDidChangeViewState=this.#d.event,this.#e=e,this.#t=t,this.#r=i,this.#i=r.viewType,this.#s=r.panelOptions,this.#o=r.viewColumn,this.#n=r.title,this.#c=r.active}dispose(){this.#u||(this.#u=!0,this.#h.fire(),this.#t.$disposeWebview(this.#e),this.#r.dispose(),super.dispose())}get webview(){return this.assertNotDisposed(),this.#r}get viewType(){return this.assertNotDisposed(),this.#i}get title(){return this.assertNotDisposed(),this.#n}set title(e){this.assertNotDisposed(),this.#n!==e&&(this.#n=e,this.#t.$setTitle(this.#e,e))}get iconPath(){return this.assertNotDisposed(),this.#a}set iconPath(e){this.assertNotDisposed(),this.#a!==e&&(this.#a=e,this.#t.$setIconPath(this.#e,y.isUri(e)?{light:e,dark:e}:e))}get options(){return this.#s}get viewColumn(){if(this.assertNotDisposed(),!(typeof this.#o=="number"&&this.#o<0))return this.#o}get active(){return this.assertNotDisposed(),this.#c}get visible(){return this.assertNotDisposed(),this.#l}_updateViewState(e){this.#u||(this.active!==e.active||this.visible!==e.visible||this.viewColumn!==e.viewColumn)&&(this.#c=e.active,this.#l=e.visible,this.#o=e.viewColumn,this.#d.fire({webviewPanel:this}))}reveal(e,t){this.assertNotDisposed(),this.#t.$reveal(this.#e,{viewColumn:typeof e>"u"?void 0:Rt.from(e),preserveFocus:!!t})}assertNotDisposed(){if(this.#u)throw new Error("Webview is disposed")}},TH=class L7 extends se{static newHandle(){return $t()}constructor(t,i,r){super(),this.webviews=i,this.workspace=r,this._webviewPanels=new Map,this._serializers=new Map,this._proxy=t.getProxy(W.MainThreadWebviewPanels)}dispose(){super.dispose(),this._webviewPanels.forEach(t=>t.dispose()),this._webviewPanels.clear()}createWebviewPanel(t,i,r,n,s={}){const o=typeof n=="object"?n.viewColumn:n,a={viewColumn:Rt.from(o),preserveFocus:typeof n=="object"&&!!n.preserveFocus},l=qa(t),c=L7.newHandle();this._proxy.$createWebviewPanel(cp(t),c,i,{title:r,panelOptions:AH(s),webviewOptions:Q5(t,this.workspace,s),serializeBuffersForPostMessage:l},a);const u=this.webviews.createNewWebview(c,s,t);return this.createNewWebviewPanel(c,i,r,o,s,u,!0)}$onDidChangeWebviewPanelViewStates(t){const i=Object.keys(t);i.sort((r,n)=>{const s=t[r],o=t[n];return s.active?1:o.active?-1:+s.visible-+o.visible});for(const r of i){const n=this.getWebviewPanel(r);if(!n)continue;const s=t[r];n._updateViewState({active:s.active,visible:s.visible,viewColumn:Rt.to(s.position)})}}async $onDidDisposeWebviewPanel(t){this.getWebviewPanel(t)?.dispose(),this._webviewPanels.delete(t),this.webviews.deleteWebview(t)}registerWebviewPanelSerializer(t,i,r){if(this._serializers.has(i))throw new Error(`Serializer for '${i}' already registered`);return this._serializers.set(i,{serializer:r,extension:t}),this._proxy.$registerSerializer(i,{serializeBuffersForPostMessage:qa(t)}),new Ce(()=>{this._serializers.delete(i),this._proxy.$unregisterSerializer(i)})}async $deserializeWebviewPanel(t,i,r,n){const s=this._serializers.get(i);if(!s)throw new Error(`No serializer found for '${i}'`);const{serializer:o,extension:a}=s,l=this.webviews.createNewWebview(t,r.webviewOptions,a),c=this.createNewWebviewPanel(t,i,r.title,n,r.panelOptions,l,r.active);await o.deserializeWebviewPanel(c,r.state)}createNewWebviewPanel(t,i,r,n,s,o,a){const l=new PH(t,this._proxy,o,{viewType:i,title:r,viewColumn:n,panelOptions:s,active:a});return this._webviewPanels.set(t,l),l}getWebviewPanel(t){return this._webviewPanels.get(t)}};function AH(e){return{enableFindWidget:e.enableFindWidget,retainContextWhenHidden:e.retainContextWhenHidden}}var RH=class extends se{#e;#t;#i;#r;#s;#n;#a;#o;#l;constructor(e,t,i,r,n,s){super(),this.#s=!1,this.#c=this._register(new P),this.onDidChangeVisibility=this.#c.event,this.#u=this._register(new P),this.onDidDispose=this.#u.event,this.#i=i,this.#a=r,this.#e=e,this.#t=t,this.#r=n,this.#n=s}dispose(){this.#s||(this.#s=!0,this.#u.fire(),this.#r.dispose(),super.dispose())}#c;#u;get title(){return this.assertNotDisposed(),this.#a}set title(e){this.assertNotDisposed(),this.#a!==e&&(this.#a=e,this.#t.$setWebviewViewTitle(this.#e,e))}get description(){return this.assertNotDisposed(),this.#o}set description(e){this.assertNotDisposed(),this.#o!==e&&(this.#o=e,this.#t.$setWebviewViewDescription(this.#e,e))}get visible(){return this.#n}get webview(){return this.#r}get viewType(){return this.#i}_setVisible(e){e===this.#n||this.#s||(this.#n=e,this.#c.fire())}get badge(){return this.assertNotDisposed(),this.#l}set badge(e){this.assertNotDisposed(),!(e?.value===this.#l?.value&&e?.tooltip===this.#l?.tooltip)&&(this.#l=vf.from(e),this.#t.$setWebviewViewBadge(this.#e,e))}show(e){this.assertNotDisposed(),this.#t.$show(this.#e,!!e)}assertNotDisposed(){if(this.#s)throw new Error("Webview is disposed")}},LH=class{constructor(e,t){this._extHostWebview=t,this._viewProviders=new Map,this._webviewViews=new Map,this._proxy=e.getProxy(W.MainThreadWebviewViews)}registerWebviewViewProvider(e,t,i,r){if(this._viewProviders.has(t))throw new Error(`View provider for '${t}' already registered`);return this._viewProviders.set(t,{provider:i,extension:e}),this._proxy.$registerWebviewViewProvider(cp(e),t,{retainContextWhenHidden:r?.retainContextWhenHidden,serializeBuffersForPostMessage:qa(e)}),new Ce(()=>{this._viewProviders.delete(t),this._proxy.$unregisterWebviewViewProvider(t)})}async $resolveWebviewView(e,t,i,r,n){const s=this._viewProviders.get(t);if(!s)throw new Error(`No view provider found for '${t}'`);const{provider:o,extension:a}=s,l=this._extHostWebview.createNewWebview(e,{},a),c=new RH(e,this._proxy,t,i,l,!0);this._webviewViews.set(e,c),await o.resolveWebviewView(c,{state:r},n)}async $onDidChangeWebviewViewVisibility(e,t){this.getWebviewView(e)._setVisible(t)}async $disposeWebviewView(e){const t=this.getWebviewView(e);this._webviewViews.delete(e),t.dispose(),this._extHostWebview.deleteWebview(e)}getWebviewView(e){const t=this._webviewViews.get(e);if(!t)throw new Error("No webview found");return t}},NH=class{constructor(e){this._settingsSearchProviders=new Map,this._nextHandle=0,this._proxy=e.getProxy(W.MainThreadAiSettingsSearch)}async $startSearch(e,t,i,r){if(this._settingsSearchProviders.size===0)throw new Error("No related information providers registered");const n=this._settingsSearchProviders.get(e);if(!n)throw new Error("Settings search provider not found");const s=new T_(o=>{this._proxy.$handleSearchResult(e,X1.fromSettingsSearchResult(o))});return n.provideSettingsSearchResults(t,i,s,r)}registerSettingsSearchProvider(e,t){const i=this._nextHandle;return this._nextHandle++,this._settingsSearchProviders.set(i,t),this._proxy.$registerAiSettingsSearchProvider(i),new Ce(()=>{this._proxy.$unregisterAiSettingsSearchProvider(i),this._settingsSearchProviders.delete(i)})}},MH=class{constructor(e,t,i,r,n,s){this.widget=e,this.onDidChangeRenderMode=t,this.onDidEnd=i,this.onWillChangeDiffs=r,this.onDidChangeDiffs=n,this.onDidChangeFocusIndex=s}dispose(){this.onDidChangeRenderMode.dispose(),this.onDidEnd.dispose()}},OH=class{constructor(e,t){this._proxy=e,this._editors=t,this._handlePool=0,this._contextMap=new Map}addInlineDiffWidget(e,t){let i;for(const u of this._editors.getVisibleTextEditors(!0))if(u.value===e){i=u;break}if(!i)throw new Error("not a visible editor");const r=this._nextHandle();this._proxy.$addInlineDiffWidget(r,i.id,i.value.document.uri,{oldRange:{startLineNumber:t.oldRange.startLineNumber,endLineNumberExclusive:t.oldRange.endLineNumberExclusive},done:t.done??!0,text:t.text,partial:t.partial});const n=new P,s=new P,o=new P,a=new P,l=new P,c={updateText:this.updateText.bind(this,r),accept:this.accept.bind(this,r),reject:this.reject.bind(this,r),cancel:this.cancel.bind(this,r),focusOnDiff:this.focusOnDiff.bind(this,r),toggleRenderMode:this.toggleRenderMode.bind(this,r),onDidChangeRenderMode:s.event,onDidEnd:n.event,onDidChangeDiffs:a.event,onWillChangeDiffs:o.event,onDidChangeFocus:l.event,dispose:()=>{this._contextMap.has(r)&&(this._proxy.$removeInlineDiffWidget(r),this._contextMap.delete(r))}};return this._contextMap.set(r,new MH(c,s,n,o,a,l)),c}$onDidChangeRenderMode(e,t){const i=this._contextMap.get(e);i&&i.onDidChangeRenderMode.fire({renderSideBySide:t})}$onDidEnd(e){const t=this._contextMap.get(e);t&&(t.onDidEnd.fire(),t.dispose())}$onDidDispose(e){this._contextMap.has(e)&&this._contextMap.get(e)?.dispose()}$onDidChangeDiffs(e,t){this._contextMap.has(e)&&this._contextMap.get(e)?.onDidChangeDiffs.fire(t)}$onWillChangeDiffs(e,t){this._contextMap.has(e)&&this._contextMap.get(e)?.onWillChangeDiffs.fire({action:t.action,changes:t.changes,all:t.all,source:t.source})}$onDidChangeFocus(e,t,i){this._contextMap.has(e)&&this._contextMap.get(e)?.onDidChangeFocusIndex.fire({index:t,focus:i})}async updateText(e,t,i){return this._proxy.$updateModifiedText(e,t,i)}async accept(e){return this._proxy.$acceptDiff(e)}async reject(e){return this._proxy.$rejectDiff(e)}async cancel(e,t){return this._proxy.$cancel(e,t)}async toggleRenderMode(e,t){return this._proxy.$toggleRenderMode(e,t)}focusOnDiff(e,t){return this._proxy.$focusOnDiff(e,t)}_nextHandle(){return this._handlePool=this._handlePool+1,this._handlePool}},FH=class{constructor(e,t){this._proxy=e,this._editors=t,this._handlePool=0,this._disposables=new he,this._widgets=new Map}dispose(){this._widgets.forEach(e=>e.widget.dispose()),this._disposables.dispose()}addOverlayWidget(e,t,i){let r;for(const l of this._editors.getVisibleTextEditors(!0))if(l.value===e){r=l;break}if(!r)throw new Error("not a visible editor");const n=this,s=this._handlePool++,o=new P,a=new class{constructor(){this.editor=e,this.onDidDispose=o.event}updateContent(l){n._proxy.$updateContent(s,n.convertContentToDto(l))}dispose(){n._widgets.has(s)&&(n._widgets.delete(s),n._proxy.$removeOverlayWidget(s),o.fire(),o.dispose())}};return this._proxy.$addOverlayWidget(s,r.id,r.value.document.uri,n.convertContentToDto(t||[]),i.identifier,i.extensionLocation),this._widgets.set(s,{editor:e,widget:a}),a}convertContentToDto(e){return e.map(t=>mi.isMarkdownString(t)?pe.from(t):t)}$onDidDispose(e){const t=this._widgets.get(e);t&&t.widget.dispose()}},$H=class{constructor(e,t,i,r){this.engines=e,this.onRequest=t,this.onStopRequest=i,this.onDidDispose=r}dispose(){this.onDidDispose?.()}},HH=class{constructor(e,t){this._proxy=e,this._editors=t,this._handlePool=0,this._contextMap=new Map}showInlineChatWidget(e,t,i,r){let n;for(const a of this._editors.getVisibleTextEditors(!0))if(a.value===e){n=a;break}if(!n)throw new Error("not a visible editor");const s=this._nextHandle(),o=new P;return this._contextMap.set(s,new $H(t.engines,i,r||(()=>{}),()=>{this._contextMap.has(s)&&this._contextMap.delete(s),this._proxy.$hideInlineChatWidget(s),o.fire(),o.dispose()})),this._proxy.$showInlineChatWidget(s,{engines:t.engines,defaultEngine:t.defaultEngine,lineNumber:t.lineNumber,column:t.column},n.id,n.value.document.uri),{setCurrentEngine:a=>{this._proxy.$setEngine(s,a)},onDidDispose:o.event,dispose:()=>{this._contextMap.has(s)&&this._contextMap.get(s)?.dispose()}}}async $onDidRequest(e,t,i,r){const n=this._contextMap.get(e);if(n){await Promise.resolve(n.onRequest(t,i));return}throw new Error("cannot find handler")}$onDidStopRequest(e){const t=this._contextMap.get(e);if(t){t.onStopRequest();return}}$onDidDispose(e){this._contextMap.has(e)&&this._contextMap.get(e)?.dispose()}_nextHandle(){return this._handlePool=this._handlePool+1,this._handlePool}},UH=class{constructor(e){this._proxy=e,this._handlePool=0,this.providers=new Map}registerTerminalCommandChatProvider(e){const t=this.nextHandle(),i={provider:e,dispose:()=>{this._proxy.$unregisterTerminalCommandChatProvider(t),this.providers.delete(t)}};return this.providers.set(t,i),this._proxy.$registerTerminalCommandChatProvider(t,e.engines,e.defaultEngine),i}$provideCommand(e,t,i,r,n){const s=this.providers.get(e);return s?Promise.resolve(s.provider.provideCommand(t,i,{cwd:r.cwd,historys:r.historys,cursor:{line:r.cursor.lineNumber-1,charactor:r.cursor.column-1}},n)).then(o=>o??void 0):Promise.resolve(void 0)}nextHandle(){return++this._handlePool}},a6=class{constructor(e){this._provider=e,this._actionMap=new Map}async provideActions(e,t){return await this._provider.provideActions(e,t)||[]}releaseHover(e){this._actionMap.delete(e.toString())}},BH=class{constructor(e,t){this.adapter=e,this.extension=t}},WH=class{constructor(e,t,i){this._proxy=e,this._editors=t,this._extensionTelemetry=i,this._adapter=new Map,this._providers=new Map,this.handlePool=0}dispose(){this._providers.forEach((e,t)=>{this._proxy.$unregisterSelectionActionProvider(t)}),this._providers.clear()}registerSelectionActionProvider(e,t){const i=this._addNewAdapter(new a6(e),t);return this._proxy.$registerSelectionActionProvider(i),new Ce(()=>{this._adapter.delete(i),this._proxy.$unregisterSelectionActionProvider(i)})}_nextHandle(){return++this.handlePool}_addNewAdapter(e,t){const i=this._nextHandle();return this._adapter.set(i,new BH(e,t)),i}async _withAdapter(e,t,i,r,n){const s=this._adapter.get(e);if(!s||!(s.adapter instanceof t))return r;const o=i(s.adapter,s.extension);return Promise.resolve(o).catch(a=>{br(a)||this._extensionTelemetry.onExtensionError(s.extension.identifier,a)}),Xe.isCancellationToken(n)?Ku(o,n):o}$provideActions(e,t,i){let r=null;for(const n of this._editors.getVisibleTextEditors(!0))if(ms(n.value.document.uri,y.revive(t))){r=n;break}return r?this._withAdapter(e,a6,n=>n.provideActions(r.value,i),[],i):Promise.resolve([])}$releaseActions(e,t){}},fw=class{constructor(e){this._provider=e,this._actionMap=new Map}async provideActions(e,t){return await this._provider.provideActions(e,t)||[]}releaseActions(e){this._actionMap.delete(e)}},VH=class{constructor(e,t){this.adapter=e,this.extension=t}},zH=class{constructor(e,t){this._proxy=e,this._extHostTelemetry=t,this._adapter=new Map,this._providers=new Map,this.handlePool=0}dispose(){this._providers.forEach((e,t)=>{this._proxy.$unregisterTerminalSelectionActionProvider(t)}),this._providers.clear()}registerTerminalSelectionActionProvider(e,t){const i=this._addNewAdapter(new fw(e),t);return this._proxy.$registerTerminalSelectionActionProvider(i),new Ce(()=>{this._adapter.delete(i),this._proxy.$unregisterTerminalSelectionActionProvider(i)})}_nextHandle(){return++this.handlePool}_addNewAdapter(e,t){const i=this._nextHandle();return this._adapter.set(i,new VH(e,t)),i}async _withAdapter(e,t,i,r,n){const s=this._adapter.get(e);if(!s||!(s.adapter instanceof t))return r;const o=i(s.adapter,s.extension);return Promise.resolve(o).catch(a=>{br(a)||this._extHostTelemetry.onExtensionError(s.extension.identifier,a)}),Xe.isCancellationToken(n)?Ku(o,n):o}$provideTerminalActions(e,t,i){return this._withAdapter(e,fw,async r=>{const n={id:t};return(await r.provideActions(n,i)).map(o=>({id:o.id,label:o.label,icon:o.icon,keybinding:o.keybinding,commandId:o.commandId,commandArgs:o.commandArgs}))},[],i)}$releaseTerminalActions(e,t){const i=this._adapter.get(e);i?.adapter instanceof fw&&i.adapter.releaseActions(String(t))}},qH=class{constructor(e){this._onDidAddOrDeleteDiffZones=new P,this.onDidAddOrDeleteDiffZones=this._onDidAddOrDeleteDiffZones.event,this._onDidChangeDiffsInDiffZoneNotStreaming=new P,this.onDidChangeDiffsInDiffZoneNotStreaming=this._onDidChangeDiffsInDiffZoneNotStreaming.event,this._onDidChangeStreamingInDiffZone=new P,this.onDidChangeStreamingInDiffZone=this._onDidChangeStreamingInDiffZone.event,this._onDidChangeCommandBarState=new P,this.onDidChangeCommandBarState=this._onDidChangeCommandBarState.event,this._onDidChangeActiveURI=new P,this.onDidChangeActiveURI=this._onDidChangeActiveURI.event,this._onDidAcceptOrRejectFile=new P,this.onDidAcceptOrRejectFile=this._onDidAcceptOrRejectFile.event,this._proxy=e.getProxy(W.MainThreadEditCode)}$onDidAddOrDeleteDiffZones(e){this._onDidAddOrDeleteDiffZones.fire({uri:y.revive(e)})}$onDidChangeDiffsInDiffZoneNotStreaming(e,t){this._onDidChangeDiffsInDiffZoneNotStreaming.fire({uri:y.revive(e),diffareaid:t})}$onDidChangeStreamingInDiffZone(e,t){this._onDidChangeStreamingInDiffZone.fire({uri:y.revive(e),diffareaid:t})}$onDidChangeCommandBarState(e){this._onDidChangeCommandBarState.fire({uri:y.revive(e)})}$onDidChangeActiveURI(e){this._onDidChangeActiveURI.fire({uri:e?y.revive(e):null})}$onDidAcceptOrRejectFile(e,t,i,r,n){this._onDidAcceptOrRejectFile.fire({uri:y.revive(e),behavior:t,diffid:i,isUserTriggered:r,diffData:n})}async processRawKeybindingText(e){return this._proxy.$processRawKeybindingText(e)}async callBeforeApplyOrEdit(e){e==="current"?await this._proxy.$callBeforeApplyOrEdit({scheme:"current"}):await this._proxy.$callBeforeApplyOrEdit(e.toJSON())}instantlyApplySearchReplaceBlocks(e){this._proxy.$instantlyApplySearchReplaceBlocks(e.uri.toJSON(),e.searchReplaceBlocks)}instantlyRewriteFile(e){this._proxy.$instantlyRewriteFile(e.uri.toJSON(),e.newContent)}instantlyRewriteFileRange(e){this._proxy.$instantlyRewriteFileRange(e.uri.toJSON(),e.newContent,e.range)}async acceptOrRejectAllDiffAreas(e){await this._proxy.$acceptOrRejectAllDiffAreas({uri:e.uri.toJSON(),removeCtrlKs:e.removeCtrlKs,behavior:e.behavior,_addToHistory:e._addToHistory,isUserTriggered:e.isUserTriggered})}async acceptDiff(e){await this._proxy.$acceptDiff(e)}async rejectDiff(e){await this._proxy.$rejectDiff(e)}async getGenieFileSnapshot(e){return this._proxy.$getGenieFileSnapshot(e.toJSON())}async restoreGenieFileSnapshot(e,t){await this._proxy.$restoreGenieFileSnapshot(e.toJSON(),{snapshotedDiffAreaOfId:t.snapshotedDiffAreaOfId,entireFileCode:t.entireFileCode})}async getCommandBarService(){const e=await this._proxy.$getCommandBarService(),t={};for(const[i,r]of Object.entries(e.stateOfURI))t[i]={sortedDiffZoneIds:r.sortedDiffZoneIds,sortedDiffIds:r.sortedDiffIds,isStreaming:r.isStreaming,diffIdx:r.diffIdx};return{stateOfURI:t,sortedURIs:e.sortedURIs.map(i=>y.revive(i)),activeURI:e.activeURI?y.revive(e.activeURI):null,onDidChangeState:this.onDidChangeCommandBarState,onDidChangeActiveURI:this.onDidChangeActiveURI,onDidAcceptOrRejectFile:this.onDidAcceptOrRejectFile}}async getDiffOfId(){return this._proxy.$getDiffOfId()}async getDiffAreaOfId(){return this._proxy.$getDiffAreaOfId()}async getDiffAreasOfURI(){return this._proxy.$getDiffAreasOfURI()}async openCurrentDiffsInMultiEditor(){return this._proxy.$openCurrentDiffsInMultiEditor()}};function jH(e){const t=e.get(Yt),i=e.get(Oo),r=e.get(zf),n=e.get(Yn),s=e.get(hn),o=e.get(qf),a=e.get(fn),l=e.get(id),c=e.get(Ue),u=e.get(g_),d=e.get(v_),f=e.get(xl),p=e.get(qe),m=e.get(x_),_=e.get(Jf),b=e.get(f5),E=e.get(B_),C=e.get(Kc),T=e.get(z_),j=e.get(A_),M=e.get(L_),B=e.get(S0);c.set(Z.ExtHostFileSystemInfo,i),c.set(Z.ExtHostLogLevelServiceShape,f),c.set(Z.ExtHostWorkspace,s),c.set(Z.ExtHostConfiguration,a),c.set(Z.ExtHostExtensionService,n),c.set(Z.ExtHostStorage,u),c.set(Z.ExtHostTunnelService,m),c.set(Z.ExtHostWindow,b),c.set(Z.ExtHostSecretState,E),c.set(Z.ExtHostTelemetry,o),c.set(Z.ExtHostEditorTabs,C),c.set(Z.ExtHostManagedSockets,T),c.set(Z.ExtHostAuthentication,j),c.set(Z.ExtHostChatProvider,M);const K=c.set(Z.ExtHostDecorations,e.get(kI)),Y=c.set(Z.ExtHostDocumentsAndEditors,e.get(Wa)),X=c.set(Z.ExtHostCommands,e.get(no)),ce=c.set(Z.ExtHostTerminalService,e.get(Ha)),We=c.set(Z.ExtHostTerminalShellIntegration,e.get(p5)),De=c.set(Z.ExtHostDebugService,e.get(l5)),gt=c.set(Z.ExtHostSearch,e.get(h5)),z=c.set(Z.ExtHostTask,e.get(ZI)),H=c.set(Z.ExtHostOutputService,e.get(II)),J=c.set(Z.ExtHostLocalization,e.get(V_)),q=c.set(Z.ExtHostUrls,new kH(c)),Q=c.set(Z.ExtHostDocuments,new UF(c,Y)),ge=c.set(Z.ExtHostDocumentContentProviders,new $F(c,Y,p)),Pe=c.set(Z.ExtHostDocumentSaveParticipant,new HF(p,Q,c.getProxy(W.MainThreadBulkEdits))),we=c.set(Z.ExtHostNotebook,new $$(c,X,Y,Q,r,gt,p)),Ge=c.set(Z.ExtHostNotebookDocuments,new U$(we)),Bt=c.set(Z.ExtHostNotebookEditors,new nw(p,we)),pt=c.set(Z.ExtHostNotebookKernels,new sw(c,t,we,X,p)),jt=c.set(Z.ExtHostNotebookRenderers,new j$(c,we)),ri=c.set(Z.ExtHostNotebookDocumentSaveParticipant,new H$(p,we,c.getProxy(W.MainThreadBulkEdits))),Qe=c.set(Z.ExtHostEditors,new pH(c,Y)),Wr=c.set(Z.ExtHostTreeViews,new CH(c.getProxy(W.MainThreadTreeViews),X,p)),go=c.set(Z.ExtHostEditorInsets,new gF(c.getProxy(W.MainThreadEditorInsets),Qe,t.remote)),Sn=c.set(Z.ExtHostDiagnostics,new L0(c,p,i,Y)),zi=c.set(Z.ExtHostLanguages,new g$(c,Q,X.converter,l)),xe=c.set(Z.ExtHostLanguageFeatures,new i$(c,l,Q,X,Sn,p,_,o)),Ve=c.set(Z.ExtHostCodeMapper,new mF(c)),Su=c.set(Z.ExtHostFileSystem,new QF(c,xe)),xi=c.set(Z.ExtHostFileSystemEventService,new KF(c,p,Y)),ui=c.set(Z.ExtHostQuickOpen,Z$(c,s,X)),ns=c.set(Z.ExtHostSCM,new dw(c,X,Q,p)),mo=c.set(Z.ExtHostQuickDiff,new X$(c,l)),Ka=c.set(Z.ExtHostShare,new cH(c,l)),Eu=c.set(Z.ExtHostComments,_F(c,X,Q)),vo=c.set(Z.ExtHostProgress,new Q$(c.getProxy(W.MainThreadProgress))),Ya=c.set(Z.ExtHostLabelService,new e$(c)),ss=c.set(Z.ExtHostTheming,new hw(c)),Si=c.set(Z.ExtHostTimeline,new gH(c,X)),Vr=c.set(Z.ExtHostWebviews,new IF(c,t.remote,s,p,_)),ht=c.set(Z.ExtHostWebviewPanels,new TH(c,Vr,s)),ti=c.set(Z.ExtHostCustomEditors,new LF(c,Q,d,Vr,ht)),Qp=c.set(Z.ExtHostWebviewViews,new LH(c,Vr)),En=c.set(Z.ExtHostTesting,e.get(rp)),_o=c.set(Z.ExtHostUriOpeners,new IH(c)),el=c.set(Z.ExtHostProfileContentHandlers,new G$(c));c.set(Z.ExtHostInteractive,new YF(c,we,Y,X,p));const D=c.set(Z.ExtHostLanguageModelTools,new p$(c,M)),L=c.set(Z.ExtHostChatAgents2,new aF(c,p,X,Q,M,Sn,D)),O=c.set(Z.ExtHostAiRelatedInformation,new YO(c)),oe=c.set(Z.ExtHostAiEmbeddingVector,new WF(c)),me=c.set(Z.ExtHostAiSettingsSearch,new NH(c)),Tt=c.set(Z.ExtHostStatusBar,new fH(c,X.converter)),ze=c.set(Z.ExtHostSpeech,new uH(c)),Mt=c.set(Z.ExtHostEmbeddings,new BF(c)),vt=c.set(Z.ExtHostInlineDiff,new OH(c.getProxy(W.MainThreadInlineDiff),Qe)),Gt=c.set(Z.ExtHostEditorBottomWidget,new FH(c.getProxy(W.MainThreadEditorBottomWidget),Qe)),qi=c.set(Z.ExtHostInlineChat,new HH(c.getProxy(W.MainThreadInlineChat),Qe)),_t=c.set(Z.ExtHostTerminalCommandChat,new UH(c.getProxy(W.MainThreadTerminalCommandChat))),Wt=c.set(Z.ExtHostSelectionAction,new WH(c.getProxy(W.MainThreadSelectionAction),Qe,o)),ni=c.set(Z.ExtHostTerminalSelectionAction,new zH(c.getProxy(W.MainThreadTerminalSelectionAction),o));c.set(Z.ExtHostMcp,e.get(S0));const Te=c.set(Z.ExtHostEditCode,new qH(c)),be=Object.values(Z);c.assertRegistered(be);const Ae=new T0(c,Y),ot=new hF(c),at=new j0(c,p),Ot=new FF(c),Cu=new uF(c);return nF.register(X),function(S,Ei,Jp){function ee(v){return(w,x,ue)=>{const rt=v(Vt=>{try{w.call(x,Vt)}catch(Z7){Qw(new Gb(S.identifier,Z7,"FAILED to handle event"))}});return ue?.push(rt),rt}}const Je=function(){let v=!S.isUnderDevelopment;function w(){v||(p.info(`Extension '${S.identifier.value}' uses a document selector without scheme. Learn more about this: https://go.microsoft.com/fwlink/?linkid=872305`),v=!0)}return function x(ue){if(Array.isArray(ue))ue.forEach(x);else if(typeof ue=="string")w();else{const rt=ue;typeof rt.scheme>"u"&&w(),typeof rt.exclusive=="boolean"&&N(S,"documentFiltersExclusive")}return ue}}(),N7={getSession(v,w,x){return(typeof x?.forceNewSession=="object"&&x.forceNewSession.learnMore||typeof x?.createIfNone=="object"&&x.createIfNone.learnMore)&&N(S,"authLearnMore"),j.getSession(S,v,w,x)},getAccounts(v){return j.getAccounts(v)},async hasSession(v,w){return N(S,"authSession"),!!await j.getSession(S,v,w,{silent:!0})},get onDidChangeSessions(){return ee(j.getExtensionScopedSessionsEvent(S.identifier.value))},registerAuthenticationProvider(v,w,x,ue){return j.registerAuthenticationProvider(v,w,x,ue)}},M7={registerCommand(v,w,x){return X.registerCommand(!0,v,w,x,void 0,S)},registerTextEditorCommand(v,w,x){return X.registerCommand(!0,v,(...ue)=>{const rt=Qe.getActiveTextEditor();if(!rt){p.warn("Cannot execute "+v+" because there is no active text editor.");return}return rt.edit(Vt=>{w.apply(x,[rt,Vt,...ue])}).then(Vt=>{Vt||p.warn("Edits from command "+v+" were not applied.")},Vt=>{p.warn("An error occurred while running command "+v,Vt)})},void 0,void 0,S)},registerDiffInformationCommand:(v,w,x)=>(N(S,"diffCommand"),X.registerCommand(!0,v,async(...ue)=>{const rt=Y.activeEditor(!0);if(!rt){p.warn("Cannot execute "+v+" because there is no active text editor.");return}const Vt=await Qe.getDiffInformation(rt.id);w.apply(x,[Vt,...ue])},void 0,void 0,S)),executeCommand(v,...w){return X.executeCommand(v,...w)},getCommands(v=!1){return X.getCommands(v)}},O7={processRawKeybindingText(v){return Te.processRawKeybindingText(v)},callBeforeApplyOrEdit(v){return Te.callBeforeApplyOrEdit(v)},instantlyApplySearchReplaceBlocks(v){Te.instantlyApplySearchReplaceBlocks(v)},instantlyRewriteFile(v){Te.instantlyRewriteFile(v)},instantlyRewriteFileRange(v){Te.instantlyRewriteFileRange(v)},get onDidChangeDiffZones(){const v=ct.map(Te.onDidAddOrDeleteDiffZones,w=>w.uri);return ee(v)},get onDidChangeDiffContent(){const v=ct.map(Te.onDidChangeDiffsInDiffZoneNotStreaming,w=>({uri:w.uri,diffareaid:Number(w.diffareaid)}));return ee(v)},get onDidChangeDiffProcessingMode(){const v=ct.map(Te.onDidChangeStreamingInDiffZone,w=>({uri:w.uri,diffareaid:Number(w.diffareaid)}));return ee(v)},async getCommandBarService(){return await Te.getCommandBarService()},get onDidChangeCommandBarState(){return ee(Te.onDidChangeCommandBarState)},get onDidChangeActiveURI(){return ee(Te.onDidChangeActiveURI)},get onDidAcceptOrRejectFile(){return ee(Te.onDidAcceptOrRejectFile)},getEditCodeService(){const v=new P,w=new P;return Te.onDidChangeDiffsInDiffZoneNotStreaming(x=>{v.fire({uri:x.uri,diffareaid:Number(x.diffareaid)})}),Te.onDidChangeStreamingInDiffZone(x=>{w.fire({uri:x.uri,diffareaid:Number(x.diffareaid)})}),{onDidAddOrDeleteDiffZones:Te.onDidAddOrDeleteDiffZones,onDidChangeDiffsInDiffZoneNotStreaming:v.event,onDidChangeStreamingInDiffZone:w.event,processRawKeybindingText:x=>Te.processRawKeybindingText(x),callBeforeApplyOrEdit:x=>Te.callBeforeApplyOrEdit(x),instantlyApplySearchReplaceBlocks:async x=>{Te.instantlyApplySearchReplaceBlocks(x)},instantlyRewriteFile:async x=>{Te.instantlyRewriteFile(x)},instantlyRewriteFileRange:async x=>{Te.instantlyRewriteFileRange(x)},acceptOrRejectAllDiffAreas:x=>Te.acceptOrRejectAllDiffAreas(x),acceptDiff:x=>Te.acceptDiff(String(x)),rejectDiff:x=>Te.rejectDiff(String(x)),getGenieFileSnapshot:async x=>({content:(await Te.getGenieFileSnapshot(x)).entireFileCode,version:Date.now()}),restoreGenieFileSnapshot:async(x,ue)=>{await Te.restoreGenieFileSnapshot(x,{snapshotedDiffAreaOfId:{},entireFileCode:ue.content})},openCurrentDiffsInMultiEditor:()=>Te.openCurrentDiffsInMultiEditor(),diffOfId:{},diffAreaOfId:{},diffAreasOfURI:{},async refreshDiffData(){const x=this;x.diffOfId=await Te.getDiffOfId(),x.diffAreaOfId=await Te.getDiffAreaOfId(),x.diffAreasOfURI=await Te.getDiffAreasOfURI()}}}},jw={get machineId(){return t.telemetryInfo.machineId},get sessionId(){return t.telemetryInfo.sessionId},get language(){return t.environment.appLanguage},get appName(){return t.environment.appName},get appRoot(){return t.environment.appRoot?.fsPath??""},get appHost(){return t.environment.appHost},get uriScheme(){return t.environment.appUriScheme},get clipboard(){return ot.value},get shell(){return ce.getDefaultShell(!1)},get onDidChangeShell(){return ee(ce.onDidChangeShell)},get isTelemetryEnabled(){return o.getTelemetryConfiguration()},get onDidChangeTelemetryEnabled(){return ee(o.onDidChangeTelemetryEnabled)},get telemetryConfiguration(){return N(S,"telemetry"),o.getTelemetryDetails()},get onDidChangeTelemetryConfiguration(){return N(S,"telemetry"),ee(o.onDidChangeTelemetryConfiguration)},get isNewAppInstall(){return UD(t.telemetryInfo.firstSessionDate)},createTelemetryLogger(v,w){return HD.validateSender(v),o.instantiateLogger(S,v,w)},openExternal(v,w){return b.openUri(v,{allowTunneling:!!t.remote.authority,allowContributedOpeners:w?.allowContributedOpeners})},async asExternalUri(v){if(v.scheme===t.environment.appUriScheme)return q.createAppUri(v);try{return await b.asExternalUri(v,{allowTunneling:!!t.remote.authority})}catch(w){if(Rg(v,V.http)||Rg(v,V.https))return v;throw w}},get remoteName(){return Fg(t.remote.authority)},get remoteAuthority(){return N(S,"resolvers"),t.remote.authority},get uiKind(){return t.uiKind},get logLevel(){return p.getLevel()},get onDidChangeLogLevel(){return ee(p.onDidChangeLogLevel)},get appQuality(){return N(S,"resolvers"),t.quality},get appCommit(){return N(S,"resolvers"),t.commit}};t.environment.extensionTestsLocationURI||Object.freeze(jw);const F7={createTestController(v,w,x){return En.createTestController(S,v,w,x)},createTestObserver(){return N(S,"testObserver"),En.createTestObserver()},runTests(v){return N(S,"testObserver"),En.runTests(v)},registerTestFollowupProvider(v){return N(S,"testObserver"),En.registerTestFollowupProvider(v)},get onDidChangeTestResults(){return N(S,"testObserver"),ee(En.onResultsChanged)},get testResults(){return N(S,"testObserver"),En.results}},Du=t.remote.isRemote?zs.Workspace:zs.UI,$7={getExtension(v,w){Ke(S,"extensionsAny")||(w=!1);const x=Ei.mine.getExtensionDescription(v);if(x)return new zc(n,S.identifier,x,Du,!1);if(w){const ue=Ei.all.getExtensionDescription(v);if(ue)return new zc(n,S.identifier,ue,Du,!0)}},get all(){const v=[];for(const w of Ei.mine.getAllExtensionDescriptions())v.push(new zc(n,S.identifier,w,Du,!1));return v},get allAcrossExtensionHosts(){N(S,"extensionsAny");const v=new vs(Ei.mine.getAllExtensionDescriptions().map(x=>x.identifier)),w=[];for(const x of Ei.all.getAllExtensionDescriptions()){const ue=!v.has(x.identifier);w.push(new zc(n,S.identifier,x,Du,ue))}return w},get onDidChange(){return Ke(S,"extensionsAny")?ee(ct.any(Ei.mine.onDidChange,Ei.all.onDidChange)):ee(Ei.mine.onDidChange)}},H7={createDiagnosticCollection(v){return Sn.createDiagnosticCollection(S.identifier,v)},get onDidChangeDiagnostics(){return ee(Sn.onDidChangeDiagnostics)},getDiagnostics:v=>Sn.getDiagnostics(v),getLanguages(){return zi.getLanguages()},setTextDocumentLanguage(v,w){return zi.changeLanguage(v.uri,w)},match(v,w){const x=P1.from(v);let ue;return P5(x)&&(ue=we.notebookDocuments.find(rt=>rt.apiNotebook.getCells().find(Vt=>Vt.document===w))?.apiNotebook),k5(x,w.uri,w.languageId,!0,ue?.uri,ue?.notebookType)},registerCodeActionsProvider(v,w,x){return xe.registerCodeActionProvider(S,Je(v),w,x)},registerDocumentPasteEditProvider(v,w,x){return xe.registerDocumentPasteEditProvider(S,Je(v),w,x)},registerCodeLensProvider(v,w){return xe.registerCodeLensProvider(S,Je(v),w)},registerDefinitionProvider(v,w){return xe.registerDefinitionProvider(S,Je(v),w)},registerDeclarationProvider(v,w){return xe.registerDeclarationProvider(S,Je(v),w)},registerImplementationProvider(v,w){return xe.registerImplementationProvider(S,Je(v),w)},registerTypeDefinitionProvider(v,w){return xe.registerTypeDefinitionProvider(S,Je(v),w)},registerHoverProvider(v,w){return xe.registerHoverProvider(S,Je(v),w,S.identifier)},registerEvaluatableExpressionProvider(v,w){return xe.registerEvaluatableExpressionProvider(S,Je(v),w,S.identifier)},registerInlineValuesProvider(v,w){return xe.registerInlineValuesProvider(S,Je(v),w,S.identifier)},registerDocumentHighlightProvider(v,w){return xe.registerDocumentHighlightProvider(S,Je(v),w)},registerMultiDocumentHighlightProvider(v,w){return xe.registerMultiDocumentHighlightProvider(S,Je(v),w)},registerLinkedEditingRangeProvider(v,w){return xe.registerLinkedEditingRangeProvider(S,Je(v),w)},registerReferenceProvider(v,w){return xe.registerReferenceProvider(S,Je(v),w)},registerRenameProvider(v,w){return xe.registerRenameProvider(S,Je(v),w)},registerNewSymbolNamesProvider(v,w){return N(S,"newSymbolNamesProvider"),xe.registerNewSymbolNamesProvider(S,Je(v),w)},registerDocumentSymbolProvider(v,w,x){return xe.registerDocumentSymbolProvider(S,Je(v),w,x)},registerWorkspaceSymbolProvider(v){return xe.registerWorkspaceSymbolProvider(S,v)},registerDocumentFormattingEditProvider(v,w){return xe.registerDocumentFormattingEditProvider(S,Je(v),w)},registerDocumentRangeFormattingEditProvider(v,w){return xe.registerDocumentRangeFormattingEditProvider(S,Je(v),w)},registerOnTypeFormattingEditProvider(v,w,x,...ue){return xe.registerOnTypeFormattingEditProvider(S,Je(v),w,[x].concat(ue))},registerDocumentSemanticTokensProvider(v,w,x){return xe.registerDocumentSemanticTokensProvider(S,Je(v),w,x)},registerDocumentRangeSemanticTokensProvider(v,w,x){return xe.registerDocumentRangeSemanticTokensProvider(S,Je(v),w,x)},registerSignatureHelpProvider(v,w,x,...ue){return typeof x=="object"?xe.registerSignatureHelpProvider(S,Je(v),w,x):xe.registerSignatureHelpProvider(S,Je(v),w,typeof x>"u"?[]:[x,...ue])},registerCompletionItemProvider(v,w,...x){return xe.registerCompletionItemProvider(S,Je(v),w,x)},registerInlineCompletionItemProvider(v,w,x){return w.handleDidShowCompletionItem&&N(S,"inlineCompletionsAdditions"),w.handleDidPartiallyAcceptCompletionItem&&N(S,"inlineCompletionsAdditions"),x&&N(S,"inlineCompletionsAdditions"),xe.registerInlineCompletionsProvider(S,Je(v),w,x)},registerInlineEditProvider(v,w){return N(S,"inlineEdit"),xe.registerInlineEditProvider(S,Je(v),w)},registerDocumentLinkProvider(v,w){return xe.registerDocumentLinkProvider(S,Je(v),w)},registerColorProvider(v,w){return xe.registerColorProvider(S,Je(v),w)},registerFoldingRangeProvider(v,w){return xe.registerFoldingRangeProvider(S,Je(v),w)},registerSelectionRangeProvider(v,w){return xe.registerSelectionRangeProvider(S,v,w)},registerCallHierarchyProvider(v,w){return xe.registerCallHierarchyProvider(S,v,w)},registerTypeHierarchyProvider(v,w){return xe.registerTypeHierarchyProvider(S,v,w)},setLanguageConfiguration:(v,w)=>xe.setLanguageConfiguration(S,v,w),getTokenInformationAtPosition(v,w){return N(S,"tokenInformation"),zi.tokenAtPosition(v,w)},registerInlayHintsProvider(v,w){return xe.registerInlayHintsProvider(S,v,w)},createLanguageStatusItem(v,w){return zi.createLanguageStatusItem(S,v,w)},registerDocumentDropEditProvider(v,w,x){return xe.registerDocumentOnDropEditProvider(S,v,w,x)}},U7={get activeTextEditor(){return Qe.getActiveTextEditor()},get visibleTextEditors(){return Qe.getVisibleTextEditors()},get activeTerminal(){return ce.activeTerminal},get terminals(){return ce.terminals},async showTextDocument(v,w,x){y.isUri(v)&&v.scheme===V.vscodeRemote&&!v.authority&&_.report("workspace.showTextDocument",S,"A URI of 'vscode-remote' scheme requires an authority.");const ue=await(y.isUri(v)?Promise.resolve(Gw.openTextDocument(v)):Promise.resolve(v));return Qe.showTextDocument(ue,w,x)},createTextEditorDecorationType(v){return Qe.createTextEditorDecorationType(S,v)},onDidChangeActiveTextEditor(v,w,x){return ee(Qe.onDidChangeActiveTextEditor)(v,w,x)},onDidChangeVisibleTextEditors(v,w,x){return ee(Qe.onDidChangeVisibleTextEditors)(v,w,x)},onDidChangeTextEditorSelection(v,w,x){return ee(Qe.onDidChangeTextEditorSelection)(v,w,x)},onDidChangeTextEditorOptions(v,w,x){return ee(Qe.onDidChangeTextEditorOptions)(v,w,x)},onDidChangeTextEditorVisibleRanges(v,w,x){return ee(Qe.onDidChangeTextEditorVisibleRanges)(v,w,x)},onDidChangeTextEditorViewColumn(v,w,x){return ee(Qe.onDidChangeTextEditorViewColumn)(v,w,x)},onDidChangeTextEditorDiffInformation(v,w,x){return N(S,"textEditorDiffInformation"),ee(Qe.onDidChangeTextEditorDiffInformation)(v,w,x)},onDidCloseTerminal(v,w,x){return ee(ce.onDidCloseTerminal)(v,w,x)},onDidOpenTerminal(v,w,x){return ee(ce.onDidOpenTerminal)(v,w,x)},onDidChangeActiveTerminal(v,w,x){return ee(ce.onDidChangeActiveTerminal)(v,w,x)},onDidChangeTerminalDimensions(v,w,x){return N(S,"terminalDimensions"),ee(ce.onDidChangeTerminalDimensions)(v,w,x)},onDidChangeTerminalState(v,w,x){return ee(ce.onDidChangeTerminalState)(v,w,x)},onDidWriteTerminalData(v,w,x){return N(S,"terminalDataWriteEvent"),ee(ce.onDidWriteTerminalData)(v,w,x)},onDidExecuteTerminalCommand(v,w,x){return N(S,"terminalExecuteCommandEvent"),ee(ce.onDidExecuteTerminalCommand)(v,w,x)},onDidChangeTerminalShellIntegration(v,w,x){return ee(We.onDidChangeTerminalShellIntegration)(v,w,x)},onDidStartTerminalShellExecution(v,w,x){return ee(We.onDidStartTerminalShellExecution)(v,w,x)},onDidEndTerminalShellExecution(v,w,x){return ee(We.onDidEndTerminalShellExecution)(v,w,x)},get state(){return b.getState()},onDidChangeWindowState(v,w,x){return ee(b.onDidChangeWindowState)(v,w,x)},showInformationMessage(v,...w){return at.showMessage(S,bt.Info,v,w[0],w.slice(1))},showWarningMessage(v,...w){return at.showMessage(S,bt.Warning,v,w[0],w.slice(1))},showErrorMessage(v,...w){return at.showMessage(S,bt.Error,v,w[0],w.slice(1))},showQuickPick(v,w,x){return ui.showQuickPick(S,v,w,x)},showWorkspaceFolderPick(v){return ui.showWorkspaceFolderPick(v)},showInputBox(v,w){return ui.showInput(v,w)},showOpenDialog(v){return Ot.showOpenDialog(v)},showSaveDialog(v){return Ot.showSaveDialog(v)},createStatusBarItem(v,w,x){let ue,rt,Vt;return typeof v=="string"?(ue=v,rt=w,Vt=x):(rt=v,Vt=w),Tt.createStatusBarEntry(S,ue,rt,Vt)},setStatusBarMessage(v,w){return Tt.setStatusBarMessage(v,w)},withScmProgress(v){return _.report("window.withScmProgress",S,"Use 'withProgress' instead."),vo.withProgress(S,{location:Us.SourceControl},(w,x)=>v({report(ue){}}))},withProgress(v,w){return vo.withProgress(S,v,w)},createOutputChannel(v,w){return H.createOutputChannel(v,w,S)},createWebviewPanel(v,w,x,ue){return ht.createWebviewPanel(S,v,w,x,ue)},createWebviewTextEditorInset(v,w,x,ue){return N(S,"editorInsets"),go.createWebviewEditorInset(v,w,x,ue,S)},createTerminal(v,w,x){return typeof v=="object"?"pty"in v?ce.createExtensionTerminal(v):ce.createTerminalFromOptions(v):ce.createTerminal(v,w,x)},registerTerminalLinkProvider(v){return ce.registerLinkProvider(v)},registerTerminalProfileProvider(v,w){return ce.registerProfileProvider(S,v,w)},registerTerminalCompletionProvider(v,...w){return N(S,"terminalCompletionProvider"),ce.registerTerminalCompletionProvider(S,v,...w)},registerTerminalQuickFixProvider(v,w){return N(S,"terminalQuickFixProvider"),ce.registerTerminalQuickFixProvider(v,S.identifier.value,w)},registerTreeDataProvider(v,w){return Wr.registerTreeDataProvider(v,w,S)},createTreeView(v,w){return Wr.createTreeView(v,w,S)},registerWebviewPanelSerializer:(v,w)=>ht.registerWebviewPanelSerializer(S,v,w),registerCustomEditorProvider:(v,w,x={})=>ti.registerCustomEditorProvider(S,v,w,x),registerFileDecorationProvider(v){return K.registerFileDecorationProvider(v,S)},registerUriHandler(v){return q.registerUriHandler(S,v)},createQuickPick(){return ui.createQuickPick(S)},createInputBox(){return ui.createInputBox(S)},get activeColorTheme(){return ss.activeColorTheme},onDidChangeActiveColorTheme(v,w,x){return ee(ss.onDidChangeActiveColorTheme)(v,w,x)},registerWebviewViewProvider(v,w,x){return Qp.registerWebviewViewProvider(S,v,w,x?.webviewOptions)},get activeNotebookEditor(){return we.activeNotebookEditor},onDidChangeActiveNotebookEditor(v,w,x){return ee(we.onDidChangeActiveNotebookEditor)(v,w,x)},get visibleNotebookEditors(){return we.visibleNotebookEditors},get onDidChangeVisibleNotebookEditors(){return ee(we.onDidChangeVisibleNotebookEditors)},onDidChangeNotebookEditorSelection(v,w,x){return ee(Bt.onDidChangeNotebookEditorSelection)(v,w,x)},onDidChangeNotebookEditorVisibleRanges(v,w,x){return ee(Bt.onDidChangeNotebookEditorVisibleRanges)(v,w,x)},showNotebookDocument(v,w){return we.showNotebookDocument(v,w)},registerExternalUriOpener(v,w,x){return N(S,"externalUriOpener"),_o.registerExternalUriOpener(S.identifier,v,w,x)},registerProfileContentHandler(v,w){return N(S,"profileContentHandlers"),el.registerProfileContentHandler(S,v,w)},registerQuickDiffProvider(v,w,x,ue,rt){return N(S,"quickDiffProvider"),mo.registerQuickDiffProvider(S,Je(v),w,x,ue,rt)},get tabGroups(){return C.tabGroups},registerShareProvider(v,w){return N(S,"shareProvider"),Ka.registerShareProvider(Je(v),w)},get nativeHandle(){return N(S,"nativeWindowHandle"),b.nativeHandle},createChatStatusItem:v=>(N(S,"chatStatusItem"),Cu.createChatStatusItem(S,v)),addInlineDiffWidget(v,w){return vt.addInlineDiffWidget(v,w)},addEditorBottomWidget(v,w){return Gt.addOverlayWidget(v,w,S)},showInlineChatWidget(v,w,x,ue){return qi.showInlineChatWidget(v,w,x,ue)},registerTerminalCommandChatProvider(v){return _t.registerTerminalCommandChatProvider(v)},registerSelectionActionProvider:v=>Wt.registerSelectionActionProvider(v,S),registerTerminalSelectionActionProvider:v=>ni.registerTerminalSelectionActionProvider(v,S)},Gw={get rootPath(){return _.report("workspace.rootPath",S,"Please use 'workspace.workspaceFolders' instead. More details: https://aka.ms/vscode-eliminating-rootpath"),s.getPath()},set rootPath(v){throw new os("rootPath")},getWorkspaceFolder(v){return s.getWorkspaceFolder(v)},get workspaceFolders(){return s.getWorkspaceFolders()},get name(){return s.name},set name(v){throw new os("name")},get workspaceFile(){return s.workspaceFile},set workspaceFile(v){throw new os("workspaceFile")},updateWorkspaceFolders:(v,w,...x)=>s.updateWorkspaceFolders(S,v,w||0,...x),onDidChangeWorkspaceFolders:function(v,w,x){return ee(s.onDidChangeWorkspace)(v,w,x)},asRelativePath:(v,w)=>s.getRelativePath(v,w),findFiles:(v,w,x,ue)=>s.findFiles(v,w,x,S.identifier,ue),findFiles2:(v,w,x)=>(N(S,"findFiles2"),s.findFiles2(v,w,S.identifier,x)),findTextInFiles:(v,w,x,ue)=>{N(S,"findTextInFiles");let rt,Vt;return typeof w=="object"?(rt=w,Vt=x):(rt={},Vt=w,ue=x),s.findTextInFiles(v,rt||{},Vt,S.identifier,ue)},findTextInFiles2:(v,w,x)=>(N(S,"findTextInFiles2"),N(S,"textSearchProvider2"),s.findTextInFiles2(v,w,S.identifier,x)),save:v=>s.save(v),saveAs:v=>s.saveAs(v),saveAll:v=>s.saveAll(v),applyEdit(v,w){return Ae.applyWorkspaceEdit(v,S,w)},createFileSystemWatcher:(v,w,x,ue)=>{const rt={ignoreCreateEvents:!!w,ignoreChangeEvents:!!x,ignoreDeleteEvents:!!ue};return xi.createFileSystemWatcher(s,Jp,S,v,rt)},get textDocuments(){return Q.getAllDocumentData().map(v=>v.document)},set textDocuments(v){throw new os("textDocuments")},openTextDocument(v,w){let x;if(w=w??v,typeof v=="string")x=Promise.resolve(y.file(v));else if(y.isUri(v))x=Promise.resolve(v);else if(!w||typeof w=="object")x=Q.createDocumentData(w);else throw new Error("illegal argument - uriOrFileNameOrOptions");return x.then(ue=>(p.trace(`openTextDocument from ${S.identifier}`),ue.scheme===V.vscodeRemote&&!ue.authority&&_.report("workspace.openTextDocument",S,"A URI of 'vscode-remote' scheme requires an authority."),Q.ensureDocumentData(ue,w).then(rt=>rt.document)))},onDidOpenTextDocument:(v,w,x)=>ee(Q.onDidAddDocument)(v,w,x),onDidCloseTextDocument:(v,w,x)=>ee(Q.onDidRemoveDocument)(v,w,x),onDidChangeTextDocument:(v,w,x)=>ee(Q.onDidChangeDocument)(v,w,x),onDidSaveTextDocument:(v,w,x)=>ee(Q.onDidSaveDocument)(v,w,x),onWillSaveTextDocument:(v,w,x)=>ee(Pe.getOnWillSaveTextDocumentEvent(S))(v,w,x),get notebookDocuments(){return we.notebookDocuments.map(v=>v.apiNotebook)},async openNotebookDocument(v,w){let x;if(y.isUri(v))x=v,await we.openNotebookDocument(v);else if(typeof v=="string")x=y.revive(await we.createNotebookDocument({viewType:v,content:w}));else throw new Error("Invalid arguments");return we.getNotebookDocument(x).apiNotebook},onDidSaveNotebookDocument(v,w,x){return ee(Ge.onDidSaveNotebookDocument)(v,w,x)},onDidChangeNotebookDocument(v,w,x){return ee(Ge.onDidChangeNotebookDocument)(v,w,x)},onWillSaveNotebookDocument(v,w,x){return ee(ri.getOnWillSaveNotebookDocumentEvent(S))(v,w,x)},get onDidOpenNotebookDocument(){return ee(we.onDidOpenNotebookDocument)},get onDidCloseNotebookDocument(){return ee(we.onDidCloseNotebookDocument)},registerNotebookSerializer(v,w,x,ue){return we.registerNotebookSerializer(S,v,w,x,Ke(S,"notebookLiveShare")?ue:void 0)},onDidChangeConfiguration:(v,w,x)=>ee(Jp.onDidChangeConfiguration)(v,w,x),getConfiguration(v,w){return w=arguments.length===1?void 0:w,Jp.getConfiguration(v,w,S)},registerTextDocumentContentProvider(v,w){return ge.registerTextDocumentContentProvider(v,w)},registerTaskProvider:(v,w)=>(_.report("window.registerTaskProvider",S,"Use the corresponding function on the 'tasks' namespace instead"),z.registerTaskProvider(S,v,w)),registerFileSystemProvider(v,w,x){return cg(Su.registerFileSystemProvider(S,v,w,x),r.addFileSystemProvider(v,w,x))},get fs(){return r.value},registerFileSearchProvider:(v,w)=>(N(S,"fileSearchProvider"),gt.registerFileSearchProviderOld(v,w)),registerTextSearchProvider:(v,w)=>(N(S,"textSearchProvider"),gt.registerTextSearchProviderOld(v,w)),registerAITextSearchProvider:(v,w)=>(N(S,"aiTextSearchProvider"),N(S,"textSearchProvider2"),gt.registerAITextSearchProvider(v,w)),registerFileSearchProvider2:(v,w)=>(N(S,"fileSearchProvider2"),gt.registerFileSearchProvider(v,w)),registerTextSearchProvider2:(v,w)=>(N(S,"textSearchProvider2"),gt.registerTextSearchProvider(v,w)),registerRemoteAuthorityResolver:(v,w)=>(N(S,"resolvers"),n.registerRemoteAuthorityResolver(v,w)),registerResourceLabelFormatter:v=>(N(S,"resolvers"),Ya.$registerResourceLabelFormatter(v)),getRemoteExecServer:v=>(N(S,"resolvers"),n.getRemoteExecServer(v)),onDidCreateFiles:(v,w,x)=>ee(xi.onDidCreateFile)(v,w,x),onDidDeleteFiles:(v,w,x)=>ee(xi.onDidDeleteFile)(v,w,x),onDidRenameFiles:(v,w,x)=>ee(xi.onDidRenameFile)(v,w,x),onWillCreateFiles:(v,w,x)=>ee(xi.getOnWillCreateFileEvent(S))(v,w,x),onWillDeleteFiles:(v,w,x)=>ee(xi.getOnWillDeleteFileEvent(S))(v,w,x),onWillRenameFiles:(v,w,x)=>ee(xi.getOnWillRenameFileEvent(S))(v,w,x),openTunnel:v=>(N(S,"tunnels"),m.openTunnel(S,v).then(w=>{if(!w)throw new Error("cannot open tunnel");return w})),get tunnels(){return N(S,"tunnels"),m.getTunnels()},onDidChangeTunnels:(v,w,x)=>(N(S,"tunnels"),ee(m.onDidChangeTunnels)(v,w,x)),registerPortAttributesProvider:(v,w)=>(N(S,"portsAttributes"),m.registerPortsAttributesProvider(v,w)),registerTunnelProvider:(v,w)=>(N(S,"tunnelFactory"),m.registerTunnelProvider(v,w)),registerTimelineProvider:(v,w)=>(N(S,"timeline"),Si.registerTimelineProvider(v,w,S.identifier,X.converter)),get isTrusted(){return s.trusted},requestWorkspaceTrust:v=>(N(S,"workspaceTrust"),s.requestWorkspaceTrust(v)),onDidGrantWorkspaceTrust:(v,w,x)=>ee(s.onDidGrantWorkspaceTrust)(v,w,x),registerEditSessionIdentityProvider:(v,w)=>(N(S,"editSessionIdentityProvider"),s.registerEditSessionIdentityProvider(v,w)),onWillCreateEditSessionIdentity:(v,w,x)=>(N(S,"editSessionIdentityProvider"),ee(s.getOnWillCreateEditSessionIdentityEvent(S))(v,w,x)),registerCanonicalUriProvider:(v,w)=>(N(S,"canonicalUriProvider"),s.registerCanonicalUriProvider(v,w)),getCanonicalUri:(v,w,x)=>(N(S,"canonicalUriProvider"),s.provideCanonicalUri(v,w,x)),decode(v,w){return s.decode(v,w)},encode(v,w){return s.encode(v,w)}},B7={get inputBox(){return _.report("scm.inputBox",S,"Use 'SourceControl.inputBox' instead"),ns.getLastInputBox(S)},createSourceControl(v,w,x){return ns.createSourceControl(S,v,w,x)}},W7={createCommentController(v,w){return Eu.createCommentController(S,v,w)}},V7={get activeDebugSession(){return De.activeDebugSession},get activeDebugConsole(){return De.activeDebugConsole},get breakpoints(){return De.breakpoints},get activeStackItem(){return De.activeStackItem},registerDebugVisualizationProvider(v,w){return N(S,"debugVisualization"),De.registerDebugVisualizationProvider(S,v,w)},registerDebugVisualizationTreeProvider(v,w){return N(S,"debugVisualization"),De.registerDebugVisualizationTree(S,v,w)},onDidStartDebugSession(v,w,x){return ee(De.onDidStartDebugSession)(v,w,x)},onDidTerminateDebugSession(v,w,x){return ee(De.onDidTerminateDebugSession)(v,w,x)},onDidChangeActiveDebugSession(v,w,x){return ee(De.onDidChangeActiveDebugSession)(v,w,x)},onDidReceiveDebugSessionCustomEvent(v,w,x){return ee(De.onDidReceiveDebugSessionCustomEvent)(v,w,x)},onDidChangeBreakpoints(v,w,x){return ee(De.onDidChangeBreakpoints)(v,w,x)},onDidChangeActiveStackItem(v,w,x){return ee(De.onDidChangeActiveStackItem)(v,w,x)},registerDebugConfigurationProvider(v,w,x){return De.registerDebugConfigurationProvider(v,w,x||ap.Initial)},registerDebugAdapterDescriptorFactory(v,w){return De.registerDebugAdapterDescriptorFactory(S,v,w)},registerDebugAdapterTrackerFactory(v,w){return De.registerDebugAdapterTrackerFactory(v,w)},startDebugging(v,w,x){return!x||typeof x=="object"&&"configuration"in x?De.startDebugging(v,w,{parentSession:x}):De.startDebugging(v,w,x||{})},stopDebugging(v){return De.stopDebugging(v)},addBreakpoints(v){return De.addBreakpoints(v)},removeBreakpoints(v){return De.removeBreakpoints(v)},asDebugSourceUri(v,w){return De.asDebugSourceUri(v,w)}},z7={registerTaskProvider:(v,w)=>z.registerTaskProvider(S,v,w),fetchTasks:v=>z.fetchTasks(v),executeTask:v=>z.executeTask(S,v),get taskExecutions(){return z.taskExecutions},onDidStartTask:(v,w,x)=>ee(z.onDidStartTask)(v,w,x),onDidEndTask:(v,w,x)=>ee(z.onDidEndTask)(v,w,x),onDidStartTaskProcess:(v,w,x)=>ee(z.onDidStartTaskProcess)(v,w,x),onDidEndTaskProcess:(v,w,x)=>ee(z.onDidEndTaskProcess)(v,w,x),onDidStartTaskProblemMatchers:(v,w,x)=>(N(S,"taskProblemMatcherStatus"),ee(z.onDidStartTaskProblemMatchers)(v,w,x)),onDidEndTaskProblemMatchers:(v,w,x)=>(N(S,"taskProblemMatcherStatus"),ee(z.onDidEndTaskProblemMatchers)(v,w,x))},q7={createNotebookController(v,w,x,ue,rt){return pt.createNotebookController(S,v,w,x,ue,Ke(S,"notebookMessaging")?rt:void 0)},registerNotebookCellStatusBarItemProvider:(v,w)=>we.registerNotebookCellStatusBarItemProvider(S,v,w),createRendererMessaging(v){return jt.createRendererMessaging(S,v)},createNotebookControllerDetectionTask(v){return N(S,"notebookKernelSource"),pt.createNotebookControllerDetectionTask(S,v)},registerKernelSourceActionProvider(v,w){return N(S,"notebookKernelSource"),pt.registerKernelSourceActionProvider(S,v,w)},onDidChangeNotebookCellExecutionState(v,w,x){return N(S,"notebookCellExecutionState"),ee(pt.onDidChangeNotebookCellExecutionState)(v,w,x)}},j7={t(...v){if(typeof v[0]=="string"){const w=v.shift(),x=!v||typeof v[0]!="object"?v:v[0];return J.getMessage(S.identifier.value,{message:w,args:x})}return J.getMessage(S.identifier.value,v[0])},get bundle(){return J.getBundle(S.identifier.value)},get uri(){return J.getBundleUri(S.identifier.value)}},G7={transferActiveChat(v){return N(S,"interactive"),L.transferActiveChat(v)}},Q7={getRelatedInformation(v,w){return N(S,"aiRelatedInformation"),O.getRelatedInformation(S,v,w)},registerRelatedInformationProvider(v,w){return N(S,"aiRelatedInformation"),O.registerRelatedInformationProvider(S,v,w)},registerEmbeddingVectorProvider(v,w){return N(S,"aiRelatedInformation"),oe.registerEmbeddingVectorProvider(S,v,w)},registerSettingsSearchProvider(v){return N(S,"aiSettingsSearch"),me.registerSettingsSearchProvider(S,v)}},J7={registerMappedEditsProvider(v,w){return N(S,"mappedEditsProvider"),{dispose(){}}},registerMappedEditsProvider2(v){return N(S,"mappedEditsProvider"),Ve.registerMappedEditsProvider(S,v)},createChatParticipant(v,w){return L.createChatAgent(S,v,w)},createDynamicChatParticipant(v,w,x){return N(S,"chatParticipantPrivate"),L.createDynamicChatAgent(S,v,w,x)},registerChatParticipantDetectionProvider(v){return N(S,"chatParticipantPrivate"),L.registerChatParticipantDetectionProvider(S,v)},registerRelatedFilesProvider(v,w){return N(S,"chatEditing"),L.registerRelatedFilesProvider(S,v,w)},onDidDisposeChatSession:(v,w,x)=>(N(S,"chatParticipantPrivate"),ee(L.onDidDisposeChatSession)(v,w,x))},Xp={selectChatModels:v=>M.selectLanguageModels(S,v??{}),onDidChangeChatModels:(v,w,x)=>M.onDidChangeProviders(v,w,x),registerChatModelProvider:(v,w,x)=>(N(S,"chatProvider"),M.registerLanguageModel(S,v,w,x)),get embeddingModels(){return N(S,"embeddings"),Mt.embeddingsModels},onDidChangeEmbeddingModels:(v,w,x)=>(N(S,"embeddings"),Mt.onDidChange(v,w,x)),registerEmbeddingsProvider(v,w){return N(S,"embeddings"),Mt.registerEmbeddingsProvider(S,v,w)},async computeEmbeddings(v,w,x){return N(S,"embeddings"),Mt.computeEmbeddings(v,w,x)},registerTool(v,w){return D.registerTool(S,v,w)},invokeTool(v,w,x){return D.invokeTool(S,v,w,x)},get tools(){return D.getTools(S)},fileIsIgnored(v,w){return M.fileIsIgnored(S,v,w)},registerIgnoredFileProvider(v){return M.registerIgnoredFileProvider(S,v)},registerMcpServerDefinitionProvider(v,w){return N(S,"mcpConfigurationProvider"),B.registerMcpConfigurationProvider(S,v,w)}};Xp.registerMcpConfigurationProvider=Xp.registerMcpServerDefinitionProvider;const X7={registerSpeechProvider(v,w){return N(S,"speech"),ze.registerProvider(S.identifier,v,w)}};return{version:t.version,ai:Q7,authentication:N7,commands:M7,comments:W7,chat:J7,debug:V7,env:jw,extensions:$7,interactive:G7,l10n:j7,languages:H7,lm:Xp,notebooks:q7,scm:B7,speech:X7,tasks:z7,tests:F7,window:U7,workspace:Gw,genieEditor:O7,Breakpoint:da,TerminalOutputAnchor:ov,ChatResultFeedbackKind:gc,ChatVariableLevel:Zv,ChatCompletionItem:M2,ChatReferenceDiagnostic:$4,CallHierarchyIncomingCall:f4,CallHierarchyItem:cv,CallHierarchyOutgoingCall:p4,CancellationError:xr,CancellationTokenSource:ft,CandidatePortSource:Eg,CodeAction:Jl,CodeActionKind:dt,CodeActionTriggerKind:Ql,CodeLens:ah,Color:oa,ColorInformation:fh,ColorPresentation:ph,ColorThemeKind:Vn,CommentMode:Lv,CommentState:Nv,CommentThreadCollapsibleState:ac,CommentThreadState:lc,CommentThreadApplicability:cc,CommentThreadFocus:uc,CompletionItem:uh,CompletionItemKind:le,CompletionItemTag:Zl,CompletionList:ea,CompletionTriggerKind:Yo,ConfigurationTarget:ca,CustomExecution:Dv,DebugAdapterExecutable:yh,DebugAdapterInlineImplementation:nc,DebugAdapterNamedPipeServer:bh,DebugAdapterServer:rc,DebugConfigurationProviderTriggerKind:ap,DebugConsoleMode:Ih,DebugVisualization:k2,DecorationRangeBehavior:$s,Diagnostic:ih,DiagnosticRelatedInformation:Vl,DiagnosticSeverity:ei,DiagnosticTag:Os,Disposable:Ce,DocumentHighlight:sh,DocumentHighlightKind:zl,MultiDocumentHighlight:oh,DocumentLink:hh,DocumentSymbol:Gl,EndOfLine:ur,EnvironmentVariableMutatorType:Zo,EvaluatableExpression:xh,InlineValueText:Sh,InlineValueVariableLookup:Eh,InlineValueEvaluatableExpression:Ch,InlineCompletionTriggerKind:sc,EventEmitter:P,ExtensionKind:zs,ExtensionMode:ma,ExternalUriOpenerPriority:Bv,FileChangeType:ha,FileDecoration:Fv,FileDecoration2:Fv,FileSystemError:At,FileType:Cs,FilePermission:Bo,FoldingRange:Rv,FoldingRangeKind:an,FunctionBreakpoint:Vs,InlineCompletionItem:gv,InlineCompletionList:mv,Hover:rh,VerboseHover:nh,HoverVerbosityAction:lv,IndentAction:I0,Location:Wi,MarkdownString:mi,OverviewRulerLane:O_,ParameterInformation:uv,PortAutoForwardAction:Vv,Position:Ie,ProcessExecution:aa,ProgressLocation:Us,QuickInputButtonLocation:Ov,QuickInputButtons:dc,Range:ye,RelativePattern:ua,Selection:on,SelectionRange:Xl,SemanticTokens:fa,SemanticTokensBuilder:I2,SemanticTokensEdit:y4,SemanticTokensEdits:Dh,SemanticTokensLegend:Mv,ShellExecution:Hs,ShellQuoting:Cv,SignatureHelp:hv,SignatureHelpTriggerKind:fv,SignatureInformation:dv,SnippetString:Ms,SourceBreakpoint:Ws,StandardTokenType:zn,StatusBarAlignment:Un,SymbolInformation:jl,SymbolKind:et,SymbolTag:ql,Task:gh,TaskEventKind:Sv,TaskGroup:tc,TaskPanelKind:Ev,TaskRevealKind:xv,TaskScope:Bn,TerminalLink:g2,TerminalQuickFixTerminalCommand:v2,TerminalQuickFixOpener:m2,TerminalLocation:yv,TerminalProfile:_2,TerminalExitReason:_v,TerminalShellExecutionCommandLineConfidence:ec,TerminalCompletionItem:w2,TerminalCompletionItemKind:bv,TerminalCompletionList:y2,TerminalShellType:wv,TextDocumentSaveReason:ia,TextEdit:Hn,SnippetTextEdit:av,TextEditorCursorStyle:gr,TextEditorChangeKind:na,TextEditorLineNumbersStyle:dr,TextEditorRevealType:dh,TextEditorSelectionChangeKind:ra,SyntaxTokenType:sa,TextDocumentChangeReason:Yl,ThemeColor:ic,ThemeIcon:ci,TreeItem:mh,TreeItemCheckboxState:Lr,TreeItemCollapsibleState:Bs,TypeHierarchyItem:zv,UIKind:sl,Uri:y,ViewColumn:Kl,WorkspaceEdit:Ns,DocumentPasteTriggerKind:Pv,DocumentDropEdit:kv,DocumentDropOrPasteEditKind:Wn,DocumentPasteEdit:S2,InlayHint:ch,InlayHintLabelPart:lh,InlayHintKind:pv,RemoteAuthorityResolverError:Xo,ResolvedAuthority:f2,ManagedResolvedAuthority:eh,SourceControlInputBoxValidationType:vv,ExtensionRuntime:Nh,TimelineItem:Hv,NotebookRange:ln,NotebookCellKind:qs,NotebookCellExecutionState:ga,NotebookCellData:Ph,NotebookData:b4,NotebookRendererScript:S4,NotebookCellStatusBarAlignment:Ah,NotebookEditorRevealType:Rh,NotebookCellOutput:Th,NotebookCellOutputItem:x4,CellErrorStackFrame:P2,NotebookCellStatusBarItem:T2,NotebookControllerAffinity:$v,NotebookControllerAffinity2:Lh,NotebookEdit:th,NotebookKernelSourceAction:A2,NotebookVariablesRequestKind:fc,PortAttributes:L2,LinkedEditingRanges:R2,TestResultState:Uv,TestRunRequest:Mh,TestMessage:Oh,TestMessageStackFrame:N2,TestTag:pc,TestRunProfileKind:va,TextSearchCompleteMessageType:Lf,DataTransfer:la,DataTransferItem:vh,TestCoverageCount:Fh,FileCoverage:Hh,StatementCoverage:C4,BranchCoverage:D4,DeclarationCoverage:I4,WorkspaceTrustState:Wv,LanguageStatusSeverity:Ko,QuickPickItemKind:hc,InputBoxValidationSeverity:pa,TabInputText:qv,TabInputTextDiff:Uh,TabInputTextMerge:k4,TabInputCustom:jv,TabInputNotebook:Gv,TabInputNotebookDiff:Qv,TabInputWebview:P4,TabInputTerminal:T4,TabInputInteractiveWindow:A4,TabInputChat:R4,TabInputTextMultiDiff:L4,TelemetryTrustedValue:Km,LogLevel:Ee,EditSessionIdentityMatch:k0,InteractiveSessionVoteDirection:Jv,ChatCopyKind:Xv,ChatEditingSessionActionOutcome:js,InteractiveEditorResponseFeedbackKind:Yv,DebugStackFrame:_4,DebugThread:w4,RelatedInformationType:l1,SpeechToTextStatus:u1,TextToSpeechStatus:d1,PartialAcceptTriggerKind:Fs,InlineCompletionEndOfLifeReasonKind:ta,KeywordRecognitionStatus:h1,ChatImageMimeType:Zh,ChatResponseMarkdownPart:Bh,ChatResponseFileTreePart:Vh,ChatResponseAnchorPart:vc,ChatResponseProgressPart:e1,ChatResponseProgressPart2:zh,ChatResponseReferencePart:Gs,ChatResponseReferencePart2:Gs,ChatResponseCodeCitationPart:Gh,ChatResponseCodeblockUriPart:jh,ChatResponseWarningPart:_c,ChatResponseTextEditPart:wc,ChatResponseNotebookEditPart:Jh,ChatResponseMarkdownWithVulnerabilitiesPart:mc,ChatResponseCommandButtonPart:qh,ChatResponseConfirmationPart:Wh,ChatResponseMovePart:Qh,ChatResponseExtensionsPart:t1,ChatResponseReferencePartStatusKind:r1,ChatRequestTurn:i1,ChatRequestTurn2:i1,ChatResponseTurn:N4,ChatLocation:hr,ChatRequestEditorData:M4,ChatRequestNotebookData:O4,ChatReferenceBinaryData:F4,ChatRequestEditedFileEventKind:Kv,LanguageModelChatMessageRole:Ai,LanguageModelChatMessage:H4,LanguageModelChatMessage2:U4,LanguageModelToolResultPart:Xh,LanguageModelToolResultPart2:n1,LanguageModelTextPart:mt,LanguageModelToolCallPart:Qs,LanguageModelError:cn,LanguageModelToolResult:Kh,LanguageModelToolResult2:B4,LanguageModelDataPart:qn,LanguageModelExtraDataPart:o1,ExtendedLanguageModelToolResult:F2,PreparedTerminalToolInvocation:O2,LanguageModelChatToolMode:a1,LanguageModelPromptTsxPart:Nr,NewSymbolName:C2,NewSymbolNameTag:Av,NewSymbolNameTriggerKind:oc,InlineEdit:$2,InlineEditTriggerKind:yc,ExcludeSettingOptions:dn,TextSearchContext2:Z1,TextSearchMatch2:Xn,AISearchKeyword:K1,TextSearchCompleteMessageTypeNew:Lf,ChatErrorLevel:s1,McpHttpServerDefinition:U2,McpStdioServerDefinition:H2,SettingsSearchResultKind:c1}}}var Ap,pw=class{constructor(t,i,r,n,s,o,a){this._apiFactory=t,this._extensionRegistry=i,this._instaService=r,this._extHostConfiguration=n,this._extHostExtensionService=s,this._initData=o,this._logService=a,this._factories=new Map,this._alternatives=[]}async install(){this._installInterceptor(),di("code/extHost/willWaitForConfig");const t=await this._extHostConfiguration.getConfigProvider();di("code/extHost/didWaitForConfig");const i=await this._extHostExtensionService.getExtensionPathIndex();this.register(new GH(this._apiFactory,i,this._extensionRegistry,t,this._logService)),this.register(this._instaService.createInstance(gw)),this._initData.remote.isRemote&&this.register(this._instaService.createInstance(mw,i,this._initData.environment.appUriScheme))}register(t){if("nodeModuleName"in t)if(Array.isArray(t.nodeModuleName))for(const i of t.nodeModuleName)this._factories.set(i,t);else this._factories.set(t.nodeModuleName,t);typeof t.alternativeModuleName=="function"&&this._alternatives.push(i=>t.alternativeModuleName(i))}};pw=__decorate([__param(2,gl),__param(3,fn),__param(4,Yn),__param(5,Yt),__param(6,qe)],pw);var gw=class{static{Ap=this}static{this.aliased=new Map([["vscode-ripgrep","@vscode/ripgrep"],["vscode-windows-registry","@vscode/windows-registry"]])}constructor(t){if(t.environment.appRoot&&Ap.aliased.size){const i=ps(this.forceForwardSlashes(t.environment.appRoot.fsPath)),r="[a-z0-9_.-]",n=`@${r}+\\/${r}+|${r}+`,s="node_modules|node_modules\\.asar(?:\\.unpacked)?";this.re=new RegExp(`^(${i}/${s}\\/)(${n})(.*)$`,"i")}}alternativeModuleName(t){if(!this.re)return;const i=this.re.exec(this.forceForwardSlashes(t));if(!i)return;const[,r,n,s]=i,o=Ap.aliased.get(n);if(o!==void 0)return console.warn(`${n} as been renamed to ${o}, please update your imports`),r+o+s}forceForwardSlashes(t){return t.replace(/\\/g,"/")}};gw=Ap=__decorate([__param(0,Yt)],gw);var GH=class{constructor(e,t,i,r,n){this._apiFactory=e,this._extensionPaths=t,this._extensionRegistry=i,this._configProvider=r,this._logService=n,this.nodeModuleName="vscode",this._extApiImpl=new Xr}load(e,t){const i=this._extensionPaths.findSubstr(t);if(i){let r=this._extApiImpl.get(i.identifier);return r||(r=this._apiFactory(i,this._extensionRegistry,this._configProvider),this._extApiImpl.set(i.identifier,r)),r}if(!this._defaultApiImpl){let r="";this._extensionPaths.forEach((n,s)=>r+=`	${s} -> ${n.identifier.value}
`),this._logService.warn(`Could not identify extension for 'vscode' require call from ${t}. These are the extension path mappings: 
${r}`),this._defaultApiImpl=this._apiFactory(t2,this._extensionRegistry,this._configProvider)}return this._defaultApiImpl}},mw=class{constructor(t,i,r){this._extensionPaths=t,this._appUriScheme=i,this.nodeModuleName=["open","opn"],this._mainThreadTelemetry=r.getProxy(W.MainThreadTelemetry);const n=r.getProxy(W.MainThreadWindow);this._impl=(s,o)=>{const a=y.parse(s);return o?this.callOriginal(s,o):a.scheme==="http"||a.scheme==="https"?n.$openUri(a,s,{allowTunneling:!0}):a.scheme==="mailto"||a.scheme===this._appUriScheme?n.$openUri(a,s,{}):this.callOriginal(s,o)}}load(t,i,r){const n=this._extensionPaths.findSubstr(i);return n&&(this._extensionId=n.identifier.value,this.sendShimmingTelemetry()),this._original=r(t),this._impl}callOriginal(t,i){return this.sendNoForwardTelemetry(),this._original(t,i)}sendShimmingTelemetry(){this._extensionId&&this._mainThreadTelemetry.$publicLog2("shimming.open",{extension:this._extensionId})}sendNoForwardTelemetry(){this._extensionId&&this._mainThreadTelemetry.$publicLog2("shimming.open.call.noForward",{extension:this._extensionId})}};mw=__decorate([__param(2,Ue)],mw);var vw=class{constructor(t,i){this._mainThreadConsole=t.getProxy(W.MainThreadConsole),this._includeStack=i.consoleForward.includeStack,this._logNative=i.consoleForward.logNative,this._wrapConsoleMethod("info","log"),this._wrapConsoleMethod("log","log"),this._wrapConsoleMethod("warn","warn"),this._wrapConsoleMethod("debug","debug"),this._wrapConsoleMethod("error","error")}_wrapConsoleMethod(t,i){const r=this,n=console[t];Object.defineProperty(console,t,{set:()=>{},get:()=>function(){r._handleConsoleCall(t,i,n,arguments)}})}_handleConsoleCall(t,i,r,n){this._mainThreadConsole.$logExtensionHostMessage({type:"__$console",severity:i,arguments:JH(n,this._includeStack)}),this._logNative&&this._nativeConsoleLogMessage(t,r,n)}};vw=__decorate([__param(0,Ue),__param(1,Yt)],vw);var QH=1e5;function JH(e,t){const i=[];if(e.length)for(let r=0;r<e.length;r++){let n=e[r];if(typeof n>"u")n="undefined";else if(n instanceof Error){const s=n;s.stack?n=s.stack:n=s.toString()}i.push(n)}if(t){const r=new Error().stack;r&&i.push({__$stack:r.split(`
`).slice(3).join(`
`)})}try{const r=b8(i);return r.length>QH?"Output omitted for a large object that exceeds the limits":r}catch(r){return`Output omitted for an object that cannot be inspected ('${r.toString()}')`}}var _w=class extends vw{constructor(t,i){super(t,i)}_nativeConsoleLogMessage(t,i,r){i.apply(console,r)}};_w=__decorate([__param(0,Ue),__param(1,Yt)],_w);var XH=class extends pw{_installInterceptor(){}getModule(e,t){for(const i of this._alternatives){const r=i(e);if(r){e=r;break}}if(this._factories.has(e))return this._factories.get(e).load(e,t,()=>{throw new Error("CANNOT LOAD MODULE from here.")})}},ZH=class extends G_{constructor(){super(...arguments),this.extensionRuntime=Nh.Webworker}async _beforeAlmostReadyToRunExtensions(){this._instaService.createInstance(_w);const e=this._instaService.invokeFunction(jH);this._fakeModules=this._instaService.createInstance(XH,e,{mine:this._myRegistry,all:this._globalRegistry}),await this._fakeModules.install(),performance.mark("code/extHost/didInitAPI"),await this._waitForDebuggerAttachment()}_getEntryPoint(e){return e.browser}async _loadCommonJSModule(e,t,i){t=t.with({path:KH(t.path,".js")});const r=e?.identifier.value;r&&performance.mark(`code/extHost/willFetchExtensionCode/${r}`);const n=y.revive(await this._mainThreadExtensionsProxy.$asBrowserUri(t)),s=await fetch(n.toString(!0));if(r&&performance.mark(`code/extHost/didFetchExtensionCode/${r}`),s.status!==200)throw new Error(s.statusText);const o=await s.text(),a=`${t.toString(!0)}#vscode-extension`,l=`${o}
//# sourceURL=${a}`;let c;try{c=new Function("module","exports","require",l)}catch(p){throw console.error(r?`Loading code for extension ${r} failed: ${p.message}`:`Loading code failed: ${p.message}`),console.error(`${t.toString(!0)}${typeof p.line=="number"?` line ${p.line}`:""}${typeof p.column=="number"?` column ${p.column}`:""}`),console.error(p),p}e&&await this._extHostLocalizationService.initializeLocalizedMessages(e);const u={},d={exports:u},f=p=>{const m=this._fakeModules.getModule(p,t);if(m===void 0)throw new Error(`Cannot load module '${p}'`);return m};try{return i.codeLoadingStart(),r&&performance.mark(`code/extHost/willLoadExtensionCode/${r}`),c(d,u,f),d.exports!==u?d.exports:u}finally{r&&performance.mark(`code/extHost/didLoadExtensionCode/${r}`),i.codeLoadingStop()}}_loadESMModule(e,t,i){throw new Error("ESM modules are not supported in the web worker extension host")}async $setRemoteEnvironment(e){}async _waitForDebuggerAttachment(e=5e3){if(!this._initData.environment.isExtensionDevelopmentDebug)return;const t=Date.now()+e;for(;Date.now()<t&&!("__jsDebugIsReady"in globalThis);)await sr(10)}};function KH(e,t){return e.endsWith(t)?e:e+t}Ze(qe,new Ir(C0,[!0],!0)),Ze(Yn,ZH,0),Ze(v_,__,0),Ze(qf,new Ir(C_,[!0],!0));var l6=self.close.bind(self);self.close=()=>console.trace("'close' has been blocked");var c6=postMessage.bind(self);self.postMessage=()=>console.trace("'postMessage' has been blocked");function u6(e){return/^(file|vscode-remote):/i.test(e)}var d6=fetch.bind(self);function YH(e){self.fetch=async function(t,i){return t instanceof Request||u6(String(t))&&(t=(await e(y.parse(String(t)))).toString(!0)),d6(t,i)},self.XMLHttpRequest=class extends XMLHttpRequest{open(t,i,r,n,s){(async()=>(u6(i.toString())&&(i=(await e(y.parse(i.toString()))).toString(!0)),super.open(t,i,r??!0,n,s)))()}}}if(self.importScripts=()=>{throw new Error("'importScripts' has been blocked")},self.addEventListener=()=>console.trace("'addEventListener' has been blocked"),self.AMDLoader=void 0,self.NLSLoaderPlugin=void 0,self.define=void 0,self.require=void 0,self.webkitRequestFileSystem=void 0,self.webkitRequestFileSystemSync=void 0,self.webkitResolveLocalFileSystemSyncURL=void 0,self.webkitResolveLocalFileSystemURL=void 0,self.Worker){const e=self.Worker;Worker=function(t,i){if(/^file:/i.test(t.toString()))t=Sb.uriToBrowserUri(y.parse(t.toString())).toString(!0);else if(/^vscode-remote:/i.test(t.toString()))throw new Error("Creating workers from remote extensions is currently not supported.");const n=`(${function(l){function c(f){return typeof f=="string"||f instanceof URL?String(f).replace(/^file:\/\//i,"vscode-file://vscode-app"):f}const u=fetch.bind(self);self.fetch=function(f,p){return f instanceof Request?u(f,p):u(c(f),p)},self.XMLHttpRequest=class extends XMLHttpRequest{open(f,p,m,_,b){return super.open(f,c(p),m??!0,_,b)}};const d=importScripts.bind(self);self.importScripts=(...f)=>{d(...f.map(c))},d(l)}.toString()}('${t}'))`;i=i||{},i.name=`${name} -> ${i.name||ki(t.toString())}`;const s=new Blob([n],{type:"application/javascript"}),o=URL.createObjectURL(s);return new e(o,i)}}else self.Worker=class extends AN{constructor(e,t){super(c6,e,{name:ki(e.toString()),...t})}};var eU=new class{constructor(){this.pid=void 0}exit(e){l6()}},tU=class{constructor(){const e=new MessageChannel,t=new P;let i=!1;c6(e.port2,[e.port2]),e.port1.onmessage=r=>{const{data:n}=r;if(!(n instanceof ArrayBuffer)){console.warn("UNKNOWN data received",n);return}const s=ae.wrap(new Uint8Array(n,0,n.byteLength));if(Z9(s,2)){i=!0,h6("received terminate message from renderer");return}t.fire(s)},this.protocol={onMessage:t.event,send:r=>{if(!i){const n=r.buffer.buffer.slice(r.buffer.byteOffset,r.buffer.byteOffset+r.buffer.byteLength);e.port1.postMessage(n,[n])}}}}};function iU(e){return new Promise(t=>{const i=e.onMessage(r=>{i.dispose();const n=JSON.parse(r.toString());e.send(by(0)),t({protocol:e,initData:n})});e.send(by(1))})}var h6=e=>l6();function rU(e){return!!e&&typeof e=="object"&&e.type==="vscode.init"&&e.data instanceof Map}function nU(){di("code/extHost/willConnectToRenderer");const e=new tU;return{onmessage(t){rU(t)&&iU(e.protocol).then(i=>{di("code/extHost/didWaitForInitData");const r=new PN(i.protocol,i.initData,eU,null,t.data);YH(n=>r.asBrowserUri(n)),h6=n=>r.terminate(n)})}}}var sU=nU();self.onmessage=e=>sU.onmessage(e.data);

//# sourceMappingURL=https://main.vscode-cdn.net/sourcemaps/e3faef6a7e3165b36b094b7db69ec05daa1ceb6f-73cd1db49b039ac35c8c6e524951c2382d96c5b3/core/vs/workbench/api/worker/extensionHostWorkerMain.js.map
