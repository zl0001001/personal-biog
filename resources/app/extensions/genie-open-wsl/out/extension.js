(()=>{"use strict";var e={618:function(e,t,n){var o=this&&this.__createBinding||(Object.create?function(e,t,n,o){void 0===o&&(o=n);var r=Object.getOwnPropertyDescriptor(t,n);r&&!("get"in r?!t.__esModule:r.writable||r.configurable)||(r={enumerable:!0,get:function(){return t[n]}}),Object.defineProperty(e,o,r)}:function(e,t,n,o){void 0===o&&(o=n),e[o]=t[n]}),r=this&&this.__setModuleDefault||(Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t}),i=this&&this.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)"default"!==n&&Object.prototype.hasOwnProperty.call(e,n)&&o(t,e,n);return r(t,e),t};Object.defineProperty(t,"__esModule",{value:!0}),t.RemoteWSLResolver=t.getRemoteAuthority=t.REMOTE_WSL_AUTHORITY=void 0;const s=i(n(496)),a=n(744);t.REMOTE_WSL_AUTHORITY="codebuddy-wsl",t.getRemoteAuthority=function(e){return`${t.REMOTE_WSL_AUTHORITY}+${e}`};class l{constructor(e,t){this.remoteAddress=e,this.localAddress=t,this._onDidDisposeEmitter=new s.EventEmitter,this.onDidDispose=this._onDidDisposeEmitter.event,"localhost"!==t.host&&"127.0.0.1"!==t.host&&(t.host="localhost")}dispose(){this._onDidDisposeEmitter.fire()}}t.RemoteWSLResolver=class{constructor(e,t){this.wslManager=e,this.logger=t}resolve(e,n){const[o,r]=e.split("+");if(o!==t.REMOTE_WSL_AUTHORITY)throw new Error(`Invalid authority type for WSL resolver: ${o}`);this.logger.info(`Resolving wsl remote authority '${e}' (attemp #${n.resolveAttempt})`);const i=s.workspace.getConfiguration("codebuddy.remote.WSL").get("serverDownloadUrlTemplate");return s.window.withProgress({title:`Setting up WSL Distro: ${r}`,location:s.ProgressLocation.Notification,cancellable:!1},(async()=>{try{const e=await(0,a.installCodeServer)(this.wslManager,r,i,[],[],this.logger);return this.labelFormatterDisposable?.dispose(),this.labelFormatterDisposable=s.workspace.registerResourceLabelFormatter({scheme:"vscode-remote",authority:`${t.REMOTE_WSL_AUTHORITY}+*`,formatting:{label:"${path}",separator:"/",tildify:!0,workspaceSuffix:`WSL: ${r}`,workspaceTooltip:`Running in ${r}`}}),new s.ResolvedAuthority("127.0.0.1",e.listeningOn,e.connectionToken)}catch(e){if(this.logger.error("Error resolving authority",e),1===n.resolveAttempt){this.logger.show();const e="Close Remote",t="Retry",n=await s.window.showErrorMessage(`Could not establish connection to WSL distro "${r}"`,{modal:!0},e,t);n===e?await s.commands.executeCommand("workbench.action.remote.close"):n===t&&await s.commands.executeCommand("workbench.action.reloadWindow")}throw e instanceof a.ServerInstallError||!(e instanceof Error)?s.RemoteAuthorityResolverError.NotAvailable(e instanceof Error?e.message:String(e)):s.RemoteAuthorityResolverError.TemporarilyNotAvailable(e.message)}}))}async tunnelFactory(e){return new l(e.remoteAddress,{host:e.remoteAddress.host,port:e.localAddressPort??e.remoteAddress.port})}dispose(){this.labelFormatterDisposable?.dispose()}}},49:function(e,t,n){var o=this&&this.__createBinding||(Object.create?function(e,t,n,o){void 0===o&&(o=n);var r=Object.getOwnPropertyDescriptor(t,n);r&&!("get"in r?!t.__esModule:r.writable||r.configurable)||(r={enumerable:!0,get:function(){return t[n]}}),Object.defineProperty(e,o,r)}:function(e,t,n,o){void 0===o&&(o=n),e[o]=t[n]}),r=this&&this.__setModuleDefault||(Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t}),i=this&&this.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)"default"!==n&&Object.prototype.hasOwnProperty.call(e,n)&&o(t,e,n);return r(t,e),t},s=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0}),t.deleteWSLDistro=t.setDefaultWSLDistro=t.openRemoteWSLLocationWindow=t.openRemoteWSLWindow=t.promptInstallNewWSLDistro=t.promptOpenRemoteWSLWindow=void 0;const a=i(n(496)),l=n(618),c=s(n(574));function d(e,t){a.commands.executeCommand("vscode.newWindow",{remoteAuthority:(0,l.getRemoteAuthority)(e),reuseWindow:t})}t.promptOpenRemoteWSLWindow=async function(e,t,n){let o;if(t){const t=await e.listDistros();o=t.find((e=>e.isDefault))?.name}else o=(await async function(e,t){const n=e.listDistros().then((e=>e.map((e=>({...e,label:`${e.name}`,detail:e.isDefault?"default distro":void 0})))));return await a.window.showQuickPick(n,{canPickMany:!1,placeHolder:"Select WSL distro"})}(e))?.name;o&&d(o,n)},t.promptInstallNewWSLDistro=async function(e){let t;t=(await async function(e,t){const n=Promise.all([e.listOnlineDistros(),e.listDistros()]).then((([e,t])=>e.filter((e=>!t.some((t=>t.name===e.name)))).map((e=>({...e,label:`${e.friendlyName}`})))));return await a.window.showQuickPick(n,{canPickMany:!1,placeHolder:"Select the WSL distro to install"})}(e))?.name,t&&c.default.runCommand(`wsl.exe --install -d ${t}`)},t.openRemoteWSLWindow=d,t.openRemoteWSLLocationWindow=function(e,t,n){a.commands.executeCommand("vscode.openFolder",a.Uri.from({scheme:"vscode-remote",authority:(0,l.getRemoteAuthority)(e),path:t}),{forceNewWindow:!n})},t.setDefaultWSLDistro=async function(e,t){await e.setDefaultDistro(t)},t.deleteWSLDistro=async function(e,t){const n="Delete";return await a.window.showInformationMessage(`Are you sure you want to permanently delete the distro "${t}" including all its data?`,{modal:!0},n)===n&&(await e.deleteDistro(t),!0)}},771:(e,t)=>{function n(e){for(;e.length;){const t=e.pop();t&&t.dispose()}}Object.defineProperty(t,"__esModule",{value:!0}),t.Disposable=t.disposeAll=void 0,t.disposeAll=n,t.Disposable=class{constructor(){this._isDisposed=!1,this._disposables=[]}dispose(){this._isDisposed||(this._isDisposed=!0,n(this._disposables))}_register(e){return this._isDisposed?e.dispose():this._disposables.push(e),e}get isDisposed(){return this._isDisposed}}},110:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.EventEmitter=t.once=t.toPromise=void 0,t.toPromise=function(e,n){return n?n.aborted?Promise.resolve(void 0):new Promise((o=>{const r=(0,t.once)(e,(e=>{n.removeEventListener("abort",i),o(e)})),i=()=>{r.dispose(),n.removeEventListener("abort",i),o(void 0)};n.addEventListener("abort",i)})):new Promise((n=>(0,t.once)(e,n)))},t.once=(e,t)=>{const n=e((e=>{t(e),n.dispose()}));return n},t.EventEmitter=class{constructor(){this.event=(e,t,n)=>{const o=this.add(t?e.bind(t):e);return n?.push(o),o}}get size(){return this.listeners?"function"==typeof this.listeners?1:this.listeners.length:0}fire(e){if(this.listeners)if("function"==typeof this.listeners)this.listeners(e);else for(const t of this.listeners)t(e)}dispose(){this.listeners=void 0}add(e){return this.listeners?"function"==typeof this.listeners?this.listeners=[this.listeners,e]:this.listeners.push(e):this.listeners=e,{dispose:()=>this.rm(e)}}rm(e){if(!this.listeners)return;if("function"==typeof this.listeners)return void(this.listeners===e&&(this.listeners=void 0));const t=this.listeners.indexOf(e);-1!==t&&(2===this.listeners.length?this.listeners=0===t?this.listeners[1]:this.listeners[0]:this.listeners=this.listeners.slice(0,t).concat(this.listeners.slice(t+1)))}}},249:function(e,t,n){var o=this&&this.__createBinding||(Object.create?function(e,t,n,o){void 0===o&&(o=n);var r=Object.getOwnPropertyDescriptor(t,n);r&&!("get"in r?!t.__esModule:r.writable||r.configurable)||(r={enumerable:!0,get:function(){return t[n]}}),Object.defineProperty(e,o,r)}:function(e,t,n,o){void 0===o&&(o=n),e[o]=t[n]}),r=this&&this.__setModuleDefault||(Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t}),i=this&&this.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)"default"!==n&&Object.prototype.hasOwnProperty.call(e,n)&&o(t,e,n);return r(t,e),t};Object.defineProperty(t,"__esModule",{value:!0});const s=i(n(496));function a(e,t,n=" "){return n.repeat(Math.max(0,t-e.length))+e}t.default=class{constructor(e){this.output=s.window.createOutputChannel(e)}data2String(e){return e instanceof Error?e.stack||e.message:!1===e.success&&e.message?e.message:e.toString()}trace(e,t){this.logLevel("Trace",e,t)}info(e,t){this.logLevel("Info",e,t)}error(e,t){this.logLevel("Error",e,t)}logLevel(e,t,n){this.output.appendLine(`[${e}  - ${this.now()}] ${t}`),n&&this.output.appendLine(this.data2String(n))}now(){const e=new Date;return a(e.getUTCHours()+"",2,"0")+":"+a(e.getMinutes()+"",2,"0")+":"+a(e.getUTCSeconds()+"",2,"0")+"."+e.getMilliseconds()}show(){this.output.show()}dispose(){this.output.dispose()}}},400:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.isLinux=t.isMacintosh=t.isWindows=void 0,t.isWindows="win32"===process.platform,t.isMacintosh="darwin"===process.platform,t.isLinux="linux"===process.platform},679:function(e,t,n){var o=this&&this.__createBinding||(Object.create?function(e,t,n,o){void 0===o&&(o=n);var r=Object.getOwnPropertyDescriptor(t,n);r&&!("get"in r?!t.__esModule:r.writable||r.configurable)||(r={enumerable:!0,get:function(){return t[n]}}),Object.defineProperty(e,o,r)}:function(e,t,n,o){void 0===o&&(o=n),e[o]=t[n]}),r=this&&this.__setModuleDefault||(Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t}),i=this&&this.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)"default"!==n&&Object.prototype.hasOwnProperty.call(e,n)&&o(t,e,n);return r(t,e),t};Object.defineProperty(t,"__esModule",{value:!0}),t.DistroTreeDataProvider=void 0;const s=i(n(496)),a=i(n(17)),l=n(771),c=n(49);class d{constructor(e,t,n){this.name=e,this.isDefault=t,this.locations=n}}class u{constructor(e,t){this.path=e,this.name=t}}class h extends l.Disposable{constructor(e,t){super(),this.locationHistory=e,this.wslManager=t,this._onDidChangeTreeData=this._register(new s.EventEmitter),this.onDidChangeTreeData=this._onDidChangeTreeData.event,this._register(s.commands.registerCommand("codebuddy.openremotewsl.explorer.addDistro",(()=>(0,c.promptInstallNewWSLDistro)(t)))),this._register(s.commands.registerCommand("codebuddy.openremotewsl.explorer.refresh",(()=>this.refresh()))),this._register(s.commands.registerCommand("codebuddy.openremotewsl.explorer.emptyWindowInNewWindow",(e=>this.openRemoteWSLWindow(e,!1)))),this._register(s.commands.registerCommand("codebuddy.openremotewsl.explorer.emptyWindowInCurrentWindow",(e=>this.openRemoteWSLWindow(e,!0)))),this._register(s.commands.registerCommand("codebuddy.openremotewsl.explorer.reopenFolderInNewWindow",(e=>this.openRemoteWSLocationWindow(e,!1)))),this._register(s.commands.registerCommand("codebuddy.openremotewsl.explorer.reopenFolderInCurrentWindow",(e=>this.openRemoteWSLocationWindow(e,!0)))),this._register(s.commands.registerCommand("codebuddy.openremotewsl.explorer.deleteFolderHistoryItem",(e=>this.deleteDistroLocation(e)))),this._register(s.commands.registerCommand("codebuddy.openremotewsl.explorer.setDefaultDistro",(e=>this.setDefaultDistro(e)))),this._register(s.commands.registerCommand("codebuddy.openremotewsl.explorer.deleteDistro",(e=>this.deleteDistro(e))))}getTreeItem(e){if(e instanceof u){const t=a.posix.basename(e.path).replace(/\.code-workspace$/," (Workspace)"),n=new s.TreeItem(t);return n.description=a.posix.dirname(e.path),n.iconPath=new s.ThemeIcon("folder"),n.contextValue="codebuddy.openremotewsl.explorer.folder",n}const t=new s.TreeItem(e.name);return t.description=e.isDefault?"default distro":void 0,t.collapsibleState=e.locations.length?s.TreeItemCollapsibleState.Collapsed:s.TreeItemCollapsibleState.None,t.iconPath=new s.ThemeIcon("vm"),t.contextValue="codebuddy.openremotewsl.explorer.distro",t}async getChildren(e){return e?e instanceof d?e.locations.map((t=>new u(t,e.name))):[]:(await this.wslManager.listDistros()).map((e=>new d(e.name,e.isDefault,this.locationHistory.getHistory(e.name))))}refresh(){this._onDidChangeTreeData.fire()}async deleteDistroLocation(e){await this.locationHistory.removeLocation(e.name,e.path),this.refresh()}async openRemoteWSLWindow(e,t){(0,c.openRemoteWSLWindow)(e.name,t)}async openRemoteWSLocationWindow(e,t){(0,c.openRemoteWSLLocationWindow)(e.name,e.path,t)}async setDefaultDistro(e){await(0,c.setDefaultWSLDistro)(this.wslManager,e.name),this.refresh()}async deleteDistro(e){await(0,c.deleteWSLDistro)(this.wslManager,e.name),this.refresh()}}t.DistroTreeDataProvider=h},112:function(e,t,n){var o=this&&this.__createBinding||(Object.create?function(e,t,n,o){void 0===o&&(o=n);var r=Object.getOwnPropertyDescriptor(t,n);r&&!("get"in r?!t.__esModule:r.writable||r.configurable)||(r={enumerable:!0,get:function(){return t[n]}}),Object.defineProperty(e,o,r)}:function(e,t,n,o){void 0===o&&(o=n),e[o]=t[n]}),r=this&&this.__setModuleDefault||(Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t}),i=this&&this.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)"default"!==n&&Object.prototype.hasOwnProperty.call(e,n)&&o(t,e,n);return r(t,e),t},s=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0}),t.deactivate=t.activate=void 0;const a=i(n(496)),l=s(n(249)),c=n(618),d=n(49),u=n(679),h=n(879),E=n(114),p=n(400);t.activate=async function(e){if(!p.isWindows)return;const t=new l.default("Remote - WSL");e.subscriptions.push(t);const n=new E.WSLManager(t),o=new c.RemoteWSLResolver(n,t);e.subscriptions.push(a.workspace.registerRemoteAuthorityResolver(c.REMOTE_WSL_AUTHORITY,o)),e.subscriptions.push(o);const r=new h.RemoteLocationHistory(e),i=(0,h.getRemoteWorkspaceLocationData)();i&&await r.addLocation(i[0],i[1]);const s=new u.DistroTreeDataProvider(r,n);e.subscriptions.push(a.window.createTreeView("codeBuddyWslTargets",{treeDataProvider:s})),e.subscriptions.push(s),e.subscriptions.push(a.commands.registerCommand("codebuddy.openremotewsl.connect",(()=>(0,d.promptOpenRemoteWSLWindow)(n,!0,!0)))),e.subscriptions.push(a.commands.registerCommand("codebuddy.openremotewsl.connectInNewWindow",(()=>(0,d.promptOpenRemoteWSLWindow)(n,!0,!1)))),e.subscriptions.push(a.commands.registerCommand("codebuddy.openremotewsl.connectUsingDistro",(()=>(0,d.promptOpenRemoteWSLWindow)(n,!1,!0)))),e.subscriptions.push(a.commands.registerCommand("codebuddy.openremotewsl.connectUsingDistroInNewWindow",(()=>(0,d.promptOpenRemoteWSLWindow)(n,!1,!1)))),e.subscriptions.push(a.commands.registerCommand("codebuddy.openremotewsl.showLog",(()=>t.show())))},t.deactivate=function(){}},879:function(e,t,n){var o=this&&this.__createBinding||(Object.create?function(e,t,n,o){void 0===o&&(o=n);var r=Object.getOwnPropertyDescriptor(t,n);r&&!("get"in r?!t.__esModule:r.writable||r.configurable)||(r={enumerable:!0,get:function(){return t[n]}}),Object.defineProperty(e,o,r)}:function(e,t,n,o){void 0===o&&(o=n),e[o]=t[n]}),r=this&&this.__setModuleDefault||(Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t}),i=this&&this.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)"default"!==n&&Object.prototype.hasOwnProperty.call(e,n)&&o(t,e,n);return r(t,e),t};Object.defineProperty(t,"__esModule",{value:!0}),t.getRemoteWorkspaceLocationData=t.RemoteLocationHistory=void 0;const s=i(n(496)),a=n(618);class l{constructor(e){this.context=e,this.remoteLocationHistory={},this.remoteLocationHistory=e.globalState.get(l.STORAGE_KEY)||{}}getHistory(e){return this.remoteLocationHistory[e]||[]}async addLocation(e,t){let n=this.remoteLocationHistory[e]||[];n.includes(t)||(n.unshift(t),this.remoteLocationHistory[e]=n,await this.context.globalState.update(l.STORAGE_KEY,this.remoteLocationHistory))}async removeLocation(e,t){let n=this.remoteLocationHistory[e]||[];n=n.filter((e=>e!==t)),this.remoteLocationHistory[e]=n,await this.context.globalState.update(l.STORAGE_KEY,this.remoteLocationHistory)}}t.RemoteLocationHistory=l,l.STORAGE_KEY="remoteLocationHistory_v0",t.getRemoteWorkspaceLocationData=function(){let e=s.workspace.workspaceFile;if(e&&"vscode-remote"===e.scheme&&e.authority.startsWith(a.REMOTE_WSL_AUTHORITY)&&e.path.endsWith(".code-workspace")){const[,t]=e.authority.split("+");return[t,e.path]}if(e=s.workspace.workspaceFolders?.[0].uri,e&&"vscode-remote"===e.scheme&&e.authority.startsWith(a.REMOTE_WSL_AUTHORITY)){const[,t]=e.authority.split("+");return[t,e.path]}}},487:function(e,t,n){var o=this&&this.__createBinding||(Object.create?function(e,t,n,o){void 0===o&&(o=n);var r=Object.getOwnPropertyDescriptor(t,n);r&&!("get"in r?!t.__esModule:r.writable||r.configurable)||(r={enumerable:!0,get:function(){return t[n]}}),Object.defineProperty(e,o,r)}:function(e,t,n,o){void 0===o&&(o=n),e[o]=t[n]}),r=this&&this.__setModuleDefault||(Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t}),i=this&&this.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)"default"!==n&&Object.prototype.hasOwnProperty.call(e,n)&&o(t,e,n);return r(t,e),t};Object.defineProperty(t,"__esModule",{value:!0}),t.getVSCodeServerConfig=void 0;const s=i(n(496)),a=i(n(147)),l=i(n(17));let c;t.getVSCodeServerConfig=async function(){const e=await async function(){if(!c){const e=await a.promises.readFile(l.join(s.env.appRoot,"product.json"),"utf8");c=JSON.parse(e)}return c}(),t=s.workspace.getConfiguration("remote.SSH.experimental").get("serverBinaryName","");return{version:e.genieVersion||s.version.replace("-insider",""),commit:e.commit,quality:e.quality||"stable",release:"13210",serverApplicationName:t||e.serverApplicationName,serverDataFolderName:e.serverDataFolderName,serverDownloadUrlTemplate:e.serverDownloadUrlTemplate}}},744:function(e,t,n){var o=this&&this.__createBinding||(Object.create?function(e,t,n,o){void 0===o&&(o=n);var r=Object.getOwnPropertyDescriptor(t,n);r&&!("get"in r?!t.__esModule:r.writable||r.configurable)||(r={enumerable:!0,get:function(){return t[n]}}),Object.defineProperty(e,o,r)}:function(e,t,n,o){void 0===o&&(o=n),e[o]=t[n]}),r=this&&this.__setModuleDefault||(Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t}),i=this&&this.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)"default"!==n&&Object.prototype.hasOwnProperty.call(e,n)&&o(t,e,n);return r(t,e),t};Object.defineProperty(t,"__esModule",{value:!0}),t.installCodeServer=t.ServerInstallError=void 0;const s=i(n(113)),a=n(487);class l extends Error{constructor(e){super(e)}}t.ServerInstallError=l,t.installCodeServer=async function(e,t,n,o,r,i){const c=s.randomBytes(12).toString("hex"),d=await(0,a.getVSCodeServerConfig)(),u=function({id:e,quality:t,version:n,commit:o,release:r,extensionIds:i,envVariables:a,serverApplicationName:l,serverDataFolderName:c,serverDownloadUrlTemplate:d}){const u=i.map((e=>"--install-extension "+e)).join(" ");return`\n# Server installation script\n\nTMP_DIR="\${XDG_RUNTIME_DIR:-"/tmp"}"\n\nDISTRO_VERSION="${n}"\nDISTRO_COMMIT="${o}"\nDISTRO_QUALITY="${t}"\nDISTRO_VSCODIUM_RELEASE="${r??""}"\n\nSERVER_APP_NAME="${l}"\nSERVER_INITIAL_EXTENSIONS="${u}"\nSERVER_LISTEN_FLAG="--port=0"\nSERVER_DATA_DIR="$HOME/${c}"\nSERVER_DIR="$SERVER_DATA_DIR/bin/$DISTRO_COMMIT"\nSERVER_SCRIPT="$SERVER_DIR/bin/$SERVER_APP_NAME"\nSERVER_LOGFILE="$SERVER_DATA_DIR/.$DISTRO_COMMIT.log"\nSERVER_PIDFILE="$SERVER_DATA_DIR/.$DISTRO_COMMIT.pid"\nSERVER_TOKENFILE="$SERVER_DATA_DIR/.$DISTRO_COMMIT.token"\nSERVER_OS=\nSERVER_ARCH=\nSERVER_CONNECTION_TOKEN=\nSERVER_DOWNLOAD_URL=\n\nLISTENING_ON=\nOS_RELEASE_ID=\nARCH=\nPLATFORM=\n\n# Mimic output from logs of remote-ssh extension\nprint_install_results_and_exit() {\n    echo "${e}: start"\n    echo "exitCode==$1=="\n    echo "listeningOn==$LISTENING_ON=="\n    echo "connectionToken==$SERVER_CONNECTION_TOKEN=="\n    echo "logFile==$SERVER_LOGFILE=="\n    echo "osReleaseId==$OS_RELEASE_ID=="\n    echo "arch==$ARCH=="\n    echo "platform==$PLATFORM=="\n    echo "tmpDir==$TMP_DIR=="\n    ${a.map((e=>`echo "${e}==$${e}=="`)).join("\n")}\n    echo "${e}: end"\n    exit 0\n}\n\n# Check if platform is supported\nPLATFORM="$(uname -s)"\ncase $PLATFORM in\n    Linux)\n        SERVER_OS="linux"\n        ;;\n    *)\n        echo "Error platform not supported: $PLATFORM"\n        print_install_results_and_exit 1\n        ;;\nesac\n\n# Check machine architecture\nARCH="$(uname -m)"\ncase $ARCH in\n    x86_64 | amd64)\n        SERVER_ARCH="x64"\n        ;;\n    armv7l | armv8l)\n        SERVER_ARCH="armhf"\n        ;;\n    arm64 | aarch64)\n        SERVER_ARCH="arm64"\n        ;;\n    *)\n        echo "Error architecture not supported: $ARCH"\n        print_install_results_and_exit 1\n        ;;\nesac\n\n# https://www.freedesktop.org/software/systemd/man/os-release.html\nOS_RELEASE_ID="$(grep -i '^ID=' /etc/os-release 2>/dev/null | sed 's/^ID=//gi' | sed 's/"//g')"\nif [[ -z $OS_RELEASE_ID ]]; then\n    OS_RELEASE_ID="$(grep -i '^ID=' /usr/lib/os-release 2>/dev/null | sed 's/^ID=//gi' | sed 's/"//g')"\n    if [[ -z $OS_RELEASE_ID ]]; then\n        OS_RELEASE_ID="unknown"\n    fi\nfi\n\n# Create installation folder\nif [[ ! -d $SERVER_DIR ]]; then\n    mkdir -p $SERVER_DIR\n    if (( $? > 0 )); then\n        echo "Error creating server install directory"\n        print_install_results_and_exit 1\n    fi\nfi\n\nSERVER_DOWNLOAD_URL="$(echo "${d.replace(/\$\{/g,"\\${")}" | sed "s/\\\${quality}/$DISTRO_QUALITY/g" | sed "s/\\\${version}/$DISTRO_VERSION/g" | sed "s/\\\${commit}/$DISTRO_COMMIT/g" | sed "s/\\\${os}/$SERVER_OS/g" | sed "s/\\\${arch}/$SERVER_ARCH/g" | sed "s/\\\${release}/$DISTRO_VSCODIUM_RELEASE/g")"\n\n# Check if server script is already installed\nif [[ ! -f $SERVER_SCRIPT ]]; then\n    if [[ "$SERVER_OS" = "dragonfly" ]] || [[ "$SERVER_OS" = "freebsd" ]]; then\n        echo "Error "$SERVER_OS" needs manual installation of remote extension host"\n        print_install_results_and_exit 1\n    fi\n\n    pushd $SERVER_DIR > /dev/null\n\n    # Download with enhanced retry and monitoring\n    SERVER_CHECKSUM_URL="$SERVER_DOWNLOAD_URL.sha256"\n    DOWNLOAD_SUCCESS=0\n    MAX_RETRIES=5\n    RETRY_DELAY=5\n\n    for attempt in $(seq 1 $MAX_RETRIES); do\n        echo "=== Download Attempt $attempt/$MAX_RETRIES ==="\n        echo "Download URL: $SERVER_DOWNLOAD_URL"\n        echo "Timestamp: $(date '+%Y-%m-%d %H:%M:%S')"\n        echo "Attempt start time: $(date +%s)"\n\n        # Clean up any partial downloads with detailed logging\n        echo "Cleaning up previous download attempts..."\n        for cleanup_file in vscode-server.tar.gz "$(basename "$SERVER_DOWNLOAD_URL")" "$(basename "$SERVER_CHECKSUM_URL")"; do\n            if [[ -f "$cleanup_file" ]]; then\n                file_size=$(stat -c%s "$cleanup_file" 2>/dev/null || stat -f%z "$cleanup_file" 2>/dev/null || echo "unknown")\n                echo "Removing partial file: $cleanup_file (size: $file_size bytes)"\n                rm -f "$cleanup_file"\n            fi\n        done\n\n        # Get original filename from URL\n        ORIGINAL_FILENAME=$(basename "$SERVER_DOWNLOAD_URL")\n        echo "Target filename: $ORIGINAL_FILENAME"\n\n        # Pre-download URL validation\n        echo "Validating download URL..."\n        if command -v curl &> /dev/null; then\n            HTTP_STATUS=$(curl --connect-timeout 10 --max-time 30 --location --silent --head --write-out "%{http_code}" --output /dev/null "$SERVER_DOWNLOAD_URL" 2>/dev/null || echo "000")\n            echo "HTTP status for download URL: $HTTP_STATUS"\n            if [[ "$HTTP_STATUS" != "200" ]]; then\n                echo "Warning: Server returned HTTP $HTTP_STATUS for download URL"\n                if [[ $attempt -lt $MAX_RETRIES ]]; then\n                    echo "Retrying in $RETRY_DELAY seconds..."\n                    sleep $RETRY_DELAY\n                    continue\n                fi\n            fi\n        fi\n\n        # Download main file with enhanced monitoring\n        echo "Starting download..."\n        DOWNLOAD_START_TIME=$(date +%s)\n        DOWNLOAD_EXIT_CODE=1\n\n        if command -v wget &> /dev/null; then\n            echo "Using wget for download with enhanced options"\n            echo "wget command: wget --tries=1 --timeout=60 --connect-timeout=30 --read-timeout=300 --progress=dot:giga --output-document="$ORIGINAL_FILENAME" "$SERVER_DOWNLOAD_URL""\n\n            # Use wget with enhanced options and capture both stdout and stderr\n            wget --tries=1 --timeout=60 --connect-timeout=30 --read-timeout=300 --progress=dot:giga --output-document="$ORIGINAL_FILENAME" "$SERVER_DOWNLOAD_URL" 2>&1 | tee wget_output.log\n            DOWNLOAD_EXIT_CODE=$PIPESTATUS[0]\n\n            echo "wget exit code: $DOWNLOAD_EXIT_CODE"\n            if [[ -f wget_output.log ]]; then\n                echo "wget output summary:"\n                tail -5 wget_output.log\n                rm -f wget_output.log\n            fi\n\n        elif command -v curl &> /dev/null; then\n            echo "Using curl for download with enhanced options"\n            echo "curl command: curl --connect-timeout 30 --max-time 600 --location --show-error --fail --progress-bar --output "$ORIGINAL_FILENAME" "$SERVER_DOWNLOAD_URL""\n\n            # Use curl with enhanced options and capture output\n            curl --connect-timeout 30 --max-time 600 --location --show-error --fail --progress-bar --output "$ORIGINAL_FILENAME" "$SERVER_DOWNLOAD_URL" 2>&1 | tee curl_output.log\n            DOWNLOAD_EXIT_CODE=$PIPESTATUS[0]\n\n            echo "curl exit code: $DOWNLOAD_EXIT_CODE"\n            if [[ -f curl_output.log ]]; then\n                echo "curl output summary:"\n                tail -5 curl_output.log\n                rm -f curl_output.log\n            fi\n        else\n            echo "Error: No download tool available (wget or curl required)"\n            print_install_results_and_exit 1\n        fi\n\n        DOWNLOAD_END_TIME=$(date +%s)\n        DOWNLOAD_DURATION=$((DOWNLOAD_END_TIME - DOWNLOAD_START_TIME))\n        echo "Download completed in "$DOWNLOAD_DURATION" s with exit code: $DOWNLOAD_EXIT_CODE"\n\n        # Enhanced download validation\n        if (( DOWNLOAD_EXIT_CODE != 0 )); then\n            echo "Download failed on attempt $attempt with exit code $DOWNLOAD_EXIT_CODE"\n\n            # Provide specific error interpretation\n            case $DOWNLOAD_EXIT_CODE in\n                1) echo "Error type: Generic error or protocol error" ;;\n                2) echo "Error type: Misuse of shell command" ;;\n                3) echo "Error type: File I/O error" ;;\n                4) echo "Error type: Network failure" ;;\n                5) echo "Error type: SSL verification failure" ;;\n                6) echo "Error type: Username/password authentication failure" ;;\n                7) echo "Error type: Protocol error" ;;\n                8) echo "Error type: Server issued an error response" ;;\n                22) echo "Error type: HTTP page not retrieved (curl specific)" ;;\n                28) echo "Error type: Operation timeout" ;;\n                *) echo "Error type: Unknown error code $DOWNLOAD_EXIT_CODE" ;;\n            esac\n\n            if [[ $attempt -lt $MAX_RETRIES ]]; then\n                echo "Retrying in $RETRY_DELAY seconds..."\n                sleep $RETRY_DELAY\n                RETRY_DELAY=$((RETRY_DELAY + 2)) # Exponential backoff\n            fi\n            continue\n        fi\n\n        # Enhanced file validation\n        if [[ ! -f "$ORIGINAL_FILENAME" ]]; then\n            echo "Error: Downloaded file does not exist: $ORIGINAL_FILENAME"\n            echo "Directory contents after download:"\n            ls -la . 2>/dev/null || echo "Cannot list directory"\n            continue\n        fi\n\n        # Get file size with cross-platform compatibility\n        FILE_SIZE=$(stat -c%s "$ORIGINAL_FILENAME" 2>/dev/null || stat -f%z "$ORIGINAL_FILENAME" 2>/dev/null || echo "0")\n        echo "Downloaded file size: $FILE_SIZE bytes"\n\n        # Enhanced empty file detection\n        if [[ ! -s "$ORIGINAL_FILENAME" ]] || [[ "$FILE_SIZE" == "0" ]]; then\n            echo "ERROR: Downloaded file is empty (0 bytes) on attempt $attempt"\n            echo "This indicates one of the following issues:"\n            echo "  - Network connection was interrupted during transfer"\n            echo "  - Server returned HTTP 200 but with empty content"\n            echo "  - Download tool crashed or was terminated"\n            echo "  - Insufficient disk space during download"\n            echo "  - Server-side issue (maintenance, overload, etc.)"\n\n            # Additional diagnostics for empty file\n            echo "File diagnostics:"\n            ls -la "$ORIGINAL_FILENAME" 2>/dev/null || echo "Cannot stat file"\n            file "$ORIGINAL_FILENAME" 2>/dev/null || echo "Cannot determine file type"\n\n            if [[ $attempt -lt $MAX_RETRIES ]]; then\n                echo "Retrying in $RETRY_DELAY seconds..."\n                sleep $RETRY_DELAY\n                RETRY_DELAY=$((RETRY_DELAY + 3))\n            fi\n            continue\n        fi\n\n        # Minimum size validation (server binary should be at least 10MB)\n        MIN_SIZE=10485760  # 10MB in bytes\n        if [[ "$FILE_SIZE" -lt "$MIN_SIZE" ]]; then\n            echo "Warning: Downloaded file size ($FILE_SIZE bytes) is smaller than expected minimum ($MIN_SIZE bytes)"\n            echo "This might indicate a partial download or server error"\n\n            if [[ $attempt -lt $MAX_RETRIES ]]; then\n                echo "Retrying in $RETRY_DELAY seconds..."\n                sleep $RETRY_DELAY\n                RETRY_DELAY=$((RETRY_DELAY + 2))\n                continue\n            else\n                echo "Proceeding with small file as this is the final attempt"\n            fi\n        fi\n\n        # Try to download and validate checksum file\n        CHECKSUM_AVAILABLE=0\n        echo "Attempting to download checksum file..."\n\n        if command -v wget &> /dev/null; then\n            wget --tries=1 --timeout=30 --connect-timeout=10 --quiet "$SERVER_CHECKSUM_URL" 2>/dev/null && CHECKSUM_AVAILABLE=1\n        elif command -v curl &> /dev/null; then\n            curl --connect-timeout 10 --max-time 30 --location --show-error --silent --remote-name "$SERVER_CHECKSUM_URL" 2>/dev/null && CHECKSUM_AVAILABLE=1\n        fi\n\n        # Enhanced checksum validation\n        CHECKSUM_FILENAME=$(basename "$SERVER_CHECKSUM_URL")\n        if [[ $CHECKSUM_AVAILABLE -eq 1 ]] && [[ -f "$CHECKSUM_FILENAME" ]]; then\n            echo "Checksum file downloaded successfully"\n\n            if command -v sha256sum &> /dev/null; then\n                echo "Validating file integrity with sha256sum..."\n                if sha256sum -c "$CHECKSUM_FILENAME" 2>/dev/null; then\n                    echo "✓ Checksum validation passed - file integrity confirmed"\n                    mv "$ORIGINAL_FILENAME" vscode-server.tar.gz\n                    DOWNLOAD_SUCCESS=1\n                    break\n                else\n                    echo "✗ Checksum validation failed on attempt $attempt"\n                    echo "File may be corrupted or incomplete"\n\n                    # Show actual vs expected checksums for debugging\n                    echo "Expected checksum:"\n                    cat "$CHECKSUM_FILENAME" 2>/dev/null || echo "Cannot read checksum file"\n                    echo "Actual checksum:"\n                    sha256sum "$ORIGINAL_FILENAME" 2>/dev/null || echo "Cannot calculate checksum"\n\n                    if [[ $attempt -lt $MAX_RETRIES ]]; then\n                        echo "Retrying in $RETRY_DELAY seconds..."\n                        sleep $RETRY_DELAY\n                        RETRY_DELAY=$((RETRY_DELAY + 2))\n                    fi\n                    continue\n                fi\n            else\n                echo "Warning: sha256sum not available, skipping checksum validation"\n                echo "Proceeding without integrity verification"\n                mv "$ORIGINAL_FILENAME" vscode-server.tar.gz\n                DOWNLOAD_SUCCESS=1\n                break\n            fi\n        else\n            echo "Warning: Checksum file not available from server"\n            echo "Proceeding without integrity verification"\n            mv "$ORIGINAL_FILENAME" vscode-server.tar.gz\n            DOWNLOAD_SUCCESS=1\n            break\n        fi\n    done\n\n    if (( DOWNLOAD_SUCCESS != 1 )); then\n        echo "Error downloading server from $SERVER_DOWNLOAD_URL after $MAX_RETRIES attempts"\n        print_install_results_and_exit 1\n    fi\n\n    # Validate tar file integrity before extraction\n    if ! tar -tzf vscode-server.tar.gz >/dev/null 2>&1; then\n        echo "Error downloaded tar file is corrupted"\n        print_install_results_and_exit 1\n    fi\n\n    # Extract with better error handling and cleanup\n    tar -xf vscode-server.tar.gz --strip-components 1 2>/dev/null\n    TAR_EXIT_CODE=$?\n\n    # Clean up downloaded files regardless of extraction result\n    rm -f vscode-server.tar.gz "$(basename "$SERVER_CHECKSUM_URL")"\n\n    if (( TAR_EXIT_CODE > 0 )); then\n        echo "Error while extracting server contents (exit code: $TAR_EXIT_CODE)"\n        echo "Check disk space and permissions in: $SERVER_DIR"\n        print_install_results_and_exit 1\n    fi\n\n    # Verify extraction was successful\n    if [[ ! -f "$SERVER_SCRIPT" ]]; then\n        echo "Error: Server script not found after extraction: $SERVER_SCRIPT"\n        echo "Extraction may have failed or server contents are corrupted"\n        print_install_results_and_exit 1\n    fi\n\n    # Verify server script is executable\n    if [[ ! -x "$SERVER_SCRIPT" ]]; then\n        echo "Warning: Server script is not executable, attempting to fix..."\n        chmod +x "$SERVER_SCRIPT" 2>/dev/null || {\n            echo "Error: Cannot make server script executable: $SERVER_SCRIPT"\n            print_install_results_and_exit 1\n        }\n    fi\n\n    popd > /dev/null\nelse\n    echo "Server script already installed in $SERVER_SCRIPT"\nfi\n\n# Try to find if server is already running\nif [[ -f $SERVER_PIDFILE ]]; then\n    SERVER_PID="$(cat $SERVER_PIDFILE)"\n    SERVER_RUNNING_PROCESS="$(ps -o pid,args -p $SERVER_PID | grep $SERVER_SCRIPT)"\nelse\n    SERVER_RUNNING_PROCESS="$(ps -o pid,args -A | grep $SERVER_SCRIPT | grep -v grep)"\nfi\n\nif [[ -z $SERVER_RUNNING_PROCESS ]]; then\n    if [[ -f $SERVER_LOGFILE ]]; then\n        rm $SERVER_LOGFILE\n    fi\n    if [[ -f $SERVER_TOKENFILE ]]; then\n        rm $SERVER_TOKENFILE\n    fi\n\n    touch $SERVER_TOKENFILE\n    chmod 600 $SERVER_TOKENFILE\n    SERVER_CONNECTION_TOKEN="${s.randomUUID()}"\n    echo $SERVER_CONNECTION_TOKEN > $SERVER_TOKENFILE\n\n    $SERVER_SCRIPT --start-server --host=127.0.0.1 $SERVER_LISTEN_FLAG $SERVER_INITIAL_EXTENSIONS --connection-token-file $SERVER_TOKENFILE --telemetry-level off --use-host-proxy --disable-websocket-compression --without-browser-env-var --enable-remote-auto-shutdown --accept-server-license-terms &> $SERVER_LOGFILE &\n    echo $! > $SERVER_PIDFILE\nelse\n    echo "Server script is already running $SERVER_SCRIPT"\nfi\n\nif [[ -f $SERVER_TOKENFILE ]]; then\n    SERVER_CONNECTION_TOKEN="$(cat $SERVER_TOKENFILE)"\nelse\n    echo "Error server token file not found $SERVER_TOKENFILE"\n    print_install_results_and_exit 1\nfi\n\nif [[ -f $SERVER_LOGFILE ]]; then\n    for i in {1..5}; do\n        LISTENING_ON="$(cat $SERVER_LOGFILE | grep -E 'Extension host agent listening on .+' | sed 's/Extension host agent listening on //')"\n        if [[ -n $LISTENING_ON ]]; then\n            break\n        fi\n        sleep 0.5\n    done\n\n    if [[ -z $LISTENING_ON ]]; then\n        echo "Error server did not start sucessfully"\n        print_install_results_and_exit 1\n    fi\nelse\n    echo "Error server log file not found $SERVER_LOGFILE"\n    print_install_results_and_exit 1\nfi\n\n# Finish server setup and keep script running\nif [[ -z $SERVER_RUNNING_PROCESS ]]; then\n    echo "${e}: start"\n    echo "exitCode==0=="\n    echo "listeningOn==$LISTENING_ON=="\n    echo "connectionToken==$SERVER_CONNECTION_TOKEN=="\n    echo "logFile==$SERVER_LOGFILE=="\n    echo "osReleaseId==$OS_RELEASE_ID=="\n    echo "arch==$ARCH=="\n    echo "platform==$PLATFORM=="\n    echo "tmpDir==$TMP_DIR=="\n    ${a.map((e=>`echo "${e}==$${e}=="`)).join("\n")}\n    echo "${e}: end"\n\n    echo "${e}: Server installation script done"\n\n    SERVER_PID="$(cat $SERVER_PIDFILE)"\n    SERVER_RUNNING_PROCESS="$(ps -o pid,args -p $SERVER_PID | grep $SERVER_SCRIPT)"\n    while [[ -n $SERVER_RUNNING_PROCESS ]]; do\n        sleep 300;\n        SERVER_RUNNING_PROCESS="$(ps -o pid,args -p $SERVER_PID | grep $SERVER_SCRIPT)"\n    done\nelse\n    print_install_results_and_exit 0\nfi\n`}({id:c,version:d.version,commit:d.commit,quality:d.quality,release:d.release,extensionIds:o,envVariables:r,serverApplicationName:d.serverApplicationName,serverDataFolderName:d.serverDataFolderName,serverDownloadUrlTemplate:n||d.serverDownloadUrlTemplate||"https://codebuddy-1328495429.cos.accelerate.myqcloud.com/ssh/release/${os}-${arch}/codebuddy-reh-${os}-${arch}-${version}.tar.gz"}),h=await e.exec("bash",["-c",`'${u.replace(/'/g,"'\\''")}'`],t),E=new RegExp(`${c}: Server installation script done`,"m"),p=await Promise.race([h.exitPromise.then((e=>({stdout:h.stdout,stderr:h.stderr,exitCode:e.exitCode}))),new Promise((e=>{h.onStdoutData((t=>{E.test(t.toString("utf8"))&&e({stdout:h.stdout,stderr:h.stderr,exitCode:0})}))}))]);p.exitCode&&i.trace("Server install command stderr:",p.stderr),i.trace("Server install command stdout:",p.stdout);const _=function(e,t){const n=`${t}: start`,o=`${t}: end`,r=e.indexOf(n);if(r<0)return;const i=e.indexOf(o,r+n.length);if(i<0)return;const s={},a=e.substring(r+n.length,i).split(/\r?\n/);for(const e of a){const[t,n]=e.split("==");s[t]=n}return s}(p.stdout,c);if(!_)throw new l("Failed parsing install script output");const m=parseInt(_.exitCode,10);if(0!==m)throw new l("Couldn't install vscode server on remote server, install script returned non-zero exit status");const f=parseInt(_.listeningOn,10),R=Object.fromEntries(Object.entries(_).filter((([e])=>r.includes(e))));return{exitCode:m,listeningOn:f,connectionToken:_.connectionToken,logFile:_.logFile,osReleaseId:_.osReleaseId,arch:_.arch,platform:_.platform,tmpDir:_.tmpDir,...R}}},114:function(e,t,n){var o=this&&this.__createBinding||(Object.create?function(e,t,n,o){void 0===o&&(o=n);var r=Object.getOwnPropertyDescriptor(t,n);r&&!("get"in r?!t.__esModule:r.writable||r.configurable)||(r={enumerable:!0,get:function(){return t[n]}}),Object.defineProperty(e,o,r)}:function(e,t,n,o){void 0===o&&(o=n),e[o]=t[n]}),r=this&&this.__setModuleDefault||(Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t}),i=this&&this.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)"default"!==n&&Object.prototype.hasOwnProperty.call(e,n)&&o(t,e,n);return r(t,e),t};Object.defineProperty(t,"__esModule",{value:!0}),t.WSLManager=void 0;const s=i(n(81)),a=n(110),l="wsl.exe";t.WSLManager=class{constructor(e){this.logger=e}async listDistros(){const e=this._runWSLCommand(["--list","--verbose"],"utf16le"),{exitCode:t}=await e.exitPromise,{stdout:n,stderr:o}=e;if(t)throw this.logger.trace(`Command wsl listDistros exited with code ${t}`,n+"\n\n"+o),new Error(`Command wsl listDistros exited with code ${t}`);const r=/(?<default>\*|\s)\s+(?<name>[\w\.-]+)\s+(?<state>[\w]+)\s+(?<version>\d)/,i=[];for(const e of n.split(/\r?\n/)){const t=e.match(r);t&&t.groups&&i.push({isDefault:"*"===t.groups.default,name:t.groups.name,state:t.groups.state,version:t.groups.version})}return i}async listOnlineDistros(){const e=this._runWSLCommand(["--list","--online"],"utf16le"),{exitCode:t}=await e.exitPromise,{stdout:n,stderr:o}=e;if(t)throw this.logger.trace(`Command wsl listOnlineDistros exited with code ${t}`,n+"\n\n"+o),new Error(`Command wsl listOnlineDistros exited with code ${t}`);let r=n.split(/\r?\n/);const i=r.findIndex((e=>/\s*NAME\s+FRIENDLY NAME\s*/.test(e)));r=r.slice(i+1);const s=/(?<name>[\w\.-]+)\s+(?<friendlyName>\w.+\w)/,a=[];for(const e of r){const t=e.match(s);t&&t.groups&&a.push({name:t.groups.name,friendlyName:t.groups.friendlyName})}return a}async setDefaultDistro(e){const t=this._runWSLCommand(["--set-default",e],"utf16le"),{exitCode:n}=await t.exitPromise,{stdout:o,stderr:r}=t;if(n)throw this.logger.trace(`Command wsl setDefaultDistro exited with code ${n}`,o+"\n\n"+r),new Error(`Command wsl setDefaultDistro exited with code ${n}`)}async deleteDistro(e){const t=this._runWSLCommand(["--unregister",e],"utf16le"),{exitCode:n}=await t.exitPromise,{stdout:o,stderr:r}=t;if(n)throw this.logger.trace(`Command wsl deleteDistro exited with code ${n}`,o+"\n\n"+r),new Error(`Command wsl deleteDistro exited with code ${n}`)}async exec(e,t,n){return this._runWSLCommand(["--distribution",n,"--",e,...t],"utf8")}_runWSLCommand(e,t){this.logger.trace(`Running WSL command: ${l} ${e.join(" ")}`);const n=s.spawn(l,e,{windowsHide:!0,windowsVerbatimArguments:!0}),o=new a.EventEmitter,r=[],i=new a.EventEmitter,c=[];return n.stdout.on("data",(e=>{r.push(e),o.fire(e)})),n.stderr.on("data",(e=>{c.push(e),i.fire(e)})),{get stdout(){return Buffer.concat(r).toString(t)},get stderr(){return Buffer.concat(c).toString(t)},get onStdoutData(){return o.event},get onStderrData(){return i.event},exitPromise:new Promise(((t,o)=>{n.on("error",(t=>{this.logger.error(`Error running WSL command: ${l} ${e.join(" ")}`,t),o(t)})),n.on("exit",((e,n)=>{t({exitCode:e??0})}))}))}}}},574:function(e,t,n){var o=this&&this.__createBinding||(Object.create?function(e,t,n,o){void 0===o&&(o=n);var r=Object.getOwnPropertyDescriptor(t,n);r&&!("get"in r?!t.__esModule:r.writable||r.configurable)||(r={enumerable:!0,get:function(){return t[n]}}),Object.defineProperty(e,o,r)}:function(e,t,n,o){void 0===o&&(o=n),e[o]=t[n]}),r=this&&this.__setModuleDefault||(Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t}),i=this&&this.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)"default"!==n&&Object.prototype.hasOwnProperty.call(e,n)&&o(t,e,n);return r(t,e),t};Object.defineProperty(t,"__esModule",{value:!0});const s=i(n(496));class a{getTerminal(){return s.window.terminals.find((e=>e.name===a.NAME))||s.window.createTerminal(a.NAME)}runCommand(e){const t=this.getTerminal();t.show(!1),t.sendText(e,!0)}}a.NAME="WSL",t.default=new a},496:e=>{e.exports=require("vscode")},81:e=>{e.exports=require("child_process")},113:e=>{e.exports=require("crypto")},147:e=>{e.exports=require("fs")},17:e=>{e.exports=require("path")}},t={},n=function n(o){var r=t[o];if(void 0!==r)return r.exports;var i=t[o]={exports:{}};return e[o].call(i.exports,i,i.exports,n),i.exports}(112);module.exports=n})();